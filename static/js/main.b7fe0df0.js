/*! For license information please see main.b7fe0df0.js.LICENSE.txt */
(()=>{var e={16:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/comfort-stay.025f3fb60d15c6af7ffa.jpg"},23:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/route1.611b23f78c07d8b2f5d4.jpg"},24:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII="},43:(e,t,n)=>{"use strict";e.exports=n(202)},66:function(e,t,n){var a;!function(e,s){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var a=0;a<n.length+64;a++)t.x^=0|n.charCodeAt(a),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function o(e,t){var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,a&&("object"==typeof a&&i(a,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(a=function(){return o}.call(t,n,t,s))||(s.exports=a):this.xor128=o}(0,e=n.nmd(e),n.amdD)},71:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC"},96:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/route2.8a1b955f70342bff015f.jpg"},105:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/spice-villa.6e2f29dc80375068f124.jpg"},108:()=>{},153:(e,t,n)=>{"use strict";var a=n(43),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var a,r={},c=null,u=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,a)&&!l.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:s,type:e,key:c,ref:u,props:r,_owner:o.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=x.prototype;var v=b.prototype=new y;v.constructor=b,f(v,x.prototype),v.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,N={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,a){var s,r={},i=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)k.call(t,s)&&!_.hasOwnProperty(s)&&(r[s]=t[s]);var l=arguments.length-2;if(1===l)r.children=a;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===r[s]&&(r[s]=l[s]);return{$$typeof:n,type:e,key:i,ref:o,props:r,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var j=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,s,r,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case a:l=!0}}if(l)return i=i(l=e),e=""===r?"."+T(l,0):r,w(i)?(s="",null!=e&&(s=e.replace(j,"$&/")+"/"),I(i,t,s,"",function(e){return e})):null!=i&&(C(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,s+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(j,"$&/")+"/")+e)),t.push(i)),1;if(l=0,r=""===r?".":r+":",w(e))for(var c=0;c<e.length;c++){var u=r+T(o=e[c],c);l+=I(o,t,s,u,i)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=I(o=o.value,t,s,u=r+T(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function E(e,t,n){if(null==e)return e;var a=[],s=0;return I(e,a,"","",function(e){return t.call(n,e,s++)}),a}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},M={transition:null},L={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:M,ReactCurrentOwner:N};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:E,forEach:function(e,t,n){E(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return E(e,function(){t++}),t},toArray:function(e){return E(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=s,t.Profiler=i,t.PureComponent=b,t.StrictMode=r,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=D,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=f({},e.props),r=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=N.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!_.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=a;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:n,type:e.type,key:r,ref:i,props:s,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},228:function(e,t){!function(e){"use strict";var t="1.9.4";function n(e){var t,n,a,s;for(n=1,a=arguments.length;n<a;n++)for(t in s=arguments[n])e[t]=s[t];return e}var a=Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}();function s(e,t){var n=Array.prototype.slice;if(e.bind)return e.bind.apply(e,n.call(arguments,1));var a=n.call(arguments,2);return function(){return e.apply(t,a.length?a.concat(n.call(arguments)):arguments)}}var r=0;function i(e){return"_leaflet_id"in e||(e._leaflet_id=++r),e._leaflet_id}function o(e,t,n){var a,s,r,i;return i=function(){a=!1,s&&(r.apply(n,s),s=!1)},r=function(){a?s=arguments:(e.apply(n,arguments),setTimeout(i,t),a=!0)},r}function l(e,t,n){var a=t[1],s=t[0],r=a-s;return e===a&&n?e:((e-s)%r+r)%r+s}function c(){return!1}function u(e,t){if(!1===t)return e;var n=Math.pow(10,void 0===t?6:t);return Math.round(e*n)/n}function d(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function h(e){return d(e).split(/\s+/)}function p(e,t){for(var n in Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?a(e.options):{}),t)e.options[n]=t[n];return e.options}function m(e,t,n){var a=[];for(var s in e)a.push(encodeURIComponent(n?s.toUpperCase():s)+"="+encodeURIComponent(e[s]));return(t&&-1!==t.indexOf("?")?"&":"?")+a.join("&")}var f=/\{ *([\w_ -]+) *\}/g;function g(e,t){return e.replace(f,function(e,n){var a=t[n];if(void 0===a)throw new Error("No value provided for variable "+e);return"function"===typeof a&&(a=a(t)),a})}var x=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function y(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var b="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function v(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var w=0;function k(e){var t=+new Date,n=Math.max(0,16-(t-w));return w=t+n,window.setTimeout(e,n)}var N=window.requestAnimationFrame||v("RequestAnimationFrame")||k,_=window.cancelAnimationFrame||v("CancelAnimationFrame")||v("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function S(e,t,n){if(!n||N!==k)return N.call(window,s(e,t));e.call(t)}function C(e){e&&_.call(window,e)}var j={__proto__:null,extend:n,create:a,bind:s,get lastId(){return r},stamp:i,throttle:o,wrapNum:l,falseFn:c,formatNum:u,trim:d,splitWords:h,setOptions:p,getParamString:m,template:g,isArray:x,indexOf:y,emptyImageUrl:b,requestFn:N,cancelFn:_,requestAnimFrame:S,cancelAnimFrame:C};function T(){}function I(e){if("undefined"!==typeof L&&L&&L.Mixin){e=x(e)?e:[e];for(var t=0;t<e.length;t++)e[t]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}T.extend=function(e){var t=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},s=t.__super__=this.prototype,r=a(s);for(var i in r.constructor=t,t.prototype=r,this)Object.prototype.hasOwnProperty.call(this,i)&&"prototype"!==i&&"__super__"!==i&&(t[i]=this[i]);return e.statics&&n(t,e.statics),e.includes&&(I(e.includes),n.apply(null,[r].concat(e.includes))),n(r,e),delete r.statics,delete r.includes,r.options&&(r.options=s.options?a(s.options):{},n(r.options,e.options)),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){s.callInitHooks&&s.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=r._initHooks.length;e<t;e++)r._initHooks[e].call(this)}},t},T.include=function(e){var t=this.prototype.options;return n(this.prototype,e),e.options&&(this.prototype.options=t,this.mergeOptions(e.options)),this},T.mergeOptions=function(e){return n(this.prototype.options,e),this},T.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"===typeof e?e:function(){this[e].apply(this,t)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var E={on:function(e,t,n){if("object"===typeof e)for(var a in e)this._on(a,e[a],t);else for(var s=0,r=(e=h(e)).length;s<r;s++)this._on(e[s],t,n);return this},off:function(e,t,n){if(arguments.length)if("object"===typeof e)for(var a in e)this._off(a,e[a],t);else{e=h(e);for(var s=1===arguments.length,r=0,i=e.length;r<i;r++)s?this._off(e[r]):this._off(e[r],t,n)}else delete this._events;return this},_on:function(e,t,n,a){if("function"===typeof t){if(!1===this._listens(e,t,n)){n===this&&(n=void 0);var s={fn:t,ctx:n};a&&(s.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(s)}}else console.warn("wrong listener type: "+typeof t)},_off:function(e,t,n){var a,s,r;if(this._events&&(a=this._events[e]))if(1!==arguments.length)if("function"===typeof t){var i=this._listens(e,t,n);if(!1!==i){var o=a[i];this._firingCount&&(o.fn=c,this._events[e]=a=a.slice()),a.splice(i,1)}}else console.warn("wrong listener type: "+typeof t);else{if(this._firingCount)for(s=0,r=a.length;s<r;s++)a[s].fn=c;delete this._events[e]}},fire:function(e,t,a){if(!this.listens(e,a))return this;var s=n({},t,{type:e,target:this,sourceTarget:t&&t.sourceTarget||this});if(this._events){var r=this._events[e];if(r){this._firingCount=this._firingCount+1||1;for(var i=0,o=r.length;i<o;i++){var l=r[i],c=l.fn;l.once&&this.off(e,c,l.ctx),c.call(l.ctx||this,s)}this._firingCount--}}return a&&this._propagateEvent(s),this},listens:function(e,t,n,a){"string"!==typeof e&&console.warn('"string" type argument expected');var s=t;"function"!==typeof t&&(a=!!t,s=void 0,n=void 0);var r=this._events&&this._events[e];if(r&&r.length&&!1!==this._listens(e,s,n))return!0;if(a)for(var i in this._eventParents)if(this._eventParents[i].listens(e,t,n,a))return!0;return!1},_listens:function(e,t,n){if(!this._events)return!1;var a=this._events[e]||[];if(!t)return!!a.length;n===this&&(n=void 0);for(var s=0,r=a.length;s<r;s++)if(a[s].fn===t&&a[s].ctx===n)return s;return!1},once:function(e,t,n){if("object"===typeof e)for(var a in e)this._on(a,e[a],t,!0);else for(var s=0,r=(e=h(e)).length;s<r;s++)this._on(e[s],t,n,!0);return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[i(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[i(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,n({layer:e.target,propagatedFrom:e.target},e),!0)}};E.addEventListener=E.on,E.removeEventListener=E.clearAllEventListeners=E.off,E.addOneTimeEventListener=E.once,E.fireEvent=E.fire,E.hasEventListeners=E.listens;var A=T.extend(E);function R(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t}var M=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};function D(e,t,n){return e instanceof R?e:x(e)?new R(e[0],e[1]):void 0===e||null===e?e:"object"===typeof e&&"x"in e&&"y"in e?new R(e.x,e.y):new R(e,t,n)}function O(e,t){if(e)for(var n=t?[e,t]:e,a=0,s=n.length;a<s;a++)this.extend(n[a])}function F(e,t){return!e||e instanceof O?e:new O(e,t)}function P(e,t){if(e)for(var n=t?[e,t]:e,a=0,s=n.length;a<s;a++)this.extend(n[a])}function z(e,t){return e instanceof P?e:new P(e,t)}function B(e,t,n){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,void 0!==n&&(this.alt=+n)}function W(e,t,n){return e instanceof B?e:x(e)&&"object"!==typeof e[0]?3===e.length?new B(e[0],e[1],e[2]):2===e.length?new B(e[0],e[1]):null:void 0===e||null===e?e:"object"===typeof e&&"lat"in e?new B(e.lat,"lng"in e?e.lng:e.lon,e.alt):void 0===t?null:new B(e,t,n)}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(e){return this.clone()._add(D(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(D(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new R(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new R(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=M(this.x),this.y=M(this.y),this},distanceTo:function(e){var t=(e=D(e)).x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return(e=D(e)).x===this.x&&e.y===this.y},contains:function(e){return e=D(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},O.prototype={extend:function(e){var t,n;if(!e)return this;if(e instanceof R||"number"===typeof e[0]||"x"in e)t=n=D(e);else if(t=(e=F(e)).min,n=e.max,!t||!n)return this;return this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=t.clone(),this.max=n.clone()),this},getCenter:function(e){return D((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return D(this.min.x,this.max.y)},getTopRight:function(){return D(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return(e="number"===typeof e[0]||e instanceof R?D(e):F(e))instanceof O?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=F(e);var t=this.min,n=this.max,a=e.min,s=e.max,r=s.x>=t.x&&a.x<=n.x,i=s.y>=t.y&&a.y<=n.y;return r&&i},overlaps:function(e){e=F(e);var t=this.min,n=this.max,a=e.min,s=e.max,r=s.x>t.x&&a.x<n.x,i=s.y>t.y&&a.y<n.y;return r&&i},isValid:function(){return!(!this.min||!this.max)},pad:function(e){var t=this.min,n=this.max,a=Math.abs(t.x-n.x)*e,s=Math.abs(t.y-n.y)*e;return F(D(t.x-a,t.y-s),D(n.x+a,n.y+s))},equals:function(e){return!!e&&(e=F(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight()))}},P.prototype={extend:function(e){var t,n,a=this._southWest,s=this._northEast;if(e instanceof B)t=e,n=e;else{if(!(e instanceof P))return e?this.extend(W(e)||z(e)):this;if(t=e._southWest,n=e._northEast,!t||!n)return this}return a||s?(a.lat=Math.min(t.lat,a.lat),a.lng=Math.min(t.lng,a.lng),s.lat=Math.max(n.lat,s.lat),s.lng=Math.max(n.lng,s.lng)):(this._southWest=new B(t.lat,t.lng),this._northEast=new B(n.lat,n.lng)),this},pad:function(e){var t=this._southWest,n=this._northEast,a=Math.abs(t.lat-n.lat)*e,s=Math.abs(t.lng-n.lng)*e;return new P(new B(t.lat-a,t.lng-s),new B(n.lat+a,n.lng+s))},getCenter:function(){return new B((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new B(this.getNorth(),this.getWest())},getSouthEast:function(){return new B(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"===typeof e[0]||e instanceof B||"lat"in e?W(e):z(e);var t,n,a=this._southWest,s=this._northEast;return e instanceof P?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=a.lat&&n.lat<=s.lat&&t.lng>=a.lng&&n.lng<=s.lng},intersects:function(e){e=z(e);var t=this._southWest,n=this._northEast,a=e.getSouthWest(),s=e.getNorthEast(),r=s.lat>=t.lat&&a.lat<=n.lat,i=s.lng>=t.lng&&a.lng<=n.lng;return r&&i},overlaps:function(e){e=z(e);var t=this._southWest,n=this._northEast,a=e.getSouthWest(),s=e.getNorthEast(),r=s.lat>t.lat&&a.lat<n.lat,i=s.lng>t.lng&&a.lng<n.lng;return r&&i},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,t){return!!e&&(e=z(e),this._southWest.equals(e.getSouthWest(),t)&&this._northEast.equals(e.getNorthEast(),t))},isValid:function(){return!(!this._southWest||!this._northEast)}},B.prototype={equals:function(e,t){return!!e&&(e=W(e),Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng))<=(void 0===t?1e-9:t))},toString:function(e){return"LatLng("+u(this.lat,e)+", "+u(this.lng,e)+")"},distanceTo:function(e){return U.distance(this,W(e))},wrap:function(){return U.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return z([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new B(this.lat,this.lng,this.alt)}};var V={latLngToPoint:function(e,t){var n=this.projection.project(e),a=this.scale(t);return this.transformation._transform(n,a)},pointToLatLng:function(e,t){var n=this.scale(t),a=this.transformation.untransform(e,n);return this.projection.unproject(a)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e);return new O(this.transformation.transform(t.min,n),this.transformation.transform(t.max,n))},infinite:!1,wrapLatLng:function(e){var t=this.wrapLng?l(e.lng,this.wrapLng,!0):e.lng;return new B(this.wrapLat?l(e.lat,this.wrapLat,!0):e.lat,t,e.alt)},wrapLatLngBounds:function(e){var t=e.getCenter(),n=this.wrapLatLng(t),a=t.lat-n.lat,s=t.lng-n.lng;if(0===a&&0===s)return e;var r=e.getSouthWest(),i=e.getNorthEast();return new P(new B(r.lat-a,r.lng-s),new B(i.lat-a,i.lng-s))}},U=n({},V,{wrapLng:[-180,180],R:6371e3,distance:function(e,t){var n=Math.PI/180,a=e.lat*n,s=t.lat*n,r=Math.sin((t.lat-e.lat)*n/2),i=Math.sin((t.lng-e.lng)*n/2),o=r*r+Math.cos(a)*Math.cos(s)*i*i,l=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return this.R*l}}),H=6378137,G={R:H,MAX_LATITUDE:85.0511287798,project:function(e){var t=Math.PI/180,n=this.MAX_LATITUDE,a=Math.max(Math.min(n,e.lat),-n),s=Math.sin(a*t);return new R(this.R*e.lng*t,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(e){var t=180/Math.PI;return new B((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:function(){var e=H*Math.PI;return new O([-e,-e],[e,e])}()};function q(e,t,n,a){if(x(e))return this._a=e[0],this._b=e[1],this._c=e[2],void(this._d=e[3]);this._a=e,this._b=t,this._c=n,this._d=a}function K(e,t,n,a){return new q(e,t,n,a)}q.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new R((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}};var Z=n({},U,{code:"EPSG:3857",projection:G,transformation:function(){var e=.5/(Math.PI*G.R);return K(e,.5,-e,.5)}()}),X=n({},Z,{code:"EPSG:900913"});function Y(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function J(e,t){var n,a,s,r,i,o,l="";for(n=0,s=e.length;n<s;n++){for(a=0,r=(i=e[n]).length;a<r;a++)l+=(a?"L":"M")+(o=i[a]).x+" "+o.y;l+=t?Oe.svg?"z":"x":""}return l||"M0 0"}var Q=document.documentElement.style,$="ActiveXObject"in window,ee=$&&!document.addEventListener,te="msLaunchUri"in navigator&&!("documentMode"in document),ne=De("webkit"),ae=De("android"),se=De("android 2")||De("android 3"),re=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ie=ae&&De("Google")&&re<537&&!("AudioNode"in window),oe=!!window.opera,le=!te&&De("chrome"),ce=De("gecko")&&!ne&&!oe&&!$,ue=!le&&De("safari"),de=De("phantom"),he="OTransition"in Q,pe=0===navigator.platform.indexOf("Win"),me=$&&"transition"in Q,fe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!se,ge="MozPerspective"in Q,xe=!window.L_DISABLE_3D&&(me||fe||ge)&&!he&&!de,ye="undefined"!==typeof orientation||De("mobile"),be=ye&&ne,ve=ye&&fe,we=!window.PointerEvent&&window.MSPointerEvent,ke=!(!window.PointerEvent&&!we),Ne="ontouchstart"in window||!!window.TouchEvent,_e=!window.L_NO_TOUCH&&(Ne||ke),Se=ye&&oe,Ce=ye&&ce,je=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Te=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",c,t),window.removeEventListener("testPassiveEventSupport",c,t)}catch(n){}return e}(),Ie=!!document.createElement("canvas").getContext,Ee=!(!document.createElementNS||!Y("svg").createSVGRect),Ae=!!Ee&&function(){var e=document.createElement("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(e.firstChild&&e.firstChild.namespaceURI)}(),Re=!Ee&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"===typeof t.adj}catch(n){return!1}}(),Me=0===navigator.platform.indexOf("Mac"),Le=0===navigator.platform.indexOf("Linux");function De(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var Oe={ie:$,ielt9:ee,edge:te,webkit:ne,android:ae,android23:se,androidStock:ie,opera:oe,chrome:le,gecko:ce,safari:ue,phantom:de,opera12:he,win:pe,ie3d:me,webkit3d:fe,gecko3d:ge,any3d:xe,mobile:ye,mobileWebkit:be,mobileWebkit3d:ve,msPointer:we,pointer:ke,touch:_e,touchNative:Ne,mobileOpera:Se,mobileGecko:Ce,retina:je,passiveEvents:Te,canvas:Ie,svg:Ee,vml:Re,inlineSvg:Ae,mac:Me,linux:Le},Fe=Oe.msPointer?"MSPointerDown":"pointerdown",Pe=Oe.msPointer?"MSPointerMove":"pointermove",ze=Oe.msPointer?"MSPointerUp":"pointerup",Be=Oe.msPointer?"MSPointerCancel":"pointercancel",We={touchstart:Fe,touchmove:Pe,touchend:ze,touchcancel:Be},Ve={touchstart:Qe,touchmove:Je,touchend:Je,touchcancel:Je},Ue={},He=!1;function Ge(e,t,n){return"touchstart"===t&&Ye(),Ve[t]?(n=Ve[t].bind(this,n),e.addEventListener(We[t],n,!1),n):(console.warn("wrong event specified:",t),c)}function qe(e,t,n){We[t]?e.removeEventListener(We[t],n,!1):console.warn("wrong event specified:",t)}function Ke(e){Ue[e.pointerId]=e}function Ze(e){Ue[e.pointerId]&&(Ue[e.pointerId]=e)}function Xe(e){delete Ue[e.pointerId]}function Ye(){He||(document.addEventListener(Fe,Ke,!0),document.addEventListener(Pe,Ze,!0),document.addEventListener(ze,Xe,!0),document.addEventListener(Be,Xe,!0),He=!0)}function Je(e,t){if(t.pointerType!==(t.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in t.touches=[],Ue)t.touches.push(Ue[n]);t.changedTouches=[t],e(t)}}function Qe(e,t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&Kt(t),Je(e,t)}function $e(e){var t,n,a={};for(n in e)t=e[n],a[n]=t&&t.bind?t.bind(e):t;return e=a,a.type="dblclick",a.detail=2,a.isTrusted=!1,a._simulated=!0,a}var et=200;function tt(e,t){e.addEventListener("dblclick",t);var n,a=0;function s(e){if(1===e.detail){if("mouse"!==e.pointerType&&(!e.sourceCapabilities||e.sourceCapabilities.firesTouchEvents)){var s=Xt(e);if(!s.some(function(e){return e instanceof HTMLLabelElement&&e.attributes.for})||s.some(function(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement})){var r=Date.now();r-a<=et?2===++n&&t($e(e)):n=1,a=r}}}else n=e.detail}return e.addEventListener("click",s),{dblclick:t,simDblclick:s}}function nt(e,t){e.removeEventListener("dblclick",t.dblclick),e.removeEventListener("click",t.simDblclick)}var at,st,rt,it,ot,lt=St(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ct=St(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ut="webkitTransition"===ct||"OTransition"===ct?ct+"End":"transitionend";function dt(e){return"string"===typeof e?document.getElementById(e):e}function ht(e,t){var n=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!n||"auto"===n)&&document.defaultView){var a=document.defaultView.getComputedStyle(e,null);n=a?a[t]:null}return"auto"===n?null:n}function pt(e,t,n){var a=document.createElement(e);return a.className=t||"",n&&n.appendChild(a),a}function mt(e){var t=e.parentNode;t&&t.removeChild(e)}function ft(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function gt(e){var t=e.parentNode;t&&t.lastChild!==e&&t.appendChild(e)}function xt(e){var t=e.parentNode;t&&t.firstChild!==e&&t.insertBefore(e,t.firstChild)}function yt(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=kt(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function bt(e,t){if(void 0!==e.classList)for(var n=h(t),a=0,s=n.length;a<s;a++)e.classList.add(n[a]);else if(!yt(e,t)){var r=kt(e);wt(e,(r?r+" ":"")+t)}}function vt(e,t){void 0!==e.classList?e.classList.remove(t):wt(e,d((" "+kt(e)+" ").replace(" "+t+" "," ")))}function wt(e,t){void 0===e.className.baseVal?e.className=t:e.className.baseVal=t}function kt(e){return e.correspondingElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function Nt(e,t){"opacity"in e.style?e.style.opacity=t:"filter"in e.style&&_t(e,t)}function _t(e,t){var n=!1,a="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(a)}catch(s){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+a+"(opacity="+t+")"}function St(e){for(var t=document.documentElement.style,n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1}function Ct(e,t,n){var a=t||new R(0,0);e.style[lt]=(Oe.ie3d?"translate("+a.x+"px,"+a.y+"px)":"translate3d("+a.x+"px,"+a.y+"px,0)")+(n?" scale("+n+")":"")}function jt(e,t){e._leaflet_pos=t,Oe.any3d?Ct(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")}function Tt(e){return e._leaflet_pos||new R(0,0)}if("onselectstart"in document)at=function(){Ft(window,"selectstart",Kt)},st=function(){zt(window,"selectstart",Kt)};else{var It=St(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);at=function(){if(It){var e=document.documentElement.style;rt=e[It],e[It]="none"}},st=function(){It&&(document.documentElement.style[It]=rt,rt=void 0)}}function Et(){Ft(window,"dragstart",Kt)}function At(){zt(window,"dragstart",Kt)}function Rt(e){for(;-1===e.tabIndex;)e=e.parentNode;e.style&&(Mt(),it=e,ot=e.style.outlineStyle,e.style.outlineStyle="none",Ft(window,"keydown",Mt))}function Mt(){it&&(it.style.outlineStyle=ot,it=void 0,ot=void 0,zt(window,"keydown",Mt))}function Lt(e){do{e=e.parentNode}while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function Dt(e){var t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}var Ot={__proto__:null,TRANSFORM:lt,TRANSITION:ct,TRANSITION_END:ut,get:dt,getStyle:ht,create:pt,remove:mt,empty:ft,toFront:gt,toBack:xt,hasClass:yt,addClass:bt,removeClass:vt,setClass:wt,getClass:kt,setOpacity:Nt,testProp:St,setTransform:Ct,setPosition:jt,getPosition:Tt,get disableTextSelection(){return at},get enableTextSelection(){return st},disableImageDrag:Et,enableImageDrag:At,preventOutline:Rt,restoreOutline:Mt,getSizedParentNode:Lt,getScale:Dt};function Ft(e,t,n,a){if(t&&"object"===typeof t)for(var s in t)Vt(e,s,t[s],n);else for(var r=0,i=(t=h(t)).length;r<i;r++)Vt(e,t[r],n,a);return this}var Pt="_leaflet_events";function zt(e,t,n,a){if(1===arguments.length)Bt(e),delete e[Pt];else if(t&&"object"===typeof t)for(var s in t)Ut(e,s,t[s],n);else if(t=h(t),2===arguments.length)Bt(e,function(e){return-1!==y(t,e)});else for(var r=0,i=t.length;r<i;r++)Ut(e,t[r],n,a);return this}function Bt(e,t){for(var n in e[Pt]){var a=n.split(/\d/)[0];t&&!t(a)||Ut(e,a,null,null,n)}}var Wt={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Vt(e,t,n,a){var s=t+i(n)+(a?"_"+i(a):"");if(e[Pt]&&e[Pt][s])return this;var r=function(t){return n.call(a||e,t||window.event)},o=r;!Oe.touchNative&&Oe.pointer&&0===t.indexOf("touch")?r=Ge(e,t,r):Oe.touch&&"dblclick"===t?r=tt(e,r):"addEventListener"in e?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?e.addEventListener(Wt[t]||t,r,!!Oe.passiveEvents&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?(r=function(t){t=t||window.event,$t(e,t)&&o(t)},e.addEventListener(Wt[t],r,!1)):e.addEventListener(t,o,!1):e.attachEvent("on"+t,r),e[Pt]=e[Pt]||{},e[Pt][s]=r}function Ut(e,t,n,a,s){s=s||t+i(n)+(a?"_"+i(a):"");var r=e[Pt]&&e[Pt][s];if(!r)return this;!Oe.touchNative&&Oe.pointer&&0===t.indexOf("touch")?qe(e,t,r):Oe.touch&&"dblclick"===t?nt(e,r):"removeEventListener"in e?e.removeEventListener(Wt[t]||t,r,!1):e.detachEvent("on"+t,r),e[Pt][s]=null}function Ht(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function Gt(e){return Vt(e,"wheel",Ht),this}function qt(e){return Ft(e,"mousedown touchstart dblclick contextmenu",Ht),e._leaflet_disable_click=!0,this}function Kt(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function Zt(e){return Kt(e),Ht(e),this}function Xt(e){if(e.composedPath)return e.composedPath();for(var t=[],n=e.target;n;)t.push(n),n=n.parentNode;return t}function Yt(e,t){if(!t)return new R(e.clientX,e.clientY);var n=Dt(t),a=n.boundingClientRect;return new R((e.clientX-a.left)/n.x-t.clientLeft,(e.clientY-a.top)/n.y-t.clientTop)}var Jt=Oe.linux&&Oe.chrome?window.devicePixelRatio:Oe.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Qt(e){return Oe.edge?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/Jt:e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0}function $t(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(a){return!1}return n!==e}var en={__proto__:null,on:Ft,off:zt,stopPropagation:Ht,disableScrollPropagation:Gt,disableClickPropagation:qt,preventDefault:Kt,stop:Zt,getPropagationPath:Xt,getMousePosition:Yt,getWheelDelta:Qt,isExternalTarget:$t,addListener:Ft,removeListener:zt},tn=A.extend({run:function(e,t,n,a){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(a||.5,.2),this._startPos=Tt(e),this._offset=t.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=S(this._animate,this),this._step()},_step:function(e){var t=+new Date-this._startTime,n=1e3*this._duration;t<n?this._runFrame(this._easeOut(t/n),e):(this._runFrame(1),this._complete())},_runFrame:function(e,t){var n=this._startPos.add(this._offset.multiplyBy(e));t&&n._round(),jt(this._el,n),this.fire("step")},_complete:function(){C(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),nn=A.extend({options:{crs:Z,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,t){t=p(this,t),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=s(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),void 0!==t.zoom&&(this._zoom=this._limitZoom(t.zoom)),t.center&&void 0!==t.zoom&&this.setView(W(t.center),t.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ct&&Oe.any3d&&!Oe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ft(this._proxy,ut,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,t,a){return t=void 0===t?this._zoom:this._limitZoom(t),e=this._limitCenter(W(e),t,this.options.maxBounds),a=a||{},this._stop(),this._loaded&&!a.reset&&!0!==a&&(void 0!==a.animate&&(a.zoom=n({animate:a.animate},a.zoom),a.pan=n({animate:a.animate,duration:a.duration},a.pan)),this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,a.zoom):this._tryAnimatedPan(e,a.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(e,t,a.pan&&a.pan.noMoveStart),this)},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=e,this)},zoomIn:function(e,t){return e=e||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,t)},zoomOut:function(e,t){return e=e||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,t)},setZoomAround:function(e,t,n){var a=this.getZoomScale(t),s=this.getSize().divideBy(2),r=(e instanceof R?e:this.latLngToContainerPoint(e)).subtract(s).multiplyBy(1-1/a),i=this.containerPointToLatLng(s.add(r));return this.setView(i,t,{zoom:n})},_getBoundsCenterZoom:function(e,t){t=t||{},e=e.getBounds?e.getBounds():z(e);var n=D(t.paddingTopLeft||t.padding||[0,0]),a=D(t.paddingBottomRight||t.padding||[0,0]),s=this.getBoundsZoom(e,!1,n.add(a));if((s="number"===typeof t.maxZoom?Math.min(t.maxZoom,s):s)===1/0)return{center:e.getCenter(),zoom:s};var r=a.subtract(n).divideBy(2),i=this.project(e.getSouthWest(),s),o=this.project(e.getNorthEast(),s);return{center:this.unproject(i.add(o).divideBy(2).add(r),s),zoom:s}},fitBounds:function(e,t){if(!(e=z(e)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(e,t);return this.setView(n.center,n.zoom,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e,t){if(t=t||{},!(e=D(e).round()).x&&!e.y)return this.fire("moveend");if(!0!==t.animate&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new tn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),!1!==t.animate){bt(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,t,n){if(!1===(n=n||{}).animate||!Oe.any3d)return this.setView(e,t,n);this._stop();var a=this.project(this.getCenter()),s=this.project(e),r=this.getSize(),i=this._zoom;e=W(e),t=void 0===t?i:t;var o=Math.max(r.x,r.y),l=o*this.getZoomScale(i,t),c=s.distanceTo(a)||1,u=1.42,d=u*u;function h(e){var t=(l*l-o*o+(e?-1:1)*d*d*c*c)/(2*(e?l:o)*d*c),n=Math.sqrt(t*t+1)-t;return n<1e-9?-18:Math.log(n)}function p(e){return(Math.exp(e)-Math.exp(-e))/2}function m(e){return(Math.exp(e)+Math.exp(-e))/2}function f(e){return p(e)/m(e)}var g=h(0);function x(e){return o*(m(g)/m(g+u*e))}function y(e){return o*(m(g)*f(g+u*e)-p(g))/d}function b(e){return 1-Math.pow(1-e,1.5)}var v=Date.now(),w=(h(1)-g)/u,k=n.duration?1e3*n.duration:1e3*w*.8;function N(){var n=(Date.now()-v)/k,r=b(n)*w;n<=1?(this._flyToFrame=S(N,this),this._move(this.unproject(a.add(s.subtract(a).multiplyBy(y(r)/c)),i),this.getScaleZoom(o/x(r),i),{flyTo:!0})):this._move(e,t)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),N.call(this),this},flyToBounds:function(e,t){var n=this._getBoundsCenterZoom(e,t);return this.flyTo(n.center,n.zoom,t)},setMaxBounds:function(e){return e=z(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var t=this.options.minZoom;return this.options.minZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var t=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,t){this._enforcingBounds=!0;var n=this.getCenter(),a=this._limitCenter(n,this._zoom,z(e));return n.equals(a)||this.panTo(a,t),this._enforcingBounds=!1,this},panInside:function(e,t){var n=D((t=t||{}).paddingTopLeft||t.padding||[0,0]),a=D(t.paddingBottomRight||t.padding||[0,0]),s=this.project(this.getCenter()),r=this.project(e),i=this.getPixelBounds(),o=F([i.min.add(n),i.max.subtract(a)]),l=o.getSize();if(!o.contains(r)){this._enforcingBounds=!0;var c=r.subtract(o.getCenter()),u=o.extend(r).getSize().subtract(l);s.x+=c.x<0?-u.x:u.x,s.y+=c.y<0?-u.y:u.y,this.panTo(this.unproject(s),t),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=n({animate:!1,pan:!0},!0===e?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var a=this.getSize(),r=t.divideBy(2).round(),i=a.divideBy(2).round(),o=r.subtract(i);return o.x||o.y?(e.animate&&e.pan?this.panBy(o):(e.pan&&this._rawPanBy(o),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:a})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=n({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=s(this._handleGeolocationResponse,this),a=s(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,a,e):navigator.geolocation.getCurrentPosition(t,a,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var t=e.code,n=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var t=new B(e.coords.latitude,e.coords.longitude),n=t.toBounds(2*e.coords.accuracy),a=this._locateOptions;if(a.setView){var s=this.getBoundsZoom(n);this.setView(t,a.maxZoom?Math.min(s,a.maxZoom):s)}var r={latlng:t,bounds:n,timestamp:e.timestamp};for(var i in e.coords)"number"===typeof e.coords[i]&&(r[i]=e.coords[i]);this.fire("locationfound",r)}},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var e;for(e in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),mt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(C(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[e].remove();for(e in this._panes)mt(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,t){var n=pt("div","leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),t||this._mapPane);return e&&(this._panes[e]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds();return new P(this.unproject(e.getBottomLeft()),this.unproject(e.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=z(e),n=D(n||[0,0]);var a=this.getZoom()||0,s=this.getMinZoom(),r=this.getMaxZoom(),i=e.getNorthWest(),o=e.getSouthEast(),l=this.getSize().subtract(n),c=F(this.project(o,a),this.project(i,a)).getSize(),u=Oe.any3d?this.options.zoomSnap:1,d=l.x/c.x,h=l.y/c.y,p=t?Math.max(d,h):Math.min(d,h);return a=this.getScaleZoom(p,a),u&&(a=Math.round(a/(u/100))*(u/100),a=t?Math.ceil(a/u)*u:Math.floor(a/u)*u),Math.max(s,Math.min(r,a))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new R(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,t){var n=this._getTopLeftPoint(e,t);return new O(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(void 0===e?this.getZoom():e)},getPane:function(e){return"string"===typeof e?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,t){var n=this.options.crs;return t=void 0===t?this._zoom:t,n.scale(e)/n.scale(t)},getScaleZoom:function(e,t){var n=this.options.crs;t=void 0===t?this._zoom:t;var a=n.zoom(e*n.scale(t));return isNaN(a)?1/0:a},project:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.latLngToPoint(W(e),t)},unproject:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.pointToLatLng(D(e),t)},layerPointToLatLng:function(e){var t=D(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){return this.project(W(e))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(W(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(z(e))},distance:function(e,t){return this.options.crs.distance(W(e),W(t))},containerPointToLayerPoint:function(e){return D(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return D(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(D(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(W(e)))},mouseEventToContainerPoint:function(e){return Yt(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=dt(e);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");Ft(t,"scroll",this._onScroll,this),this._containerId=i(t)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&Oe.any3d,bt(e,"leaflet-container"+(Oe.touch?" leaflet-touch":"")+(Oe.retina?" leaflet-retina":"")+(Oe.ielt9?" leaflet-oldie":"")+(Oe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var t=ht(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&"sticky"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),jt(this._mapPane,new R(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(bt(e.markerPane,"leaflet-zoom-hide"),bt(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,t,n){jt(this._mapPane,new R(0,0));var a=!this._loaded;this._loaded=!0,t=this._limitZoom(t),this.fire("viewprereset");var s=this._zoom!==t;this._moveStart(s,n)._move(e,t)._moveEnd(s),this.fire("viewreset"),a&&this.fire("load")},_moveStart:function(e,t){return e&&this.fire("zoomstart"),t||this.fire("movestart"),this},_move:function(e,t,n,a){void 0===t&&(t=this._zoom);var s=this._zoom!==t;return this._zoom=t,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),a?n&&n.pinch&&this.fire("zoom",n):((s||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return C(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){jt(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[i(this._container)]=this;var t=e?zt:Ft;t(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&t(window,"resize",this._onResize,this),Oe.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){C(this._resizeRequest),this._resizeRequest=S(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,t){for(var n,a=[],s="mouseout"===t||"mouseover"===t,r=e.target||e.srcElement,o=!1;r;){if((n=this._targets[i(r)])&&("click"===t||"preclick"===t)&&this._draggableMoved(n)){o=!0;break}if(n&&n.listens(t,!0)){if(s&&!$t(r,e))break;if(a.push(n),s)break}if(r===this._container)break;r=r.parentNode}return a.length||o||s||!this.listens(t,!0)||(a=[this]),a},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var t=e.target||e.srcElement;if(!(!this._loaded||t._leaflet_disable_events||"click"===e.type&&this._isClickDisabled(t))){var n=e.type;"mousedown"===n&&Rt(t),this._fireDOMEvent(e,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,t,a){if("click"===e.type){var s=n({},e);s.type="preclick",this._fireDOMEvent(s,s.type,a)}var r=this._findEventTargets(e,t);if(a){for(var i=[],o=0;o<a.length;o++)a[o].listens(t,!0)&&i.push(a[o]);r=i.concat(r)}if(r.length){"contextmenu"===t&&Kt(e);var l=r[0],c={originalEvent:e};if("keypress"!==e.type&&"keydown"!==e.type&&"keyup"!==e.type){var u=l.getLatLng&&(!l._radius||l._radius<=10);c.containerPoint=u?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(e),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=u?l.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(o=0;o<r.length;o++)if(r[o].fire(t,c,!0),c.originalEvent._stopped||!1===r[o].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,t))return}},_draggableMoved:function(e){return(e=e.dragging&&e.dragging.enabled()?e:this).dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,{target:this}):this.on("load",e,t),this},_getMapPanePos:function(){return Tt(this._mapPane)||new R(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,t){return(e&&void 0!==t?this._getNewPixelOrigin(e,t):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,t,n){var a=this._getNewPixelOrigin(n,t);return this.project(e,t)._subtract(a)},_latLngBoundsToNewLayerBounds:function(e,t,n){var a=this._getNewPixelOrigin(n,t);return F([this.project(e.getSouthWest(),t)._subtract(a),this.project(e.getNorthWest(),t)._subtract(a),this.project(e.getSouthEast(),t)._subtract(a),this.project(e.getNorthEast(),t)._subtract(a)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var a=this.project(e,t),s=this.getSize().divideBy(2),r=new O(a.subtract(s),a.add(s)),i=this._getBoundsOffset(r,n,t);return Math.abs(i.x)<=1&&Math.abs(i.y)<=1?e:this.unproject(a.add(i),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),a=new O(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(a,t))},_getBoundsOffset:function(e,t,n){var a=F(this.project(t.getNorthEast(),n),this.project(t.getSouthWest(),n)),s=a.min.subtract(e.min),r=a.max.subtract(e.max);return new R(this._rebound(s.x,-r.x),this._rebound(s.y,-r.y))},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom(),a=Oe.any3d?this.options.zoomSnap:1;return a&&(e=Math.round(e/a)*a),Math.max(t,Math.min(n,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){vt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._trunc();return!(!0!==(t&&t.animate)&&!this.getSize().contains(n))&&(this.panBy(n,t),!0)},_createAnimProxy:function(){var e=this._proxy=pt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(e){var t=lt,n=this._proxy.style[t];Ct(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===this._proxy.style[t]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){mt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),t=this.getZoom();Ct(this._proxy,this.project(e,t),this.getZoomScale(t,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var a=this.getZoomScale(t),s=this._getCenterOffset(e)._divideBy(1-1/a);return!(!0!==n.animate&&!this.getSize().contains(s))&&(S(function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(e,t,!0)},this),!0)},_animateZoom:function(e,t,n,a){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=t,bt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:t,noUpdate:a}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(s(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&vt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function an(e,t){return new nn(e,t)}var sn=T.extend({options:{position:"topright"},initialize:function(e){p(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),a=e._controlCorners[n];return bt(t,"leaflet-control"),-1!==n.indexOf("bottom")?a.insertBefore(t,a.firstChild):a.appendChild(t),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(mt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),rn=function(e){return new sn(e)};nn.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=pt("div",t+"control-container",this._container);function a(a,s){var r=t+a+" "+t+s;e[a+s]=pt("div",r,n)}a("top","left"),a("top","right"),a("bottom","left"),a("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)mt(this._controlCorners[e]);mt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var on=sn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,t,n,a){return n<a?-1:a<n?1:0}},initialize:function(e,t,n){for(var a in p(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,e)this._addLayer(e[a],a);for(a in t)this._addLayer(t[a],a,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return sn.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._map?this._update():this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var t=this._getLayer(i(e));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){bt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(bt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):vt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return vt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=pt("div",e),n=this.options.collapsed;t.setAttribute("aria-haspopup",!0),qt(t),Gt(t);var a=this._section=pt("section",e+"-list");n&&(this._map.on("click",this.collapse,this),Ft(t,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var s=this._layersLink=pt("a",e+"-toggle",t);s.href="#",s.title="Layers",s.setAttribute("role","button"),Ft(s,{keydown:function(e){13===e.keyCode&&this._expandSafely()},click:function(e){Kt(e),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=pt("div",e+"-base",a),this._separator=pt("div",e+"-separator",a),this._overlaysList=pt("div",e+"-overlays",a),t.appendChild(a)},_getLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&i(this._layers[t].layer)===e)return this._layers[t]},_addLayer:function(e,t,n){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:t,overlay:n}),this.options.sortLayers&&this._layers.sort(s(function(e,t){return this.options.sortFunction(e.layer,t.layer,e.name,t.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ft(this._baseLayersList),ft(this._overlaysList),this._layerControlInputs=[];var e,t,n,a,s=0;for(n=0;n<this._layers.length;n++)a=this._layers[n],this._addItem(a),t=t||a.overlay,e=e||!a.overlay,s+=a.overlay?0:1;return this.options.hideSingleBase&&(e=e&&s>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=t&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._getLayer(i(e.target)),n=t.overlay?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this._map.fire(n,t)},_createRadioElement:function(e,t){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",a=document.createElement("div");return a.innerHTML=n,a.firstChild},_addItem:function(e){var t,n=document.createElement("label"),a=this._map.hasLayer(e.layer);e.overlay?((t=document.createElement("input")).type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=a):t=this._createRadioElement("leaflet-base-layers_"+i(this),a),this._layerControlInputs.push(t),t.layerId=i(e.layer),Ft(t,"click",this._onInputClick,this);var s=document.createElement("span");s.innerHTML=" "+e.name;var r=document.createElement("span");return n.appendChild(r),r.appendChild(t),r.appendChild(s),(e.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var e,t,n=this._layerControlInputs,a=[],s=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)e=n[r],t=this._getLayer(e.layerId).layer,e.checked?a.push(t):e.checked||s.push(t);for(r=0;r<s.length;r++)this._map.hasLayer(s[r])&&this._map.removeLayer(s[r]);for(r=0;r<a.length;r++)this._map.hasLayer(a[r])||this._map.addLayer(a[r]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e,t,n=this._layerControlInputs,a=this._map.getZoom(),s=n.length-1;s>=0;s--)e=n[s],t=this._getLayer(e.layerId).layer,e.disabled=void 0!==t.options.minZoom&&a<t.options.minZoom||void 0!==t.options.maxZoom&&a>t.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,Ft(e,"click",Kt),this.expand();var t=this;setTimeout(function(){zt(e,"click",Kt),t._preventClick=!1})}}),ln=function(e,t,n){return new on(e,t,n)},cn=sn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=pt("div",t+" leaflet-bar"),a=this.options;return this._zoomInButton=this._createButton(a.zoomInText,a.zoomInTitle,t+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(a.zoomOutText,a.zoomOutTitle,t+"-out",n,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,t,n,a,s){var r=pt("a",n,a);return r.innerHTML=e,r.href="#",r.title=t,r.setAttribute("role","button"),r.setAttribute("aria-label",t),qt(r),Ft(r,"click",Zt),Ft(r,"click",s,this),Ft(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";vt(this._zoomInButton,t),vt(this._zoomOutButton,t),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(bt(this._zoomOutButton,t),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(bt(this._zoomInButton,t),this._zoomInButton.setAttribute("aria-disabled","true"))}});nn.mergeOptions({zoomControl:!0}),nn.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new cn,this.addControl(this.zoomControl))});var un=function(e){return new cn(e)},dn=sn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var t="leaflet-control-scale",n=pt("div",t),a=this.options;return this._addScales(a,t+"-line",n),e.on(a.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=pt("div",t,n)),e.imperial&&(this._iScale=pt("div",t,n))},_update:function(){var e=this._map,t=e.getSize().y/2,n=e.distance(e.containerPointToLatLng([0,t]),e.containerPointToLatLng([this.options.maxWidth,t]));this._updateScales(n)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var t=this._getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this._updateScale(this._mScale,n,t/e)},_updateImperial:function(e){var t,n,a,s=3.2808399*e;s>5280?(t=s/5280,n=this._getRoundNum(t),this._updateScale(this._iScale,n+" mi",n/t)):(a=this._getRoundNum(s),this._updateScale(this._iScale,a+" ft",a/s))},_updateScale:function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)+"px",e.innerHTML=t},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),hn=function(e){return new dn(e)},pn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',mn=sn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Oe.inlineSvg?pn+" ":"")+"Leaflet</a>"},initialize:function(e){p(this,e),this._attributions={}},onAdd:function(e){for(var t in e.attributionControl=this,this._container=pt("div","leaflet-control-attribution"),qt(this._container),e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",function(){this.removeAttribution(e.layer.getAttribution())},this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});nn.mergeOptions({attributionControl:!0}),nn.addInitHook(function(){this.options.attributionControl&&(new mn).addTo(this)});var fn=function(e){return new mn(e)};sn.Layers=on,sn.Zoom=cn,sn.Scale=dn,sn.Attribution=mn,rn.layers=ln,rn.zoom=un,rn.scale=hn,rn.attribution=fn;var gn=T.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});gn.addTo=function(e,t){return e.addHandler(t,this),this};var xn={Events:E},yn=Oe.touch?"touchstart mousedown":"mousedown",bn=A.extend({options:{clickTolerance:3},initialize:function(e,t,n,a){p(this,a),this._element=e,this._dragStartTarget=t||e,this._preventOutline=n},enable:function(){this._enabled||(Ft(this._dragStartTarget,yn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(bn._dragging===this&&this.finishDrag(!0),zt(this._dragStartTarget,yn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!yt(this._element,"leaflet-zoom-anim")))if(e.touches&&1!==e.touches.length)bn._dragging===this&&this.finishDrag();else if(!(bn._dragging||e.shiftKey||1!==e.which&&1!==e.button&&!e.touches)&&(bn._dragging=this,this._preventOutline&&Rt(this._element),Et(),at(),!this._moving)){this.fire("down");var t=e.touches?e.touches[0]:e,n=Lt(this._element);this._startPoint=new R(t.clientX,t.clientY),this._startPos=Tt(this._element),this._parentScale=Dt(n);var a="mousedown"===e.type;Ft(document,a?"mousemove":"touchmove",this._onMove,this),Ft(document,a?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(e){if(this._enabled)if(e.touches&&e.touches.length>1)this._moved=!0;else{var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=new R(t.clientX,t.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Kt(e),this._moved||(this.fire("dragstart"),this._moved=!0,bt(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),bt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=e,this._updatePosition()))}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),jt(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){vt(document.body,"leaflet-dragging"),this._lastTarget&&(vt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zt(document,"mousemove touchmove",this._onMove,this),zt(document,"mouseup touchend touchcancel",this._onUp,this),At(),st();var t=this._moved&&this._moving;this._moving=!1,bn._dragging=!1,t&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function vn(e,t,n){var a,s,r,i,o,l,c,u,d,h=[1,4,2,8];for(s=0,c=e.length;s<c;s++)e[s]._code=Mn(e[s],t);for(i=0;i<4;i++){for(u=h[i],a=[],s=0,r=(c=e.length)-1;s<c;r=s++)o=e[s],l=e[r],o._code&u?l._code&u||((d=Rn(l,o,u,t,n))._code=Mn(d,t),a.push(d)):(l._code&u&&((d=Rn(l,o,u,t,n))._code=Mn(d,t),a.push(d)),a.push(o));e=a}return e}function wn(e,t){var n,a,s,r,i,o,l,c,u;if(!e||0===e.length)throw new Error("latlngs not passed");On(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var d=W([0,0]),h=z(e);h.getNorthWest().distanceTo(h.getSouthWest())*h.getNorthEast().distanceTo(h.getNorthWest())<1700&&(d=kn(e));var p=e.length,m=[];for(n=0;n<p;n++){var f=W(e[n]);m.push(t.project(W([f.lat-d.lat,f.lng-d.lng])))}for(o=l=c=0,n=0,a=p-1;n<p;a=n++)s=m[n],r=m[a],i=s.y*r.x-r.y*s.x,l+=(s.x+r.x)*i,c+=(s.y+r.y)*i,o+=3*i;u=0===o?m[0]:[l/o,c/o];var g=t.unproject(D(u));return W([g.lat+d.lat,g.lng+d.lng])}function kn(e){for(var t=0,n=0,a=0,s=0;s<e.length;s++){var r=W(e[s]);t+=r.lat,n+=r.lng,a++}return W([t/a,n/a])}var Nn,_n={__proto__:null,clipPolygon:vn,polygonCenter:wn,centroid:kn};function Sn(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=Tn(e=En(e,n),n)}function Cn(e,t,n){return Math.sqrt(Dn(e,t,n,!0))}function jn(e,t,n){return Dn(e,t,n)}function Tn(e,t){var n=e.length,a=new(typeof Uint8Array!==void 0+""?Uint8Array:Array)(n);a[0]=a[n-1]=1,In(e,a,t,0,n-1);var s,r=[];for(s=0;s<n;s++)a[s]&&r.push(e[s]);return r}function In(e,t,n,a,s){var r,i,o,l=0;for(i=a+1;i<=s-1;i++)(o=Dn(e[i],e[a],e[s],!0))>l&&(r=i,l=o);l>n&&(t[r]=1,In(e,t,n,a,r),In(e,t,n,r,s))}function En(e,t){for(var n=[e[0]],a=1,s=0,r=e.length;a<r;a++)Ln(e[a],e[s])>t&&(n.push(e[a]),s=a);return s<r-1&&n.push(e[r-1]),n}function An(e,t,n,a,s){var r,i,o,l=a?Nn:Mn(e,n),c=Mn(t,n);for(Nn=c;;){if(!(l|c))return[e,t];if(l&c)return!1;o=Mn(i=Rn(e,t,r=l||c,n,s),n),r===l?(e=i,l=o):(t=i,c=o)}}function Rn(e,t,n,a,s){var r,i,o=t.x-e.x,l=t.y-e.y,c=a.min,u=a.max;return 8&n?(r=e.x+o*(u.y-e.y)/l,i=u.y):4&n?(r=e.x+o*(c.y-e.y)/l,i=c.y):2&n?(r=u.x,i=e.y+l*(u.x-e.x)/o):1&n&&(r=c.x,i=e.y+l*(c.x-e.x)/o),new R(r,i,s)}function Mn(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n}function Ln(e,t){var n=t.x-e.x,a=t.y-e.y;return n*n+a*a}function Dn(e,t,n,a){var s,r=t.x,i=t.y,o=n.x-r,l=n.y-i,c=o*o+l*l;return c>0&&((s=((e.x-r)*o+(e.y-i)*l)/c)>1?(r=n.x,i=n.y):s>0&&(r+=o*s,i+=l*s)),o=e.x-r,l=e.y-i,a?o*o+l*l:new R(r,i)}function On(e){return!x(e[0])||"object"!==typeof e[0][0]&&"undefined"!==typeof e[0][0]}function Fn(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),On(e)}function Pn(e,t){var n,a,s,r,i,o,l,c;if(!e||0===e.length)throw new Error("latlngs not passed");On(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var u=W([0,0]),d=z(e);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(u=kn(e));var h=e.length,p=[];for(n=0;n<h;n++){var m=W(e[n]);p.push(t.project(W([m.lat-u.lat,m.lng-u.lng])))}for(n=0,a=0;n<h-1;n++)a+=p[n].distanceTo(p[n+1])/2;if(0===a)c=p[0];else for(n=0,r=0;n<h-1;n++)if(i=p[n],o=p[n+1],(r+=s=i.distanceTo(o))>a){l=(r-a)/s,c=[o.x-l*(o.x-i.x),o.y-l*(o.y-i.y)];break}var f=t.unproject(D(c));return W([f.lat+u.lat,f.lng+u.lng])}var zn={__proto__:null,simplify:Sn,pointToSegmentDistance:Cn,closestPointOnSegment:jn,clipSegment:An,_getEdgeIntersection:Rn,_getBitCode:Mn,_sqClosestPointOnSegment:Dn,isFlat:On,_flat:Fn,polylineCenter:Pn},Bn={project:function(e){return new R(e.lng,e.lat)},unproject:function(e){return new B(e.y,e.x)},bounds:new O([-180,-90],[180,90])},Wn={R:6378137,R_MINOR:6356752.314245179,bounds:new O([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var t=Math.PI/180,n=this.R,a=e.lat*t,s=this.R_MINOR/n,r=Math.sqrt(1-s*s),i=r*Math.sin(a),o=Math.tan(Math.PI/4-a/2)/Math.pow((1-i)/(1+i),r/2);return a=-n*Math.log(Math.max(o,1e-10)),new R(e.lng*t*n,a)},unproject:function(e){for(var t,n=180/Math.PI,a=this.R,s=this.R_MINOR/a,r=Math.sqrt(1-s*s),i=Math.exp(-e.y/a),o=Math.PI/2-2*Math.atan(i),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)t=r*Math.sin(o),t=Math.pow((1-t)/(1+t),r/2),o+=c=Math.PI/2-2*Math.atan(i*t)-o;return new B(o*n,e.x*n/a)}},Vn={__proto__:null,LonLat:Bn,Mercator:Wn,SphericalMercator:G},Un=n({},U,{code:"EPSG:3395",projection:Wn,transformation:function(){var e=.5/(Math.PI*Wn.R);return K(e,.5,-e,.5)}()}),Hn=n({},U,{code:"EPSG:4326",projection:Bn,transformation:K(1/180,1,-1/180,.5)}),Gn=n({},V,{projection:Bn,transformation:K(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,t){var n=t.lng-e.lng,a=t.lat-e.lat;return Math.sqrt(n*n+a*a)},infinite:!0});V.Earth=U,V.EPSG3395=Un,V.EPSG3857=Z,V.EPSG900913=X,V.EPSG4326=Hn,V.Simple=Gn;var qn=A.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[i(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[i(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var t=e.target;if(t.hasLayer(this)){if(this._map=t,this._zoomAnimated=t._zoomAnimated,this.getEvents){var n=this.getEvents();t.on(n,this),this.once("remove",function(){t.off(n,this)},this)}this.onAdd(t),this.fire("add"),t.fire("layeradd",{layer:this})}}});nn.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var t=i(e);return this._layers[t]||(this._layers[t]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e)),this},removeLayer:function(e){var t=i(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return i(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},_addLayers:function(e){for(var t=0,n=(e=e?x(e)?e:[e]:[]).length;t<n;t++)this.addLayer(e[t])},_addZoomLimit:function(e){isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[i(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var t=i(e);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,t=-1/0,n=this._getZoomSpan();for(var a in this._zoomBoundLayers){var s=this._zoomBoundLayers[a].options;e=void 0===s.minZoom?e:Math.min(e,s.minZoom),t=void 0===s.maxZoom?t:Math.max(t,s.maxZoom)}this._layersMaxZoom=t===-1/0?void 0:t,this._layersMinZoom=e===1/0?void 0:e,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Kn=qn.extend({initialize:function(e,t){var n,a;if(p(this,t),this._layers={},e)for(n=0,a=e.length;n<a;n++)this.addLayer(e[n])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return("number"===typeof e?e:this.getLayerId(e))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var t,n,a=Array.prototype.slice.call(arguments,1);for(t in this._layers)(n=this._layers[t])[e]&&n[e].apply(n,a);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return i(e)}}),Zn=function(e,t){return new Kn(e,t)},Xn=Kn.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),Kn.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),Kn.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new P;for(var t in this._layers){var n=this._layers[t];e.extend(n.getBounds?n.getBounds():n.getLatLng())}return e}}),Yn=function(e,t){return new Xn(e,t)},Jn=T.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){p(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var a=this._createImg(n,t&&"IMG"===t.tagName?t:null);return this._setIconStyles(a,e),(this.options.crossOrigin||""===this.options.crossOrigin)&&(a.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),a},_setIconStyles:function(e,t){var n=this.options,a=n[t+"Size"];"number"===typeof a&&(a=[a,a]);var s=D(a),r=D("shadow"===t&&n.shadowAnchor||n.iconAnchor||s&&s.divideBy(2,!0));e.className="leaflet-marker-"+t+" "+(n.className||""),r&&(e.style.marginLeft=-r.x+"px",e.style.marginTop=-r.y+"px"),s&&(e.style.width=s.x+"px",e.style.height=s.y+"px")},_createImg:function(e,t){return(t=t||document.createElement("img")).src=e,t},_getIconUrl:function(e){return Oe.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function Qn(e){return new Jn(e)}var $n=Jn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return"string"!==typeof $n.imagePath&&($n.imagePath=this._detectIconPath()),(this.options.imagePath||$n.imagePath)+Jn.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var t=function(e,t,n){var a=t.exec(e);return a&&a[n]};return(e=t(e,/^url\((['"])?(.+)\1\)$/,2))&&t(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=pt("div","leaflet-default-icon-path",document.body),t=ht(e,"background-image")||ht(e,"backgroundImage");if(document.body.removeChild(e),t=this._stripUrl(t))return t;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),ea=gn.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new bn(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),bt(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&vt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var t=this._marker,n=t._map,a=this._marker.options.autoPanSpeed,s=this._marker.options.autoPanPadding,r=Tt(t._icon),i=n.getPixelBounds(),o=n.getPixelOrigin(),l=F(i.min._subtract(o).add(s),i.max._subtract(o).subtract(s));if(!l.contains(r)){var c=D((Math.max(l.max.x,r.x)-l.max.x)/(i.max.x-l.max.x)-(Math.min(l.min.x,r.x)-l.min.x)/(i.min.x-l.min.x),(Math.max(l.max.y,r.y)-l.max.y)/(i.max.y-l.max.y)-(Math.min(l.min.y,r.y)-l.min.y)/(i.min.y-l.min.y)).multiplyBy(a);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),jt(t._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=S(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(C(this._panRequest),this._panRequest=S(this._adjustPan.bind(this,e)))},_onDrag:function(e){var t=this._marker,n=t._shadow,a=Tt(t._icon),s=t._map.layerPointToLatLng(a);n&&jt(n,a),t._latlng=s,e.latlng=s,e.oldLatLng=this._oldLatLng,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){C(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),ta=qn.extend({options:{icon:new $n,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,t){p(this,t),this._latlng=W(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var t=this._latlng;return this._latlng=W(e),this.update(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=e.icon.createIcon(this._icon),a=!1;n!==this._icon&&(this._icon&&this._removeIcon(),a=!0,e.title&&(n.title=e.title),"IMG"===n.tagName&&(n.alt=e.alt||"")),bt(n,t),e.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ft(n,"focus",this._panOnFocus,this);var s=e.icon.createShadow(this._shadow),r=!1;s!==this._shadow&&(this._removeShadow(),r=!0),s&&(bt(s,t),s.alt=""),this._shadow=s,e.opacity<1&&this._updateOpacity(),a&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&r&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zt(this._icon,"focus",this._panOnFocus,this),mt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&mt(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&jt(this._icon,e),this._shadow&&jt(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(this.options.interactive&&(bt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ea)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ea(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&Nt(this._icon,e),this._shadow&&Nt(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var t=this.options.icon.options,n=t.iconSize?D(t.iconSize):D(0,0),a=t.iconAnchor?D(t.iconAnchor):D(0,0);e.panInside(this._latlng,{paddingTopLeft:a,paddingBottomRight:n.subtract(a)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function na(e,t){return new ta(e,t)}var aa=qn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return p(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),sa=aa.extend({options:{fill:!0,radius:10},initialize:function(e,t){p(this,t),this._latlng=W(e),this._radius=this.options.radius},setLatLng:function(e){var t=this._latlng;return this._latlng=W(e),this.redraw(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var t=e&&e.radius||this._radius;return aa.prototype.setStyle.call(this,e),this.setRadius(t),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,t=this._radiusY||e,n=this._clickTolerance(),a=[e+n,t+n];this._pxBounds=new O(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ra(e,t){return new sa(e,t)}var ia=sa.extend({initialize:function(e,t,a){if("number"===typeof t&&(t=n({},a,{radius:t})),p(this,t),this._latlng=W(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new P(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:aa.prototype.setStyle,_project:function(){var e=this._latlng.lng,t=this._latlng.lat,n=this._map,a=n.options.crs;if(a.distance===U.distance){var s=Math.PI/180,r=this._mRadius/U.R/s,i=n.project([t+r,e]),o=n.project([t-r,e]),l=i.add(o).divideBy(2),c=n.unproject(l).lat,u=Math.acos((Math.cos(r*s)-Math.sin(t*s)*Math.sin(c*s))/(Math.cos(t*s)*Math.cos(c*s)))/s;(isNaN(u)||0===u)&&(u=r/Math.cos(Math.PI/180*t)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(u)?0:l.x-n.project([c,e-u]).x,this._radiusY=l.y-i.y}else{var d=a.unproject(a.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(d).x}this._updateBounds()}});function oa(e,t,n){return new ia(e,t,n)}var la=aa.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,t){p(this,t),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var t,n,a=1/0,s=null,r=Dn,i=0,o=this._parts.length;i<o;i++)for(var l=this._parts[i],c=1,u=l.length;c<u;c++){var d=r(e,t=l[c-1],n=l[c],!0);d<a&&(a=d,s=r(e,t,n))}return s&&(s.distance=Math.sqrt(a)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Pn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,t){return t=t||this._defaultShape(),e=W(e),t.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new P,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return On(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var t=[],n=On(e),a=0,s=e.length;a<s;a++)n?(t[a]=W(e[a]),this._bounds.extend(t[a])):t[a]=this._convertLatLngs(e[a]);return t},_project:function(){var e=new O;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),t=new R(e,e);this._rawPxBounds&&(this._pxBounds=new O([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)]))},_projectLatlngs:function(e,t,n){var a,s,r=e[0]instanceof B,i=e.length;if(r){for(s=[],a=0;a<i;a++)s[a]=this._map.latLngToLayerPoint(e[a]),n.extend(s[a]);t.push(s)}else for(a=0;a<i;a++)this._projectLatlngs(e[a],t,n)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else{var t,n,a,s,r,i,o,l=this._parts;for(t=0,a=0,s=this._rings.length;t<s;t++)for(n=0,r=(o=this._rings[t]).length;n<r-1;n++)(i=An(o[n],o[n+1],e,n,!0))&&(l[a]=l[a]||[],l[a].push(i[0]),i[1]===o[n+1]&&n!==r-2||(l[a].push(i[1]),a++))}},_simplifyPoints:function(){for(var e=this._parts,t=this.options.smoothFactor,n=0,a=e.length;n<a;n++)e[n]=Sn(e[n],t)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,t){var n,a,s,r,i,o,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(n=0,r=this._parts.length;n<r;n++)for(a=0,s=(i=(o=this._parts[n]).length)-1;a<i;s=a++)if((t||0!==a)&&Cn(e,o[s],o[a])<=l)return!0;return!1}});function ca(e,t){return new la(e,t)}la._flat=Fn;var ua=la.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return wn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var t=la.prototype._convertLatLngs.call(this,e),n=t.length;return n>=2&&t[0]instanceof B&&t[0].equals(t[n-1])&&t.pop(),t},_setLatLngs:function(e){la.prototype._setLatLngs.call(this,e),On(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return On(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,t=this.options.weight,n=new R(t,t);if(e=new O(e.min.subtract(n),e.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else for(var a,s=0,r=this._rings.length;s<r;s++)(a=vn(this._rings[s],e,!0)).length&&this._parts.push(a)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var t,n,a,s,r,i,o,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(s=0,o=this._parts.length;s<o;s++)for(r=0,i=(l=(t=this._parts[s]).length)-1;r<l;i=r++)n=t[r],a=t[i],n.y>e.y!==a.y>e.y&&e.x<(a.x-n.x)*(e.y-n.y)/(a.y-n.y)+n.x&&(c=!c);return c||la.prototype._containsPoint.call(this,e,!0)}});function da(e,t){return new ua(e,t)}var ha=Xn.extend({initialize:function(e,t){p(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,n,a,s=x(e)?e:e.features;if(s){for(t=0,n=s.length;t<n;t++)((a=s[t]).geometries||a.geometry||a.features||a.coordinates)&&this.addData(a);return this}var r=this.options;if(r.filter&&!r.filter(e))return this;var i=pa(e,r);return i?(i.feature=va(e),i.defaultOptions=i.options,this.resetStyle(i),r.onEachFeature&&r.onEachFeature(e,i),this.addLayer(i)):this},resetStyle:function(e){return void 0===e?this.eachLayer(this.resetStyle,this):(e.options=n({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){e.setStyle&&("function"===typeof t&&(t=t(e.feature)),e.setStyle(t))}});function pa(e,t){var n,a,s,r,i="Feature"===e.type?e.geometry:e,o=i?i.coordinates:null,l=[],c=t&&t.pointToLayer,u=t&&t.coordsToLatLng||fa;if(!o&&!i)return null;switch(i.type){case"Point":return ma(c,e,n=u(o),t);case"MultiPoint":for(s=0,r=o.length;s<r;s++)n=u(o[s]),l.push(ma(c,e,n,t));return new Xn(l);case"LineString":case"MultiLineString":return a=ga(o,"LineString"===i.type?0:1,u),new la(a,t);case"Polygon":case"MultiPolygon":return a=ga(o,"Polygon"===i.type?1:2,u),new ua(a,t);case"GeometryCollection":for(s=0,r=i.geometries.length;s<r;s++){var d=pa({geometry:i.geometries[s],type:"Feature",properties:e.properties},t);d&&l.push(d)}return new Xn(l);case"FeatureCollection":for(s=0,r=i.features.length;s<r;s++){var h=pa(i.features[s],t);h&&l.push(h)}return new Xn(l);default:throw new Error("Invalid GeoJSON object.")}}function ma(e,t,n,a){return e?e(t,n):new ta(n,a&&a.markersInheritOptions&&a)}function fa(e){return new B(e[1],e[0],e[2])}function ga(e,t,n){for(var a,s=[],r=0,i=e.length;r<i;r++)a=t?ga(e[r],t-1,n):(n||fa)(e[r]),s.push(a);return s}function xa(e,t){return void 0!==(e=W(e)).alt?[u(e.lng,t),u(e.lat,t),u(e.alt,t)]:[u(e.lng,t),u(e.lat,t)]}function ya(e,t,n,a){for(var s=[],r=0,i=e.length;r<i;r++)s.push(t?ya(e[r],On(e[r])?0:t-1,n,a):xa(e[r],a));return!t&&n&&s.length>0&&s.push(s[0].slice()),s}function ba(e,t){return e.feature?n({},e.feature,{geometry:t}):va(t)}function va(e){return"Feature"===e.type||"FeatureCollection"===e.type?e:{type:"Feature",properties:{},geometry:e}}var wa={toGeoJSON:function(e){return ba(this,{type:"Point",coordinates:xa(this.getLatLng(),e)})}};function ka(e,t){return new ha(e,t)}ta.include(wa),ia.include(wa),sa.include(wa),la.include({toGeoJSON:function(e){var t=!On(this._latlngs);return ba(this,{type:(t?"Multi":"")+"LineString",coordinates:ya(this._latlngs,t?1:0,!1,e)})}}),ua.include({toGeoJSON:function(e){var t=!On(this._latlngs),n=t&&!On(this._latlngs[0]),a=ya(this._latlngs,n?2:t?1:0,!0,e);return t||(a=[a]),ba(this,{type:(n?"Multi":"")+"Polygon",coordinates:a})}}),Kn.include({toMultiPoint:function(e){var t=[];return this.eachLayer(function(n){t.push(n.toGeoJSON(e).geometry.coordinates)}),ba(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(e){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint(e);var n="GeometryCollection"===t,a=[];return this.eachLayer(function(t){if(t.toGeoJSON){var s=t.toGeoJSON(e);if(n)a.push(s.geometry);else{var r=va(s);"FeatureCollection"===r.type?a.push.apply(a,r.features):a.push(r)}}}),n?ba(this,{geometries:a,type:"GeometryCollection"}):{type:"FeatureCollection",features:a}}});var Na=ka,_a=qn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,t,n){this._url=e,this._bounds=z(t),p(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(bt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){mt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&gt(this._image),this},bringToBack:function(){return this._map&&xt(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=z(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e="IMG"===this._url.tagName,t=this._image=e?this._url:pt("img");bt(t,"leaflet-image-layer"),this._zoomAnimated&&bt(t,"leaflet-zoom-animated"),this.options.className&&bt(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onload=s(this.fire,this,"load"),t.onerror=s(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(t.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e?this._url=t.src:(t.src=this._url,t.alt=this.options.alt)},_animateZoom:function(e){var t=this._map.getZoomScale(e.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;Ct(this._image,n,t)},_reset:function(){var e=this._image,t=new O(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=t.getSize();jt(e,t.min),e.style.width=n.x+"px",e.style.height=n.y+"px"},_updateOpacity:function(){Nt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),Sa=function(e,t,n){return new _a(e,t,n)},Ca=_a.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e="VIDEO"===this._url.tagName,t=this._image=e?this._url:pt("video");if(bt(t,"leaflet-image-layer"),this._zoomAnimated&&bt(t,"leaflet-zoom-animated"),this.options.className&&bt(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onloadeddata=s(this.fire,this,"load"),e){for(var n=t.getElementsByTagName("source"),a=[],r=0;r<n.length;r++)a.push(n[r].src);this._url=n.length>0?a:[t.src]}else{x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(t.style,"objectFit")&&(t.style.objectFit="fill"),t.autoplay=!!this.options.autoplay,t.loop=!!this.options.loop,t.muted=!!this.options.muted,t.playsInline=!!this.options.playsInline;for(var i=0;i<this._url.length;i++){var o=pt("source");o.src=this._url[i],t.appendChild(o)}}}});function ja(e,t,n){return new Ca(e,t,n)}var Ta=_a.extend({_initImage:function(){var e=this._image=this._url;bt(e,"leaflet-image-layer"),this._zoomAnimated&&bt(e,"leaflet-zoom-animated"),this.options.className&&bt(e,this.options.className),e.onselectstart=c,e.onmousemove=c}});function Ia(e,t,n){return new Ta(e,t,n)}var Ea=qn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,t){e&&(e instanceof B||x(e))?(this._latlng=W(e),p(this,t)):(p(this,e),this._source=t),this.options.content&&(this._content=this.options.content)},openOn:function(e){return(e=arguments.length?e:this._source._map).hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&Nt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&Nt(this._container,1),this.bringToFront(),this.options.interactive&&(bt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(Nt(this._container,0),this._removeTimeout=setTimeout(s(mt,void 0,this._container),200)):mt(this._container),this.options.interactive&&(vt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=W(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&gt(this._container),this},bringToBack:function(){return this._map&&xt(this._container),this},_prepareOpen:function(e){var t=this._source;if(!t._map)return!1;if(t instanceof Xn){t=null;var n=this._source._layers;for(var a in n)if(n[a]._map){t=n[a];break}if(!t)return!1;this._source=t}if(!e)if(t.getCenter)e=t.getCenter();else if(t.getLatLng)e=t.getLatLng();else{if(!t.getBounds)throw new Error("Unable to get source layer LatLng.");e=t.getBounds().getCenter()}return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,t="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof t)e.innerHTML=t;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(t)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),t=D(this.options.offset),n=this._getAnchor();this._zoomAnimated?jt(this._container,e.add(n)):t=t.add(e).add(n);var a=this._containerBottom=-t.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+t.x;this._container.style.bottom=a+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}});nn.include({_initOverlay:function(e,t,n,a){var s=t;return s instanceof e||(s=new e(a).setContent(t)),n&&s.setLatLng(n),s}}),qn.include({_initOverlay:function(e,t,n,a){var s=n;return s instanceof e?(p(s,a),s._source=this):(s=t&&!a?t:new e(a,this)).setContent(n),s}});var Aa=Ea.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return!(e=arguments.length?e:this._source._map).hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,Ea.prototype.openOn.call(this,e)},onAdd:function(e){Ea.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof aa||this._source.on("preclick",Ht))},onRemove:function(e){Ea.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof aa||this._source.off("preclick",Ht))},getEvents:function(){var e=Ea.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",t=this._container=pt("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=pt("div",e+"-content-wrapper",t);if(this._contentNode=pt("div",e+"-content",n),qt(t),Gt(this._contentNode),Ft(t,"contextmenu",Ht),this._tipContainer=pt("div",e+"-tip-container",t),this._tip=pt("div",e+"-tip",this._tipContainer),this.options.closeButton){var a=this._closeButton=pt("a",e+"-close-button",t);a.setAttribute("role","button"),a.setAttribute("aria-label","Close popup"),a.href="#close",a.innerHTML='<span aria-hidden="true">&#215;</span>',Ft(a,"click",function(e){Kt(e),this.close()},this)}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var a=e.offsetHeight,s=this.options.maxHeight,r="leaflet-popup-scrolled";s&&a>s?(t.height=s+"px",bt(e,r)):vt(e,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),n=this._getAnchor();jt(this._container,t.add(n))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var e=this._map,t=parseInt(ht(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+t,a=this._containerWidth,s=new R(this._containerLeft,-n-this._containerBottom);s._add(Tt(this._container));var r=e.layerPointToContainerPoint(s),i=D(this.options.autoPanPadding),o=D(this.options.autoPanPaddingTopLeft||i),l=D(this.options.autoPanPaddingBottomRight||i),c=e.getSize(),u=0,d=0;r.x+a+l.x>c.x&&(u=r.x+a-c.x+l.x),r.x-u-o.x<0&&(u=r.x-o.x),r.y+n+l.y>c.y&&(d=r.y+n-c.y+l.y),r.y-d-o.y<0&&(d=r.y-o.y),(u||d)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([u,d]))}},_getAnchor:function(){return D(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ra=function(e,t){return new Aa(e,t)};nn.mergeOptions({closePopupOnClick:!0}),nn.include({openPopup:function(e,t,n){return this._initOverlay(Aa,e,t,n).openOn(this),this},closePopup:function(e){return(e=arguments.length?e:this._popup)&&e.close(),this}}),qn.include({bindPopup:function(e,t){return this._popup=this._initOverlay(Aa,this._popup,e,t),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof Xn||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(this._popup&&this._map){Zt(e);var t=e.layer||e.target;this._popup._source!==t||t instanceof aa?(this._popup._source=t,this.openPopup(e.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){13===e.originalEvent.keyCode&&this._openPopup(e)}});var Ma=Ea.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){Ea.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){Ea.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=Ea.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=pt("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+i(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var t,n,a=this._map,s=this._container,r=a.latLngToContainerPoint(a.getCenter()),i=a.layerPointToContainerPoint(e),o=this.options.direction,l=s.offsetWidth,c=s.offsetHeight,u=D(this.options.offset),d=this._getAnchor();"top"===o?(t=l/2,n=c):"bottom"===o?(t=l/2,n=0):"center"===o?(t=l/2,n=c/2):"right"===o?(t=0,n=c/2):"left"===o?(t=l,n=c/2):i.x<r.x?(o="right",t=0,n=c/2):(o="left",t=l+2*(u.x+d.x),n=c/2),e=e.subtract(D(t,n,!0)).add(u).add(d),vt(s,"leaflet-tooltip-right"),vt(s,"leaflet-tooltip-left"),vt(s,"leaflet-tooltip-top"),vt(s,"leaflet-tooltip-bottom"),bt(s,"leaflet-tooltip-"+o),jt(s,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&Nt(this._container,e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(t)},_getAnchor:function(){return D(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),La=function(e,t){return new Ma(e,t)};nn.include({openTooltip:function(e,t,n){return this._initOverlay(Ma,e,t,n).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),qn.include({bindTooltip:function(e,t){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ma,this._tooltip,e,t),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(e||!this._tooltipHandlersAdded){var t=e?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[t](n),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof Xn||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var t="function"===typeof e.getElement&&e.getElement();t&&(Ft(t,"focus",function(){this._tooltip._source=e,this.openTooltip()},this),Ft(t,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var t="function"===typeof e.getElement&&e.getElement();t&&t.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var t=this;this._map.once("moveend",function(){t._openOnceFlag=!1,t._openTooltip(e)})}else this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)},_moveTooltip:function(e){var t,n,a=e.latlng;this._tooltip.options.sticky&&e.originalEvent&&(t=this._map.mouseEventToContainerPoint(e.originalEvent),n=this._map.containerPointToLayerPoint(t),a=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(a)}});var Da=Jn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var t=e&&"DIV"===e.tagName?e:document.createElement("div"),n=this.options;if(n.html instanceof Element?(ft(t),t.appendChild(n.html)):t.innerHTML=!1!==n.html?n.html:"",n.bgPos){var a=D(n.bgPos);t.style.backgroundPosition=-a.x+"px "+-a.y+"px"}return this._setIconStyles(t,"icon"),t},createShadow:function(){return null}});function Oa(e){return new Da(e)}Jn.Default=$n;var Fa=qn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Oe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){p(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),mt(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(gt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(xt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof R?e:new R(e,e)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var t,n=this.getPane().children,a=-e(-1/0,1/0),s=0,r=n.length;s<r;s++)t=n[s].style.zIndex,n[s]!==this._container&&t&&(a=e(a,+t));isFinite(a)&&(this.options.zIndex=a+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Oe.ielt9){Nt(this._container,this.options.opacity);var e=+new Date,t=!1,n=!1;for(var a in this._tiles){var s=this._tiles[a];if(s.current&&s.loaded){var r=Math.min(1,(e-s.loaded)/200);Nt(s.el,r),r<1?t=!0:(s.active?n=!0:this._onOpaqueTile(s),s.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),t&&(C(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=pt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,t=this.options.maxZoom;if(void 0!==e){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===e?(this._levels[n].el.style.zIndex=t-Math.abs(e-n),this._onUpdateLevel(n)):(mt(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var a=this._levels[e],s=this._map;return a||((a=this._levels[e]={}).el=pt("div","leaflet-tile-container leaflet-zoom-animated",this._container),a.el.style.zIndex=t,a.origin=s.project(s.unproject(s.getPixelOrigin()),e).round(),a.zoom=e,this._setZoomTransform(a,s.getCenter(),s.getZoom()),c(a.el.offsetWidth),this._onCreateLevel(a)),this._level=a,a}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var e,t,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(e in this._tiles)(t=this._tiles[e]).retain=t.current;for(e in this._tiles)if((t=this._tiles[e]).current&&!t.active){var a=t.coords;this._retainParent(a.x,a.y,a.z,a.z-5)||this._retainChildren(a.x,a.y,a.z,a.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}}},_removeTilesAtZoom:function(e){for(var t in this._tiles)this._tiles[t].coords.z===e&&this._removeTile(t)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)mt(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,t,n,a){var s=Math.floor(e/2),r=Math.floor(t/2),i=n-1,o=new R(+s,+r);o.z=+i;var l=this._tileCoordsToKey(o),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),i>a&&this._retainParent(s,r,i,a))},_retainChildren:function(e,t,n,a){for(var s=2*e;s<2*e+2;s++)for(var r=2*t;r<2*t+2;r++){var i=new R(s,r);i.z=n+1;var o=this._tileCoordsToKey(i),l=this._tiles[o];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<a&&this._retainChildren(s,r,n+1,a))}},_resetView:function(e){var t=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var t=this.options;return void 0!==t.minNativeZoom&&e<t.minNativeZoom?t.minNativeZoom:void 0!==t.maxNativeZoom&&t.maxNativeZoom<e?t.maxNativeZoom:e},_setView:function(e,t,n,a){var s=Math.round(t);s=void 0!==this.options.maxZoom&&s>this.options.maxZoom||void 0!==this.options.minZoom&&s<this.options.minZoom?void 0:this._clampZoom(s);var r=this.options.updateWhenZooming&&s!==this._tileZoom;a&&!r||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==s&&this._update(e),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(e,t)},_setZoomTransforms:function(e,t){for(var n in this._levels)this._setZoomTransform(this._levels[n],e,t)},_setZoomTransform:function(e,t,n){var a=this._map.getZoomScale(n,e.zoom),s=e.origin.multiplyBy(a).subtract(this._map._getNewPixelOrigin(t,n)).round();Oe.any3d?Ct(e.el,s,a):jt(e.el,s)},_resetGrid:function(){var e=this._map,t=e.options.crs,n=this._tileSize=this.getTileSize(),a=this._tileZoom,s=this._map.getPixelWorldBounds(this._tileZoom);s&&(this._globalTileRange=this._pxBoundsToTileRange(s)),this._wrapX=t.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,t.wrapLng[0]],a).x/n.x),Math.ceil(e.project([0,t.wrapLng[1]],a).x/n.y)],this._wrapY=t.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([t.wrapLat[0],0],a).y/n.x),Math.ceil(e.project([t.wrapLat[1],0],a).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(e){var t=this._map,n=t._animatingZoom?Math.max(t._animateToZoom,t.getZoom()):t.getZoom(),a=t.getZoomScale(n,this._tileZoom),s=t.project(e,this._tileZoom).floor(),r=t.getSize().divideBy(2*a);return new O(s.subtract(r),s.add(r))},_update:function(e){var t=this._map;if(t){var n=this._clampZoom(t.getZoom());if(void 0===e&&(e=t.getCenter()),void 0!==this._tileZoom){var a=this._getTiledPixelBounds(e),s=this._pxBoundsToTileRange(a),r=s.getCenter(),i=[],o=this.options.keepBuffer,l=new O(s.getBottomLeft().subtract([o,-o]),s.getTopRight().add([o,-o]));if(!(isFinite(s.min.x)&&isFinite(s.min.y)&&isFinite(s.max.x)&&isFinite(s.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var u=this._tiles[c].coords;u.z===this._tileZoom&&l.contains(new R(u.x,u.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(e,n);else{for(var d=s.min.y;d<=s.max.y;d++)for(var h=s.min.x;h<=s.max.x;h++){var p=new R(h,d);if(p.z=this._tileZoom,this._isValidTile(p)){var m=this._tiles[this._tileCoordsToKey(p)];m?m.current=!0:i.push(p)}}if(i.sort(function(e,t){return e.distanceTo(r)-t.distanceTo(r)}),0!==i.length){this._loading||(this._loading=!0,this.fire("loading"));var f=document.createDocumentFragment();for(h=0;h<i.length;h++)this._addTile(i[h],f);this._level.el.appendChild(f)}}}}},_isValidTile:function(e){var t=this._map.options.crs;if(!t.infinite){var n=this._globalTileRange;if(!t.wrapLng&&(e.x<n.min.x||e.x>n.max.x)||!t.wrapLat&&(e.y<n.min.y||e.y>n.max.y))return!1}if(!this.options.bounds)return!0;var a=this._tileCoordsToBounds(e);return z(this.options.bounds).overlaps(a)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var t=this._map,n=this.getTileSize(),a=e.scaleBy(n),s=a.add(n);return[t.unproject(a,e.z),t.unproject(s,e.z)]},_tileCoordsToBounds:function(e){var t=this._tileCoordsToNwSe(e),n=new P(t[0],t[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var t=e.split(":"),n=new R(+t[0],+t[1]);return n.z=+t[2],n},_removeTile:function(e){var t=this._tiles[e];t&&(mt(t.el),delete this._tiles[e],this.fire("tileunload",{tile:t.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){bt(e,"leaflet-tile");var t=this.getTileSize();e.style.width=t.x+"px",e.style.height=t.y+"px",e.onselectstart=c,e.onmousemove=c,Oe.ielt9&&this.options.opacity<1&&Nt(e,this.options.opacity)},_addTile:function(e,t){var n=this._getTilePos(e),a=this._tileCoordsToKey(e),r=this.createTile(this._wrapCoords(e),s(this._tileReady,this,e));this._initTile(r),this.createTile.length<2&&S(s(this._tileReady,this,e,null,r)),jt(r,n),this._tiles[a]={el:r,coords:e,current:!0},t.appendChild(r),this.fire("tileloadstart",{tile:r,coords:e})},_tileReady:function(e,t,n){t&&this.fire("tileerror",{error:t,tile:n,coords:e});var a=this._tileCoordsToKey(e);(n=this._tiles[a])&&(n.loaded=+new Date,this._map._fadeAnimated?(Nt(n.el,0),C(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),t||(bt(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Oe.ielt9||!this._map._fadeAnimated?S(this._pruneTiles,this):setTimeout(s(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var t=new R(this._wrapX?l(e.x,this._wrapX):e.x,this._wrapY?l(e.y,this._wrapY):e.y);return t.z=e.z,t},_pxBoundsToTileRange:function(e){var t=this.getTileSize();return new O(e.min.unscaleBy(t).floor(),e.max.unscaleBy(t).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Pa(e){return new Fa(e)}var za=Fa.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,t){this._url=e,(t=p(this,t)).detectRetina&&Oe.retina&&t.maxZoom>0?(t.tileSize=Math.floor(t.tileSize/2),t.zoomReverse?(t.zoomOffset--,t.minZoom=Math.min(t.maxZoom,t.minZoom+1)):(t.zoomOffset++,t.maxZoom=Math.max(t.minZoom,t.maxZoom-1)),t.minZoom=Math.max(0,t.minZoom)):t.zoomReverse?t.minZoom=Math.min(t.maxZoom,t.minZoom):t.maxZoom=Math.max(t.minZoom,t.maxZoom),"string"===typeof t.subdomains&&(t.subdomains=t.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,t){return this._url===e&&void 0===t&&(t=!0),this._url=e,t||this.redraw(),this},createTile:function(e,t){var n=document.createElement("img");return Ft(n,"load",s(this._tileOnLoad,this,t,n)),Ft(n,"error",s(this._tileOnError,this,t,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"===typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(e),n},getTileUrl:function(e){var t={r:Oe.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var a=this._globalTileRange.max.y-e.y;this.options.tms&&(t.y=a),t["-y"]=a}return g(this._url,n(t,this.options))},_tileOnLoad:function(e,t){Oe.ielt9?setTimeout(s(e,this,null,t),0):e(null,t)},_tileOnError:function(e,t,n){var a=this.options.errorTileUrl;a&&t.getAttribute("src")!==a&&(t.src=a),e(n,t)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,t=this.options.maxZoom;return this.options.zoomReverse&&(e=t-e),e+this.options.zoomOffset},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var e,t;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&((t=this._tiles[e].el).onload=c,t.onerror=c,!t.complete)){t.src=b;var n=this._tiles[e].coords;mt(t),delete this._tiles[e],this.fire("tileabort",{tile:t,coords:n})}},_removeTile:function(e){var t=this._tiles[e];if(t)return t.el.setAttribute("src",b),Fa.prototype._removeTile.call(this,e)},_tileReady:function(e,t,n){if(this._map&&(!n||n.getAttribute("src")!==b))return Fa.prototype._tileReady.call(this,e,t,n)}});function Ba(e,t){return new za(e,t)}var Wa=za.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,t){this._url=e;var a=n({},this.defaultWmsParams);for(var s in t)s in this.options||(a[s]=t[s]);var r=(t=p(this,t)).detectRetina&&Oe.retina?2:1,i=this.getTileSize();a.width=i.x*r,a.height=i.y*r,this.wmsParams=a},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,za.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._tileCoordsToNwSe(e),n=this._crs,a=F(n.project(t[0]),n.project(t[1])),s=a.min,r=a.max,i=(this._wmsVersion>=1.3&&this._crs===Hn?[s.y,s.x,r.y,r.x]:[s.x,s.y,r.x,r.y]).join(","),o=za.prototype.getTileUrl.call(this,e);return o+m(this.wmsParams,o,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+i},setParams:function(e,t){return n(this.wmsParams,e),t||this.redraw(),this}});function Va(e,t){return new Wa(e,t)}za.WMS=Wa,Ba.wms=Va;var Ua=qn.extend({options:{padding:.1},initialize:function(e){p(this,e),i(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),bt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,t){var n=this._map.getZoomScale(t,this._zoom),a=this._map.getSize().multiplyBy(.5+this.options.padding),s=this._map.project(this._center,t),r=a.multiplyBy(-n).add(s).subtract(this._map._getNewPixelOrigin(e,t));Oe.any3d?Ct(this._container,r,n):jt(this._container,r)},_reset:function(){for(var e in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,t=this._map.getSize(),n=this._map.containerPointToLayerPoint(t.multiplyBy(-e)).round();this._bounds=new O(n,n.add(t.multiplyBy(1+2*e)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ha=Ua.extend({options:{tolerance:0},getEvents:function(){var e=Ua.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ua.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");Ft(e,"mousemove",this._onMouseMove,this),Ft(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ft(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){C(this._redrawRequest),delete this._ctx,mt(this._container),zt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var e in this._redrawBounds=null,this._layers)this._layers[e]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Ua.prototype._update.call(this);var e=this._bounds,t=this._container,n=e.getSize(),a=Oe.retina?2:1;jt(t,e.min),t.width=a*n.x,t.height=a*n.y,t.style.width=n.x+"px",t.style.height=n.y+"px",Oe.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){Ua.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[i(e)]=e;var t=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var t=e._order,n=t.next,a=t.prev;n?n.prev=a:this._drawLast=a,a?a.next=n:this._drawFirst=n,delete e._order,delete this._layers[i(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if("string"===typeof e.options.dashArray){var t,n,a=e.options.dashArray.split(/[, ]+/),s=[];for(n=0;n<a.length;n++){if(t=Number(a[n]),isNaN(t))return;s.push(t)}e.options._dashArray=s}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||S(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var t=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new O,this._redrawBounds.extend(e._pxBounds.min.subtract([t,t])),this._redrawBounds.extend(e._pxBounds.max.add([t,t]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var t=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,t.x,t.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,t=this._redrawBounds;if(this._ctx.save(),t){var n=t.getSize();this._ctx.beginPath(),this._ctx.rect(t.min.x,t.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var a=this._drawFirst;a;a=a.next)e=a.layer,(!t||e._pxBounds&&e._pxBounds.intersects(t))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,t){if(this._drawing){var n,a,s,r,i=e._parts,o=i.length,l=this._ctx;if(o){for(l.beginPath(),n=0;n<o;n++){for(a=0,s=i[n].length;a<s;a++)r=i[n][a],l[a?"lineTo":"moveTo"](r.x,r.y);t&&l.closePath()}this._fillStroke(l,e)}}},_updateCircle:function(e){if(this._drawing&&!e._empty()){var t=e._point,n=this._ctx,a=Math.max(Math.round(e._radius),1),s=(Math.max(Math.round(e._radiusY),1)||a)/a;1!==s&&(n.save(),n.scale(1,s)),n.beginPath(),n.arc(t.x,t.y/s,a,0,2*Math.PI,!1),1!==s&&n.restore(),this._fillStroke(n,e)}},_fillStroke:function(e,t){var n=t.options;n.fill&&(e.globalAlpha=n.fillOpacity,e.fillStyle=n.fillColor||n.color,e.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.globalAlpha=n.opacity,e.lineWidth=n.weight,e.strokeStyle=n.color,e.lineCap=n.lineCap,e.lineJoin=n.lineJoin,e.stroke())},_onClick:function(e){for(var t,n,a=this._map.mouseEventToLayerPoint(e),s=this._drawFirst;s;s=s.next)(t=s.layer).options.interactive&&t._containsPoint(a)&&("click"!==e.type&&"preclick"!==e.type||!this._map._draggableMoved(t))&&(n=t);this._fireEvent(!!n&&[n],e)},_onMouseMove:function(e){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var t=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,t)}},_handleMouseOut:function(e){var t=this._hoveredLayer;t&&(vt(this._container,"leaflet-interactive"),this._fireEvent([t],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,t){if(!this._mouseHoverThrottled){for(var n,a,r=this._drawFirst;r;r=r.next)(n=r.layer).options.interactive&&n._containsPoint(t)&&(a=n);a!==this._hoveredLayer&&(this._handleMouseOut(e),a&&(bt(this._container,"leaflet-interactive"),this._fireEvent([a],e,"mouseover"),this._hoveredLayer=a)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],e),this._mouseHoverThrottled=!0,setTimeout(s(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(e,t,n){this._map._fireDOMEvent(t,n||t.type,e)},_bringToFront:function(e){var t=e._order;if(t){var n=t.next,a=t.prev;n&&(n.prev=a,a?a.next=n:n&&(this._drawFirst=n),t.prev=this._drawLast,this._drawLast.next=t,t.next=null,this._drawLast=t,this._requestRedraw(e))}},_bringToBack:function(e){var t=e._order;if(t){var n=t.next,a=t.prev;a&&(a.next=n,n?n.prev=a:a&&(this._drawLast=a),t.prev=null,t.next=this._drawFirst,this._drawFirst.prev=t,this._drawFirst=t,this._requestRedraw(e))}}});function Ga(e){return Oe.canvas?new Ha(e):null}var qa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ka={_initContainer:function(){this._container=pt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ua.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var t=e._container=qa("shape");bt(t,"leaflet-vml-shape "+(this.options.className||"")),t.coordsize="1 1",e._path=qa("path"),t.appendChild(e._path),this._updateStyle(e),this._layers[i(e)]=e},_addPath:function(e){var t=e._container;this._container.appendChild(t),e.options.interactive&&e.addInteractiveTarget(t)},_removePath:function(e){var t=e._container;mt(t),e.removeInteractiveTarget(t),delete this._layers[i(e)]},_updateStyle:function(e){var t=e._stroke,n=e._fill,a=e.options,s=e._container;s.stroked=!!a.stroke,s.filled=!!a.fill,a.stroke?(t||(t=e._stroke=qa("stroke")),s.appendChild(t),t.weight=a.weight+"px",t.color=a.color,t.opacity=a.opacity,a.dashArray?t.dashStyle=x(a.dashArray)?a.dashArray.join(" "):a.dashArray.replace(/( *, *)/g," "):t.dashStyle="",t.endcap=a.lineCap.replace("butt","flat"),t.joinstyle=a.lineJoin):t&&(s.removeChild(t),e._stroke=null),a.fill?(n||(n=e._fill=qa("fill")),s.appendChild(n),n.color=a.fillColor||a.color,n.opacity=a.fillOpacity):n&&(s.removeChild(n),e._fill=null)},_updateCircle:function(e){var t=e._point.round(),n=Math.round(e._radius),a=Math.round(e._radiusY||n);this._setPath(e,e._empty()?"M0 0":"AL "+t.x+","+t.y+" "+n+","+a+" 0,23592600")},_setPath:function(e,t){e._path.v=t},_bringToFront:function(e){gt(e._container)},_bringToBack:function(e){xt(e._container)}},Za=Oe.vml?qa:Y,Xa=Ua.extend({_initContainer:function(){this._container=Za("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Za("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){mt(this._container),zt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){Ua.prototype._update.call(this);var e=this._bounds,t=e.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(t)||(this._svgSize=t,n.setAttribute("width",t.x),n.setAttribute("height",t.y)),jt(n,e.min),n.setAttribute("viewBox",[e.min.x,e.min.y,t.x,t.y].join(" ")),this.fire("update")}},_initPath:function(e){var t=e._path=Za("path");e.options.className&&bt(t,e.options.className),e.options.interactive&&bt(t,"leaflet-interactive"),this._updateStyle(e),this._layers[i(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){mt(e._path),e.removeInteractiveTarget(e._path),delete this._layers[i(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var t=e._path,n=e.options;t&&(n.stroke?(t.setAttribute("stroke",n.color),t.setAttribute("stroke-opacity",n.opacity),t.setAttribute("stroke-width",n.weight),t.setAttribute("stroke-linecap",n.lineCap),t.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?t.setAttribute("stroke-dasharray",n.dashArray):t.removeAttribute("stroke-dasharray"),n.dashOffset?t.setAttribute("stroke-dashoffset",n.dashOffset):t.removeAttribute("stroke-dashoffset")):t.setAttribute("stroke","none"),n.fill?(t.setAttribute("fill",n.fillColor||n.color),t.setAttribute("fill-opacity",n.fillOpacity),t.setAttribute("fill-rule",n.fillRule||"evenodd")):t.setAttribute("fill","none"))},_updatePoly:function(e,t){this._setPath(e,J(e._parts,t))},_updateCircle:function(e){var t=e._point,n=Math.max(Math.round(e._radius),1),a="a"+n+","+(Math.max(Math.round(e._radiusY),1)||n)+" 0 1,0 ",s=e._empty()?"M0 0":"M"+(t.x-n)+","+t.y+a+2*n+",0 "+a+2*-n+",0 ";this._setPath(e,s)},_setPath:function(e,t){e._path.setAttribute("d",t)},_bringToFront:function(e){gt(e._path)},_bringToBack:function(e){xt(e._path)}});function Ya(e){return Oe.svg||Oe.vml?new Xa(e):null}Oe.vml&&Xa.include(Ka),nn.include({getRenderer:function(e){var t=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return t||(t=this._renderer=this._createRenderer()),this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(e){if("overlayPane"===e||void 0===e)return!1;var t=this._paneRenderers[e];return void 0===t&&(t=this._createRenderer({pane:e}),this._paneRenderers[e]=t),t},_createRenderer:function(e){return this.options.preferCanvas&&Ga(e)||Ya(e)}});var Ja=ua.extend({initialize:function(e,t){ua.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return[(e=z(e)).getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Qa(e,t){return new Ja(e,t)}Xa.create=Za,Xa.pointsToPath=J,ha.geometryToLayer=pa,ha.coordsToLatLng=fa,ha.coordsToLatLngs=ga,ha.latLngToCoords=xa,ha.latLngsToCoords=ya,ha.getFeature=ba,ha.asFeature=va,nn.mergeOptions({boxZoom:!0});var $a=gn.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){Ft(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){mt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||1!==e.which&&1!==e.button)return!1;this._clearDeferredResetState(),this._resetState(),at(),Et(),this._startPoint=this._map.mouseEventToContainerPoint(e),Ft(document,{contextmenu:Zt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=pt("div","leaflet-zoom-box",this._container),bt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var t=new O(this._point,this._startPoint),n=t.getSize();jt(this._box,t.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(mt(this._box),vt(this._container,"leaflet-crosshair")),st(),At(),zt(document,{contextmenu:Zt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if((1===e.which||1===e.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(s(this._resetState,this),0);var t=new P(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})}},_onKeyDown:function(e){27===e.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});nn.addInitHook("addHandler","boxZoom",$a),nn.mergeOptions({doubleClickZoom:!0});var es=gn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom(),a=t.options.zoomDelta,s=e.originalEvent.shiftKey?n-a:n+a;"center"===t.options.doubleClickZoom?t.setZoom(s):t.setZoomAround(e.containerPoint,s)}});nn.addInitHook("addHandler","doubleClickZoom",es),nn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ts=gn.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new bn(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}bt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){vt(this._map._container,"leaflet-grab"),vt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var t=z(this._map.options.maxBounds);this._offsetLimit=F(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var t=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(t),this._prunePositions(t)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,t){return e-(e-t)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var e=this._draggable._newPos.subtract(this._draggable._startPos),t=this._offsetLimit;e.x<t.min.x&&(e.x=this._viscousLimit(e.x,t.min.x)),e.y<t.min.y&&(e.y=this._viscousLimit(e.y,t.min.y)),e.x>t.max.x&&(e.x=this._viscousLimit(e.x,t.max.x)),e.y>t.max.y&&(e.y=this._viscousLimit(e.y,t.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,a=this._draggable._newPos.x,s=(a-t+n)%e+t-n,r=(a+t+n)%e-t-n,i=Math.abs(s+n)<Math.abs(r+n)?s:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=i},_onDragEnd:function(e){var t=this._map,n=t.options,a=!n.inertia||e.noInertia||this._times.length<2;if(t.fire("dragend",e),a)t.fire("moveend");else{this._prunePositions(+new Date);var s=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,i=n.easeLinearity,o=s.multiplyBy(i/r),l=o.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),u=o.multiplyBy(c/l),d=c/(n.inertiaDeceleration*i),h=u.multiplyBy(-d/2).round();h.x||h.y?(h=t._limitOffset(h,t.options.maxBounds),S(function(){t.panBy(h,{duration:d,easeLinearity:i,noMoveStart:!0,animate:!0})})):t.fire("moveend")}}});nn.addInitHook("addHandler","dragging",ts),nn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ns=gn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),Ft(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,t=document.documentElement,n=e.scrollTop||t.scrollTop,a=e.scrollLeft||t.scrollLeft;this._map._container.focus(),window.scrollTo(a,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var t,n,a=this._panKeys={},s=this.keyCodes;for(t=0,n=s.left.length;t<n;t++)a[s.left[t]]=[-1*e,0];for(t=0,n=s.right.length;t<n;t++)a[s.right[t]]=[e,0];for(t=0,n=s.down.length;t<n;t++)a[s.down[t]]=[0,e];for(t=0,n=s.up.length;t<n;t++)a[s.up[t]]=[0,-1*e]},_setZoomDelta:function(e){var t,n,a=this._zoomKeys={},s=this.keyCodes;for(t=0,n=s.zoomIn.length;t<n;t++)a[s.zoomIn[t]]=e;for(t=0,n=s.zoomOut.length;t<n;t++)a[s.zoomOut[t]]=-e},_addHooks:function(){Ft(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t,n=e.keyCode,a=this._map;if(n in this._panKeys){if(!a._panAnim||!a._panAnim._inProgress)if(t=this._panKeys[n],e.shiftKey&&(t=D(t).multiplyBy(3)),a.options.maxBounds&&(t=a._limitOffset(D(t),a.options.maxBounds)),a.options.worldCopyJump){var s=a.wrapLatLng(a.unproject(a.project(a.getCenter()).add(t)));a.panTo(s)}else a.panBy(t)}else if(n in this._zoomKeys)a.setZoom(a.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!a._popup||!a._popup.options.closeOnEscapeKey)return;a.closePopup()}Zt(e)}}});nn.addInitHook("addHandler","keyboard",ns),nn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var as=gn.extend({addHooks:function(){Ft(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var t=Qt(e),n=this._map.options.wheelDebounceTime;this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var a=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s(this._performZoom,this),a),Zt(e)},_performZoom:function(){var e=this._map,t=e.getZoom(),n=this._map.options.zoomSnap||0;e._stop();var a=this._delta/(4*this._map.options.wheelPxPerZoomLevel),s=4*Math.log(2/(1+Math.exp(-Math.abs(a))))/Math.LN2,r=n?Math.ceil(s/n)*n:s,i=e._limitZoom(t+(this._delta>0?r:-r))-t;this._delta=0,this._startTime=null,i&&("center"===e.options.scrollWheelZoom?e.setZoom(t+i):e.setZoomAround(this._lastMousePos,t+i))}});nn.addInitHook("addHandler","scrollWheelZoom",as);var ss=600;nn.mergeOptions({tapHold:Oe.touchNative&&Oe.safari&&Oe.mobile,tapTolerance:15});var rs=gn.extend({addHooks:function(){Ft(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),1===e.touches.length){var t=e.touches[0];this._startPos=this._newPos=new R(t.clientX,t.clientY),this._holdTimeout=setTimeout(s(function(){this._cancel(),this._isTapValid()&&(Ft(document,"touchend",Kt),Ft(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",t))},this),ss),Ft(document,"touchend touchcancel contextmenu",this._cancel,this),Ft(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){zt(document,"touchend",Kt),zt(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),zt(document,"touchend touchcancel contextmenu",this._cancel,this),zt(document,"touchmove",this._onMove,this)},_onMove:function(e){var t=e.touches[0];this._newPos=new R(t.clientX,t.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,t){var n=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY});n._simulated=!0,t.target.dispatchEvent(n)}});nn.addInitHook("addHandler","tapHold",rs),nn.mergeOptions({touchZoom:Oe.touch,bounceAtZoomLimits:!0});var is=gn.extend({addHooks:function(){bt(this._map._container,"leaflet-touch-zoom"),Ft(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){vt(this._map._container,"leaflet-touch-zoom"),zt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var n=t.mouseEventToContainerPoint(e.touches[0]),a=t.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=t.getSize()._divideBy(2),this._startLatLng=t.containerPointToLatLng(this._centerPoint),"center"!==t.options.touchZoom&&(this._pinchStartLatLng=t.containerPointToLatLng(n.add(a)._divideBy(2))),this._startDist=n.distanceTo(a),this._startZoom=t.getZoom(),this._moved=!1,this._zooming=!0,t._stop(),Ft(document,"touchmove",this._onTouchMove,this),Ft(document,"touchend touchcancel",this._onTouchEnd,this),Kt(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length&&this._zooming){var t=this._map,n=t.mouseEventToContainerPoint(e.touches[0]),a=t.mouseEventToContainerPoint(e.touches[1]),r=n.distanceTo(a)/this._startDist;if(this._zoom=t.getScaleZoom(r,this._startZoom),!t.options.bounceAtZoomLimits&&(this._zoom<t.getMinZoom()&&r<1||this._zoom>t.getMaxZoom()&&r>1)&&(this._zoom=t._limitZoom(this._zoom)),"center"===t.options.touchZoom){if(this._center=this._startLatLng,1===r)return}else{var i=n._add(a)._divideBy(2)._subtract(this._centerPoint);if(1===r&&0===i.x&&0===i.y)return;this._center=t.unproject(t.project(this._pinchStartLatLng,this._zoom).subtract(i),this._zoom)}this._moved||(t._moveStart(!0,!1),this._moved=!0),C(this._animRequest);var o=s(t._move,t,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=S(o,this,!0),Kt(e)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,C(this._animRequest),zt(document,"touchmove",this._onTouchMove,this),zt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});nn.addInitHook("addHandler","touchZoom",is),nn.BoxZoom=$a,nn.DoubleClickZoom=es,nn.Drag=ts,nn.Keyboard=ns,nn.ScrollWheelZoom=as,nn.TapHold=rs,nn.TouchZoom=is,e.Bounds=O,e.Browser=Oe,e.CRS=V,e.Canvas=Ha,e.Circle=ia,e.CircleMarker=sa,e.Class=T,e.Control=sn,e.DivIcon=Da,e.DivOverlay=Ea,e.DomEvent=en,e.DomUtil=Ot,e.Draggable=bn,e.Evented=A,e.FeatureGroup=Xn,e.GeoJSON=ha,e.GridLayer=Fa,e.Handler=gn,e.Icon=Jn,e.ImageOverlay=_a,e.LatLng=B,e.LatLngBounds=P,e.Layer=qn,e.LayerGroup=Kn,e.LineUtil=zn,e.Map=nn,e.Marker=ta,e.Mixin=xn,e.Path=aa,e.Point=R,e.PolyUtil=_n,e.Polygon=ua,e.Polyline=la,e.Popup=Aa,e.PosAnimation=tn,e.Projection=Vn,e.Rectangle=Ja,e.Renderer=Ua,e.SVG=Xa,e.SVGOverlay=Ta,e.TileLayer=za,e.Tooltip=Ma,e.Transformation=q,e.Util=j,e.VideoOverlay=Ca,e.bind=s,e.bounds=F,e.canvas=Ga,e.circle=oa,e.circleMarker=ra,e.control=rn,e.divIcon=Oa,e.extend=n,e.featureGroup=Yn,e.geoJSON=ka,e.geoJson=Na,e.gridLayer=Pa,e.icon=Qn,e.imageOverlay=Sa,e.latLng=W,e.latLngBounds=z,e.layerGroup=Zn,e.map=an,e.marker=na,e.point=D,e.polygon=da,e.polyline=ca,e.popup=Ra,e.rectangle=Qa,e.setOptions=p,e.stamp=i,e.svg=Ya,e.svgOverlay=Ia,e.tileLayer=Ba,e.tooltip=La,e.transformation=K,e.version=t,e.videoOverlay=ja;var os=window.L;e.noConflict=function(){return window.L=os,this},window.L=e}(t)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,s=e[a];if(!(0<r(s,t)))break e;e[a]=t,e[n]=s,n=a}}function a(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,s=e.length,i=s>>>1;a<i;){var o=2*(a+1)-1,l=e[o],c=o+1,u=e[c];if(0>r(l,n))c<s&&0>r(u,l)?(e[a]=u,e[c]=n,a=c):(e[a]=l,e[o]=n,a=o);else{if(!(c<s&&0>r(u,n)))break e;e[a]=u,e[c]=n,a=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,m=!1,f=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=a(u);null!==t;){if(null===t.callback)s(u);else{if(!(t.startTime<=e))break;s(u),t.sortIndex=t.expirationTime,n(c,t)}t=a(u)}}function w(e){if(g=!1,v(e),!f)if(null!==a(c))f=!0,M(k);else{var t=a(u);null!==t&&L(w,t.startTime-e)}}function k(e,n){f=!1,g&&(g=!1,y(C),C=-1),m=!0;var r=p;try{for(v(n),h=a(c);null!==h&&(!(h.expirationTime>n)||e&&!I());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var o=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===a(c)&&s(c),v(n)}else s(c);h=a(c)}if(null!==h)var l=!0;else{var d=a(u);null!==d&&L(w,d.startTime-n),l=!1}return l}finally{h=null,p=r,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,_=!1,S=null,C=-1,j=5,T=-1;function I(){return!(t.unstable_now()-T<j)}function E(){if(null!==S){var e=t.unstable_now();T=e;var n=!0;try{n=S(!0,e)}finally{n?N():(_=!1,S=null)}}else _=!1}if("function"===typeof b)N=function(){b(E)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,R=A.port2;A.port1.onmessage=E,N=function(){R.postMessage(null)}}else N=function(){x(E,0)};function M(e){S=e,_||(_=!0,N())}function L(e,n){C=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,M(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,s,r){var i=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?i+r:i:r=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:s,priorityLevel:e,startTime:r,expirationTime:o=r+o,sortIndex:-1},r>i?(e.sortIndex=r,n(u,e),null===a(c)&&e===a(u)&&(g?(y(C),C=-1):g=!0,L(w,r-i))):(e.sortIndex=o,n(c,e),f||m||(f=!0,M(k))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},249:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg=="},262:function(e,t,n){var a;!function(e,s){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,a=t.d,s=t.a;return e=e<<25^e>>>7^n,n=n-a|0,a=a<<24^a>>>8^s,s=s-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-a|0,t.d=a<<16^n>>>16^s,t.a=s-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var a=0;a<n.length+20;a++)t.b^=0|n.charCodeAt(a),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function o(e,t){var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,a&&("object"==typeof a&&i(a,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(a=function(){return o}.call(t,n,t,s))||(s.exports=a):this.tychei=o}(0,e=n.nmd(e),n.amdD)},288:function(e,t,n){var a;!function(e,s){function r(e){var t=this;t.next=function(){var e,n,a=t.w,s=t.X,r=t.i;return t.w=a=a+1640531527|0,n=s[r+34&127],e=s[r=r+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=s[r]=n^e,t.i=r,n+(a^a>>>16)|0},function(e,t){var n,a,s,r,i,o=[],l=128;for(t===(0|t)?(a=t,t=null):(t+="\0",a=0,l=Math.max(l,t.length)),s=0,r=-32;r<l;++r)t&&(a^=t.charCodeAt((r+32)%t.length)),0===r&&(i=a),a^=a<<10,a^=a>>>15,a^=a<<4,a^=a>>>13,r>=0&&(i=i+1640531527|0,s=0==(n=o[127&r]^=a+i)?s+1:0);for(s>=128&&(o[127&(t&&t.length||0)]=-1),s=127,r=512;r>0;--r)a=o[s+34&127],n=o[s=s+1&127],a^=a<<13,n^=n<<17,a^=a>>>15,n^=n>>>12,o[s]=a^n;e.w=i,e.X=o,e.i=s}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function o(e,t){null==e&&(e=+new Date);var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,a&&(a.X&&i(a,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(a=function(){return o}.call(t,n,t,s))||(s.exports=a):this.xor4096=o}(0,e=n.nmd(e),n.amdD)},334:(e,t,n)=>{var a=n(359),s=n(66),r=n(635),i=n(538),o=n(288),l=n(262),c=n(430);c.alea=a,c.xor128=s,c.xorwow=r,c.xorshift7=i,c.xor4096=o,c.tychei=l,e.exports=c},353:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(S){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function a(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=a;var s={},r={};function i(e,t){var n,a,i;return t?(i=0<=(e>>>=0)&&e<256)&&(a=r[e])?a:(n=l(e,(0|e)<0?-1:0,!0),i&&(r[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(a=s[e])?a:(n=l(e,e<0?-1:0,!1),i&&(s[e]=n),n)}function o(e,t){if(isNaN(e))return t?x:g;if(t){if(e<0)return x;if(e>=p)return k}else{if(e<=-m)return N;if(e+1>=m)return w}return e<0?o(-e,t).neg():l(e%h|0,e/h|0,t)}function l(e,t,a){return new n(e,t,a)}n.fromInt=i,n.fromNumber=o,n.fromBits=l;var c=Math.pow;function u(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var a;if((a=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===a)return u(e.substring(1),t,n).neg();for(var s=o(c(n,8)),r=g,i=0;i<e.length;i+=8){var l=Math.min(8,e.length-i),d=parseInt(e.substring(i,i+l),n);if(l<8){var h=o(c(n,l));r=r.mul(h).add(o(d))}else r=(r=r.mul(s)).add(o(d))}return r.unsigned=t,r}function d(e,t){return"number"===typeof e?o(e,t):"string"===typeof e?u(e,t):l(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=u,n.fromValue=d;var h=4294967296,p=h*h,m=p/2,f=i(1<<24),g=i(0);n.ZERO=g;var x=i(0,!0);n.UZERO=x;var y=i(1);n.ONE=y;var b=i(1,!0);n.UONE=b;var v=i(-1);n.NEG_ONE=v;var w=l(-1,2147483647,!1);n.MAX_VALUE=w;var k=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var N=l(0,-2147483648,!1);n.MIN_VALUE=N;var _=n.prototype;_.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},_.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(N)){var t=o(e),n=this.div(t),a=n.mul(t).sub(this);return n.toString(e)+a.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var s=o(c(e,6),this.unsigned),r=this,i="";;){var l=r.div(s),u=(r.sub(l.mul(s)).toInt()>>>0).toString(e);if((r=l).isZero())return u+i;for(;u.length<6;)u="0"+u;i=""+u+i}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},_.isZero=function(){return 0===this.high&&0===this.low},_.eqz=_.isZero,_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||this.high>=0},_.isOdd=function(){return 1===(1&this.low)},_.isEven=function(){return 0===(1&this.low)},_.equals=function(e){return a(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},_.eq=_.equals,_.notEquals=function(e){return!this.eq(e)},_.neq=_.notEquals,_.ne=_.notEquals,_.lessThan=function(e){return this.comp(e)<0},_.lt=_.lessThan,_.lessThanOrEqual=function(e){return this.comp(e)<=0},_.lte=_.lessThanOrEqual,_.le=_.lessThanOrEqual,_.greaterThan=function(e){return this.comp(e)>0},_.gt=_.greaterThan,_.greaterThanOrEqual=function(e){return this.comp(e)>=0},_.gte=_.greaterThanOrEqual,_.ge=_.greaterThanOrEqual,_.compare=function(e){if(a(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(y)},_.neg=_.negate,_.add=function(e){a(e)||(e=d(e));var t=this.high>>>16,n=65535&this.high,s=this.low>>>16,r=65535&this.low,i=e.high>>>16,o=65535&e.high,c=e.low>>>16,u=0,h=0,p=0,m=0;return p+=(m+=r+(65535&e.low))>>>16,h+=(p+=s+c)>>>16,u+=(h+=n+o)>>>16,u+=t+i,l((p&=65535)<<16|(m&=65535),(u&=65535)<<16|(h&=65535),this.unsigned)},_.subtract=function(e){return a(e)||(e=d(e)),this.add(e.neg())},_.sub=_.subtract,_.multiply=function(e){if(this.isZero())return g;if(a(e)||(e=d(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(N))return e.isOdd()?N:g;if(e.eq(N))return this.isOdd()?N:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(f)&&e.lt(f))return o(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,s=65535&this.high,r=this.low>>>16,i=65535&this.low,c=e.high>>>16,u=65535&e.high,h=e.low>>>16,p=65535&e.low,m=0,x=0,y=0,b=0;return y+=(b+=i*p)>>>16,x+=(y+=r*p)>>>16,y&=65535,x+=(y+=i*h)>>>16,m+=(x+=s*p)>>>16,x&=65535,m+=(x+=r*h)>>>16,x&=65535,m+=(x+=i*u)>>>16,m+=n*p+s*h+r*u+i*c,l((y&=65535)<<16|(b&=65535),(m&=65535)<<16|(x&=65535),this.unsigned)},_.mul=_.multiply,_.divide=function(e){if(a(e)||(e=d(e)),e.isZero())throw Error("division by zero");var n,s,r;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?x:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return x;if(e.gt(this.shru(1)))return b;r=x}else{if(this.eq(N))return e.eq(y)||e.eq(v)?N:e.eq(N)?y:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:v:(s=this.sub(e.mul(n)),r=n.add(s.div(e)));if(e.eq(N))return this.unsigned?x:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=g}for(s=this;s.gte(e);){n=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),u=i<=48?1:c(2,i-48),h=o(n),p=h.mul(e);p.isNegative()||p.gt(s);)p=(h=o(n-=u,this.unsigned)).mul(e);h.isZero()&&(h=y),r=r.add(h),s=s.sub(p)}return r},_.div=_.divide,_.modulo=function(e){return a(e)||(e=d(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},_.mod=_.modulo,_.rem=_.modulo,_.not=function(){return l(~this.low,~this.high,this.unsigned)},_.and=function(e){return a(e)||(e=d(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},_.or=function(e){return a(e)||(e=d(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},_.xor=function(e){return a(e)||(e=d(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},_.shiftLeft=function(e){return a(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(e){return a(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(e){if(a(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.shr_u=_.shiftRightUnsigned,_.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},_.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},_.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,a){return a?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},359:function(e,t,n){var a;!function(e,s){function r(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var a=.02519603282416938*(e+=t.charCodeAt(n));a-=e=a>>>0,e=(a*=e)>>>0,e+=4294967296*(a-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function o(e,t){var n=new r(e),a=t&&t.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,a&&("object"==typeof a&&i(a,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(a=function(){return o}.call(t,n,t,s))||(s.exports=a):this.alea=o}(0,e=n.nmd(e),n.amdD)},374:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/route4.5e304a06dc0436b4baf4.jpg"},391:(e,t,n)=>{"use strict";var a=n(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},430:function(e,t,n){var a;!function(s,r,i){var o,l=256,c=i.pow(l,6),u=i.pow(2,52),d=2*u,h=255;function p(e,t,n){var a=[],h=x(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(r)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(l):(e=new Uint8Array(l),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(a){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(r)]}}():e,3),a),p=new m(a),b=function(){for(var e=p.g(6),t=c,n=0;e<u;)e=(e+n)*l,t*=l,n=p.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,x(y(p.S),r),(t.pass||n||function(e,t,n,a){return a&&(a.S&&f(a,p),e.state=function(){return f(p,{})}),n?(i.random=e,t):e})(b,h,"global"in t?t.global:this==i,t.state)}function m(e){var t,n=e.length,a=this,s=0,r=a.i=a.j=0,i=a.S=[];for(n||(e=[n++]);s<l;)i[s]=s++;for(s=0;s<l;s++)i[s]=i[r=h&r+e[s%n]+(t=i[s])],i[r]=t;(a.g=function(e){for(var t,n=0,s=a.i,r=a.j,i=a.S;e--;)t=i[s=h&s+1],n=n*l+i[h&(i[s]=i[r=h&r+t])+(i[r]=t)];return a.i=s,a.j=r,n})(l)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,a=[],s=typeof e;if(t&&"object"==s)for(n in e)try{a.push(g(e[n],t-1))}catch(r){}return a.length?a:"string"==s?e:e+"\0"}function x(e,t){for(var n,a=e+"",s=0;s<a.length;)t[h&s]=h&(n^=19*t[h&s])+a.charCodeAt(s++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(x(i.random(),r),e.exports){e.exports=p;try{o=n(996)}catch(b){}}else void 0===(a=function(){return p}.call(t,n,t,e))||(e.exports=a)}("undefined"!==typeof self?self:this,[],Math)},530:()=>{},538:function(e,t,n){var a;!function(e,s){function r(e){var t=this;t.next=function(){var e,n,a=t.x,s=t.i;return e=a[s],n=(e^=e>>>7)^e<<24,n^=(e=a[s+1&7])^e>>>10,n^=(e=a[s+3&7])^e>>>3,n^=(e=a[s+4&7])^e<<7,e=a[s+7&7],n^=(e^=e<<13)^e<<9,a[s]=n,t.i=s+1&7,n},function(e,t){var n,a=[];if(t===(0|t))a[0]=t;else for(t=""+t,n=0;n<t.length;++n)a[7&n]=a[7&n]<<15^t.charCodeAt(n)+a[n+1&7]<<13;for(;a.length<8;)a.push(0);for(n=0;n<8&&0===a[n];++n);for(8==n?a[7]=-1:a[n],e.x=a,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function o(e,t){null==e&&(e=+new Date);var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,a&&(a.x&&i(a,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(a=function(){return o}.call(t,n,t,s))||(s.exports=a):this.xorshift7=o}(0,e=n.nmd(e),n.amdD)},551:()=>{},553:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/grand-palace.a606f8aa3fd1354e47f5.jpg"},579:(e,t,n)=>{"use strict";e.exports=n(153)},590:()=>{},635:function(e,t,n){var a;!function(e,s){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var a=0;a<n.length+64;a++)t.x^=0|n.charCodeAt(a),a==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function o(e,t){var n=new r(e),a=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,a&&("object"==typeof a&&i(a,n),s.state=function(){return i(n,{})}),s}s&&s.exports?s.exports=o:n.amdD&&n.amdO?void 0===(a=function(){return o}.call(t,n,t,s))||(s.exports=a):this.xorwow=o}(0,e=n.nmd(e),n.amdD)},683:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/route5.ae89ab886b3df636971a.jpg"},708:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/route6.4a4402653f1221cb77b7.jpg"},709:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/route3.fa157f19327a83597197.jpg"},728:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/green-leaf.499db221ec9e5da63e81.jpg"},730:(e,t,n)=>{"use strict";var a=n(43),s=n(853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,a,s,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,a){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,a){if(null===t||"undefined"===typeof t||function(e,t,n,a){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,a))return!0;if(a)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,a)&&(n=null),a||null===s?function(e){return!!d.call(m,e)||!d.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,a=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,a?e.setAttributeNS(a,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var v=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),j=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var O,F=Object.assign;function P(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var z=!1;function B(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var a=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){a=c}e.call(t.prototype)}else{try{throw Error()}catch(c){a=c}e()}}catch(c){if(c&&a&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),r=a.stack.split("\n"),i=s.length-1,o=r.length-1;1<=i&&0<=o&&s[i]!==r[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==r[o]){if(1!==i||1!==o)do{if(i--,0>--o||s[i]!==r[o]){var l="\n"+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?P(e):""}function W(e){switch(e.tag){case 5:return P(e.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case k:return"Portal";case S:return"Profiler";case _:return"StrictMode";case I:return"Suspense";case E:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case j:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function U(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){a=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=G(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function Z(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:a,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){J(e,t);var n=H(t.value),a=t.type;if(null!=n)"number"===a?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Z(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,a){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&a&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(a&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(te(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function re(e,t){var n=H(t.value),a=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=a&&(e.defaultValue=""+a)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,a){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var a=0===n.indexOf("--"),s=fe(n,t[n],a);"float"===n&&(n="cssFloat"),a?e.setProperty(n,s):e[n]=s}}Object.keys(pe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var xe=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ne=null,_e=null;function Se(e){if(e=bs(e)){if("function"!==typeof ke)throw Error(r(280));var t=e.stateNode;t&&(t=ws(t),ke(e.stateNode,e.type,t))}}function Ce(e){Ne?_e?_e.push(e):_e=[e]:Ne=e}function je(){if(Ne){var e=Ne,t=_e;if(_e=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Te(e,t){return e(t)}function Ie(){}var Ee=!1;function Ae(e,t,n){if(Ee)return e(t,n);Ee=!0;try{return Te(e,t,n)}finally{Ee=!1,(null!==Ne||null!==_e)&&(Ie(),je())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var a=ws(n);if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(r(231,t,typeof n));return n}var Me=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){Me=!1}function De(e,t,n,a,s,r,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Fe=null,Pe=!1,ze=null,Be={onError:function(e){Oe=!0,Fe=e}};function We(e,t,n,a,s,r,i,o,l){Oe=!1,Fe=null,De.apply(Be,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ue(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ve(e)!==e)throw Error(r(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,a=t;;){var s=n.return;if(null===s)break;var i=s.alternate;if(null===i){if(null!==(a=s.return)){n=a;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return He(s),e;if(i===a)return He(s),t;i=i.sibling}throw Error(r(188))}if(n.return!==a.return)n=s,a=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,a=i;break}if(l===a){o=!0,a=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,a=s;break}if(l===a){o=!0,a=i,n=s;break}l=l.sibling}if(!o)throw Error(r(189))}}if(n.alternate!==a)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=s.unstable_scheduleCallback,Ze=s.unstable_cancelCallback,Xe=s.unstable_shouldYield,Ye=s.unstable_requestPaint,Je=s.unstable_now,Qe=s.unstable_getCurrentPriorityLevel,$e=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,at=s.unstable_IdlePriority,st=null,rt=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var a=0,s=e.suspendedLanes,r=e.pingedLanes,i=268435455&n;if(0!==i){var o=i&~s;0!==o?a=dt(o):0!==(r&=i)&&(a=dt(r))}else 0!==(i=n&~s)?a=dt(i):0!==r&&(a=dt(r));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&s)&&((s=a&-a)>=(r=t&-t)||16===s&&0!==(4194240&r)))return t;if(0!==(4&a)&&(a|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)s=1<<(n=31-it(t)),a|=e[n],t&=~s;return a}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-it(n),s=1<<a;s&t|e[a]&t&&(e[a]|=t),n&=~s}}var bt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,Nt,_t,St,Ct=!1,jt=[],Tt=null,It=null,Et=null,At=new Map,Rt=new Map,Mt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Et=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Ot(e,t,n,a,s,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:r,targetContainers:[s]},null!==t&&(null!==(t=bs(t))&&kt(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Ft(e){var t=ys(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ue(n)))return e.blockedOn=t,void St(e.priority,function(){Nt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Pt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bs(n))&&kt(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);ve=a,n.target.dispatchEvent(a),ve=null,t.shift()}return!0}function zt(e,t,n){Pt(e)&&n.delete(t)}function Bt(){Ct=!1,null!==Tt&&Pt(Tt)&&(Tt=null),null!==It&&Pt(It)&&(It=null),null!==Et&&Pt(Et)&&(Et=null),At.forEach(zt),Rt.forEach(zt)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Bt)))}function Vt(e){function t(t){return Wt(t,e)}if(0<jt.length){Wt(jt[0],e);for(var n=1;n<jt.length;n++){var a=jt[n];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==Tt&&Wt(Tt,e),null!==It&&Wt(It,e),null!==Et&&Wt(Et,e),At.forEach(t),Rt.forEach(t),n=0;n<Mt.length;n++)(a=Mt[n]).blockedOn===e&&(a.blockedOn=null);for(;0<Mt.length&&null===(n=Mt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Mt.shift()}var Ut=v.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,a){var s=bt,r=Ut.transition;Ut.transition=null;try{bt=1,Kt(e,t,n,a)}finally{bt=s,Ut.transition=r}}function qt(e,t,n,a){var s=bt,r=Ut.transition;Ut.transition=null;try{bt=4,Kt(e,t,n,a)}finally{bt=s,Ut.transition=r}}function Kt(e,t,n,a){if(Ht){var s=Xt(e,t,n,a);if(null===s)Ha(e,t,a,Zt,n),Dt(e,a);else if(function(e,t,n,a,s){switch(t){case"focusin":return Tt=Ot(Tt,e,t,n,a,s),!0;case"dragenter":return It=Ot(It,e,t,n,a,s),!0;case"mouseover":return Et=Ot(Et,e,t,n,a,s),!0;case"pointerover":var r=s.pointerId;return At.set(r,Ot(At.get(r)||null,e,t,n,a,s)),!0;case"gotpointercapture":return r=s.pointerId,Rt.set(r,Ot(Rt.get(r)||null,e,t,n,a,s)),!0}return!1}(s,e,t,n,a))a.stopPropagation();else if(Dt(e,a),4&t&&-1<Lt.indexOf(e)){for(;null!==s;){var r=bs(s);if(null!==r&&wt(r),null===(r=Xt(e,t,n,a))&&Ha(e,t,a,Zt,n),r===s)break;s=r}null!==s&&a.stopPropagation()}else Ha(e,t,a,null,n)}}var Zt=null;function Xt(e,t,n,a){if(Zt=null,null!==(e=ys(e=we(a))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ue(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case at:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,$t=null;function en(){if($t)return $t;var e,t,n=Qt,a=n.length,s="value"in Jt?Jt.value:Jt.textContent,r=s.length;for(e=0;e<a&&n[e]===s[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===s[r-t];t++);return $t=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function an(){return!1}function sn(e){function t(t,n,a,s,r){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:an,this.isPropagationStopped=an,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var rn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=F({},cn,{view:0,detail:0}),hn=sn(dn),pn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(rn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=rn=0,ln=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=sn(pn),fn=sn(F({},pn,{dataTransfer:0})),gn=sn(F({},dn,{relatedTarget:0})),xn=sn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(yn),vn=sn(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Sn(){return _n}var Cn=F({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),jn=sn(Cn),Tn=sn(F({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=sn(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),En=sn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=F({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(An),Mn=[9,13,27,32],Ln=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var On=u&&"TextEvent"in window&&!Dn,Fn=u&&(!Ln||Dn&&8<Dn&&11>=Dn),Pn=String.fromCharCode(32),zn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Un={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Un[e.type]:"textarea"===t}function Gn(e,t,n,a){Ce(a),0<(t=qa(t,"onChange")).length&&(n=new un("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var qn=null,Kn=null;function Zn(e){Pa(e,0)}function Xn(e){if(K(vs(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Qn;if(u){var $n="oninput"in document;if(!$n){var ea=document.createElement("div");ea.setAttribute("oninput","return;"),$n="function"===typeof ea.oninput}Qn=$n}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function ta(){qn&&(qn.detachEvent("onpropertychange",na),Kn=qn=null)}function na(e){if("value"===e.propertyName&&Xn(Kn)){var t=[];Gn(t,Kn,e,we(e)),Ae(Zn,t)}}function aa(e,t,n){"focusin"===e?(ta(),Kn=n,(qn=t).attachEvent("onpropertychange",na)):"focusout"===e&&ta()}function sa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Kn)}function ra(e,t){if("click"===e)return Xn(t)}function ia(e,t){if("input"===e||"change"===e)return Xn(t)}var oa="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function la(e,t){if(oa(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var s=n[a];if(!d.call(t,s)||!oa(e[s],t[s]))return!1}return!0}function ca(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ua(e,t){var n,a=ca(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=ca(a)}}function da(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?da(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ha(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=Z((e=t.contentWindow).document)}return t}function pa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ma(e){var t=ha(),n=e.focusedElem,a=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&da(n.ownerDocument.documentElement,n)){if(null!==a&&pa(n))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,r=Math.min(a.start,s);a=void 0===a.end?r:Math.min(a.end,s),!e.extend&&r>a&&(s=a,a=r,r=s),s=ua(n,r);var i=ua(n,a);s&&i&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),r>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fa=u&&"documentMode"in document&&11>=document.documentMode,ga=null,xa=null,ya=null,ba=!1;function va(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ba||null==ga||ga!==Z(a)||("selectionStart"in(a=ga)&&pa(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},ya&&la(ya,a)||(ya=a,0<(a=qa(xa,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=ga)))}function wa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ka={animationend:wa("Animation","AnimationEnd"),animationiteration:wa("Animation","AnimationIteration"),animationstart:wa("Animation","AnimationStart"),transitionend:wa("Transition","TransitionEnd")},Na={},_a={};function Sa(e){if(Na[e])return Na[e];if(!ka[e])return e;var t,n=ka[e];for(t in n)if(n.hasOwnProperty(t)&&t in _a)return Na[e]=n[t];return e}u&&(_a=document.createElement("div").style,"AnimationEvent"in window||(delete ka.animationend.animation,delete ka.animationiteration.animation,delete ka.animationstart.animation),"TransitionEvent"in window||delete ka.transitionend.transition);var Ca=Sa("animationend"),ja=Sa("animationiteration"),Ta=Sa("animationstart"),Ia=Sa("transitionend"),Ea=new Map,Aa="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ra(e,t){Ea.set(e,t),l(t,[e])}for(var Ma=0;Ma<Aa.length;Ma++){var La=Aa[Ma];Ra(La.toLowerCase(),"on"+(La[0].toUpperCase()+La.slice(1)))}Ra(Ca,"onAnimationEnd"),Ra(ja,"onAnimationIteration"),Ra(Ta,"onAnimationStart"),Ra("dblclick","onDoubleClick"),Ra("focusin","onFocus"),Ra("focusout","onBlur"),Ra(Ia,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Da="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oa=new Set("cancel close invalid load scroll toggle".split(" ").concat(Da));function Fa(e,t,n){var a=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,a,s,i,o,l,c){if(We.apply(this,arguments),Oe){if(!Oe)throw Error(r(198));var u=Fe;Oe=!1,Fe=null,Pe||(Pe=!0,ze=u)}}(a,t,void 0,e),e.currentTarget=null}function Pa(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],s=a.event;a=a.listeners;e:{var r=void 0;if(t)for(var i=a.length-1;0<=i;i--){var o=a[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==r&&s.isPropagationStopped())break e;Fa(s,o,c),r=l}else for(i=0;i<a.length;i++){if(l=(o=a[i]).instance,c=o.currentTarget,o=o.listener,l!==r&&s.isPropagationStopped())break e;Fa(s,o,c),r=l}}}if(Pe)throw e=ze,Pe=!1,ze=null,e}function za(e,t){var n=t[fs];void 0===n&&(n=t[fs]=new Set);var a=e+"__bubble";n.has(a)||(Ua(t,e,2,!1),n.add(a))}function Ba(e,t,n){var a=0;t&&(a|=4),Ua(n,e,a,t)}var Wa="_reactListening"+Math.random().toString(36).slice(2);function Va(e){if(!e[Wa]){e[Wa]=!0,i.forEach(function(t){"selectionchange"!==t&&(Oa.has(t)||Ba(t,!1,e),Ba(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wa]||(t[Wa]=!0,Ba("selectionchange",!1,t))}}function Ua(e,t,n,a){switch(Yt(t)){case 1:var s=Gt;break;case 4:s=qt;break;default:s=Kt}n=s.bind(null,t,n,e),s=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),a?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Ha(e,t,n,a,s){var r=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===i)for(i=a.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;i=i.return}for(;null!==o;){if(null===(i=ys(o)))return;if(5===(l=i.tag)||6===l){a=r=i;continue e}o=o.parentNode}}a=a.return}Ae(function(){var a=r,s=we(n),i=[];e:{var o=Ea.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=jn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Ca:case ja:case Ta:l=xn;break;case Ia:l=En;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var p,m=a;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Re(m,h))&&u.push(Ga(m,f,p)))),d)break;m=m.return}0<u.length&&(o=new l(o,c,null,n,s),i.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===ve||!(c=n.relatedTarget||n.fromElement)||!ys(c)&&!c[ms])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=a,null!==(c=(c=n.relatedTarget||n.toElement)?ys(c):null)&&(c!==(d=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=a),l!==c)){if(u=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=Tn,f="onPointerLeave",h="onPointerEnter",m="pointer"),d=null==l?o:vs(l),p=null==c?o:vs(c),(o=new u(f,m+"leave",l,n,s)).target=d,o.relatedTarget=p,f=null,ys(s)===a&&((u=new u(h,m+"enter",c,n,s)).target=p,u.relatedTarget=d,f=u),d=f,l&&c)e:{for(h=c,m=0,p=u=l;p;p=Ka(p))m++;for(p=0,f=h;f;f=Ka(f))p++;for(;0<m-p;)u=Ka(u),m--;for(;0<p-m;)h=Ka(h),p--;for(;m--;){if(u===h||null!==h&&u===h.alternate)break e;u=Ka(u),h=Ka(h)}u=null}else u=null;null!==l&&Za(i,o,l,u,!1),null!==c&&null!==d&&Za(i,d,c,u,!0)}if("select"===(l=(o=a?vs(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Yn;else if(Hn(o))if(Jn)g=ia;else{g=sa;var x=aa}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ra);switch(g&&(g=g(e,a))?Gn(i,g,n,s):(x&&x(e,o,a),"focusout"===e&&(x=o._wrapperState)&&x.controlled&&"number"===o.type&&ee(o,"number",o.value)),x=a?vs(a):window,e){case"focusin":(Hn(x)||"true"===x.contentEditable)&&(ga=x,xa=a,ya=null);break;case"focusout":ya=xa=ga=null;break;case"mousedown":ba=!0;break;case"contextmenu":case"mouseup":case"dragend":ba=!1,va(i,n,s);break;case"selectionchange":if(fa)break;case"keydown":case"keyup":va(i,n,s)}var y;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=en()):(Qt="value"in(Jt=s)?Jt.value:Jt.textContent,Vn=!0)),0<(x=qa(a,b)).length&&(b=new vn(b,e,null,n,s),i.push({event:b,listeners:x}),y?b.data=y:null!==(y=Wn(n))&&(b.data=y))),(y=On?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(zn=!0,Pn);case"textInput":return(e=t.data)===Pn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Ln&&Bn(e,t)?(e=en(),$t=Qt=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(a=qa(a,"onBeforeInput")).length&&(s=new vn("onBeforeInput","beforeinput",null,n,s),i.push({event:s,listeners:a}),s.data=y))}Pa(i,t)})}function Ga(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qa(e,t){for(var n=t+"Capture",a=[];null!==e;){var s=e,r=s.stateNode;5===s.tag&&null!==r&&(s=r,null!=(r=Re(e,n))&&a.unshift(Ga(e,r,s)),null!=(r=Re(e,t))&&a.push(Ga(e,r,s))),e=e.return}return a}function Ka(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Za(e,t,n,a,s){for(var r=t._reactName,i=[];null!==n&&n!==a;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===a)break;5===o.tag&&null!==c&&(o=c,s?null!=(l=Re(n,r))&&i.unshift(Ga(n,l,o)):s||null!=(l=Re(n,r))&&i.push(Ga(n,l,o))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Xa=/\r\n?/g,Ya=/\u0000|\uFFFD/g;function Ja(e){return("string"===typeof e?e:""+e).replace(Xa,"\n").replace(Ya,"")}function Qa(e,t,n){if(t=Ja(t),Ja(e)!==t&&n)throw Error(r(425))}function $a(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var as="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,rs="function"===typeof Promise?Promise:void 0,is="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rs?function(e){return rs.resolve(null).then(e).catch(os)}:as;function os(e){setTimeout(function(){throw e})}function ls(e,t){var n=t,a=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===a)return e.removeChild(s),void Vt(t);a--}else"$"!==n&&"$?"!==n&&"$!"!==n||a++;n=s}while(n);Vt(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function us(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ds=Math.random().toString(36).slice(2),hs="__reactFiber$"+ds,ps="__reactProps$"+ds,ms="__reactContainer$"+ds,fs="__reactEvents$"+ds,gs="__reactListeners$"+ds,xs="__reactHandles$"+ds;function ys(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ms]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=us(e);null!==e;){if(n=e[hs])return n;e=us(e)}return t}n=(e=n).parentNode}return null}function bs(e){return!(e=e[hs]||e[ms])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function ws(e){return e[ps]||null}var ks=[],Ns=-1;function _s(e){return{current:e}}function Ss(e){0>Ns||(e.current=ks[Ns],ks[Ns]=null,Ns--)}function Cs(e,t){Ns++,ks[Ns]=e.current,e.current=t}var js={},Ts=_s(js),Is=_s(!1),Es=js;function As(e,t){var n=e.type.contextTypes;if(!n)return js;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var s,r={};for(s in n)r[s]=t[s];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Rs(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ms(){Ss(Is),Ss(Ts)}function Ls(e,t,n){if(Ts.current!==js)throw Error(r(168));Cs(Ts,t),Cs(Is,n)}function Ds(e,t,n){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return n;for(var s in a=a.getChildContext())if(!(s in t))throw Error(r(108,U(e)||"Unknown",s));return F({},n,a)}function Os(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||js,Es=Ts.current,Cs(Ts,e),Cs(Is,Is.current),!0}function Fs(e,t,n){var a=e.stateNode;if(!a)throw Error(r(169));n?(e=Ds(e,t,Es),a.__reactInternalMemoizedMergedChildContext=e,Ss(Is),Ss(Ts),Cs(Ts,e)):Ss(Is),Cs(Is,n)}var Ps=null,zs=!1,Bs=!1;function Ws(e){null===Ps?Ps=[e]:Ps.push(e)}function Vs(){if(!Bs&&null!==Ps){Bs=!0;var e=0,t=bt;try{var n=Ps;for(bt=1;e<n.length;e++){var a=n[e];do{a=a(!0)}while(null!==a)}Ps=null,zs=!1}catch(s){throw null!==Ps&&(Ps=Ps.slice(e+1)),Ke($e,Vs),s}finally{bt=t,Bs=!1}}return null}var Us=[],Hs=0,Gs=null,qs=0,Ks=[],Zs=0,Xs=null,Ys=1,Js="";function Qs(e,t){Us[Hs++]=qs,Us[Hs++]=Gs,Gs=e,qs=t}function $s(e,t,n){Ks[Zs++]=Ys,Ks[Zs++]=Js,Ks[Zs++]=Xs,Xs=e;var a=Ys;e=Js;var s=32-it(a)-1;a&=~(1<<s),n+=1;var r=32-it(t)+s;if(30<r){var i=s-s%5;r=(a&(1<<i)-1).toString(32),a>>=i,s-=i,Ys=1<<32-it(t)+s|n<<s|a,Js=r+e}else Ys=1<<r|n<<s|a,Js=e}function er(e){null!==e.return&&(Qs(e,1),$s(e,1,0))}function tr(e){for(;e===Gs;)Gs=Us[--Hs],Us[Hs]=null,qs=Us[--Hs],Us[Hs]=null;for(;e===Xs;)Xs=Ks[--Zs],Ks[Zs]=null,Js=Ks[--Zs],Ks[Zs]=null,Ys=Ks[--Zs],Ks[Zs]=null}var nr=null,ar=null,sr=!1,rr=null;function ir(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function or(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,nr=e,ar=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,nr=e,ar=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xs?{id:Ys,overflow:Js}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,nr=e,ar=null,!0);default:return!1}}function lr(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(sr){var t=ar;if(t){var n=t;if(!or(e,t)){if(lr(e))throw Error(r(418));t=cs(n.nextSibling);var a=nr;t&&or(e,t)?ir(a,n):(e.flags=-4097&e.flags|2,sr=!1,nr=e)}}else{if(lr(e))throw Error(r(418));e.flags=-4097&e.flags|2,sr=!1,nr=e}}}function ur(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;nr=e}function dr(e){if(e!==nr)return!1;if(!sr)return ur(e),sr=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ar)){if(lr(e))throw hr(),Error(r(418));for(;t;)ir(e,t),t=cs(t.nextSibling)}if(ur(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ar=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ar=null}}else ar=nr?cs(e.stateNode.nextSibling):null;return!0}function hr(){for(var e=ar;e;)e=cs(e.nextSibling)}function pr(){ar=nr=null,sr=!1}function mr(e){null===rr?rr=[e]:rr.push(e)}var fr=v.ReactCurrentBatchConfig;function gr(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var a=n.stateNode}if(!a)throw Error(r(147,e));var s=a,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=s.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function xr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yr(e){return(0,e._init)(e._payload)}function br(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function i(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=2,n):a:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,a){return null===t||6!==t.tag?((t=Fc(n,e.mode,a)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,a){var r=n.type;return r===N?d(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===R&&yr(r)===t.type)?((a=s(t,n.props)).ref=gr(e,t,n),a.return=e,a):((a=Lc(n.type,n.key,n.props,null,e.mode,a)).ref=gr(e,t,n),a.return=e,a)}function u(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Pc(n,e.mode,a)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function d(e,t,n,a,r){return null===t||7!==t.tag?((t=Dc(n,e.mode,a,r)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=gr(e,null,t),n.return=e,n;case k:return(t=Pc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Dc(t,e.mode,n,null)).return=e,t;xr(e,t)}return null}function p(e,t,n,a){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,a):null;case k:return n.key===s?u(e,t,n,a):null;case R:return p(e,t,(s=n._init)(n._payload),a)}if(te(n)||D(n))return null!==s?null:d(e,t,n,a,null);xr(e,n)}return null}function m(e,t,n,a,s){if("string"===typeof a&&""!==a||"number"===typeof a)return l(t,e=e.get(n)||null,""+a,s);if("object"===typeof a&&null!==a){switch(a.$$typeof){case w:return c(t,e=e.get(null===a.key?n:a.key)||null,a,s);case k:return u(t,e=e.get(null===a.key?n:a.key)||null,a,s);case R:return m(e,t,n,(0,a._init)(a._payload),s)}if(te(a)||D(a))return d(t,e=e.get(n)||null,a,s,null);xr(t,a)}return null}function f(s,r,o,l){for(var c=null,u=null,d=r,f=r=0,g=null;null!==d&&f<o.length;f++){d.index>f?(g=d,d=null):g=d.sibling;var x=p(s,d,o[f],l);if(null===x){null===d&&(d=g);break}e&&d&&null===x.alternate&&t(s,d),r=i(x,r,f),null===u?c=x:u.sibling=x,u=x,d=g}if(f===o.length)return n(s,d),sr&&Qs(s,f),c;if(null===d){for(;f<o.length;f++)null!==(d=h(s,o[f],l))&&(r=i(d,r,f),null===u?c=d:u.sibling=d,u=d);return sr&&Qs(s,f),c}for(d=a(s,d);f<o.length;f++)null!==(g=m(d,s,f,o[f],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?f:g.key),r=i(g,r,f),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(s,e)}),sr&&Qs(s,f),c}function g(s,o,l,c){var u=D(l);if("function"!==typeof u)throw Error(r(150));if(null==(l=u.call(l)))throw Error(r(151));for(var d=u=null,f=o,g=o=0,x=null,y=l.next();null!==f&&!y.done;g++,y=l.next()){f.index>g?(x=f,f=null):x=f.sibling;var b=p(s,f,y.value,c);if(null===b){null===f&&(f=x);break}e&&f&&null===b.alternate&&t(s,f),o=i(b,o,g),null===d?u=b:d.sibling=b,d=b,f=x}if(y.done)return n(s,f),sr&&Qs(s,g),u;if(null===f){for(;!y.done;g++,y=l.next())null!==(y=h(s,y.value,c))&&(o=i(y,o,g),null===d?u=y:d.sibling=y,d=y);return sr&&Qs(s,g),u}for(f=a(s,f);!y.done;g++,y=l.next())null!==(y=m(f,s,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),o=i(y,o,g),null===d?u=y:d.sibling=y,d=y);return e&&f.forEach(function(e){return t(s,e)}),sr&&Qs(s,g),u}return function e(a,r,i,l){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,u=r;null!==u;){if(u.key===c){if((c=i.type)===N){if(7===u.tag){n(a,u.sibling),(r=s(u,i.props.children)).return=a,a=r;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&yr(c)===u.type){n(a,u.sibling),(r=s(u,i.props)).ref=gr(a,u,i),r.return=a,a=r;break e}n(a,u);break}t(a,u),u=u.sibling}i.type===N?((r=Dc(i.props.children,a.mode,l,i.key)).return=a,a=r):((l=Lc(i.type,i.key,i.props,null,a.mode,l)).ref=gr(a,r,i),l.return=a,a=l)}return o(a);case k:e:{for(u=i.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(a,r.sibling),(r=s(r,i.children||[])).return=a,a=r;break e}n(a,r);break}t(a,r),r=r.sibling}(r=Pc(i,a.mode,l)).return=a,a=r}return o(a);case R:return e(a,r,(u=i._init)(i._payload),l)}if(te(i))return f(a,r,i,l);if(D(i))return g(a,r,i,l);xr(a,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==r&&6===r.tag?(n(a,r.sibling),(r=s(r,i)).return=a,a=r):(n(a,r),(r=Fc(i,a.mode,l)).return=a,a=r),o(a)):n(a,r)}}var vr=br(!0),wr=br(!1),kr=_s(null),Nr=null,_r=null,Sr=null;function Cr(){Sr=_r=Nr=null}function jr(e){var t=kr.current;Ss(kr),e._currentValue=t}function Tr(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Ir(e,t){Nr=e,Sr=_r=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Er(e){var t=e._currentValue;if(Sr!==e)if(e={context:e,memoizedValue:t,next:null},null===_r){if(null===Nr)throw Error(r(308));_r=e,Nr.dependencies={lanes:0,firstContext:e}}else _r=_r.next=e;return t}var Ar=null;function Rr(e){null===Ar?Ar=[e]:Ar.push(e)}function Mr(e,t,n,a){var s=t.interleaved;return null===s?(n.next=n,Rr(t)):(n.next=s.next,s.next=n),t.interleaved=n,Lr(e,a)}function Lr(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Dr=!1;function Or(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zr(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Tl)){var s=a.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),a.pending=t,Lr(e,n)}return null===(s=a.interleaved)?(t.next=t,Rr(a)):(t.next=s.next,s.next=t),a.interleaved=t,Lr(e,n)}function Br(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Wr(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var s=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?s=r=i:r=r.next=i,n=n.next}while(null!==n);null===r?s=r=t:r=r.next=t}else s=r=t;return n={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:a.shared,effects:a.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vr(e,t,n,a){var s=e.updateQueue;Dr=!1;var r=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?r=c:i.next=c,i=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==r){var d=s.baseState;for(i=0,u=c=l=null,o=r;;){var h=o.lane,p=o.eventTime;if((a&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){d=m.call(p,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,d,h):m)||void 0===h)break e;d=F({},d,h);break e;case 2:Dr=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,i|=h;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(h=o).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===u&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,null!==(t=s.shared.interleaved)){s=t;do{i|=s.lane,s=s.next}while(s!==t)}else null===r&&(s.shared.lanes=0);Ol|=i,e.lanes=i,e.memoizedState=d}}function Ur(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],s=a.callback;if(null!==s){if(a.callback=null,a=n,"function"!==typeof s)throw Error(r(191,s));s.call(a)}}}var Hr={},Gr=_s(Hr),qr=_s(Hr),Kr=_s(Hr);function Zr(e){if(e===Hr)throw Error(r(174));return e}function Xr(e,t){switch(Cs(Kr,t),Cs(qr,e),Cs(Gr,Hr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ss(Gr),Cs(Gr,t)}function Yr(){Ss(Gr),Ss(qr),Ss(Kr)}function Jr(e){Zr(Kr.current);var t=Zr(Gr.current),n=le(t,e.type);t!==n&&(Cs(qr,e),Cs(Gr,n))}function Qr(e){qr.current===e&&(Ss(Gr),Ss(qr))}var $r=_s(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ai=v.ReactCurrentDispatcher,si=v.ReactCurrentBatchConfig,ri=0,ii=null,oi=null,li=null,ci=!1,ui=!1,di=0,hi=0;function pi(){throw Error(r(321))}function mi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oa(e[n],t[n]))return!1;return!0}function fi(e,t,n,a,s,i){if(ri=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ai.current=null===e||null===e.memoizedState?Qi:$i,e=n(a,s),ui){i=0;do{if(ui=!1,di=0,25<=i)throw Error(r(301));i+=1,li=oi=null,t.updateQueue=null,ai.current=eo,e=n(a,s)}while(ui)}if(ai.current=Ji,t=null!==oi&&null!==oi.next,ri=0,li=oi=ii=null,ci=!1,t)throw Error(r(300));return e}function gi(){var e=0!==di;return di=0,e}function xi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function yi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(r(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function bi(e,t){return"function"===typeof t?t(e):t}function vi(e){var t=yi(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var a=oi,s=a.baseQueue,i=n.pending;if(null!==i){if(null!==s){var o=s.next;s.next=i.next,i.next=o}a.baseQueue=s=i,n.pending=null}if(null!==s){i=s.next,a=a.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((ri&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:e(a,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=a):c=c.next=h,ii.lanes|=d,Ol|=d}u=u.next}while(null!==u&&u!==i);null===c?o=a:c.next=l,oa(a,t.memoizedState)||(bo=!0),t.memoizedState=a,t.baseState=o,t.baseQueue=c,n.lastRenderedState=a}if(null!==(e=n.interleaved)){s=e;do{i=s.lane,ii.lanes|=i,Ol|=i,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wi(e){var t=yi(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var a=n.dispatch,s=n.pending,i=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{i=e(i,o.action),o=o.next}while(o!==s);oa(i,t.memoizedState)||(bo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,a]}function ki(){}function Ni(e,t){var n=ii,a=yi(),s=t(),i=!oa(a.memoizedState,s);if(i&&(a.memoizedState=s,bo=!0),a=a.queue,Di(Ci.bind(null,n,a,e),[e]),a.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(n.flags|=2048,Ei(9,Si.bind(null,n,a,s,t),void 0,null),null===Il)throw Error(r(349));0!==(30&ri)||_i(n,t,s)}return s}function _i(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Si(e,t,n,a){t.value=n,t.getSnapshot=a,ji(t)&&Ti(e)}function Ci(e,t,n){return n(function(){ji(t)&&Ti(e)})}function ji(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oa(e,n)}catch(a){return!0}}function Ti(e){var t=Lr(e,1);null!==t&&nc(t,e,1,-1)}function Ii(e){var t=xi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[t.memoizedState,e]}function Ei(e,t,n,a){return e={tag:e,create:t,destroy:n,deps:a,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function Ai(){return yi().memoizedState}function Ri(e,t,n,a){var s=xi();ii.flags|=e,s.memoizedState=Ei(1|t,n,void 0,void 0===a?null:a)}function Mi(e,t,n,a){var s=yi();a=void 0===a?null:a;var r=void 0;if(null!==oi){var i=oi.memoizedState;if(r=i.destroy,null!==a&&mi(a,i.deps))return void(s.memoizedState=Ei(t,n,r,a))}ii.flags|=e,s.memoizedState=Ei(1|t,n,r,a)}function Li(e,t){return Ri(8390656,8,e,t)}function Di(e,t){return Mi(2048,8,e,t)}function Oi(e,t){return Mi(4,2,e,t)}function Fi(e,t){return Mi(4,4,e,t)}function Pi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mi(4,4,Pi.bind(null,t,e),n)}function Bi(){}function Wi(e,t){var n=yi();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&mi(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Vi(e,t){var n=yi();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&mi(t,a[1])?a[0]:(e=e(),n.memoizedState=[e,t],e)}function Ui(e,t,n){return 0===(21&ri)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(oa(n,t)||(n=ft(),ii.lanes|=n,Ol|=n,e.baseState=!0),t)}function Hi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var a=si.transition;si.transition={};try{e(!1),t()}finally{bt=n,si.transition=a}}function Gi(){return yi().memoizedState}function qi(e,t,n){var a=tc(e);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},Zi(e))Xi(t,n);else if(null!==(n=Mr(e,t,n,a))){nc(n,e,a,ec()),Yi(n,t,a)}}function Ki(e,t,n){var a=tc(e),s={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(Zi(e))Xi(t,s);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=r(i,n);if(s.hasEagerState=!0,s.eagerState=o,oa(o,i)){var l=t.interleaved;return null===l?(s.next=s,Rr(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Mr(e,t,s,a))&&(nc(n,e,a,s=ec()),Yi(n,t,a))}}function Zi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Xi(e,t){ui=ci=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yi(e,t,n){if(0!==(4194240&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Ji={readContext:Er,useCallback:pi,useContext:pi,useEffect:pi,useImperativeHandle:pi,useInsertionEffect:pi,useLayoutEffect:pi,useMemo:pi,useReducer:pi,useRef:pi,useState:pi,useDebugValue:pi,useDeferredValue:pi,useTransition:pi,useMutableSource:pi,useSyncExternalStore:pi,useId:pi,unstable_isNewReconciler:!1},Qi={readContext:Er,useCallback:function(e,t){return xi().memoizedState=[e,void 0===t?null:t],e},useContext:Er,useEffect:Li,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ri(4194308,4,Pi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ri(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ri(4,2,e,t)},useMemo:function(e,t){var n=xi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var a=xi();return t=void 0!==n?n(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=qi.bind(null,ii,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},xi().memoizedState=e},useState:Ii,useDebugValue:Bi,useDeferredValue:function(e){return xi().memoizedState=e},useTransition:function(){var e=Ii(!1),t=e[0];return e=Hi.bind(null,e[1]),xi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var a=ii,s=xi();if(sr){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===Il)throw Error(r(349));0!==(30&ri)||_i(a,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Li(Ci.bind(null,a,i,e),[e]),a.flags|=2048,Ei(9,Si.bind(null,a,i,n,t),void 0,null),n},useId:function(){var e=xi(),t=Il.identifierPrefix;if(sr){var n=Js;t=":"+t+"R"+(n=(Ys&~(1<<32-it(Ys)-1)).toString(32)+n),0<(n=di++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$i={readContext:Er,useCallback:Wi,useContext:Er,useEffect:Di,useImperativeHandle:zi,useInsertionEffect:Oi,useLayoutEffect:Fi,useMemo:Vi,useReducer:vi,useRef:Ai,useState:function(){return vi(bi)},useDebugValue:Bi,useDeferredValue:function(e){return Ui(yi(),oi.memoizedState,e)},useTransition:function(){return[vi(bi)[0],yi().memoizedState]},useMutableSource:ki,useSyncExternalStore:Ni,useId:Gi,unstable_isNewReconciler:!1},eo={readContext:Er,useCallback:Wi,useContext:Er,useEffect:Di,useImperativeHandle:zi,useInsertionEffect:Oi,useLayoutEffect:Fi,useMemo:Vi,useReducer:wi,useRef:Ai,useState:function(){return wi(bi)},useDebugValue:Bi,useDeferredValue:function(e){var t=yi();return null===oi?t.memoizedState=e:Ui(t,oi.memoizedState,e)},useTransition:function(){return[wi(bi)[0],yi().memoizedState]},useMutableSource:ki,useSyncExternalStore:Ni,useId:Gi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ao={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var a=ec(),s=tc(e),r=Pr(a,s);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=zr(e,r,s))&&(nc(t,e,s,a),Br(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=ec(),s=tc(e),r=Pr(a,s);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=zr(e,r,s))&&(nc(t,e,s,a),Br(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),a=tc(e),s=Pr(n,a);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=zr(e,s,a))&&(nc(t,e,a,n),Br(t,e,a))}};function so(e,t,n,a,s,r,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,r,i):!t.prototype||!t.prototype.isPureReactComponent||(!la(n,a)||!la(s,r))}function ro(e,t,n){var a=!1,s=js,r=t.contextType;return"object"===typeof r&&null!==r?r=Er(r):(s=Rs(t)?Es:Ts.current,r=(a=null!==(a=t.contextTypes)&&void 0!==a)?As(e,s):js),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ao,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=r),t}function io(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&ao.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,a){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Or(e);var r=t.contextType;"object"===typeof r&&null!==r?s.context=Er(r):(r=Rs(t)?Es:Ts.current,s.context=As(e,r)),s.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(no(e,t,r,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&ao.enqueueReplaceState(s,s.state,null),Vr(e,n,s,a),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",a=t;do{n+=W(a),a=a.return}while(a);var s=n}catch(r){s="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:s,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Pr(-1,n)).tag=3,n.payload={element:null};var a=t.value;return n.callback=function(){Hl||(Hl=!0,Gl=a),uo(0,t)},n}function mo(e,t,n){(n=Pr(-1,n)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var s=t.value;n.payload=function(){return a(s)},n.callback=function(){uo(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof a&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fo(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new ho;var s=new Set;a.set(t,s)}else void 0===(s=a.get(t))&&(s=new Set,a.set(t,s));s.has(n)||(s.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xo(e,t,n,a,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Pr(-1,1)).tag=2,zr(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var yo=v.ReactCurrentOwner,bo=!1;function vo(e,t,n,a){t.child=null===e?wr(t,null,n,a):vr(t,e.child,n,a)}function wo(e,t,n,a,s){n=n.render;var r=t.ref;return Ir(t,s),a=fi(e,t,n,a,r,s),n=gi(),null===e||bo?(sr&&n&&er(t),t.flags|=1,vo(e,t,a,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ho(e,t,s))}function ko(e,t,n,a,s){if(null===e){var r=n.type;return"function"!==typeof r||Rc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,a,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,No(e,t,r,a,s))}if(r=e.child,0===(e.lanes&s)){var i=r.memoizedProps;if((n=null!==(n=n.compare)?n:la)(i,a)&&e.ref===t.ref)return Ho(e,t,s)}return t.flags|=1,(e=Mc(r,a)).ref=t.ref,e.return=t,t.child=e}function No(e,t,n,a,s){if(null!==e){var r=e.memoizedProps;if(la(r,a)&&e.ref===t.ref){if(bo=!1,t.pendingProps=a=r,0===(e.lanes&s))return t.lanes=e.lanes,Ho(e,t,s);0!==(131072&e.flags)&&(bo=!0)}}return Co(e,t,n,a,s)}function _o(e,t,n){var a=t.pendingProps,s=a.children,r=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cs(Ml,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cs(Ml,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==r?r.baseLanes:n,Cs(Ml,Rl),Rl|=a}else null!==r?(a=r.baseLanes|n,t.memoizedState=null):a=n,Cs(Ml,Rl),Rl|=a;return vo(e,t,s,n),t.child}function So(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,n,a,s){var r=Rs(n)?Es:Ts.current;return r=As(t,r),Ir(t,s),n=fi(e,t,n,a,r,s),a=gi(),null===e||bo?(sr&&a&&er(t),t.flags|=1,vo(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ho(e,t,s))}function jo(e,t,n,a,s){if(Rs(n)){var r=!0;Os(t)}else r=!1;if(Ir(t,s),null===t.stateNode)Uo(e,t),ro(t,n,a),oo(t,n,a,s),a=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=Er(c):c=As(t,c=Rs(n)?Es:Ts.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==a||l!==c)&&io(t,i,a,c),Dr=!1;var h=t.memoizedState;i.state=h,Vr(t,a,i,s),l=t.memoizedState,o!==a||h!==l||Is.current||Dr?("function"===typeof u&&(no(t,n,u,a),l=t.memoizedState),(o=Dr||so(t,n,o,a,h,l,c))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=l),i.props=a,i.state=l,i.context=c,a=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,Fr(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,d=t.pendingProps,h=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=Er(l):l=As(t,l=Rs(n)?Es:Ts.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==d||h!==l)&&io(t,i,a,l),Dr=!1,h=t.memoizedState,i.state=h,Vr(t,a,i,s);var m=t.memoizedState;o!==d||h!==m||Is.current||Dr?("function"===typeof p&&(no(t,n,p,a),m=t.memoizedState),(c=Dr||so(t,n,c,a,h,m,l)||!1)?(u||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(a,m,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,m,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=m),i.props=a,i.state=m,i.context=l,a=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return To(e,t,n,a,r,s)}function To(e,t,n,a,s,r){So(e,t);var i=0!==(128&t.flags);if(!a&&!i)return s&&Fs(t,n,!1),Ho(e,t,r);a=t.stateNode,yo.current=t;var o=i&&"function"!==typeof n.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&i?(t.child=vr(t,e.child,null,r),t.child=vr(t,null,o,r)):vo(e,t,o,r),t.memoizedState=a.state,s&&Fs(t,n,!0),t.child}function Io(e){var t=e.stateNode;t.pendingContext?Ls(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ls(0,t.context,!1),Xr(e,t.containerInfo)}function Eo(e,t,n,a,s){return pr(),mr(s),t.flags|=256,vo(e,t,n,a),t.child}var Ao,Ro,Mo,Lo,Do={dehydrated:null,treeContext:null,retryLane:0};function Oo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var a,s=t.pendingProps,i=$r.current,o=!1,l=0!==(128&t.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&0!==(2&i)),a?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Cs($r,1&i),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,o?(s=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Oc(l,s,0,null),e=Dc(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Oo(n),t.memoizedState=Do,e):Po(t,l));if(null!==(i=e.memoizedState)&&null!==(a=i.dehydrated))return function(e,t,n,a,s,i,o){if(n)return 256&t.flags?(t.flags&=-257,zo(e,t,o,a=co(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=a.fallback,s=t.mode,a=Oc({mode:"visible",children:a.children},s,0,null),(i=Dc(i,s,o,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,0!==(1&t.mode)&&vr(t,e.child,null,o),t.child.memoizedState=Oo(o),t.memoizedState=Do,i);if(0===(1&t.mode))return zo(e,t,o,null);if("$!"===s.data){if(a=s.nextSibling&&s.nextSibling.dataset)var l=a.dgst;return a=l,zo(e,t,o,a=co(i=Error(r(419)),a,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(a=Il)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(a.suspendedLanes|o))?0:s)&&s!==i.retryLane&&(i.retryLane=s,Lr(e,s),nc(a,e,s,-1))}return fc(),zo(e,t,o,a=co(Error(r(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=jc.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,ar=cs(s.nextSibling),nr=t,sr=!0,rr=null,null!==e&&(Ks[Zs++]=Ys,Ks[Zs++]=Js,Ks[Zs++]=Xs,Ys=e.id,Js=e.overflow,Xs=t),t=Po(t,a.children),t.flags|=4096,t)}(e,t,l,s,a,i,n);if(o){o=s.fallback,l=t.mode,a=(i=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==i?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Mc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==a?o=Mc(a,o):(o=Dc(o,l,n,null)).flags|=2,o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,l=null===(l=e.child.memoizedState)?Oo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Do,s}return e=(o=e.child).sibling,s=Mc(o,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Po(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zo(e,t,n,a){return null!==a&&mr(a),vr(t,e.child,null,n),(e=Po(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bo(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Tr(e.return,t,n)}function Wo(e,t,n,a,s){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=a,r.tail=n,r.tailMode=s)}function Vo(e,t,n){var a=t.pendingProps,s=a.revealOrder,r=a.tail;if(vo(e,t,a.children,n),0!==(2&(a=$r.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bo(e,n,t);else if(19===e.tag)Bo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Cs($r,a),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Wo(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ei(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Wo(t,!0,n,null,r);break;case"together":Wo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!sr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,a|=14680064&s.subtreeFlags,a|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function Ko(e,t,n){var a=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Rs(t.type)&&Ms(),qo(t),null;case 3:return a=t.stateNode,Yr(),Ss(Is),Ss(Ts),ni(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(dr(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(ic(rr),rr=null))),Ro(e,t),qo(t),null;case 5:Qr(t);var s=Zr(Kr.current);if(n=t.type,null!==e&&null!=t.stateNode)Mo(e,t,n,a,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(r(166));return qo(t),null}if(e=Zr(Gr.current),dr(t)){a=t.stateNode,n=t.type;var i=t.memoizedProps;switch(a[hs]=t,a[ps]=i,e=0!==(1&t.mode),n){case"dialog":za("cancel",a),za("close",a);break;case"iframe":case"object":case"embed":za("load",a);break;case"video":case"audio":for(s=0;s<Da.length;s++)za(Da[s],a);break;case"source":za("error",a);break;case"img":case"image":case"link":za("error",a),za("load",a);break;case"details":za("toggle",a);break;case"input":Y(a,i),za("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},za("invalid",a);break;case"textarea":se(a,i),za("invalid",a)}for(var l in ye(n,i),s=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?a.textContent!==c&&(!0!==i.suppressHydrationWarning&&Qa(a.textContent,c,e),s=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Qa(a.textContent,c,e),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&za("scroll",a)}switch(n){case"input":q(a),$(a,i,!0);break;case"textarea":q(a),ie(a);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(a.onclick=$a)}a=s,t.updateQueue=a,null!==a&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=l.createElement(n,{is:a.is}):(e=l.createElement(n),"select"===n&&(l=e,a.multiple?l.multiple=!0:a.size&&(l.size=a.size))):e=l.createElementNS(e,n),e[hs]=t,e[ps]=a,Ao(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,a),n){case"dialog":za("cancel",e),za("close",e),s=a;break;case"iframe":case"object":case"embed":za("load",e),s=a;break;case"video":case"audio":for(s=0;s<Da.length;s++)za(Da[s],e);s=a;break;case"source":za("error",e),s=a;break;case"img":case"image":case"link":za("error",e),za("load",e),s=a;break;case"details":za("toggle",e),s=a;break;case"input":Y(e,a),s=X(e,a),za("invalid",e);break;case"option":default:s=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},s=F({},a,{value:void 0}),za("invalid",e);break;case"textarea":se(e,a),s=ae(e,a),za("invalid",e)}for(i in ye(n,s),c=s)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?ge(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=u&&"onScroll"===i&&za("scroll",e):null!=u&&b(e,i,u,l))}switch(n){case"input":q(e),$(e,a,!1);break;case"textarea":q(e),ie(e);break;case"option":null!=a.value&&e.setAttribute("value",""+H(a.value));break;case"select":e.multiple=!!a.multiple,null!=(i=a.value)?ne(e,!!a.multiple,i,!1):null!=a.defaultValue&&ne(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=$a)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)Lo(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(r(166));if(n=Zr(Kr.current),Zr(Gr.current),dr(t)){if(a=t.stateNode,n=t.memoizedProps,a[hs]=t,(i=a.nodeValue!==n)&&null!==(e=nr))switch(e.tag){case 3:Qa(a.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qa(a.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(a=(9===n.nodeType?n:n.ownerDocument).createTextNode(a))[hs]=t,t.stateNode=a}return qo(t),null;case 13:if(Ss($r),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(sr&&null!==ar&&0!==(1&t.mode)&&0===(128&t.flags))hr(),pr(),t.flags|=98560,i=!1;else if(i=dr(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[hs]=t}else pr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),i=!1}else null!==rr&&(ic(rr),rr=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$r.current)?0===Ll&&(Ll=3):fc())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return Yr(),Ro(e,t),null===e&&Va(t.stateNode.containerInfo),qo(t),null;case 10:return jr(t.type._context),qo(t),null;case 19:if(Ss($r),null===(i=t.memoizedState))return qo(t),null;if(a=0!==(128&t.flags),null===(l=i.rendering))if(a)Go(i,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Go(i,!1),null!==(a=l.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=n,n=t.child;null!==n;)e=a,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Cs($r,1&$r.current|2),t.child}e=e.sibling}null!==i.tail&&Je()>Vl&&(t.flags|=128,a=!0,Go(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=ei(l))){if(t.flags|=128,a=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!sr)return qo(t),null}else 2*Je()-i.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,a=!0,Go(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,n=$r.current,Cs($r,a?1&n|2:1&n),t):(qo(t),null);case 22:case 23:return dc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Zo(e,t){switch(tr(t),t.tag){case 1:return Rs(t.type)&&Ms(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yr(),Ss(Is),Ss(Ts),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qr(t),null;case 13:if(Ss($r),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));pr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ss($r),null;case 4:return Yr(),null;case 10:return jr(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Ao=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ro=function(){},Mo=function(e,t,n,a){var s=e.memoizedProps;if(s!==a){e=t.stateNode,Zr(Gr.current);var r,i=null;switch(n){case"input":s=X(e,s),a=X(e,a),i=[];break;case"select":s=F({},s,{value:void 0}),a=F({},a,{value:void 0}),i=[];break;case"textarea":s=ae(e,s),a=ae(e,a),i=[];break;default:"function"!==typeof s.onClick&&"function"===typeof a.onClick&&(e.onclick=$a)}for(u in ye(n,a),n=null,s)if(!a.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in a){var c=a[u];if(l=null!=s?s[u]:void 0,a.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(i||(i=[]),i.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&za("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Lo=function(e,t,n,a){n!==a&&(t.flags|=4)};var Xo=!1,Yo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Qo=null;function $o(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(a){_c(e,t,a)}else n.current=null}function el(e,t,n){try{n()}catch(a){_c(e,t,a)}}var tl=!1;function nl(e,t,n){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var s=a=a.next;do{if((s.tag&e)===e){var r=s.destroy;s.destroy=void 0,void 0!==r&&el(t,n,r)}s=s.next}while(s!==a)}}function al(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var a=n.create;n.destroy=a()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function rl(e){var t=e.alternate;null!==t&&(e.alternate=null,rl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[ps],delete t[fs],delete t[gs],delete t[xs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$a));else if(4!==a&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(st,n)}catch(o){}switch(n.tag){case 5:Yo||$o(n,t);case 6:var a=ul,s=dl;ul=null,hl(e,t,n),dl=s,null!==(ul=a)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),Vt(e)):ls(ul,n.stateNode));break;case 4:a=ul,s=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=a,dl=s;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(a=n.updateQueue)&&null!==(a=a.lastEffect))){s=a=a.next;do{var r=s,i=r.destroy;r=r.tag,void 0!==i&&(0!==(2&r)||0!==(4&r))&&el(n,t,i),s=s.next}while(s!==a)}hl(e,t,n);break;case 1:if(!Yo&&($o(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(o){_c(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Yo=(a=Yo)||null!==n.memoizedState,hl(e,t,n),Yo=a):hl(e,t,n);break;default:hl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach(function(t){var a=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var s=n[a];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(r(160));pl(i,o,s),ul=null,dl=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(u){_c(s,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),xl(e),4&a){try{nl(3,e,e.return),al(3,e)}catch(g){_c(e,e.return,g)}try{nl(5,e,e.return)}catch(g){_c(e,e.return,g)}}break;case 1:fl(t,e),xl(e),512&a&&null!==n&&$o(n,n.return);break;case 5:if(fl(t,e),xl(e),512&a&&null!==n&&$o(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(g){_c(e,e.return,g)}}if(4&a&&null!=(s=e.stateNode)){var i=e.memoizedProps,o=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&J(s,i),be(l,o);var u=be(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(s,h):"dangerouslySetInnerHTML"===d?de(s,h):"children"===d?he(s,h):b(s,d,h,u)}switch(l){case"input":Q(s,i);break;case"textarea":re(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;null!=m?ne(s,!!i.multiple,m,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(s,!!i.multiple,i.defaultValue,!0):ne(s,!!i.multiple,i.multiple?[]:"",!1))}s[ps]=i}catch(g){_c(e,e.return,g)}}break;case 6:if(fl(t,e),xl(e),4&a){if(null===e.stateNode)throw Error(r(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(g){_c(e,e.return,g)}}break;case 3:if(fl(t,e),xl(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){_c(e,e.return,g)}break;case 4:default:fl(t,e),xl(e);break;case 13:fl(t,e),xl(e),8192&(s=e.child).flags&&(i=null!==s.memoizedState,s.stateNode.isHidden=i,!i||null!==s.alternate&&null!==s.alternate.memoizedState||(Wl=Je())),4&a&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(u=Yo)||d,fl(t,e),Yo=u):fl(t,e),xl(e),8192&a){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Qo=e,d=e.child;null!==d;){for(h=Qo=d;null!==Qo;){switch(m=(p=Qo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:$o(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){a=p,n=p.return;try{t=a,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){_c(a,n,g)}}break;case 5:$o(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==m?(m.return=p,Qo=m):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{s=h.stateNode,u?"function"===typeof(i=s.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(g){_c(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){_c(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),xl(e),4&a&&ml(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var a=n;break e}n=n.return}throw Error(r(160))}switch(a.tag){case 5:var s=a.stateNode;32&a.flags&&(he(s,""),a.flags&=-33),cl(e,ol(e),s);break;case 3:case 4:var i=a.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(r(161))}}catch(o){_c(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Qo=e,bl(e,t,n)}function bl(e,t,n){for(var a=0!==(1&e.mode);null!==Qo;){var s=Qo,r=s.child;if(22===s.tag&&a){var i=null!==s.memoizedState||Xo;if(!i){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Xo;var c=Yo;if(Xo=i,(Yo=l)&&!c)for(Qo=s;null!==Qo;)l=(i=Qo).child,22===i.tag&&null!==i.memoizedState?kl(s):null!==l?(l.return=i,Qo=l):kl(s);for(;null!==r;)Qo=r,bl(r,t,n),r=r.sibling;Qo=s,Xo=o,Yo=c}vl(e)}else 0!==(8772&s.subtreeFlags)&&null!==r?(r.return=s,Qo=r):vl(e)}}function vl(e){for(;null!==Qo;){var t=Qo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||al(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!Yo)if(null===n)a.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);a.componentDidUpdate(s,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ur(t,i,a);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ur(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(r(163))}Yo||512&t.flags&&sl(t)}catch(p){_c(t,t.return,p)}}if(t===e){Qo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qo=n;break}Qo=t.return}}function wl(e){for(;null!==Qo;){var t=Qo;if(t===e){Qo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qo=n;break}Qo=t.return}}function kl(e){for(;null!==Qo;){var t=Qo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{al(4,t)}catch(l){_c(t,n,l)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var s=t.return;try{a.componentDidMount()}catch(l){_c(t,s,l)}}var r=t.return;try{sl(t)}catch(l){_c(t,r,l)}break;case 5:var i=t.return;try{sl(t)}catch(l){_c(t,i,l)}}}catch(l){_c(t,t.return,l)}if(t===e){Qo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Qo=o;break}Qo=t.return}}var Nl,_l=Math.ceil,Sl=v.ReactCurrentDispatcher,Cl=v.ReactCurrentOwner,jl=v.ReactCurrentBatchConfig,Tl=0,Il=null,El=null,Al=0,Rl=0,Ml=_s(0),Ll=0,Dl=null,Ol=0,Fl=0,Pl=0,zl=null,Bl=null,Wl=0,Vl=1/0,Ul=null,Hl=!1,Gl=null,ql=null,Kl=!1,Zl=null,Xl=0,Yl=0,Jl=null,Ql=-1,$l=0;function ec(){return 0!==(6&Tl)?Je():-1!==Ql?Ql:Ql=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==Al?Al&-Al:null!==fr.transition?(0===$l&&($l=ft()),$l):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nc(e,t,n,a){if(50<Yl)throw Yl=0,Jl=null,Error(r(185));xt(e,n,a),0!==(2&Tl)&&e===Il||(e===Il&&(0===(2&Tl)&&(Fl|=n),4===Ll&&oc(e,Al)),ac(e,a),1===n&&0===Tl&&0===(1&t.mode)&&(Vl=Je()+500,zs&&Vs()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes;0<r;){var i=31-it(r),o=1<<i,l=s[i];-1===l?0!==(o&n)&&0===(o&a)||(s[i]=pt(o,t)):l<=t&&(e.expiredLanes|=o),r&=~o}}(e,t);var a=ht(e,e===Il?Al:0);if(0===a)null!==n&&Ze(n),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=n&&Ze(n),1===t)0===e.tag?function(e){zs=!0,Ws(e)}(lc.bind(null,e)):Ws(lc.bind(null,e)),is(function(){0===(6&Tl)&&Vs()}),n=null;else{switch(vt(a)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=at}n=Ic(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Ql=-1,$l=0,0!==(6&Tl))throw Error(r(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var a=ht(e,e===Il?Al:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=gc(e,a);else{t=a;var s=Tl;Tl|=2;var i=mc();for(Il===e&&Al===t||(Ul=null,Vl=Je()+500,hc(e,t));;)try{yc();break}catch(l){pc(e,l)}Cr(),Sl.current=i,Tl=s,null!==El?t=0:(Il=null,Al=0,t=Ll)}if(0!==t){if(2===t&&(0!==(s=mt(e))&&(a=s,t=rc(e,s))),1===t)throw n=Dl,hc(e,0),oc(e,a),ac(e,Je()),n;if(6===t)oc(e,a);else{if(s=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var a=0;a<n.length;a++){var s=n[a],r=s.getSnapshot;s=s.value;try{if(!oa(r(),s))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=gc(e,a))&&(0!==(i=mt(e))&&(a=i,t=rc(e,i))),1===t))throw n=Dl,hc(e,0),oc(e,a),ac(e,Je()),n;switch(e.finishedWork=s,e.finishedLanes=a,t){case 0:case 1:throw Error(r(345));case 2:case 5:wc(e,Bl,Ul);break;case 3:if(oc(e,a),(130023424&a)===a&&10<(t=Wl+500-Je())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&a)!==a){ec(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=as(wc.bind(null,e,Bl,Ul),t);break}wc(e,Bl,Ul);break;case 4:if(oc(e,a),(4194240&a)===a)break;for(t=e.eventTimes,s=-1;0<a;){var o=31-it(a);i=1<<o,(o=t[o])>s&&(s=o),a&=~i}if(a=s,10<(a=(120>(a=Je()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*_l(a/1960))-a)){e.timeoutHandle=as(wc.bind(null,e,Bl,Ul),a);break}wc(e,Bl,Ul);break;default:throw Error(r(329))}}}return ac(e,Je()),e.callbackNode===n?sc.bind(null,e):null}function rc(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Bl,Bl=n,null!==t&&ic(t)),e}function ic(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function oc(e,t){for(t&=~Pl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),a=1<<n;e[n]=-1,t&=~a}}function lc(e){if(0!==(6&Tl))throw Error(r(327));kc();var t=ht(e,0);if(0===(1&t))return ac(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var a=mt(e);0!==a&&(t=a,n=rc(e,a))}if(1===n)throw n=Dl,hc(e,0),oc(e,t),ac(e,Je()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Bl,Ul),ac(e,Je()),null}function cc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(Vl=Je()+500,zs&&Vs())}}function uc(e){null!==Zl&&0===Zl.tag&&0===(6&Tl)&&kc();var t=Tl;Tl|=1;var n=jl.transition,a=bt;try{if(jl.transition=null,bt=1,e)return e()}finally{bt=a,jl.transition=n,0===(6&(Tl=t))&&Vs()}}function dc(){Rl=Ml.current,Ss(Ml)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==El)for(n=El.return;null!==n;){var a=n;switch(tr(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Ms();break;case 3:Yr(),Ss(Is),Ss(Ts),ni();break;case 5:Qr(a);break;case 4:Yr();break;case 13:case 19:Ss($r);break;case 10:jr(a.type._context);break;case 22:case 23:dc()}n=n.return}if(Il=e,El=e=Mc(e.current,null),Al=Rl=t,Ll=0,Dl=null,Pl=Fl=Ol=0,Bl=zl=null,null!==Ar){for(t=0;t<Ar.length;t++)if(null!==(a=(n=Ar[t]).interleaved)){n.interleaved=null;var s=a.next,r=n.pending;if(null!==r){var i=r.next;r.next=s,a.next=i}n.pending=a}Ar=null}return e}function pc(e,t){for(;;){var n=El;try{if(Cr(),ai.current=Ji,ci){for(var a=ii.memoizedState;null!==a;){var s=a.queue;null!==s&&(s.pending=null),a=a.next}ci=!1}if(ri=0,li=oi=ii=null,ui=!1,di=0,Cl.current=null,null===n||null===n.return){Ll=1,Dl=t,El=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,xo(m,o,l,0,t),1&m.mode&&fo(i,u,t),c=u;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fo(i,u,t),fc();break e}c=Error(r(426))}else if(sr&&1&l.mode){var x=go(o);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xo(x,o,l,0,t),mr(lo(c,l));break e}}i=c=lo(c,l),4!==Ll&&(Ll=2),null===zl?zl=[i]:zl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Wr(i,po(0,c,t));break e;case 1:l=c;var y=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===ql||!ql.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Wr(i,mo(i,l,t));break e}}i=i.return}while(null!==i)}vc(n)}catch(v){t=v,El===n&&null!==n&&(El=n=n.return);continue}break}}function mc(){var e=Sl.current;return Sl.current=Ji,null===e?Ji:e}function fc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Il||0===(268435455&Ol)&&0===(268435455&Fl)||oc(Il,Al)}function gc(e,t){var n=Tl;Tl|=2;var a=mc();for(Il===e&&Al===t||(Ul=null,hc(e,t));;)try{xc();break}catch(s){pc(e,s)}if(Cr(),Tl=n,Sl.current=a,null!==El)throw Error(r(261));return Il=null,Al=0,Ll}function xc(){for(;null!==El;)bc(El)}function yc(){for(;null!==El&&!Xe();)bc(El)}function bc(e){var t=Nl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?vc(e):El=t,Cl.current=null}function vc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Rl)))return void(El=n)}else{if(null!==(n=Zo(n,t)))return n.flags&=32767,void(El=n);if(null===e)return Ll=6,void(El=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(El=t);El=t=e}while(null!==t);0===Ll&&(Ll=5)}function wc(e,t,n){var a=bt,s=jl.transition;try{jl.transition=null,bt=1,function(e,t,n,a){do{kc()}while(null!==Zl);if(0!==(6&Tl))throw Error(r(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-it(n),r=1<<s;t[s]=0,a[s]=-1,e[s]=-1,n&=~r}}(e,i),e===Il&&(El=Il=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Ic(tt,function(){return kc(),null})),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=jl.transition,jl.transition=null;var o=bt;bt=1;var l=Tl;Tl|=4,Cl.current=null,function(e,t){if(es=Ht,pa(e=ha())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var s=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==s&&3!==h.nodeType||(l=o+s),h!==i||0!==a&&3!==h.nodeType||(c=o+a),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++u===s&&(l=o),p===i&&++d===a&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},Ht=!1,Qo=t;null!==Qo;)if(e=(t=Qo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qo=e;else for(;null!==Qo;){t=Qo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,x=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),x);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(r(163))}}catch(w){_c(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qo=e;break}Qo=t.return}f=tl,tl=!1}(e,n),gl(n,e),ma(ts),Ht=!!es,ts=es=null,e.current=n,yl(n,e,s),Ye(),Tl=l,bt=o,jl.transition=i}else e.current=n;if(Kl&&(Kl=!1,Zl=e,Xl=s),i=e.pendingLanes,0===i&&(ql=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Je()),null!==t)for(a=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],a(s.value,{componentStack:s.stack,digest:s.digest});if(Hl)throw Hl=!1,e=Gl,Gl=null,e;0!==(1&Xl)&&0!==e.tag&&kc(),i=e.pendingLanes,0!==(1&i)?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,Vs()}(e,t,n,a)}finally{jl.transition=s,bt=a}return null}function kc(){if(null!==Zl){var e=vt(Xl),t=jl.transition,n=bt;try{if(jl.transition=null,bt=16>e?16:e,null===Zl)var a=!1;else{if(e=Zl,Zl=null,Xl=0,0!==(6&Tl))throw Error(r(331));var s=Tl;for(Tl|=4,Qo=e.current;null!==Qo;){var i=Qo,o=i.child;if(0!==(16&Qo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qo=u;null!==Qo;){var d=Qo;switch(d.tag){case 0:case 11:case 15:nl(8,d,i)}var h=d.child;if(null!==h)h.return=d,Qo=h;else for(;null!==Qo;){var p=(d=Qo).sibling,m=d.return;if(rl(d),d===u){Qo=null;break}if(null!==p){p.return=m,Qo=p;break}Qo=m}}}var f=i.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}Qo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Qo=o;else e:for(;null!==Qo;){if(0!==(2048&(i=Qo).flags))switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Qo=y;break e}Qo=i.return}}var b=e.current;for(Qo=b;null!==Qo;){var v=(o=Qo).child;if(0!==(2064&o.subtreeFlags)&&null!==v)v.return=o,Qo=v;else e:for(o=b;null!==Qo;){if(0!==(2048&(l=Qo).flags))try{switch(l.tag){case 0:case 11:case 15:al(9,l)}}catch(k){_c(l,l.return,k)}if(l===o){Qo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qo=w;break e}Qo=l.return}}if(Tl=s,Vs(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(st,e)}catch(k){}a=!0}return a}finally{bt=n,jl.transition=t}}return!1}function Nc(e,t,n){e=zr(e,t=po(0,t=lo(n,t),1),1),t=ec(),null!==e&&(xt(e,1,t),ac(e,t))}function _c(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===ql||!ql.has(a))){t=zr(t,e=mo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(xt(t,1,e),ac(t,e));break}}t=t.return}}function Sc(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Il===e&&(Al&n)===n&&(4===Ll||3===Ll&&(130023424&Al)===Al&&500>Je()-Wl?hc(e,0):Pl|=n),ac(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Lr(e,t))&&(xt(e,t,n),ac(e,n))}function jc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(r(314))}null!==a&&a.delete(t),Cc(e,n)}function Ic(e,t){return Ke(e,t)}function Ec(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,a){return new Ec(e,t,n,a)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,a,s,i){var o=2;if(a=e,"function"===typeof e)Rc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Dc(n.children,s,i,t);case _:o=8,s|=8;break;case S:return(e=Ac(12,n,t,2|s)).elementType=S,e.lanes=i,e;case I:return(e=Ac(13,n,t,s)).elementType=I,e.lanes=i,e;case E:return(e=Ac(19,n,t,s)).elementType=E,e.lanes=i,e;case M:return Oc(n,s,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case j:o=9;break e;case T:o=11;break e;case A:o=14;break e;case R:o=16,a=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Ac(o,n,t,s)).elementType=e,t.type=a,t.lanes=i,t}function Dc(e,t,n,a){return(e=Ac(7,e,a,t)).lanes=n,e}function Oc(e,t,n,a){return(e=Ac(22,e,a,t)).elementType=M,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Pc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,a,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=a,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,a,s,r,i,o,l){return e=new zc(e,t,n,o,l),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Ac(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Or(r),e}function Wc(e){if(!e)return js;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Rs(n))return Ds(e,n,t)}return t}function Vc(e,t,n,a,s,r,i,o,l){return(e=Bc(n,a,!0,e,0,r,0,o,l)).context=Wc(null),n=e.current,(r=Pr(a=ec(),s=tc(n))).callback=void 0!==t&&null!==t?t:null,zr(n,r,s),e.current.lanes=s,xt(e,s,a),ac(e,a),e}function Uc(e,t,n,a){var s=t.current,r=ec(),i=tc(s);return n=Wc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Pr(r,i)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=zr(s,t,i))&&(nc(e,s,i,r),Br(e,s,i)),i}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Is.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Io(t),pr();break;case 5:Jr(t);break;case 1:Rs(t.type)&&Os(t);break;case 4:Xr(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,s=t.memoizedProps.value;Cs(kr,a._currentValue),a._currentValue=s;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Cs($r,1&$r.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(Cs($r,1&$r.current),null!==(e=Ho(e,t,n))?e.sibling:null);Cs($r,1&$r.current);break;case 19:if(a=0!==(n&t.childLanes),0!==(128&e.flags)){if(a)return Vo(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Cs($r,$r.current),a)break;return null;case 22:case 23:return t.lanes=0,_o(e,t,n)}return Ho(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,sr&&0!==(1048576&t.flags)&&$s(t,qs,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Uo(e,t),e=t.pendingProps;var s=As(t,Ts.current);Ir(t,n),s=fi(null,t,a,e,s,n);var i=gi();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rs(a)?(i=!0,Os(t)):i=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Or(t),s.updater=ao,t.stateNode=s,s._reactInternals=t,oo(t,a,e,n),t=To(null,t,a,!0,i,n)):(t.tag=0,sr&&i&&er(t),vo(null,t,s,n),t=t.child),t;case 16:a=t.elementType;e:{switch(Uo(e,t),e=t.pendingProps,a=(s=a._init)(a._payload),t.type=a,s=t.tag=function(e){if("function"===typeof e)return Rc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===A)return 14}return 2}(a),e=to(a,e),s){case 0:t=Co(null,t,a,e,n);break e;case 1:t=jo(null,t,a,e,n);break e;case 11:t=wo(null,t,a,e,n);break e;case 14:t=ko(null,t,a,to(a.type,e),n);break e}throw Error(r(306,a,""))}return t;case 0:return a=t.type,s=t.pendingProps,Co(e,t,a,s=t.elementType===a?s:to(a,s),n);case 1:return a=t.type,s=t.pendingProps,jo(e,t,a,s=t.elementType===a?s:to(a,s),n);case 3:e:{if(Io(t),null===e)throw Error(r(387));a=t.pendingProps,s=(i=t.memoizedState).element,Fr(e,t),Vr(t,a,null,n);var o=t.memoizedState;if(a=o.element,i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Eo(e,t,a,n,s=lo(Error(r(423)),t));break e}if(a!==s){t=Eo(e,t,a,n,s=lo(Error(r(424)),t));break e}for(ar=cs(t.stateNode.containerInfo.firstChild),nr=t,sr=!0,rr=null,n=wr(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pr(),a===s){t=Ho(e,t,n);break e}vo(e,t,a,n)}t=t.child}return t;case 5:return Jr(t),null===e&&cr(t),a=t.type,s=t.pendingProps,i=null!==e?e.memoizedProps:null,o=s.children,ns(a,s)?o=null:null!==i&&ns(a,i)&&(t.flags|=32),So(e,t),vo(e,t,o,n),t.child;case 6:return null===e&&cr(t),null;case 13:return Fo(e,t,n);case 4:return Xr(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=vr(t,null,a,n):vo(e,t,a,n),t.child;case 11:return a=t.type,s=t.pendingProps,wo(e,t,a,s=t.elementType===a?s:to(a,s),n);case 7:return vo(e,t,t.pendingProps,n),t.child;case 8:case 12:return vo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(a=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Cs(kr,a._currentValue),a._currentValue=o,null!==i)if(oa(i.value,o)){if(i.children===s.children&&!Is.current){t=Ho(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===a){if(1===i.tag){(c=Pr(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Tr(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(r(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Tr(o,n,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}vo(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,a=t.pendingProps.children,Ir(t,n),a=a(s=Er(s)),t.flags|=1,vo(e,t,a,n),t.child;case 14:return s=to(a=t.type,t.pendingProps),ko(e,t,a,s=to(a.type,s),n);case 15:return No(e,t,t.type,t.pendingProps,n);case 17:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:to(a,s),Uo(e,t),t.tag=1,Rs(a)?(e=!0,Os(t)):e=!1,Ir(t,n),ro(t,a,s),oo(t,a,s,n),To(null,t,a,!0,e,n);case 19:return Vo(e,t,n);case 22:return _o(e,t,n)}throw Error(r(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Zc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function $c(e,t,n,a,s){var r=n._reactRootContainer;if(r){var i=r;if("function"===typeof s){var o=s;s=function(){var e=Hc(i);o.call(e)}}Uc(t,i,e,s)}else i=function(e,t,n,a,s){if(s){if("function"===typeof a){var r=a;a=function(){var e=Hc(i);r.call(e)}}var i=Vc(t,a,e,0,null,!1,0,"",Qc);return e._reactRootContainer=i,e[ms]=i.current,Va(8===e.nodeType?e.parentNode:e),uc(),i}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof a){var o=a;a=function(){var e=Hc(l);o.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[ms]=l.current,Va(8===e.nodeType?e.parentNode:e),uc(function(){Uc(t,l,n,a)}),l}(n,t,e,s,a);return Hc(i)}Xc.prototype.render=Zc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Uc(e,t,null,null)},Xc.prototype.unmount=Zc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Uc(null,e,null,null)}),t[ms]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mt.length&&0!==t&&t<Mt[n].priority;n++);Mt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),ac(t,Je()),0===(6&Tl)&&(Vl=Je()+500,Vs()))}break;case 13:uc(function(){var t=Lr(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),qc(e,1)}},kt=function(e){if(13===e.tag){var t=Lr(e,134217728);if(null!==t)nc(t,e,134217728,ec());qc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),n=Lr(e,t);if(null!==n)nc(n,e,t,ec());qc(e,t)}},_t=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var s=ws(a);if(!s)throw Error(r(90));K(a),Q(a,s)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cc,Ie=uc;var eu={usingClientEntryPoint:!1,Events:[bs,vs,ws,Ce,je,cc]},tu={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{st=au.inject(nu),rt=au}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(r(200));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(r(299));var n=!1,a="",s=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,a,s),e[ms]=t.current,Va(8===e.nodeType?e.parentNode:e),new Zc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(r(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(r(405));var a=null!=n&&n.hydratedSources||null,s=!1,i="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,s,0,i,o),e[ms]=t.current,Va(e),a)for(e=0;e<a.length;e++)s=(s=(n=a[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Xc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(r(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(r(40));return!!e._reactRootContainer&&(uc(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[ms]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,a){if(!Jc(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return $c(e,t,n,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},817:()=>{},853:(e,t,n)=>{"use strict";e.exports=n(234)},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},996:()=>{}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(a,s){if(1&s&&(a=this(a)),8&s)return a;if("object"===typeof a&&a){if(4&s&&a.__esModule)return a;if(16&s&&"function"===typeof a.then)return a}var r=Object.create(null);n.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&s&&a;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>i[e]=()=>a[e]);return i.default=()=>a,n.d(r,i),r}})(),n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/Trailbrazer--/",(()=>{"use strict";var e={};n.r(e),n.d(e,{arraysEqual:()=>rs,arraysEqualWithNull:()=>ss,assert:()=>$a,assertNonNegativeIntegerDimensions:()=>Ds,assertNonNull:()=>ts,assertShapesMatch:()=>es,bytesFromStringArray:()=>ws,bytesPerElement:()=>vs,checkConversionForErrors:()=>xs,clamp:()=>Ka,computeStrides:()=>Ts,convertBackendValuesAndArrayBuffer:()=>As,createScalarValue:()=>Bl,createShuffledIndices:()=>cs,decodeString:()=>Gl,distSquared:()=>Qa,encodeString:()=>Hl,fetch:()=>Ul,fingerPrint64:()=>zl,flatten:()=>Kl,getArrayFromDType:()=>gs,getTypedArrayFromDType:()=>fs,hasEncodingLoss:()=>bs,hexToLong:()=>Tl,indexToLoc:()=>Fs,inferDtype:()=>Ss,inferFromImplicitShape:()=>hs,isBoolean:()=>Ns,isFunction:()=>Cs,isInt:()=>is,isNumber:()=>_s,isPromise:()=>Ps,isScalarShape:()=>as,isString:()=>ks,isTypedArray:()=>ql,isValidDtype:()=>ys,locToIndex:()=>Os,makeOnesTypedArray:()=>Rs,makeZerosNestedTypedArray:()=>Ls,makeZerosTypedArray:()=>Ms,nearestDivisor:()=>js,nearestLargerEven:()=>Za,now:()=>Vl,parseAxisParam:()=>ps,randUniform:()=>Ja,repeatedTry:()=>ds,rightPad:()=>us,shuffle:()=>Ga,shuffleCombo:()=>qa,sizeFromShape:()=>ns,sizeToSquarishShape:()=>ls,squeezeShape:()=>ms,sum:()=>Ya,swap:()=>Xa,tanh:()=>os,toNestedArray:()=>Es,toTypedArray:()=>Wl});var t={};n.r(t),n.d(t,{assertTypesMatch:()=>vc,getTensorsInContainer:()=>kc,isTensorInList:()=>wc,makeTypesMatch:()=>bc});var a={};n.r(a),n.d(a,{isBrowser:()=>Mc,isMobile:()=>Rc,mockIsMobile:()=>Ac});var s={};n.r(s),n.d(s,{Serializable:()=>Fd,SerializationMap:()=>Pd,getRegisteredName:()=>Bd,registerClass:()=>zd});var r={};n.r(r),n.d(r,{assertAndGetBroadcastShape:()=>Jd,getBroadcastDims:()=>Xd,getReductionAxes:()=>Yd});var i={};n.r(i),n.d(i,{CompositeArrayBuffer:()=>qc,browserFiles:()=>oh,browserHTTPRequest:()=>gh,concatenateArrayBuffers:()=>Su,copyModel:()=>ud,decodeWeights:()=>gu,decodeWeightsStream:()=>wu,encodeWeights:()=>fu,fromMemory:()=>vh,fromMemorySync:()=>wh,getLoadHandlers:()=>Ou,getModelArtifactsForJSON:()=>Iu,getModelArtifactsForJSONSync:()=>Tu,getModelArtifactsInfoForJSON:()=>Eu,getSaveHandlers:()=>Du,getWeightSpecs:()=>Au,http:()=>fh,isHTTPScheme:()=>ph,listModels:()=>ld,loadWeights:()=>uh,moveModel:()=>dd,registerLoadRouter:()=>Lu,registerSaveRouter:()=>Mu,removeModel:()=>cd,weightsLoaderFactory:()=>dh,withSaveHandler:()=>kh,withSaveHandlerSync:()=>Nh});var o={};n.r(o),n.d(o,{confusionMatrix:()=>Eh});var l={};n.r(l),n.d(l,{draw:()=>zh,fromPixels:()=>Bh,fromPixelsAsync:()=>Oh,toPixels:()=>Ph});var c={};n.r(c),n.d(c,{prepareAndValidate:()=>Wh});var u={};n.r(u),n.d(u,{calculateShapes:()=>Hh,validateInput:()=>Uh,validateUpdateShape:()=>Vh});var d={};n.r(d),n.d(d,{assertParamsValid:()=>Kh,computeFlatOffset:()=>ip,computeOutShape:()=>Xh,getNormalizedAxes:()=>$h,isSliceContinous:()=>rp,maskToAxes:()=>Zh,parseSliceParams:()=>op,sliceInfo:()=>lp,startForAxis:()=>ap,startIndicesWithElidedDims:()=>ep,stopForAxis:()=>sp,stopIndicesWithElidedDims:()=>tp,stridesForAxis:()=>np,stridesWithElidedDims:()=>Yh});var h={};n.r(h),n.d(h,{TEST_EPSILON_FLOAT16:()=>dp,createVideoElement:()=>kp,encodeStrings:()=>wp,expectArrayBuffersEqual:()=>vp,expectArraysClose:()=>hp,expectArraysEqual:()=>gp,expectNumbersClose:()=>xp,expectPromiseToFail:()=>fp,expectValuesInRange:()=>bp,play:()=>Np,testEpsilon:()=>pp});var p={};n.r(p),n.d(p,{conv2d:()=>Ix,depthwiseConv2d:()=>Rx,matMul:()=>Mx});var m={};n.r(m),n.d(m,{collectGatherOpShapeInfo:()=>Ub,computeOutShape:()=>Vb,segOpComputeOptimalWindowSize:()=>Wb});var f={};n.r(f),n.d(f,{ERF_A1:()=>rb,ERF_A2:()=>ib,ERF_A3:()=>ob,ERF_A4:()=>lb,ERF_A5:()=>cb,ERF_P:()=>sb,PARALLELIZE_THRESHOLD:()=>Zy,RowPartitionType:()=>Uy,SELU_SCALE:()=>ab,SELU_SCALEALPHA:()=>nb,applyActivation:()=>jx,assertAndGetBroadcastShape:()=>Jd,assertAxesAreInnerMostDims:()=>Ym,assertParamsConsistent:()=>Wy,assignToTypedArray:()=>fb,axesAreInnerMostDims:()=>qm,calculateShapes:()=>Hh,checkEinsumDimSizes:()=>_b,checkPadOnDimRoundingMode:()=>Qp,combineLocations:()=>Km,combineRaggedTensorToTensorShapes:()=>Hy,complexWithEvenIndex:()=>hb,complexWithOddIndex:()=>pb,computeConv2DInfo:()=>Wp,computeConv3DInfo:()=>Vp,computeDefaultPad:()=>Up,computeDilation2DInfo:()=>Pp,computeOptimalWindowSize:()=>Xy,computeOutAndReduceShapes:()=>Zm,computeOutShape:()=>Vy,computePool2DInfo:()=>zp,computePool3DInfo:()=>Bp,convertConv2DDataFormat:()=>Jp,decodeEinsumEquation:()=>kb,eitherStridesOrDilationsAreOne:()=>Xp,expandShapeToKeepDim:()=>Xm,exponent:()=>xb,exponents:()=>gb,fromStringArrayToUint8:()=>Gb,fromUint8ToStringArray:()=>Hb,getAxesPermutation:()=>Jm,getBroadcastDims:()=>Xd,getComplexWithIndex:()=>mb,getEinsumComputePath:()=>Sb,getEinsumPermutation:()=>Nb,getFusedBiasGradient:()=>Cx,getFusedDyActivation:()=>Sx,getImageCenter:()=>Yy,getInnerMostAxes:()=>$m,getPermuted:()=>Qy,getRaggedRank:()=>qy,getReductionAxes:()=>Yd,getReshaped:()=>Jy,getReshapedPermuted:()=>$y,getRowPartitionTypesHelper:()=>Gy,getSliceBeginCoords:()=>eb,getSliceSize:()=>tb,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>Ib,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>Eb,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>Ab,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>Lb,getSparseReshapeInputOutputMismatchErrorMessage:()=>Ob,getSparseReshapeInputOutputMultipleErrorMessage:()=>Db,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>Rb,getSparseReshapeNegativeOutputDimErrorMessage:()=>Mb,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>Bb,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>Fb,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Pb,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>zb,getUndoAxesPermutation:()=>Qm,isIdentityPermutation:()=>Cb,log:()=>pl,mergeRealAndImagArrays:()=>ub,prepareAndValidate:()=>Wh,prepareSplitSize:()=>Tb,segment_util:()=>m,shouldFuse:()=>Tx,slice_util:()=>d,splitRealAndImagArrays:()=>db,stridesOrDilationsArePositive:()=>Yp,tupleValuesAreOne:()=>Zp,upcastType:()=>fc,validateDefaultValueShape:()=>Ky,validateInput:()=>Uh,validateUpdateShape:()=>Vh,warn:()=>hl});var g={};n.r(g),n.d(g,{nonMaxSuppressionV3Impl:()=>Kx,nonMaxSuppressionV4Impl:()=>Zx,nonMaxSuppressionV5Impl:()=>Xx,whereImpl:()=>px});var x={};n.r(x),n.d(x,{Abs:()=>Ks,Acos:()=>Zs,Acosh:()=>Xs,AdadeltaOptimizer:()=>Vd,AdagradOptimizer:()=>Hd,AdamOptimizer:()=>Kd,AdamaxOptimizer:()=>$d,Add:()=>Ys,AddN:()=>Js,All:()=>Qs,Any:()=>$s,ArgMax:()=>er,ArgMin:()=>tr,Asin:()=>nr,Asinh:()=>ar,Atan:()=>sr,Atan2:()=>ir,Atanh:()=>rr,AvgPool:()=>or,AvgPool3D:()=>cr,AvgPool3DGrad:()=>ur,AvgPoolGrad:()=>lr,BatchMatMul:()=>dr,BatchToSpaceND:()=>hr,Bincount:()=>pr,BitwiseAnd:()=>mr,BroadcastArgs:()=>gr,BroadcastTo:()=>fr,Cast:()=>xr,Ceil:()=>yr,ClipByValue:()=>br,Complex:()=>vr,ComplexAbs:()=>wr,Concat:()=>kr,Conv2D:()=>Nr,Conv2DBackpropFilter:()=>_r,Conv2DBackpropInput:()=>Sr,Conv3D:()=>Cr,Conv3DBackpropFilterV2:()=>jr,Conv3DBackpropInputV2:()=>Tr,Cos:()=>Ir,Cosh:()=>Er,CropAndResize:()=>Mr,Cumprod:()=>Ar,Cumsum:()=>Rr,DataStorage:()=>Va,DenseBincount:()=>Lr,DepthToSpace:()=>Dr,DepthwiseConv2dNative:()=>Or,DepthwiseConv2dNativeBackpropFilter:()=>Fr,DepthwiseConv2dNativeBackpropInput:()=>Pr,Diag:()=>zr,Dilation2D:()=>Br,Dilation2DBackpropFilter:()=>Vr,Dilation2DBackpropInput:()=>Wr,Draw:()=>Ur,ENV:()=>Hs,Einsum:()=>Gr,Elu:()=>qr,EluGrad:()=>Kr,Environment:()=>Bs,Equal:()=>Xr,Erf:()=>Zr,Exp:()=>Yr,ExpandDims:()=>Jr,Expm1:()=>Qr,FFT:()=>$r,Fill:()=>ei,FlipLeftRight:()=>ti,Floor:()=>ni,FloorDiv:()=>ai,FromPixels:()=>ol,FusedBatchNorm:()=>si,FusedConv2D:()=>ul,FusedDepthwiseConv2D:()=>dl,GatherNd:()=>ii,GatherV2:()=>ri,Greater:()=>oi,GreaterEqual:()=>li,IFFT:()=>ui,Identity:()=>ci,Imag:()=>di,IsFinite:()=>hi,IsInf:()=>pi,IsNan:()=>mi,KernelBackend:()=>Ua,LRN:()=>ji,LRNGrad:()=>Ti,LeakyRelu:()=>fi,Less:()=>gi,LessEqual:()=>xi,LinSpace:()=>yi,Log:()=>bi,Log1p:()=>vi,LogSoftmax:()=>Si,LogicalAnd:()=>wi,LogicalNot:()=>ki,LogicalOr:()=>Ni,LogicalXor:()=>_i,LowerBound:()=>Ci,MatrixBandPart:()=>Ii,Max:()=>Ei,MaxPool:()=>Ri,MaxPool3D:()=>Li,MaxPool3DGrad:()=>Di,MaxPoolGrad:()=>Mi,MaxPoolWithArgmax:()=>Oi,Maximum:()=>Ai,Mean:()=>Fi,Min:()=>Pi,Minimum:()=>zi,MirrorPad:()=>Bi,Mod:()=>Wi,MomentumOptimizer:()=>th,Multinomial:()=>Vi,Multiply:()=>Ui,Neg:()=>Hi,NonMaxSuppressionV3:()=>qi,NonMaxSuppressionV4:()=>Ki,NonMaxSuppressionV5:()=>Zi,NotEqual:()=>Gi,OP_SCOPE_SUFFIX:()=>Bc,OneHot:()=>Yi,OnesLike:()=>Xi,Optimizer:()=>Wd,OptimizerConstructors:()=>Sp,Pack:()=>Ji,PadV2:()=>Qi,Pool:()=>$i,Pow:()=>eo,Prelu:()=>to,Prod:()=>no,RMSPropOptimizer:()=>nh,RaggedGather:()=>ao,RaggedRange:()=>so,RaggedTensorToTensor:()=>ro,Range:()=>io,Rank:()=>cc,Real:()=>oo,RealDiv:()=>Hr,Reciprocal:()=>lo,Reduction:()=>py,Relu:()=>co,Relu6:()=>go,Reshape:()=>uo,ResizeBilinear:()=>mo,ResizeBilinearGrad:()=>fo,ResizeNearestNeighbor:()=>ho,ResizeNearestNeighborGrad:()=>po,Reverse:()=>xo,RotateWithOffset:()=>ll,Round:()=>yo,Rsqrt:()=>bo,SGDOptimizer:()=>eh,ScatterNd:()=>vo,SearchSorted:()=>ko,Select:()=>No,Selu:()=>_o,Sigmoid:()=>Io,Sign:()=>To,Sin:()=>Co,Sinh:()=>jo,Slice:()=>So,Softmax:()=>Do,Softplus:()=>Eo,SpaceToBatchND:()=>Mo,SparseFillEmptyRows:()=>Oo,SparseReshape:()=>Fo,SparseSegmentMean:()=>Po,SparseSegmentSum:()=>zo,SparseToDense:()=>Bo,SplitV:()=>Lo,Sqrt:()=>Ao,Square:()=>Vo,SquaredDifference:()=>Wo,StaticRegexReplace:()=>Uo,Step:()=>il,StridedSlice:()=>Ho,StringNGrams:()=>Go,StringSplit:()=>qo,StringToHashBucketFast:()=>Ko,Sub:()=>Zo,Sum:()=>Ro,Tan:()=>Xo,Tanh:()=>Yo,Tensor:()=>ic,TensorBuffer:()=>nc,TensorScatterUpdate:()=>wo,Tile:()=>Jo,TopK:()=>Qo,Transform:()=>$o,Transpose:()=>el,Unique:()=>tl,Unpack:()=>nl,UnsortedSegmentSum:()=>al,UpperBound:()=>sl,Variable:()=>lc,ZerosLike:()=>rl,_FusedMatMul:()=>cl,abs:()=>Zd,acos:()=>Cp,acosh:()=>jp,add:()=>vd,addN:()=>Tp,all:()=>Ip,any:()=>Ep,argMax:()=>Ap,argMin:()=>Rp,asin:()=>Mp,asinh:()=>Lp,atan:()=>Dp,atan2:()=>Op,atanh:()=>Fp,avgPool:()=>em,avgPool3d:()=>tm,backend:()=>hu,backend_util:()=>f,basicLSTMCell:()=>im,batchNorm:()=>lm,batchNorm2d:()=>cm,batchNorm3d:()=>um,batchNorm4d:()=>dm,batchToSpaceND:()=>om,bincount:()=>hm,bitwiseAnd:()=>pm,booleanMaskAsync:()=>fx,broadcastArgs:()=>mm,broadcastTo:()=>fm,broadcast_util:()=>r,browser:()=>l,buffer:()=>gd,cast:()=>xd,ceil:()=>gm,clipByValue:()=>xm,clone:()=>yd,complex:()=>Vc,concat:()=>nm,concat1d:()=>ym,concat2d:()=>bm,concat3d:()=>vm,concat4d:()=>wm,conv1d:()=>Nm,conv2d:()=>km,conv2dTranspose:()=>Sm,conv3d:()=>Cm,conv3dTranspose:()=>Tm,copyRegisteredKernels:()=>Nl,cos:()=>Im,cosh:()=>Em,cosineWindow:()=>kx,cumprod:()=>Am,cumsum:()=>Rm,customGrad:()=>Rd,denseBincount:()=>Mm,deprecationWarn:()=>Yc,depthToSpace:()=>Lm,depthwiseConv2d:()=>Dm,device_util:()=>a,diag:()=>Om,dilation2d:()=>Fm,disableDeprecationWarnings:()=>Xc,dispose:()=>nu,disposeVariables:()=>Jc,div:()=>kd,divNoNan:()=>Bm,dot:()=>Wm,dropout:()=>vx,einsum:()=>Vm,elu:()=>Um,enableDebugMode:()=>Zc,enableProdMode:()=>Kc,enclosingPowerOfTwo:()=>wx,engine:()=>Qc,ensureShape:()=>Hm,env:()=>Vs,equal:()=>Pm,erf:()=>Gm,euclideanNorm:()=>rf,exp:()=>of,expandDims:()=>lf,expm1:()=>cf,eye:()=>df,fft:()=>Ug,fill:()=>Ud,findBackend:()=>cu,findBackendFactory:()=>uu,floor:()=>hf,floorDiv:()=>wd,fused:()=>p,gather:()=>pf,gatherND:()=>bx,gather_util:()=>c,getBackend:()=>ou,getGradient:()=>xl,getKernel:()=>gl,getKernelsForBackend:()=>yl,grad:()=>jd,grads:()=>Td,greater:()=>mf,greaterEqual:()=>ff,ifft:()=>Hg,imag:()=>Ch,image:()=>My,inTopKAsync:()=>Nx,io:()=>i,irfft:()=>Gg,isFinite:()=>gf,isInf:()=>xf,isNaN:()=>yf,keep:()=>au,kernel_impls:()=>g,leakyRelu:()=>bf,less:()=>vf,lessEqual:()=>wf,linalg:()=>Ly,linspace:()=>kf,localResponseNormalization:()=>Nf,log:()=>_f,log1p:()=>Sf,logSigmoid:()=>jf,logSoftmax:()=>Tf,logSumExp:()=>If,logicalAnd:()=>Ef,logicalNot:()=>Af,logicalOr:()=>Rf,logicalXor:()=>Mf,losses:()=>Dy,lowerBound:()=>Of,matMul:()=>_h,math:()=>o,max:()=>ef,maxPool:()=>Ff,maxPool3d:()=>Pf,maxPoolWithArgmax:()=>zf,maximum:()=>Qd,mean:()=>Bf,memory:()=>$c,meshgrid:()=>Uf,min:()=>tf,minimum:()=>Hf,mirrorPad:()=>Gf,mod:()=>qf,moments:()=>Kf,movingAverage:()=>gx,mul:()=>Nd,multiRNNCell:()=>Zf,multinomial:()=>Xf,neg:()=>jh,nextFrame:()=>By,norm:()=>sf,notEqual:()=>Yf,oneHot:()=>Sh,ones:()=>Vf,onesLike:()=>Jf,op:()=>Wc,outerProduct:()=>Qf,pad:()=>$f,pad1d:()=>eg,pad2d:()=>tg,pad3d:()=>ng,pad4d:()=>ag,pool:()=>rg,pow:()=>Gd,prelu:()=>ig,print:()=>bd,prod:()=>og,profile:()=>eu,raggedGather:()=>lg,raggedRange:()=>cg,raggedTensorToTensor:()=>ug,rand:()=>dg,randomGamma:()=>gg,randomNormal:()=>xg,randomStandardNormal:()=>yg,randomUniform:()=>bg,randomUniformInt:()=>vg,range:()=>wg,ready:()=>iu,real:()=>Th,reciprocal:()=>kg,registerBackend:()=>du,registerGradient:()=>vl,registerKernel:()=>bl,relu:()=>Ng,relu6:()=>_g,removeBackend:()=>lu,reshape:()=>$p,reverse:()=>Sg,reverse1d:()=>Cg,reverse2d:()=>jg,reverse3d:()=>Tg,reverse4d:()=>Ig,rfft:()=>Kg,round:()=>Eg,rsqrt:()=>Ag,scalar:()=>Ld,scatterND:()=>xx,scatter_util:()=>u,searchSorted:()=>Df,selu:()=>Rg,separableConv2d:()=>Mg,serialization:()=>s,setBackend:()=>ru,setPlatform:()=>pu,setdiff1dAsync:()=>Lg,sigmoid:()=>am,sign:()=>Dg,signal:()=>Ry,sin:()=>Og,sinh:()=>Fg,slice:()=>sm,slice1d:()=>Pg,slice2d:()=>zg,slice3d:()=>Bg,slice4d:()=>Wg,slice_util:()=>d,softmax:()=>Vg,softplus:()=>Cf,spaceToBatchND:()=>sg,sparse:()=>Oy,sparseToDense:()=>yx,spectral:()=>Ay,split:()=>qg,sqrt:()=>_d,square:()=>Sd,squaredDifference:()=>Zg,squeeze:()=>Xg,stack:()=>Yg,step:()=>Jg,stridedSlice:()=>Qg,string:()=>Fy,sub:()=>qd,sum:()=>nf,sumOutType:()=>gc,tan:()=>$g,tanh:()=>rm,tensor:()=>Hc,tensor1d:()=>ex,tensor2d:()=>tx,tensor3d:()=>Ah,tensor4d:()=>nx,tensor5d:()=>ax,tensor6d:()=>sx,tensorScatterUpdate:()=>rx,tensor_util:()=>t,test_util:()=>h,tidy:()=>tu,tile:()=>uf,time:()=>su,topk:()=>ix,train:()=>Py,transpose:()=>Ih,truncatedNormal:()=>ox,unique:()=>lx,unregisterGradient:()=>kl,unregisterKernel:()=>wl,unsortedSegmentSum:()=>cx,unstack:()=>ux,upcastType:()=>fc,upperBound:()=>dx,util:()=>e,valueAndGrad:()=>Id,valueAndGrads:()=>Ed,variable:()=>hx,variableGrads:()=>Ad,version_core:()=>_p,where:()=>zm,whereAsync:()=>mx,zeros:()=>Wf,zerosLike:()=>Cd});var y={};n.r(y),n.d(y,{json:()=>xj});var b={};n.r(b),n.d(b,{json:()=>yj});var v={};n.r(v),n.d(v,{json:()=>bj});var w={};n.r(w),n.d(w,{json:()=>vj});var k={};n.r(k),n.d(k,{json:()=>wj});var N={};n.r(N),n.d(N,{json:()=>kj});var _={};n.r(_),n.d(_,{json:()=>Nj});var S={};n.r(S),n.d(S,{json:()=>_j});var C={};n.r(C),n.d(C,{json:()=>Sj});var j={};n.r(j),n.d(j,{json:()=>Cj});var T={};n.r(T),n.d(T,{json:()=>jj});var I={};n.r(I),n.d(I,{json:()=>Tj});var E={};n.r(E),n.d(E,{json:()=>Ij});var A={};n.r(A),n.d(A,{json:()=>Ej});var R={};n.r(R),n.d(R,{json:()=>Aj});var M={};n.r(M),n.d(M,{json:()=>Rj});var L={};n.r(L),n.d(L,{json:()=>Mj});var D={};n.r(D),n.d(D,{json:()=>Lj});var O={};n.r(O),n.d(O,{json:()=>Dj});var F={};n.r(F),n.d(F,{OP_SCOPE_SUFFIX:()=>Bc,abs:()=>Zd,acos:()=>Cp,acosh:()=>jp,add:()=>vd,addN:()=>Tp,all:()=>Ip,any:()=>Ep,argMax:()=>Ap,argMin:()=>Rp,asin:()=>Mp,asinh:()=>Lp,atan:()=>Dp,atan2:()=>Op,atanh:()=>Fp,avgPool:()=>em,avgPool3d:()=>tm,basicLSTMCell:()=>im,batchNorm:()=>lm,batchNorm2d:()=>cm,batchNorm3d:()=>um,batchNorm4d:()=>dm,batchToSpaceND:()=>om,bincount:()=>hm,bitwiseAnd:()=>pm,booleanMaskAsync:()=>fx,broadcastArgs:()=>mm,broadcastTo:()=>fm,buffer:()=>gd,cast:()=>xd,ceil:()=>gm,clipByValue:()=>xm,clone:()=>yd,complex:()=>Vc,concat:()=>nm,concat1d:()=>ym,concat2d:()=>bm,concat3d:()=>vm,concat4d:()=>wm,conv1d:()=>Nm,conv2d:()=>km,conv2dTranspose:()=>Sm,conv3d:()=>Cm,conv3dTranspose:()=>Tm,cos:()=>Im,cosh:()=>Em,cosineWindow:()=>kx,cumprod:()=>Am,cumsum:()=>Rm,denseBincount:()=>Mm,depthToSpace:()=>Lm,depthwiseConv2d:()=>Dm,diag:()=>Om,dilation2d:()=>Fm,div:()=>kd,divNoNan:()=>Bm,dot:()=>Wm,dropout:()=>vx,einsum:()=>Vm,elu:()=>Um,enclosingPowerOfTwo:()=>wx,ensureShape:()=>Hm,equal:()=>Pm,erf:()=>Gm,euclideanNorm:()=>rf,exp:()=>of,expandDims:()=>lf,expm1:()=>cf,eye:()=>df,fft:()=>Ug,fill:()=>Ud,floor:()=>hf,floorDiv:()=>wd,fused:()=>p,gather:()=>pf,gatherND:()=>bx,greater:()=>mf,greaterEqual:()=>ff,ifft:()=>Hg,imag:()=>Ch,image:()=>My,inTopKAsync:()=>Nx,irfft:()=>Gg,isFinite:()=>gf,isInf:()=>xf,isNaN:()=>yf,leakyRelu:()=>bf,less:()=>vf,lessEqual:()=>wf,linalg:()=>Ly,linspace:()=>kf,localResponseNormalization:()=>Nf,log:()=>_f,log1p:()=>Sf,logSigmoid:()=>jf,logSoftmax:()=>Tf,logSumExp:()=>If,logicalAnd:()=>Ef,logicalNot:()=>Af,logicalOr:()=>Rf,logicalXor:()=>Mf,losses:()=>Dy,lowerBound:()=>Of,matMul:()=>_h,max:()=>ef,maxPool:()=>Ff,maxPool3d:()=>Pf,maxPoolWithArgmax:()=>zf,maximum:()=>Qd,mean:()=>Bf,meshgrid:()=>Uf,min:()=>tf,minimum:()=>Hf,mirrorPad:()=>Gf,mod:()=>qf,moments:()=>Kf,movingAverage:()=>gx,mul:()=>Nd,multiRNNCell:()=>Zf,multinomial:()=>Xf,neg:()=>jh,norm:()=>sf,notEqual:()=>Yf,oneHot:()=>Sh,ones:()=>Vf,onesLike:()=>Jf,op:()=>Wc,outerProduct:()=>Qf,pad:()=>$f,pad1d:()=>eg,pad2d:()=>tg,pad3d:()=>ng,pad4d:()=>ag,pool:()=>rg,pow:()=>Gd,prelu:()=>ig,print:()=>bd,prod:()=>og,raggedGather:()=>lg,raggedRange:()=>cg,raggedTensorToTensor:()=>ug,rand:()=>dg,randomGamma:()=>gg,randomNormal:()=>xg,randomStandardNormal:()=>yg,randomUniform:()=>bg,randomUniformInt:()=>vg,range:()=>wg,real:()=>Th,reciprocal:()=>kg,relu:()=>Ng,relu6:()=>_g,reshape:()=>$p,reverse:()=>Sg,reverse1d:()=>Cg,reverse2d:()=>jg,reverse3d:()=>Tg,reverse4d:()=>Ig,rfft:()=>Kg,round:()=>Eg,rsqrt:()=>Ag,scalar:()=>Ld,scatterND:()=>xx,searchSorted:()=>Df,selu:()=>Rg,separableConv2d:()=>Mg,setdiff1dAsync:()=>Lg,sigmoid:()=>am,sign:()=>Dg,signal:()=>Ry,sin:()=>Og,sinh:()=>Fg,slice:()=>sm,slice1d:()=>Pg,slice2d:()=>zg,slice3d:()=>Bg,slice4d:()=>Wg,softmax:()=>Vg,softplus:()=>Cf,spaceToBatchND:()=>sg,sparse:()=>Oy,sparseToDense:()=>yx,spectral:()=>Ay,split:()=>qg,sqrt:()=>_d,square:()=>Sd,squaredDifference:()=>Zg,squeeze:()=>Xg,stack:()=>Yg,step:()=>Jg,stridedSlice:()=>Qg,string:()=>Fy,sub:()=>qd,sum:()=>nf,tan:()=>$g,tanh:()=>rm,tensor:()=>Hc,tensor1d:()=>ex,tensor2d:()=>tx,tensor3d:()=>Ah,tensor4d:()=>nx,tensor5d:()=>ax,tensor6d:()=>sx,tensorScatterUpdate:()=>rx,tile:()=>uf,topk:()=>ix,transpose:()=>Ih,truncatedNormal:()=>ox,unique:()=>lx,unsortedSegmentSum:()=>cx,unstack:()=>ux,upperBound:()=>dx,variable:()=>hx,where:()=>zm,whereAsync:()=>mx,zeros:()=>Wf,zerosLike:()=>Cd});var P={};n.r(P),n.d(P,{mx:()=>OI,XI:()=>TE,Nk:()=>IE,f6:()=>AE,ct:()=>AI,YG:()=>DE,hH:()=>WE,z3:()=>SA,sG:()=>OA,uM:()=>WA,vS:()=>sR,qB:()=>hR,GG:()=>mR,lg:()=>bR,rq:()=>gR,cu:()=>RR,WR:()=>IR,GE:()=>DR,px:()=>FR,jC:()=>QR,He:()=>tM,hE:()=>dM,BF:()=>xA,Dk:()=>wM,cl:()=>IM,_B:()=>VM,ub:()=>KM,_f:()=>YM,Ku:()=>nL,qy:()=>sL,Zy:()=>gL,bu:()=>bL,zv:()=>kI,dH:()=>GI,HS:()=>_E,yH:()=>zL,l3:()=>WL,z9:()=>UL,x6:()=>ZL,_m:()=>tD,eW:()=>iD,GK:()=>cD,SP:()=>hD,yr:()=>mD,dl:()=>KA,Dw:()=>vD,xT:()=>_D,_X:()=>QI,wz:()=>AD});var z,B=n(43),W=n.t(B,2),V=n(391);function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},U.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(z||(z={}));const H="popstate";function G(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function q(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function K(e,t){return{usr:e.state,key:e.key,idx:t}}function Z(e,t,n,a){return void 0===n&&(n=null),U({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?Y(t):t,{state:n,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function X(e){let{pathname:t="/",search:n="",hash:a=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function Y(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function J(e,t,n,a){void 0===a&&(a={});let{window:s=document.defaultView,v5Compat:r=!1}=a,i=s.history,o=z.Pop,l=null,c=u();function u(){return(i.state||{idx:null}).idx}function d(){o=z.Pop;let e=u(),t=null==e?null:e-c;c=e,l&&l({action:o,location:p.location,delta:t})}function h(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:X(e);return n=n.replace(/ $/,"%20"),G(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==c&&(c=0,i.replaceState(U({},i.state,{idx:c}),""));let p={get action(){return o},get location(){return e(s,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(H,d),l=e,()=>{s.removeEventListener(H,d),l=null}},createHref:e=>t(s,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=z.Push;let a=Z(p.location,e,t);n&&n(a,e),c=u()+1;let d=K(a,c),h=p.createHref(a);try{i.pushState(d,"",h)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;s.location.assign(h)}r&&l&&l({action:o,location:p.location,delta:1})},replace:function(e,t){o=z.Replace;let a=Z(p.location,e,t);n&&n(a,e),c=u();let s=K(a,c),d=p.createHref(a);i.replaceState(s,"",d),r&&l&&l({action:o,location:p.location,delta:0})},go:e=>i.go(e)};return p}var Q;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(Q||(Q={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function $(e,t,n){return void 0===n&&(n="/"),ee(e,t,n,!1)}function ee(e,t,n,a){let s=me(("string"===typeof t?Y(t):t).pathname||"/",n);if(null==s)return null;let r=te(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(r);let i=null;for(let o=0;null==i&&o<r.length;++o){let e=pe(s);i=de(r[o],e,a)}return i}function te(e,t,n,a){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===a&&(a="");let s=(e,s,r)=>{let i={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};i.relativePath.startsWith("/")&&(G(i.relativePath.startsWith(a),'Absolute route path "'+i.relativePath+'" nested under path "'+a+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(a.length));let o=be([a,i.relativePath]),l=n.concat(i);e.children&&e.children.length>0&&(G(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),te(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:ue(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let a of ne(e.path))s(e,t,a);else s(e,t)}),t}function ne(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,s=n.endsWith("?"),r=n.replace(/\?$/,"");if(0===a.length)return s?[r,""]:[r];let i=ne(a.join("/")),o=[];return o.push(...i.map(e=>""===e?r:[r,e].join("/"))),s&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}const ae=/^:[\w-]+$/,se=3,re=2,ie=1,oe=10,le=-2,ce=e=>"*"===e;function ue(e,t){let n=e.split("/"),a=n.length;return n.some(ce)&&(a+=le),t&&(a+=re),n.filter(e=>!ce(e)).reduce((e,t)=>e+(ae.test(t)?se:""===t?ie:oe),a)}function de(e,t,n){void 0===n&&(n=!1);let{routesMeta:a}=e,s={},r="/",i=[];for(let o=0;o<a.length;++o){let e=a[o],l=o===a.length-1,c="/"===r?t:t.slice(r.length)||"/",u=he({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!a[a.length-1].route.index&&(u=he({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(s,u.params),i.push({params:s,pathname:be([r,u.pathname]),pathnameBase:ve(be([r,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(r=be([r,u.pathnameBase]))}return i}function he(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);q("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let a=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(a.push({paramName:"*"}),s+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":""!==e&&"/"!==e&&(s+="(?:(?=\\/|$))");let r=new RegExp(s,t?void 0:"i");return[r,a]}(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let r=s[0],i=r.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:a.reduce((e,t,n)=>{let{paramName:a,isOptional:s}=t;if("*"===a){let e=o[n]||"";i=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[a]=s&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:r,pathnameBase:i,pattern:e}}function pe(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return q(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function me(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}function fe(e,t,n,a){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function ge(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function xe(e,t){let n=ge(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function ye(e,t,n,a){let s;void 0===a&&(a=!1),"string"===typeof e?s=Y(e):(s=U({},e),G(!s.pathname||!s.pathname.includes("?"),fe("?","pathname","search",s)),G(!s.pathname||!s.pathname.includes("#"),fe("#","pathname","hash",s)),G(!s.search||!s.search.includes("#"),fe("#","search","hash",s)));let r,i=""===e||""===s.pathname,o=i?"/":s.pathname;if(null==o)r=n;else{let e=t.length-1;if(!a&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;s.pathname=t.join("/")}r=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:a="",hash:s=""}="string"===typeof e?Y(e):e,r=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:r,search:we(a),hash:ke(s)}}(s,r),c=o&&"/"!==o&&o.endsWith("/"),u=(i||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const be=e=>e.join("/").replace(/\/\/+/g,"/"),ve=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),we=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",ke=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function Ne(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const _e=["post","put","patch","delete"],Se=(new Set(_e),["get",..._e]);new Set(Se),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function Ce(){return Ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ce.apply(this,arguments)}const je=B.createContext(null);const Te=B.createContext(null);const Ie=B.createContext(null);const Ee=B.createContext(null);const Ae=B.createContext({outlet:null,matches:[],isDataRoute:!1});const Re=B.createContext(null);function Me(){return null!=B.useContext(Ee)}function Le(){return Me()||G(!1),B.useContext(Ee).location}function De(e){B.useContext(Ie).static||B.useLayoutEffect(e)}function Oe(){let{isDataRoute:e}=B.useContext(Ae);return e?function(){let{router:e}=qe(He.UseNavigateStable),t=Ze(Ge.UseNavigateStable),n=B.useRef(!1);return De(()=>{n.current=!0}),B.useCallback(function(a,s){void 0===s&&(s={}),n.current&&("number"===typeof a?e.navigate(a):e.navigate(a,Ce({fromRouteId:t},s)))},[e,t])}():function(){Me()||G(!1);let e=B.useContext(je),{basename:t,future:n,navigator:a}=B.useContext(Ie),{matches:s}=B.useContext(Ae),{pathname:r}=Le(),i=JSON.stringify(xe(s,n.v7_relativeSplatPath)),o=B.useRef(!1);De(()=>{o.current=!0});let l=B.useCallback(function(n,s){if(void 0===s&&(s={}),!o.current)return;if("number"===typeof n)return void a.go(n);let l=ye(n,JSON.parse(i),r,"path"===s.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:be([t,l.pathname])),(s.replace?a.replace:a.push)(l,s.state,s)},[t,a,i,r,e]);return l}()}function Fe(e,t){let{relative:n}=void 0===t?{}:t,{future:a}=B.useContext(Ie),{matches:s}=B.useContext(Ae),{pathname:r}=Le(),i=JSON.stringify(xe(s,a.v7_relativeSplatPath));return B.useMemo(()=>ye(e,JSON.parse(i),r,"path"===n),[e,i,r,n])}function Pe(e,t,n,a){Me()||G(!1);let{navigator:s}=B.useContext(Ie),{matches:r}=B.useContext(Ae),i=r[r.length-1],o=i?i.params:{},l=(i&&i.pathname,i?i.pathnameBase:"/");i&&i.route;let c,u=Le();if(t){var d;let e="string"===typeof t?Y(t):t;"/"===l||(null==(d=e.pathname)?void 0:d.startsWith(l))||G(!1),c=e}else c=u;let h=c.pathname||"/",p=h;if("/"!==l){let e=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(e.length).join("/")}let m=$(e,{pathname:p});let f=Ue(m&&m.map(e=>Object.assign({},e,{params:Object.assign({},o,e.params),pathname:be([l,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:be([l,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),r,n,a);return t&&f?B.createElement(Ee.Provider,{value:{location:Ce({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:z.Pop}},f):f}function ze(){let e=function(){var e;let t=B.useContext(Re),n=Ke(Ge.UseRouteError),a=Ze(Ge.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[a]}(),t=Ne(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:a};return B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},t),n?B.createElement("pre",{style:s},n):null,null)}const Be=B.createElement(ze,null);class We extends B.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?B.createElement(Ae.Provider,{value:this.props.routeContext},B.createElement(Re.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ve(e){let{routeContext:t,match:n,children:a}=e,s=B.useContext(je);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),B.createElement(Ae.Provider,{value:t},a)}function Ue(e,t,n,a){var s;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===a&&(a=null),null==e){var r;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(r=a)&&r.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let i=e,o=null==(s=n)?void 0:s.errors;if(null!=o){let e=i.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||G(!1),i=i.slice(0,Math.min(i.length,e+1))}let l=!1,c=-1;if(n&&a&&a.v7_partialHydration)for(let u=0;u<i.length;u++){let e=i[u];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=u),e.route.id){let{loaderData:t,errors:a}=n,s=e.route.loader&&void 0===t[e.route.id]&&(!a||void 0===a[e.route.id]);if(e.route.lazy||s){l=!0,i=c>=0?i.slice(0,c+1):[i[0]];break}}}return i.reduceRight((e,a,s)=>{let r,u=!1,d=null,h=null;var p;n&&(r=o&&a.route.id?o[a.route.id]:void 0,d=a.route.errorElement||Be,l&&(c<0&&0===s?(p="route-fallback",!1||Xe[p]||(Xe[p]=!0),u=!0,h=null):c===s&&(u=!0,h=a.route.hydrateFallbackElement||null)));let m=t.concat(i.slice(0,s+1)),f=()=>{let t;return t=r?d:u?h:a.route.Component?B.createElement(a.route.Component,null):a.route.element?a.route.element:e,B.createElement(Ve,{match:a,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(a.route.ErrorBoundary||a.route.errorElement||0===s)?B.createElement(We,{location:n.location,revalidation:n.revalidation,component:d,error:r,children:f(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):f()},null)}var He=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(He||{}),Ge=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ge||{});function qe(e){let t=B.useContext(je);return t||G(!1),t}function Ke(e){let t=B.useContext(Te);return t||G(!1),t}function Ze(e){let t=function(){let e=B.useContext(Ae);return e||G(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||G(!1),n.route.id}const Xe={};function Ye(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}W.startTransition;function Je(e){G(!1)}function Qe(e){let{basename:t="/",children:n=null,location:a,navigationType:s=z.Pop,navigator:r,static:i=!1,future:o}=e;Me()&&G(!1);let l=t.replace(/^\/*/,"/"),c=B.useMemo(()=>({basename:l,navigator:r,static:i,future:Ce({v7_relativeSplatPath:!1},o)}),[l,o,r,i]);"string"===typeof a&&(a=Y(a));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:m="default"}=a,f=B.useMemo(()=>{let e=me(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:m},navigationType:s}},[l,u,d,h,p,m,s]);return null==f?null:B.createElement(Ie.Provider,{value:c},B.createElement(Ee.Provider,{children:n,value:f}))}function $e(e){let{children:t,location:n}=e;return Pe(et(t),n)}new Promise(()=>{});B.Component;function et(e,t){void 0===t&&(t=[]);let n=[];return B.Children.forEach(e,(e,a)=>{if(!B.isValidElement(e))return;let s=[...t,a];if(e.type===B.Fragment)return void n.push.apply(n,et(e.props.children,s));e.type!==Je&&G(!1),e.props.index&&e.props.children&&G(!1);let r={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(r.children=et(e.props.children,s)),n.push(r)}),n}var tt=n(950),nt=n.t(tt,2);function at(){return at=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},at.apply(this,arguments)}function st(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const rt=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(vq){}new Map;const it=W.startTransition;nt.flushSync,W.useId;function ot(e){let{basename:t,children:n,future:a,window:s}=e,r=B.useRef();var i;null==r.current&&(r.current=(void 0===(i={window:s,v5Compat:!0})&&(i={}),J(function(e,t){let{pathname:n,search:a,hash:s}=e.location;return Z("",{pathname:n,search:a,hash:s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:X(t)},null,i)));let o=r.current,[l,c]=B.useState({action:o.action,location:o.location}),{v7_startTransition:u}=a||{},d=B.useCallback(e=>{u&&it?it(()=>c(e)):c(e)},[c,u]);return B.useLayoutEffect(()=>o.listen(d),[o,d]),B.useEffect(()=>Ye(a),[a]),B.createElement(Qe,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:a})}const lt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,ct=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ut=B.forwardRef(function(e,t){let n,{onClick:a,relative:s,reloadDocument:r,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,h=st(e,rt),{basename:p}=B.useContext(Ie),m=!1;if("string"===typeof c&&ct.test(c)&&(n=c,lt))try{let e=new URL(window.location.href),t=c.startsWith("//")?new URL(e.protocol+c):new URL(c),n=me(t.pathname,p);t.origin===e.origin&&null!=n?c=n+t.search+t.hash:m=!0}catch(vq){}let f=function(e,t){let{relative:n}=void 0===t?{}:t;Me()||G(!1);let{basename:a,navigator:s}=B.useContext(Ie),{hash:r,pathname:i,search:o}=Fe(e,{relative:n}),l=i;return"/"!==a&&(l="/"===i?a:be([a,i])),s.createHref({pathname:l,search:o,hash:r})}(c,{relative:s}),g=function(e,t){let{target:n,replace:a,state:s,preventScrollReset:r,relative:i,viewTransition:o}=void 0===t?{}:t,l=Oe(),c=Le(),u=Fe(e,{relative:i});return B.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==a?a:X(c)===X(u);l(e,{replace:n,state:s,preventScrollReset:r,relative:i,viewTransition:o})}},[c,l,u,a,s,n,e,r,i,o])}(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:d});return B.createElement("a",at({},h,{href:n||f,onClick:m||r?a:function(e){a&&a(e),e.defaultPrevented||g(e)},ref:t,target:l}))});var dt,ht;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(dt||(dt={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(ht||(ht={}));function pt(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}const mt=["title","titleId"];function ft(e,t){let{title:n,titleId:a}=e,s=pt(e,mt);return B.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?B.createElement("title",{id:a},n):null,B.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const gt=B.forwardRef(ft),xt=["title","titleId"];function yt(e,t){let{title:n,titleId:a}=e,s=pt(e,xt);return B.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?B.createElement("title",{id:a},n):null,B.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const bt=B.forwardRef(yt),vt=["title","titleId"];function wt(e,t){let{title:n,titleId:a}=e,s=pt(e,vt);return B.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?B.createElement("title",{id:a},n):null,B.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const kt=B.forwardRef(wt),Nt=["title","titleId"];function _t(e,t){let{title:n,titleId:a}=e,s=pt(e,Nt);return B.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?B.createElement("title",{id:a},n):null,B.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const St=B.forwardRef(_t),Ct=["title","titleId"];function jt(e,t){let{title:n,titleId:a}=e,s=pt(e,Ct);return B.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?B.createElement("title",{id:a},n):null,B.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const Tt=B.forwardRef(jt),It=n.p+"static/media/logo.d82ab3340a71635f6a52.jpg";function Et(e){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(e)}function At(e){var t=function(e,t){if("object"!=Et(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=Et(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Et(t)?t:t+""}function Rt(e,t,n){return(t=At(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach(function(t){Rt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Dt=n(579);const Ot=(0,B.createContext)(),Ft=e=>{let{children:t}=e;const[n,a]=(0,B.useState)(null),[s,r]=(0,B.useState)(!0);(0,B.useEffect)(()=>{const e=localStorage.getItem("user");if(e)try{a(JSON.parse(e))}catch(t){console.error("Failed to parse stored user data:",t),localStorage.removeItem("user")}r(!1)},[]);const i={user:n,loading:s,login:e=>{const t=Lt(Lt({},e),{},{avatar:e.avatar||"https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y"});return a(t),localStorage.setItem("user",JSON.stringify(t)),!0},logout:()=>{a(null),localStorage.removeItem("user")},updateProfile:e=>{if(!n)return!1;const t=Lt(Lt({},n),e);return a(t),localStorage.setItem("user",JSON.stringify(t)),!0},isAuthenticated:()=>!!n};return(0,Dt.jsx)(Ot.Provider,{value:i,children:t})},Pt=()=>{const e=(0,B.useContext)(Ot);if(void 0===e)throw new Error("useUser must be used within a UserProvider");return e},zt=(0,B.createContext)();function Bt(){return(0,B.useContext)(zt)}function Wt(e){let{children:t}=e;const[n,a]=(0,B.useState)([]);(0,B.useEffect)(()=>{const e=localStorage.getItem("tripCart");if(e)try{a(JSON.parse(e))}catch(t){console.error("Failed to parse cart from localStorage:",t),a([])}},[]),(0,B.useEffect)(()=>{localStorage.setItem("tripCart",JSON.stringify(n))},[n]);const s={cartItems:n,addToCart:e=>!n.find(t=>t.id===e.id&&t.type===e.type)&&(a(t=>[...t,Lt(Lt({},e),{},{addedAt:(new Date).toISOString()})]),!0),removeFromCart:(e,t)=>{a(n=>n.filter(n=>!(n.id===e&&n.type===t)))},clearCart:()=>{a([])}};return(0,Dt.jsx)(zt.Provider,{value:s,children:t})}const Vt=()=>{const{cartItems:e}=Bt();return(0,Dt.jsxs)(ut,{to:"/cart",className:"relative p-2 text-gray-700 hover:text-blue-600",children:[(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),e.length>0&&(0,Dt.jsx)("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-blue-600 rounded-full",children:e.length})]})},Ut=[{name:"Home",href:"/"},{name:"Dashboard",href:"/dashboard"},{name:"Recommendations",href:"/recommendations"},{name:"Safety",href:"/safety"},{name:"Live Map",href:"/live-location"},{name:"Community",href:"/community"},{name:"Admin",href:"/admin"}],Ht=[{name:"Cabs",href:"/booking/cabs"},{name:"Bikes",href:"/booking/bikes"},{name:"Train",href:"/booking/train"},{name:"Metro",href:"/booking/metro"},{name:"Flights",href:"/booking/flight"},{name:"Auto",href:"/booking/auto"}];const Gt=function(){const[e,t]=(0,B.useState)(!1),{user:n,logout:a,isAuthenticated:s}=Pt(),[r,i]=(0,B.useState)(!1),[o,l]=(0,B.useState)(""),c=Oe(),u=e=>{e.preventDefault(),o.trim()&&(c("/recommendations?search=".concat(encodeURIComponent(o))),l(""))};return(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("nav",{className:"bg-primary-50 shadow-md sticky top-0 z-50",children:(0,Dt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Dt.jsxs)("div",{className:"flex justify-between h-16",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,Dt.jsxs)(ut,{to:"/",className:"flex items-center group",children:[(0,Dt.jsx)("span",{className:"text-2xl font-extrabold text-primary-700 tracking-tight mr-2 group-hover:text-secondary-600 transition",children:"Trailbrazers"}),(0,Dt.jsx)("img",{src:It,alt:"Logo",className:"h-12 w-auto rounded-full border-2 border-primary-300 shadow-md bg-white"})]})}),(0,Dt.jsx)("div",{className:"hidden sm:flex sm:items-center sm:justify-center flex-1 mx-4",children:(0,Dt.jsxs)("form",{onSubmit:u,className:"relative w-full max-w-md",children:[(0,Dt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Dt.jsx)(gt,{className:"h-5 w-5 text-gray-400"})}),(0,Dt.jsx)("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-full leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Search destinations, hotels, activities...",value:o,onChange:e=>l(e.target.value)}),(0,Dt.jsx)("button",{type:"submit",className:"hidden",children:"Search"})]})}),(0,Dt.jsx)("div",{className:"hidden sm:ml-6 sm:flex sm:items-center",children:s()?(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Vt,{}),(0,Dt.jsxs)("div",{className:"flex items-center mx-4",children:[n.avatar?(0,Dt.jsx)("img",{src:n.avatar,alt:"User avatar",className:"h-8 w-8 rounded-full object-cover border-2 border-primary-300"}):(0,Dt.jsx)(bt,{className:"h-8 w-8 text-primary-600"}),(0,Dt.jsx)("span",{className:"ml-2 text-primary-700 text-sm font-medium",children:n.username||n.email})]}),(0,Dt.jsx)("button",{onClick:a,className:"text-white bg-primary-600 hover:bg-primary-700 px-4 py-2 rounded-md text-sm font-medium",children:"Logout"})]}):(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)(ut,{to:"/login",className:"text-white bg-primary-600 hover:bg-primary-700 px-4 py-2 rounded-md text-sm font-medium",children:"Login"}),(0,Dt.jsx)(ut,{to:"/signup",className:"ml-3 text-primary-600 bg-white border border-primary-300 hover:bg-primary-50 px-4 py-2 rounded-md text-sm font-medium",children:"Sign up"})]})}),(0,Dt.jsx)("div",{className:"-mr-2 flex items-center sm:hidden",children:(0,Dt.jsxs)("button",{onClick:()=>t(!e),className:"inline-flex items-center justify-center p-2 rounded-md text-primary-600 hover:text-primary-800 hover:bg-primary-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500",children:[(0,Dt.jsx)("span",{className:"sr-only",children:"Open main menu"}),e?(0,Dt.jsx)(kt,{className:"block h-6 w-6","aria-hidden":"true"}):(0,Dt.jsx)(St,{className:"block h-6 w-6","aria-hidden":"true"})]})})]})})}),(0,Dt.jsx)("nav",{className:"bg-white shadow-sm",children:(0,Dt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Dt.jsx)("div",{className:"flex justify-center h-10",children:(0,Dt.jsx)("div",{className:"hidden sm:flex sm:items-center",children:(0,Dt.jsxs)("div",{className:"flex space-x-4",children:[Ut.map(e=>(0,Dt.jsx)(ut,{to:e.href,className:"text-gray-600 hover:text-primary-600 px-3 py-1 text-sm font-medium",children:e.name},e.name)),(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsxs)("button",{className:"text-gray-600 hover:text-primary-600 px-3 py-1 text-sm font-medium flex items-center",onClick:()=>i(!r),children:["Commute",(0,Dt.jsx)(Tt,{className:"ml-1 h-4 w-4"})]}),r&&(0,Dt.jsx)("div",{className:"absolute z-10 mt-1 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5",children:(0,Dt.jsx)("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:Ht.map(e=>(0,Dt.jsx)(ut,{to:e.href,className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:e.name},e.name))})})]}),(0,Dt.jsx)(ut,{to:"/hotels-restaurants",className:"text-gray-600 hover:text-primary-600 px-3 py-1 text-sm font-medium",children:"Hotels & Restaurants"})]})})})})}),e&&(0,Dt.jsxs)("div",{className:"sm:hidden bg-white shadow-lg rounded-b-lg",children:[(0,Dt.jsxs)("div",{className:"pt-2 pb-3 space-y-1",children:[(0,Dt.jsx)("div",{className:"px-4 py-2",children:(0,Dt.jsxs)("form",{onSubmit:u,className:"relative",children:[(0,Dt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Dt.jsx)(gt,{className:"h-5 w-5 text-gray-400"})}),(0,Dt.jsx)("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Search...",value:o,onChange:e=>l(e.target.value)}),(0,Dt.jsx)("button",{type:"submit",className:"hidden",children:"Search"})]})}),Ut.map(e=>(0,Dt.jsx)(ut,{to:e.href,className:"block px-4 py-2 text-base font-medium text-gray-600 hover:text-primary-600 hover:bg-gray-50",onClick:()=>t(!1),children:e.name},e.name)),(0,Dt.jsxs)("div",{className:"px-4 py-2",children:[(0,Dt.jsxs)("button",{className:"flex items-center w-full text-left text-base font-medium text-gray-600 hover:text-primary-600",onClick:()=>i(!r),children:["Commute",(0,Dt.jsx)(Tt,{className:"ml-auto h-5 w-5 transform ".concat(r?"rotate-180":"")})]}),r&&(0,Dt.jsx)("div",{className:"mt-2 space-y-1 pl-4",children:Ht.map(e=>(0,Dt.jsx)(ut,{to:e.href,className:"block px-3 py-2 text-base font-medium text-gray-500 hover:text-primary-600 hover:bg-gray-50",onClick:()=>t(!1),children:e.name},e.name))})]}),(0,Dt.jsx)(ut,{to:"/hotels-restaurants",className:"block px-4 py-2 text-base font-medium text-gray-600 hover:text-primary-600 hover:bg-gray-50",onClick:()=>t(!1),children:"Hotels & Restaurants"})]}),(0,Dt.jsx)("div",{className:"pt-4 pb-3 border-t border-gray-200",children:s()?(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex items-center px-4 py-2",children:[n.avatar?(0,Dt.jsx)("img",{src:n.avatar,alt:"User avatar",className:"h-10 w-10 rounded-full object-cover border-2 border-primary-300"}):(0,Dt.jsx)(bt,{className:"h-10 w-10 text-primary-600"}),(0,Dt.jsxs)("div",{className:"ml-3",children:[(0,Dt.jsx)("div",{className:"text-base font-medium text-gray-800",children:n.username||n.email}),(0,Dt.jsx)("div",{className:"text-sm font-medium text-gray-500",children:n.email})]})]}),(0,Dt.jsx)("div",{className:"mt-3 px-2 space-y-1",children:(0,Dt.jsx)("button",{onClick:a,className:"block w-full text-left px-3 py-2 text-base font-medium text-gray-600 hover:text-primary-600 hover:bg-gray-50",children:"Logout"})})]}):(0,Dt.jsxs)("div",{className:"px-2 space-y-1",children:[(0,Dt.jsx)(ut,{to:"/login",className:"block px-3 py-2 text-base font-medium text-gray-600 hover:text-primary-600 hover:bg-gray-50",children:"Login"}),(0,Dt.jsx)(ut,{to:"/signup",className:"block px-3 py-2 text-base font-medium text-gray-600 hover:text-primary-600 hover:bg-gray-50",children:"Sign up"})]})})]})]})};const qt=function(){return(0,Dt.jsx)("footer",{className:"bg-gray-800 text-white",children:(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Trailblazers"}),(0,Dt.jsx)("p",{className:"text-gray-400 text-sm",children:"Capture your travel experiences, discover new places, and travel safely with our comprehensive travel companion app."})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Features"}),(0,Dt.jsxs)("ul",{className:"space-y-2 text-gray-400 text-sm",children:[(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/dashboard",className:"hover:text-white",children:"Trip Management"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/recommendations",className:"hover:text-white",children:"AI Recommendations"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/safety",className:"hover:text-white",children:"Safety & Emergency"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/live-location",className:"hover:text-white",children:"Live Map"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/community",className:"hover:text-white",children:"Community"})})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Community"}),(0,Dt.jsxs)("ul",{className:"space-y-2 text-gray-400 text-sm",children:[(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/community?tab=forums",className:"hover:text-white",children:"Forums"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/community?tab=reviews",className:"hover:text-white",children:"Reviews"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/community?tab=buddies",className:"hover:text-white",children:"Travel Buddies"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/community?tab=guides",className:"hover:text-white",children:"Local Guides"})})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Contact"}),(0,Dt.jsxs)("ul",{className:"space-y-2 text-gray-400 text-sm",children:[(0,Dt.jsx)("li",{children:"Email: kumarsanskar52515@gmail.com"}),(0,Dt.jsx)("li",{children:"Phone: +91 7302028936"}),(0,Dt.jsx)("li",{children:"Address: Gautam Buddha University, Greater Noida"})]}),(0,Dt.jsxs)("div",{className:"mt-4 flex space-x-4",children:[(0,Dt.jsxs)("a",{href:"https://www.facebook.com/profile.php?id=100095307382889",className:"text-gray-400 hover:text-white",children:[(0,Dt.jsx)("span",{className:"sr-only",children:"Facebook"}),(0,Dt.jsx)("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z",clipRule:"evenodd"})})]}),(0,Dt.jsxs)("a",{href:"https://www.instagram.com/mainhoonsanskar",className:"text-gray-400 hover:text-white",children:[(0,Dt.jsx)("span",{className:"sr-only",children:"Instagram"}),(0,Dt.jsx)("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z",clipRule:"evenodd"})})]}),(0,Dt.jsxs)("a",{href:"https://github.com/Underwaterbet023",className:"text-gray-400 hover:text-white",children:[(0,Dt.jsx)("span",{className:"sr-only",children:"Github"}),(0,Dt.jsx)("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:(0,Dt.jsx)("path",{d:"M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"})})]})]})]})]}),(0,Dt.jsxs)("div",{className:"mt-8 border-t border-gray-700 pt-8 flex flex-col md:flex-row justify-between",children:[(0,Dt.jsx)("p",{className:"text-gray-400 text-sm",children:"\xa9 2025 Trailblazers. All rights reserved."}),(0,Dt.jsx)("div",{className:"mt-4 md:mt-0",children:(0,Dt.jsxs)("ul",{className:"flex space-x-6 text-gray-400 text-sm",children:[(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/privacy-policy",className:"hover:text-white",children:"Privacy Policy"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/terms-of-service",className:"hover:text-white",children:"Terms of Service"})}),(0,Dt.jsx)("li",{children:(0,Dt.jsx)(ut,{to:"/cookie-policy",className:"hover:text-white",children:"Cookie Policy"})})]})})]})]})})};function Kt(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=Kt(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}const Zt=function(){for(var e,t,n=0,a="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=Kt(e))&&(a&&(a+=" "),a+=t);return a},Xt=["theme","type","isLoading"];!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var Yt=e=>"number"==typeof e&&!isNaN(e),Jt=e=>"string"==typeof e,Qt=e=>"function"==typeof e,$t=e=>Jt(e)||Qt(e)?e:null,en=(e,t)=>!1===e||Yt(e)&&e>0?e:t,tn=e=>(0,B.isValidElement)(e)||Jt(e)||Qt(e)||Yt(e);function nn(e){let{enter:t,exit:n,appendPosition:a=!1,collapse:s=!0,collapseDuration:r=300}=e;return function(e){let{children:i,position:o,preventExitTransition:l,done:c,nodeRef:u,isIn:d,playToast:h}=e,p=a?"".concat(t,"--").concat(o):t,m=a?"".concat(n,"--").concat(o):n,f=(0,B.useRef)(0);return(0,B.useLayoutEffect)(()=>{let e=u.current,t=p.split(" "),n=a=>{a.target===u.current&&(h(),e.removeEventListener("animationend",n),e.removeEventListener("animationcancel",n),0===f.current&&"animationcancel"!==a.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",n),e.addEventListener("animationcancel",n)},[]),(0,B.useEffect)(()=>{let e=u.current,t=()=>{e.removeEventListener("animationend",t),s?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:a,style:s}=e;requestAnimationFrame(()=>{s.minHeight="initial",s.height=a+"px",s.transition="all ".concat(n,"ms"),requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(t,n)})})}(e,c,r):c()};d||(l?t():(f.current=1,e.className+=" ".concat(m),e.addEventListener("animationend",t)))},[d]),B.createElement(B.Fragment,null,i)}}function an(e,t){return{content:sn(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function sn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,B.isValidElement)(e)&&!Jt(e.type)?(0,B.cloneElement)(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):Qt(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):e}function rn(e){let{delay:t,isRunning:n,closeToast:a,type:s="default",hide:r,className:i,controlledProgress:o,progress:l,rtl:c,isIn:u,theme:d}=e,h=r||o&&0===l,p={animationDuration:"".concat(t,"ms"),animationPlayState:n?"running":"paused"};o&&(p.transform="scaleX(".concat(l,")"));let m=Zt("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated","Toastify__progress-bar-theme--".concat(d),"Toastify__progress-bar--".concat(s),{"Toastify__progress-bar--rtl":c}),f=Qt(i)?i({rtl:c,type:s,defaultClassName:m}):Zt(m,i),g={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{u&&a()}};return B.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},B.createElement("div",{className:"Toastify__progress-bar--bg Toastify__progress-bar-theme--".concat(d," Toastify__progress-bar--").concat(s)}),B.createElement("div",Lt({role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:f,style:p},g)))}var on=1,ln=()=>"".concat(on++);function cn(e,t,n){let a=1,s=0,r=[],i=[],o=t,l=new Map,c=new Set,u=()=>{i=Array.from(l.values()),c.forEach(e=>e())},d=e=>{var t,n;null==(n=null==(t=e.props)?void 0:t.onClose)||n.call(t,e.removalReason),e.isActive=!1},h=e=>{if(null==e)l.forEach(d);else{let t=l.get(e);t&&d(t)}u()},p=e=>{var t,a;let{toastId:s,updateId:r}=e.props,i=null==r;e.staleId&&l.delete(e.staleId),e.isActive=!0,l.set(s,e),u(),n(an(e,i?"added":"updated")),i&&(null==(a=(t=e.props).onOpen)||a.call(t))};return{id:e,props:o,observe:e=>(c.add(e),()=>c.delete(e)),toggle:(e,t)=>{l.forEach(n=>{var a;(null==t||t===n.props.toastId)&&(null==(a=n.toggle)||a.call(n,e))})},removeToast:h,toasts:l,clearQueue:()=>{s-=r.length,r=[]},buildToast:(t,i)=>{if((t=>{let{containerId:n,toastId:a,updateId:s}=t,r=n?n!==e:1!==e,i=l.has(a)&&null==s;return r||i})(i))return;let{toastId:c,updateId:d,data:m,staleId:f,delay:g}=i,x=null==d;x&&s++;let y=Lt(Lt(Lt({},o),{},{style:o.toastStyle,key:a++},Object.fromEntries(Object.entries(i).filter(e=>{let[t,n]=e;return null!=n}))),{},{toastId:c,updateId:d,data:m,isIn:!1,className:$t(i.className||o.toastClassName),progressClassName:$t(i.progressClassName||o.progressClassName),autoClose:!i.isLoading&&en(i.autoClose,o.autoClose),closeToast(e){l.get(c).removalReason=e,h(c)},deleteToast(){let e=l.get(c);if(null!=e){if(n(an(e,"removed")),l.delete(c),s--,s<0&&(s=0),r.length>0)return void p(r.shift());u()}}});y.closeButton=o.closeButton,!1===i.closeButton||tn(i.closeButton)?y.closeButton=i.closeButton:!0===i.closeButton&&(y.closeButton=!tn(o.closeButton)||o.closeButton);let b={content:t,props:y,staleId:f};o.limit&&o.limit>0&&s>o.limit&&x?r.push(b):Yt(g)?setTimeout(()=>{p(b)},g):p(b)},setProps(e){o=e},setToggle:(e,t)=>{let n=l.get(e);n&&(n.toggle=t)},isToastActive:e=>{var t;return null==(t=l.get(e))?void 0:t.isActive},getSnapshot:()=>i}}var un=new Map,dn=[],hn=new Set,pn=e=>hn.forEach(t=>t(e)),mn=()=>un.size>0;function fn(e,t){var n;if(t)return!(null==(n=un.get(t))||!n.isToastActive(e));let a=!1;return un.forEach(t=>{t.isToastActive(e)&&(a=!0)}),a}function gn(e){if(mn()){if(null==e||(e=>Jt(e)||Yt(e))(e))un.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=un.get(e.containerId);t?t.removeToast(e.id):un.forEach(t=>{t.removeToast(e.id)})}}else dn=dn.filter(t=>null!=e&&t.options.toastId!==e)}function xn(e,t){tn(e)&&(mn()||dn.push({content:e,options:t}),un.forEach(n=>{n.buildToast(e,t)}))}function yn(e,t){un.forEach(n=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===n.id)&&n.toggle(e,null==t?void 0:t.id)})}function bn(e){let t=e.containerId||1;return{subscribe(n){let a=cn(t,e,pn);un.set(t,a);let s=a.observe(n);return dn.forEach(e=>xn(e.content,e.options)),dn=[],()=>{s(),un.delete(t)}},setProps(e){var n;null==(n=un.get(t))||n.setProps(e)},getSnapshot(){var e;return null==(e=un.get(t))?void 0:e.getSnapshot()}}}function vn(e){return e&&(Jt(e.toastId)||Yt(e.toastId))?e.toastId:ln()}function wn(e,t){return xn(e,t),t.toastId}function kn(e,t){return Lt(Lt({},t),{},{type:t&&t.type||e,toastId:vn(t)})}function Nn(e){return(t,n)=>wn(t,kn(e,n))}function _n(e,t){return wn(e,kn("default",t))}function Sn(e){let[t,n]=(0,B.useState)(!1),[a,s]=(0,B.useState)(!1),r=(0,B.useRef)(null),i=(0,B.useRef)({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:l,closeToast:c,onClick:u,closeOnClick:d}=e;function h(){n(!0)}function p(){n(!1)}function m(n){let a=r.current;if(i.canDrag&&a){i.didMove=!0,t&&p(),"x"===e.draggableDirection?i.delta=n.clientX-i.start:i.delta=n.clientY-i.start,i.start!==n.clientX&&(i.canCloseOnClick=!1);let s="x"===e.draggableDirection?"".concat(i.delta,"px, var(--y)"):"0, calc(".concat(i.delta,"px + var(--y))");a.style.transform="translate3d(".concat(s,",0)"),a.style.opacity="".concat(1-Math.abs(i.delta/i.removalDistance))}}function f(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",f);let t=r.current;if(i.canDrag&&i.didMove&&t){if(i.canDrag=!1,Math.abs(i.delta)>i.removalDistance)return s(!0),e.closeToast(!0),void e.collapseAll();t.style.transition="transform 0.2s, opacity 0.2s",t.style.removeProperty("transform"),t.style.removeProperty("opacity")}}(function(e){var t;null==(t=un.get(e.containerId||1))||t.setToggle(e.id,e.fn)})({id:e.toastId,containerId:e.containerId,fn:n}),(0,B.useEffect)(()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||p(),window.addEventListener("focus",h),window.addEventListener("blur",p),()=>{window.removeEventListener("focus",h),window.removeEventListener("blur",p)}},[e.pauseOnFocusLoss]);let g={onPointerDown:function(t){if(!0===e.draggable||e.draggable===t.pointerType){i.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",f);let n=r.current;i.canCloseOnClick=!0,i.canDrag=!0,n.style.transition="none","x"===e.draggableDirection?(i.start=t.clientX,i.removalDistance=n.offsetWidth*(e.draggablePercent/100)):(i.start=t.clientY,i.removalDistance=n.offsetHeight*(80===e.draggablePercent?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(t){let{top:n,bottom:a,left:s,right:i}=r.current.getBoundingClientRect();"touchend"!==t.nativeEvent.type&&e.pauseOnHover&&t.clientX>=s&&t.clientX<=i&&t.clientY>=n&&t.clientY<=a?p():h()}};return o&&l&&(g.onMouseEnter=p,e.stacked||(g.onMouseLeave=h)),d&&(g.onClick=e=>{u&&u(e),i.canCloseOnClick&&c(!0)}),{playToast:h,pauseToast:p,isRunning:t,preventExitTransition:a,toastRef:r,eventHandlers:g}}_n.loading=(e,t)=>wn(e,kn("default",Lt({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},t))),_n.promise=function(e,t,n){let a,{pending:s,error:r,success:i}=t;s&&(a=Jt(s)?_n.loading(s,n):_n.loading(s.render,Lt(Lt({},n),s)));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,s)=>{if(null==t)return void _n.dismiss(a);let r=Lt(Lt(Lt({type:e},o),n),{},{data:s}),i=Jt(t)?{render:t}:t;return a?_n.update(a,Lt(Lt({},r),i)):_n(i.render,Lt(Lt({},r),i)),s},c=Qt(e)?e():e;return c.then(e=>l("success",i,e)).catch(e=>l("error",r,e)),c},_n.success=Nn("success"),_n.info=Nn("info"),_n.error=Nn("error"),_n.warning=Nn("warning"),_n.warn=_n.warning,_n.dark=(e,t)=>wn(e,kn("default",Lt({theme:"dark"},t))),_n.dismiss=function(e){gn(e)},_n.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};un.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})},_n.isActive=fn,_n.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=((e,t)=>{let{containerId:n}=t;var a;return null==(a=un.get(n||1))?void 0:a.toasts.get(e)})(e,t);if(n){let{props:a,content:s}=n,r=Lt(Lt(Lt({delay:100},a),t),{},{toastId:t.toastId||e,updateId:ln()});r.toastId!==e&&(r.staleId=e);let i=r.render||s;delete r.render,wn(i,r)}},_n.done=e=>{_n.update(e,{progress:1})},_n.onChange=function(e){return hn.add(e),()=>{hn.delete(e)}},_n.play=e=>yn(!0,e),_n.pause=e=>yn(!1,e);var Cn="undefined"!=typeof window?B.useLayoutEffect:B.useEffect,jn=e=>{let{theme:t,type:n,isLoading:a}=e,s=pt(e,Xt);return B.createElement("svg",Lt({viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===t?"currentColor":"var(--toastify-icon-color-".concat(n,")")},s))};var Tn={info:function(e){return B.createElement(jn,Lt({},e),B.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return B.createElement(jn,Lt({},e),B.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return B.createElement(jn,Lt({},e),B.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return B.createElement(jn,Lt({},e),B.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return B.createElement("div",{className:"Toastify__spinner"})}};function In(e){let{theme:t,type:n,isLoading:a,icon:s}=e,r=null,i={theme:t,type:n};return!1===s||(Qt(s)?r=s(Lt(Lt({},i),{},{isLoading:a})):(0,B.isValidElement)(s)?r=(0,B.cloneElement)(s,i):a?r=Tn.spinner():(e=>e in Tn)(n)&&(r=Tn[n](i))),r}var En=e=>{let{isRunning:t,preventExitTransition:n,toastRef:a,eventHandlers:s,playToast:r}=Sn(e),{closeButton:i,children:o,autoClose:l,onClick:c,type:u,hideProgressBar:d,closeToast:h,transition:p,position:m,className:f,style:g,progressClassName:x,updateId:y,role:b,progress:v,rtl:w,toastId:k,deleteToast:N,isIn:_,isLoading:S,closeOnClick:C,theme:j,ariaLabel:T}=e,I=Zt("Toastify__toast","Toastify__toast-theme--".concat(j),"Toastify__toast--".concat(u),{"Toastify__toast--rtl":w},{"Toastify__toast--close-on-click":C}),E=Qt(f)?f({rtl:w,position:m,type:u,defaultClassName:I}):Zt(I,f),A=In(e),R=!!v||!l,M={closeToast:h,type:u,theme:j},L=null;return!1===i||(L=Qt(i)?i(M):(0,B.isValidElement)(i)?(0,B.cloneElement)(i,M):function(e){let{closeToast:t,theme:n,ariaLabel:a="close"}=e;return B.createElement("button",{className:"Toastify__close-button Toastify__close-button--".concat(n),type:"button",onClick:e=>{e.stopPropagation(),t(!0)},"aria-label":a},B.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},B.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(M)),B.createElement(p,{isIn:_,done:N,position:m,preventExitTransition:n,nodeRef:a,playToast:r},B.createElement("div",Lt(Lt({id:k,tabIndex:0,onClick:c,"data-in":_,className:E},s),{},{style:g,ref:a},_&&{role:b,"aria-label":T}),null!=A&&B.createElement("div",{className:Zt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!S})},A),sn(o,e,!t),L,!e.customProgressBar&&B.createElement(rn,Lt(Lt({},y&&!R?{key:"p-".concat(y)}:{}),{},{rtl:w,theme:j,delay:l,isRunning:t,isIn:_,closeToast:h,hide:d,type:u,className:x,controlledProgress:R,progress:v||0}))))},An=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{enter:"Toastify--animate Toastify__".concat(e,"-enter"),exit:"Toastify--animate Toastify__".concat(e,"-exit"),appendPosition:t}},Rn=nn(An("bounce",!0)),Mn=(nn(An("slide",!0)),nn(An("zoom")),nn(An("flip")),{position:"top-right",transition:Rn,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&"KeyT"===e.code});function Ln(e){let t=Lt(Lt({},Mn),e),n=e.stacked,[a,s]=(0,B.useState)(!0),r=(0,B.useRef)(null),{getToastToRender:i,isToastActive:o,count:l}=function(e){var t;let{subscribe:n,getSnapshot:a,setProps:s}=(0,B.useRef)(bn(e)).current;s(e);let r=null==(t=(0,B.useSyncExternalStore)(n,a,a))?void 0:t.slice();return{getToastToRender:function(t){if(!r)return[];let n=new Map;return e.newestOnTop&&r.reverse(),r.forEach(e=>{let{position:t}=e.props;n.has(t)||n.set(t,[]),n.get(t).push(e)}),Array.from(n,e=>t(e[0],e[1]))},isToastActive:fn,count:null==r?void 0:r.length}}(t),{className:c,style:u,rtl:d,containerId:h,hotKeys:p}=t;function m(e){let t=Zt("Toastify__toast-container","Toastify__toast-container--".concat(e),{"Toastify__toast-container--rtl":d});return Qt(c)?c({position:e,rtl:d,defaultClassName:t}):Zt(t,$t(c))}function f(){n&&(s(!0),_n.play())}return Cn(()=>{var e;if(n){let n=r.current.querySelectorAll('[data-in="true"]'),s=12,i=null==(e=t.position)?void 0:e.includes("top"),o=0,l=0;Array.from(n).reverse().forEach((e,t)=>{let n=e;n.classList.add("Toastify__toast--stacked"),t>0&&(n.dataset.collapsed="".concat(a)),n.dataset.pos||(n.dataset.pos=i?"top":"bot");let r=o*(a?.2:1)+(a?0:s*t);n.style.setProperty("--y","".concat(i?r:-1*r,"px")),n.style.setProperty("--g","".concat(s)),n.style.setProperty("--s","".concat(1-(a?l:0))),o+=n.offsetHeight,l+=.025})}},[a,l,n]),(0,B.useEffect)(()=>{function e(e){var t;let n=r.current;p(e)&&(null==(t=n.querySelector('[tabIndex="0"]'))||t.focus(),s(!1),_n.pause()),"Escape"===e.key&&(document.activeElement===n||null!=n&&n.contains(document.activeElement))&&(s(!0),_n.play())}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[p]),B.createElement("section",{ref:r,className:"Toastify",id:h,onMouseEnter:()=>{n&&(s(!1),_n.pause())},onMouseLeave:f,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},i((e,t)=>{let a=t.length?Lt({},u):Lt(Lt({},u),{},{pointerEvents:"none"});return B.createElement("div",{tabIndex:-1,className:m(e),"data-stacked":n,style:a,key:"c-".concat(e)},t.map(e=>{let{content:t,props:a}=e;return B.createElement(En,Lt(Lt({},a),{},{stacked:n,collapseAll:f,isIn:o(a.toastId,a.containerId),key:"t-".concat(a.key)}),t)}))}))}function Dn(e){const t=JSON.parse(localStorage.getItem("bookings")||"[]");e.status=e.status||"Active",t.push(e),localStorage.setItem("bookings",JSON.stringify(t))}function On(){return JSON.parse(localStorage.getItem("bookings")||"[]")}function Fn(){return On().filter(e=>"Active"===e.status||"Confirmed"===e.status||"Pending Payment"===e.status)}function Pn(){return Fn().length>0}function zn(e,t){const n=On().map(n=>n.id===e?Lt(Lt({},n),{},{status:t}):n);return localStorage.setItem("bookings",JSON.stringify(n)),n}const Bn=function(e){let{label:t,value:n,onChange:a,placeholder:s,allowCurrentLocation:r=!1}=e;const[i,o]=(0,B.useState)("manual"),[l,c]=(0,B.useState)(!1),[u,d]=(0,B.useState)({country:"",state:"",city:"",district:"",landmark:""}),h=(e,t)=>{const n=Lt(Lt({},u),{},{[e]:t});d(n);const s=Object.values(n).filter(e=>""!==e.trim()).join(", ");a(s)};return(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsxs)("label",{className:"block text-lg font-medium mb-2",children:[t,":"]}),(0,Dt.jsxs)("div",{className:"flex mb-2 space-x-2",children:[(0,Dt.jsx)("button",{type:"button",className:"px-3 py-1 rounded-md text-sm font-medium ".concat("manual"===i?"bg-primary-600 text-white":"bg-gray-200 text-gray-700"),onClick:()=>o("manual"),children:"Manual Entry"}),r&&(0,Dt.jsx)("button",{type:"button",className:"px-3 py-1 rounded-md text-sm font-medium ".concat("current"===i?"bg-primary-600 text-white":"bg-gray-200 text-gray-700"),onClick:()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{const t="Current Location (".concat(e.coords.latitude.toFixed(4),", ").concat(e.coords.longitude.toFixed(4),")");a(t),o("current")},e=>{console.error("Error getting location:",e);let t="Unable to retrieve your location. ";switch(e.code){case e.PERMISSION_DENIED:t+="Please allow location access in your browser settings.";break;case e.POSITION_UNAVAILABLE:t+="Location information is currently unavailable.";break;case e.TIMEOUT:t+="Location request timed out.";break;default:t+="Please enter your location manually."}alert(t)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}):alert("Geolocation is not supported by this browser. Please enter your location manually.")},children:"Use Current Location"}),(0,Dt.jsx)("button",{type:"button",className:"px-3 py-1 rounded-md text-sm font-medium ".concat(l?"bg-primary-600 text-white":"bg-gray-200 text-gray-700"),onClick:()=>{c(!l)},children:l?"Simple Entry":"Detailed Entry"})]}),"manual"===i&&!l&&(0,Dt.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:s,value:n,onChange:e=>{a(e.target.value),o("manual")}}),"manual"===i&&l&&(0,Dt.jsxs)("div",{className:"space-y-2 border border-primary-300 rounded-md p-3",children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Country"}),(0,Dt.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary-500",value:u.country,onChange:e=>h("country",e.target.value),placeholder:"Country"})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),(0,Dt.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary-500",value:u.state,onChange:e=>h("state",e.target.value),placeholder:"State"})]})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),(0,Dt.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary-500",value:u.city,onChange:e=>h("city",e.target.value),placeholder:"City"})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"District"}),(0,Dt.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary-500",value:u.district,onChange:e=>h("district",e.target.value),placeholder:"District"})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Landmark"}),(0,Dt.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-primary-500",value:u.landmark,onChange:e=>h("landmark",e.target.value),placeholder:"Landmark or specific location"})]})]}),"manual"===i&&(0,Dt.jsxs)("button",{type:"button",className:"mt-2 flex items-center text-primary-600 hover:text-primary-700 text-sm font-medium",onClick:()=>alert("Map selection would open here in a real application"),children:[(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),"Select on Map"]})]})},Wn=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Vn=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},Un=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var Hn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Gn=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],qn=(0,B.forwardRef)((e,t)=>{let{color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:i="",children:o,iconNode:l}=e,c=pt(e,Gn);return(0,B.createElement)("svg",Lt(Lt(Lt({ref:t},Hn),{},{width:a,height:a,stroke:n,strokeWidth:r?24*Number(s)/Number(a):s,className:Un("lucide",i)},!o&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"}),c),[...l.map(e=>{let[t,n]=e;return(0,B.createElement)(t,n)}),...Array.isArray(o)?o:[o]])}),Kn=["className"],Zn=(e,t)=>{const n=(0,B.forwardRef)((n,a)=>{let{className:s}=n,r=pt(n,Kn);return(0,B.createElement)(qn,Lt({ref:a,iconNode:t,className:Un("lucide-".concat(Wn(Vn(e))),"lucide-".concat(e),s)},r))});return n.displayName=Vn(e),n},Xn=Zn("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Yn=[{name:"Flight",icon:"\u2708\ufe0f"},{name:"Train",icon:"\ud83d\ude86"},{name:"Bus",icon:"\ud83d\ude8c"},{name:"Car",icon:"\ud83d\ude97"},{name:"Bike",icon:"\ud83c\udfcd\ufe0f"},{name:"Auto",icon:"\ud83d\udefa"}],Jn={Flight:5999,Train:1499,Bus:899,Car:2499,Bike:1299,Auto:599};const Qn=function(){const e=Oe(),{isAuthenticated:t}=Pt(),[n,a]=(0,B.useState)("Flight"),[s,r]=(0,B.useState)(""),[i,o]=(0,B.useState)(""),[l,c]=(0,B.useState)(Jn.Flight),[u,d]=(0,B.useState)(!1),[h,p]=(0,B.useState)(""),[m,f]=(0,B.useState)(""),[g,x]=(0,B.useState)(!1);return(0,B.useEffect)(()=>{t()||e("/login",{state:{from:"/booking"}}),x(Pn())},[t,e]),(0,Dt.jsxs)("div",{className:"max-w-2xl mx-auto py-10 px-4",children:[g&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-6 text-primary-700",children:"Book Your Transport"}),(0,Dt.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),g)return void alert("You already have an active booking. Please complete or delete your current booking before making a new one.");if(!s||!i)return void alert("Please enter both pickup and destination addresses.");Dn({id:"BK-".concat(Date.now().toString().slice(-6)),from:s,to:i,type:n,price:l,date:h||(new Date).toLocaleDateString(),time:m||(new Date).toLocaleTimeString(),status:"Active",details:{"Booking ID":"BK-".concat(Date.now().toString().slice(-6)),Traveler:"You",Payment:"Completed"}}),d(!0),r(""),o(""),p(""),f(""),a("Flight"),c(Jn.Flight),setTimeout(()=>{d(!1),e("/dashboard")},1500)},children:[(0,Dt.jsx)(Bn,{label:"From",value:s,onChange:r,placeholder:"Enter your pickup location",allowCurrentLocation:!0}),(0,Dt.jsx)(Bn,{label:"To",value:i,onChange:o,placeholder:"Enter your destination",allowCurrentLocation:!1}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-lg font-medium mb-2",children:"Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:h,onChange:e=>p(e.target.value)})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-lg font-medium mb-2",children:"Time:"}),(0,Dt.jsx)("input",{type:"time",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:m,onChange:e=>f(e.target.value)})]})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("label",{className:"block text-lg font-medium mb-2",children:"Select Mode of Transport:"}),(0,Dt.jsx)("div",{className:"flex gap-4 flex-wrap",children:Yn.map(t=>(0,Dt.jsxs)("button",{type:"button",className:"px-4 py-2 rounded-md border ".concat(n===t.name?"bg-primary-600 text-white":"bg-white text-primary-700 border-primary-300"," font-medium flex items-center gap-2"),onClick:()=>(t=>{a(t),c(Jn[t]),Pn()?alert("You already have an active booking. Please complete or delete your current booking before making a new one."):"Flight"===t?e("/booking/flight"):"Train"===t?e("/booking/train"):"Car"===t?e("/booking/cabs"):"Bike"===t?e("/booking/bikes"):"Auto"===t?e("/booking/auto"):"Bus"===t&&e("/booking/metro")})(t.name),children:[(0,Dt.jsx)("span",{children:t.icon})," ",t.name]},t.name))})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("label",{className:"block text-lg font-medium mb-2",children:"Ticket Price:"}),(0,Dt.jsxs)("div",{className:"text-xl font-semibold text-primary-700",children:["\u20b9 ",l]})]}),(0,Dt.jsx)("button",{type:"submit",className:"w-full bg-primary-600 text-white py-3 rounded-md font-bold hover:bg-primary-700 transition",children:"Book Now"}),u&&(0,Dt.jsx)("div",{className:"mt-4 text-green-600 font-semibold text-center",children:"Booking successful! Redirecting to dashboard..."})]})]})},$n=[{id:"r1",name:"Spice Villa",description:"Authentic Indian cuisine with a modern twist.",reviews:["Amazing food and great ambiance!","Loved the butter chicken and naan."],area:"Mumbai",image:n(105),price:1200,cuisine:"North Indian, Mughlai",rating:4.5,timings:"11:00 AM - 11:00 PM",address:"123 Food Street, Mumbai",menu:[{name:"Butter Chicken",price:350},{name:"Paneer Tikka",price:280},{name:"Dal Makhani",price:220},{name:"Naan",price:60},{name:"Biryani",price:320}]},{id:"r2",name:"Green Leaf",description:"Vegetarian and vegan-friendly restaurant.",reviews:["Healthy and tasty options.","Fresh salads and juices!"],area:"Delhi",image:n(728),price:800,cuisine:"Vegetarian, Healthy",rating:4.2,timings:"9:00 AM - 10:00 PM",address:"456 Veg Lane, Delhi",menu:[{name:"Veg Thali",price:250},{name:"Fruit Salad",price:180},{name:"Fresh Juice",price:120},{name:"Veg Sandwich",price:150},{name:"Soup",price:140}]}],ea=[{id:"h1",name:"Grand Palace Hotel",description:"5-star hotel with luxury amenities and city views.",reviews:["Excellent service and clean rooms.","Great location for tourists."],area:"Mumbai",image:n(553),price:8500,rating:4.8,amenities:["Swimming Pool","Spa","Gym","Restaurant","Room Service"],address:"789 Luxury Avenue, Mumbai",roomTypes:[{type:"Deluxe Room",price:8500,capacity:2},{type:"Executive Suite",price:12e3,capacity:2},{type:"Family Room",price:15e3,capacity:4}]},{id:"h2",name:"Comfort Stay",description:"Affordable and comfortable stay for families.",reviews:["Very budget-friendly.","Staff was very helpful."],area:"Delhi",image:n(16),price:3500,rating:4,amenities:["Free Wi-Fi","Breakfast","Parking","Air Conditioning"],address:"101 Budget Road, Delhi",roomTypes:[{type:"Standard Room",price:3500,capacity:2},{type:"Deluxe Room",price:4500,capacity:2},{type:"Family Room",price:6e3,capacity:4}]}];const ta=function(){const e=Oe(),{addToCart:t}=Bt(),[n,a]=(0,B.useState)("Mumbai"),[s,r]=(0,B.useState)(null),[i,o]=(0,B.useState)(!1),[l,c]=(0,B.useState)(""),[u,d]=(0,B.useState)(""),[h,p]=(0,B.useState)(""),[m,f]=(0,B.useState)(1),[g,x]=(0,B.useState)(""),[y,b]=(0,B.useState)(""),[v,w]=(0,B.useState)(""),[k,N]=(0,B.useState)(2),[_,S]=(0,B.useState)(!1),C=$n.filter(e=>e.area===n),j=ea.filter(e=>e.area===n),T=(e,t)=>{_?alert("You already have an active booking. Please complete or delete your current booking before making a new one."):(r(e),c(t),o(!0),"hotel"===t?(d(""),p(""),f(1),x(e.roomTypes[0].type)):(b(""),w(""),N(2)))};return(0,B.useEffect)(()=>{S(Pn())},[]),(0,Dt.jsxs)("div",{className:"max-w-4xl mx-auto py-10 px-4",children:[_&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-6 text-primary-700",children:"Hotels & Restaurants"}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("label",{className:"block text-lg font-medium mb-2",children:"Select Area:"}),(0,Dt.jsxs)("select",{className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:n,onChange:e=>a(e.target.value),children:[(0,Dt.jsx)("option",{value:"Mumbai",children:"Mumbai"}),(0,Dt.jsx)("option",{value:"Delhi",children:"Delhi"})]})]}),(0,Dt.jsxs)("div",{className:"mb-8",children:[(0,Dt.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-primary-600",children:"Restaurants"}),C.map((e,t)=>(0,Dt.jsxs)("div",{className:"mb-6 p-4 border rounded-lg bg-white shadow flex flex-col md:flex-row items-start gap-4 cursor-pointer hover:shadow-lg transition",onClick:()=>T(e,"restaurant"),children:[(0,Dt.jsx)("img",{src:e.image,alt:e.name,className:"w-32 h-32 object-cover rounded-lg border"}),(0,Dt.jsxs)("div",{className:"flex-grow",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("div",{className:"font-bold text-lg",children:e.name}),(0,Dt.jsx)("div",{className:"text-gray-600 mb-2",children:e.description})]}),(0,Dt.jsxs)("div",{className:"text-primary-600 font-bold",children:["\u20b9",e.price," for two"]})]}),(0,Dt.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,Dt.jsx)("span",{className:"mr-3",children:e.cuisine}),(0,Dt.jsx)("span",{className:"mr-3",children:"\u2022"}),(0,Dt.jsxs)("span",{className:"flex items-center",children:[(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-yellow-500 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),e.rating]})]}),(0,Dt.jsx)("div",{className:"text-sm text-primary-700 font-medium mb-1",children:"Reviews:"}),(0,Dt.jsx)("ul",{className:"list-disc ml-6 text-gray-700 text-sm",children:e.reviews.map((e,t)=>(0,Dt.jsx)("li",{children:e},t))}),(0,Dt.jsx)("button",{className:"mt-3 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition",onClick:t=>{t.stopPropagation(),T(e,"restaurant")},children:"Book a Table"})]})]},t))]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-primary-600",children:"Nearby Hotels"}),j.map((t,n)=>(0,Dt.jsxs)("div",{className:"mb-6 p-4 border rounded-lg bg-white shadow flex flex-col md:flex-row items-start gap-4 cursor-pointer hover:shadow-lg transition",onClick:()=>T(t,"hotel"),children:[(0,Dt.jsx)("img",{src:t.image,alt:t.name,className:"w-32 h-32 object-cover rounded-lg border"}),(0,Dt.jsxs)("div",{className:"flex-grow",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("div",{className:"font-bold text-lg",children:t.name}),(0,Dt.jsx)("div",{className:"text-gray-600 mb-2",children:t.description})]}),(0,Dt.jsxs)("div",{className:"text-primary-600 font-bold",children:["\u20b9",t.price," / night"]})]}),(0,Dt.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,Dt.jsx)("span",{className:"mr-3",children:t.address}),(0,Dt.jsx)("span",{className:"mr-3",children:"\u2022"}),(0,Dt.jsxs)("span",{className:"flex items-center",children:[(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-yellow-500 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),t.rating]})]}),(0,Dt.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:t.amenities.map((e,t)=>(0,Dt.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-xs rounded-full",children:e},t))}),(0,Dt.jsx)("div",{className:"text-sm text-primary-700 font-medium mb-1",children:"Reviews:"}),(0,Dt.jsx)("ul",{className:"list-disc ml-6 text-gray-700 text-sm",children:t.reviews.map((e,t)=>(0,Dt.jsx)("li",{children:e},t))}),(0,Dt.jsx)("button",{className:"mt-3 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition",onClick:n=>{n.stopPropagation();localStorage.getItem("user")?T(t,"hotel"):e("/login?redirect=/hotels-restaurants")},children:"Book Now"})]})]},n))]}),i&&"hotel"===l&&s&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-bold mb-4",children:s.name}),(0,Dt.jsx)("p",{className:"text-gray-600 mb-4",children:"Complete your booking details"}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Room Type:"}),(0,Dt.jsx)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:g,onChange:e=>x(e.target.value),children:s.roomTypes.map((e,t)=>(0,Dt.jsxs)("option",{value:e.type,children:[e.type," - \u20b9",e.price," (Up to ",e.capacity," guests)"]},t))})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Check-in Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:u,onChange:e=>d(e.target.value),min:(new Date).toISOString().split("T")[0]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Check-out Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:h,onChange:e=>p(e.target.value),min:u||(new Date).toISOString().split("T")[0]})]})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Number of Guests:"}),(0,Dt.jsx)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:m,onChange:e=>f(parseInt(e.target.value)),children:[1,2,3,4,5,6].map(e=>(0,Dt.jsxs)("option",{value:e,children:[e," ",1===e?"Guest":"Guests"]},e))})]}),(0,Dt.jsxs)("div",{className:"flex gap-4",children:[(0,Dt.jsx)("button",{onClick:()=>o(!1),className:"flex-1 py-2 border border-gray-300 rounded-md font-medium hover:bg-gray-50 transition",children:"Cancel"}),(0,Dt.jsx)("button",{onClick:()=>{if(_)return void alert("You already have an active booking. Please complete or delete your current booking before making a new one.");if(!u||!h)return void alert("Please select check-in and check-out dates");const e=s.roomTypes.find(e=>e.type===g),n=new Date(u),a=new Date(h),r=Math.ceil((a-n)/864e5);if(r<=0)return void alert("Check-out date must be after check-in date");const i={id:"HT-".concat(Date.now().toString().slice(-6)),type:"Hotel",name:s.name,roomType:g,checkIn:u,checkOut:h,guests:m,nights:r,price:e.price*r,address:s.address,image:s.image};t(i),o(!1),alert("Hotel booking added to cart!")},className:"flex-1 bg-primary-600 text-white py-2 rounded-md font-medium hover:bg-primary-700 transition",children:"Add to Cart"})]})]})}),i&&"restaurant"===l&&s&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-bold mb-4",children:s.name}),(0,Dt.jsx)("p",{className:"text-gray-600 mb-4",children:"Reserve a table"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:y,onChange:e=>b(e.target.value),min:(new Date).toISOString().split("T")[0]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Time:"}),(0,Dt.jsx)("input",{type:"time",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:v,onChange:e=>w(e.target.value)})]})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Number of Diners:"}),(0,Dt.jsx)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:k,onChange:e=>N(parseInt(e.target.value)),children:[1,2,3,4,5,6,7,8].map(e=>(0,Dt.jsxs)("option",{value:e,children:[e," ",1===e?"Person":"People"]},e))})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Popular Menu Items:"}),(0,Dt.jsx)("div",{className:"bg-gray-50 p-3 rounded-md",children:(0,Dt.jsx)("ul",{className:"space-y-1",children:s.menu.map((e,t)=>(0,Dt.jsxs)("li",{className:"flex justify-between text-sm",children:[(0,Dt.jsx)("span",{children:e.name}),(0,Dt.jsxs)("span",{className:"font-medium",children:["\u20b9",e.price]})]},t))})})]}),(0,Dt.jsxs)("div",{className:"flex gap-4",children:[(0,Dt.jsx)("button",{onClick:()=>o(!1),className:"flex-1 py-2 border border-gray-300 rounded-md font-medium hover:bg-gray-50 transition",children:"Cancel"}),(0,Dt.jsx)("button",{onClick:()=>{if(_)return void alert("You already have an active booking. Please complete or delete your current booking before making a new one.");if(!y||!v)return void alert("Please select reservation date and time");const e={id:"RS-".concat(Date.now().toString().slice(-6)),type:"Restaurant",name:s.name,date:y,time:v,diners:k,price:Math.round(s.price*k/2),address:s.address,cuisine:s.cuisine,image:s.image};t(e),o(!1),alert("Restaurant reservation added to cart!")},className:"flex-1 bg-primary-600 text-white py-2 rounded-md font-medium hover:bg-primary-700 transition",children:"Add to Cart"})]})]})})]})};function na(e,t){return Object.freeze(Lt(Lt({},e),t))}const aa=(0,B.createContext)(null),sa=aa.Provider;function ra(){const e=(0,B.useContext)(aa);if(null==e)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var ia=n(228),oa=n.n(ia);const la=["bounds","boundsOptions","center","children","className","id","placeholder","style","whenReady","zoom"];function ca(){return ca=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ca.apply(this,arguments)}function ua(e,t){let{bounds:n,boundsOptions:a,center:s,children:r,className:i,id:o,placeholder:l,style:c,whenReady:u,zoom:d}=e,h=pt(e,la);const[p]=(0,B.useState)({className:i,id:o,style:c}),[m,f]=(0,B.useState)(null);(0,B.useImperativeHandle)(t,()=>{var e;return null!==(e=null===m||void 0===m?void 0:m.map)&&void 0!==e?e:null},[m]);const g=(0,B.useCallback)(e=>{if(null!==e&&null===m){const t=new ia.Map(e,h);null!=s&&null!=d?t.setView(s,d):null!=n&&t.fitBounds(n,a),null!=u&&t.whenReady(u),f(function(e){return Object.freeze({__version:1,map:e})}(t))}},[]);(0,B.useEffect)(()=>()=>{null===m||void 0===m||m.map.remove()},[m]);const x=m?B.createElement(sa,{value:m},r):null!==l&&void 0!==l?l:null;return B.createElement("div",ca({},p,{ref:g}),x)}const da=(0,B.forwardRef)(ua);function ha(e){function t(t,n){const{instance:a,context:s}=e(t).current;return(0,B.useImperativeHandle)(n,()=>a),null==t.children?null:B.createElement(sa,{value:s},t.children)}return(0,B.forwardRef)(t)}function pa(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function ma(e,t){return null==t?function(t,n){const a=(0,B.useRef)();return a.current||(a.current=e(t,n)),a}:function(n,a){const s=(0,B.useRef)();s.current||(s.current=e(n,a));const r=(0,B.useRef)(n),{instance:i}=s.current;return(0,B.useEffect)(function(){r.current!==n&&(t(i,n,r.current),r.current=n)},[i,n,a]),s}}function fa(e,t){const n=(0,B.useRef)(t);(0,B.useEffect)(function(){t!==n.current&&null!=e.attributionControl&&(null!=n.current&&e.attributionControl.removeAttribution(n.current),null!=t&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}function ga(e,t){const n=(0,B.useRef)();(0,B.useEffect)(function(){return null!=t&&e.instance.on(t),n.current=t,function(){null!=n.current&&e.instance.off(n.current),n.current=null}},[e,t])}function xa(e,t){var n;const a=null!==(n=e.pane)&&void 0!==n?n:t.pane;return a?Lt(Lt({},e),{},{pane:a}):e}function ya(e,t){(0,B.useEffect)(function(){var n;return(null!==(n=t.layerContainer)&&void 0!==n?n:t.map).addLayer(e.instance),function(){var n;null===(n=t.layerContainer)||void 0===n||n.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function ba(e){return function(t){const n=ra(),a=e(xa(t,n),n);return fa(n.map,t.attribution),ga(a.current,t.eventHandlers),ya(a.current,n),a}}function va(e){return function(t){const n=ra(),a=e(xa(t,n),n);return ga(a.current,t.eventHandlers),ya(a.current,n),function(e,t){const n=(0,B.useRef)();(0,B.useEffect)(function(){if(t.pathOptions!==n.current){var a;const s=null!==(a=t.pathOptions)&&void 0!==a?a:{};e.instance.setStyle(s),n.current=s}},[e,t])}(a.current,t),a}}function wa(e,t){const n=function(e,t){return function(n,a){const s=ra(),r=e(xa(n,s),s);return fa(s.map,n.attribution),ga(r.current,n.eventHandlers),t(r.current,s,n,a),r}}(ma(e),t);return function(e){function t(t,n){const[a,s]=(0,B.useState)(!1),{instance:r}=e(t,s).current;(0,B.useImperativeHandle)(n,()=>r),(0,B.useEffect)(function(){a&&r.update()},[r,a,t.children]);const i=r._contentNode;return i?(0,tt.createPortal)(t.children,i):null}return(0,B.forwardRef)(t)}(n)}function ka(e,t){return ha(va(ma(e,t)))}const Na=["url"],_a=function(e){function t(t,n){const{instance:a}=e(t).current;return(0,B.useImperativeHandle)(n,()=>a),null}return(0,B.forwardRef)(t)}(ba(ma(function(e,t){let{url:n}=e,a=pt(e,Na);return pa(new ia.TileLayer(n,xa(a,t)),t)},function(e,t,n){!function(e,t,n){const{opacity:a,zIndex:s}=t;null!=a&&a!==n.opacity&&e.setOpacity(a),null!=s&&s!==n.zIndex&&e.setZIndex(s)}(e,t,n);const{url:a}=t;null!=a&&a!==n.url&&e.setUrl(a)})));function Sa(){return ra().map}function Ca(e,t,n){t.center!==n.center&&e.setLatLng(t.center),null!=t.radius&&t.radius!==n.radius&&e.setRadius(t.radius)}const ja=["center","children"],Ta=ka(function(e,t){let{center:n,children:a}=e,s=pt(e,ja);const r=new ia.CircleMarker(n,s);return pa(r,na(t,{overlayContainer:r}))},Ca),Ia=["position"],Ea=function(e,t){return ha(ba(ma(e,t)))}(function(e,t){let{position:n}=e,a=pt(e,Ia);const s=new ia.Marker(n,a);return pa(s,na(t,{overlayContainer:s}))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}),Aa=wa(function(e,t){return pa(new ia.Popup(e,t.overlayContainer),t)},function(e,t,n,a){let{position:s}=n;(0,B.useEffect)(function(){const{instance:n}=e;function r(e){e.popup===n&&(n.update(),a(!0))}function i(e){e.popup===n&&a(!1)}return t.map.on({popupopen:r,popupclose:i}),null==t.overlayContainer?(null!=s&&n.setLatLng(s),n.openOn(t.map)):t.overlayContainer.bindPopup(n),function(){var e;t.map.off({popupopen:r,popupclose:i}),null===(e=t.overlayContainer)||void 0===e||e.unbindPopup(),t.map.removeLayer(n)}},[e,t,a,s])});function Ra(e){let{position:t,accuracy:n}=e;const a=Sa();return(0,B.useEffect)(()=>{t&&a.flyTo(t,15,{animate:!0,duration:1.5})},[a,t]),(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)(Ta,{center:t,radius:n/2,pathOptions:{color:"#3b82f6",fillColor:"#3b82f6",fillOpacity:.15}}),(0,Dt.jsx)(Ea,{position:t,children:(0,Dt.jsxs)(Aa,{children:["You are here ",(0,Dt.jsx)("br",{}),"Accuracy: ",n.toFixed(1)," meters"]})})]})}delete oa().Icon.Default.prototype._getIconUrl,oa().Icon.Default.mergeOptions({iconRetinaUrl:n(249),iconUrl:n(24),shadowUrl:n(71)});const Ma=function(){const[e,t]=(0,B.useState)(null),[n,a]=(0,B.useState)(null),[s,r]=(0,B.useState)(!1),i=(0,B.useRef)(null);return(0,B.useEffect)(()=>()=>{i.current&&navigator.geolocation.clearWatch(i.current)},[]),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Dt.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Live Location"}),(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:s?"Tracking your location in real-time":"Start tracking to see your location"})]}),(0,Dt.jsx)("div",{children:s?(0,Dt.jsx)("button",{onClick:()=>{i.current&&(navigator.geolocation.clearWatch(i.current),i.current=null,r(!1))},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Stop Tracking"}):(0,Dt.jsx)("button",{onClick:()=>{navigator.geolocation?(r(!0),i.current=navigator.geolocation.watchPosition(e=>{t({lat:e.coords.latitude,lng:e.coords.longitude,accuracy:e.coords.accuracy,timestamp:e.timestamp}),a(null)},e=>{a("Error: ".concat(e.message)),console.error("Error getting location:",e)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:1e4})):a("Geolocation is not supported by this browser.")},className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",children:"Start Tracking"})})]}),(0,Dt.jsx)("div",{className:"relative h-96 w-full",children:n?(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:(0,Dt.jsxs)("div",{className:"text-center p-4 text-red-600",children:[(0,Dt.jsx)("svg",{className:"mx-auto h-12 w-12",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,Dt.jsx)("p",{className:"mt-2 text-sm",children:n})]})}):(0,Dt.jsxs)("div",{className:"h-full w-full",children:[(0,Dt.jsxs)(da,{center:e?[e.lat,e.lng]:[20.5937,78.9629],zoom:e?15:5,style:{height:"100%",width:"100%"},children:[(0,Dt.jsx)(_a,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e&&(0,Dt.jsx)(Ra,{position:[e.lat,e.lng],accuracy:e.accuracy})]}),e&&(0,Dt.jsx)("div",{className:"absolute bottom-4 left-4 right-4 bg-white bg-opacity-90 p-3 rounded-md shadow-md z-[1000]",children:(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("span",{className:"font-medium",children:"Latitude:"})," ",e.lat.toFixed(6)]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("span",{className:"font-medium",children:"Longitude:"})," ",e.lng.toFixed(6)]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("span",{className:"font-medium",children:"Accuracy:"})," ",e.accuracy.toFixed(1)," meters"]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("span",{className:"font-medium",children:"Updated:"})," ",new Date(e.timestamp).toLocaleTimeString()]})]})}),!e&&!s&&(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,Dt.jsxs)("div",{className:"text-center p-4",children:[(0,Dt.jsxs)("svg",{className:"mx-auto h-12 w-12 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,Dt.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:'Click "Start Tracking" to see your location'})]})})]})}),(0,Dt.jsx)("div",{className:"p-4 bg-gray-50 border-t border-gray-200",children:(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Powered by OpenStreetMap and Leaflet. Location accuracy depends on your device's GPS capabilities."})})]})},La=Zn("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Da=Zn("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Oa=Zn("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Fa=Zn("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),Pa=Zn("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),za=Zn("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Ba=Zn("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Wa=Zn("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);class Va{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Ua{refCount(e){return Ha("refCount")}incRef(e){return Ha("incRef")}timerAvailable(){return!0}time(e){return Ha("time")}read(e){return Ha("read")}readSync(e){return Ha("readSync")}readToGPU(e,t){return Ha("readToGPU")}numDataIds(){return Ha("numDataIds")}disposeData(e,t){return Ha("disposeData")}write(e,t,n){return Ha("write")}move(e,t,n,a,s){return Ha("move")}createTensorFromGPUData(e,t,n){return Ha("createTensorFromGPUData")}memory(){return Ha("memory")}floatPrecision(){return Ha("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return Ha("dispose")}}function Ha(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function Ga(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,Xa(e,t,n)}function qa(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(e.length)+"Second array length was ".concat(t.length));let n=e.length,a=0;for(;n>0;)a=Math.random()*n|0,n--,Xa(e,n,a),Xa(t,n,a)}function Ka(e,t,n){return Math.max(e,Math.min(t,n))}function Za(e){return e%2===0?e:e+1}function Xa(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function Ya(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function Ja(e,t){const n=Math.random();return t*n+(1-n)*e}function Qa(e,t){let n=0;for(let a=0;a<e.length;a++){const s=Number(e[a])-Number(t[a]);n+=s*s}return n}function $a(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function es(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";$a(rs(e,t),()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}function ts(e){$a(null!=e,()=>"The input to the tensor constructor must be a non-null value.")}function ns(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function as(e){return 0===e.length}function ss(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}function rs(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function is(e){return e%1===0}function os(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;{const t=Math.exp(2*e);return(t-1)/(t+1)}}function ls(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function cs(e){const t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return Ga(t),t}function us(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function ds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return new Promise((s,r)=>{let i=0;const o=()=>{if(e())return void s();i++;const l=t(i);null!=n&&i>=n?r():null!=a?a(o,l):setTimeout(o,l)};o()})}function hs(e,t){let n=1,a=-1;for(let r=0;r<e.length;++r)if(e[r]>=0)n*=e[r];else if(-1===e[r]){if(-1!==a)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(a," and dim ").concat(r));a=r}else if(e[r]<0)throw Error("Shapes can not be < 0. Found ".concat(e[r]," at dim ").concat(r));if(-1===a){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));const s=e.slice();return s[a]=t/n,s}function ps(e,t){const n=t.length;return $a((e=null==e?t.map((e,t)=>t):[].concat(e)).every(e=>e>=-n&&e<n),()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)),$a(e.every(e=>is(e)),()=>"All values in axis param must be integers but "+"got axis ".concat(e)),e.map(e=>e<0?n+e:e)}function ms(e,t){const n=[],a=[],s=null!=t&&Array.isArray(t)&&0===t.length,r=null==t||s?null:ps(t,e).sort();let i=0;for(let o=0;o<e.length;++o){if(null!=r){if(r[i]===o&&1!==e[o])throw new Error("Can't squeeze axis ".concat(o," since its dim '").concat(e[o],"' is not 1"));(null==r[i]||r[i]>o)&&1===e[o]&&(n.push(e[o]),a.push(o)),r[i]<=o&&i++}1!==e[o]&&(n.push(e[o]),a.push(o))}return{newShape:n,keptDims:a}}function fs(e,t){return gs(e,t)}function gs(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function xs(e,t){for(let n=0;n<e.length;n++){const a=e[n];if(isNaN(a)||!isFinite(a))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(a,"."))}}function ys(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function bs(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function vs(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function ws(e){if(null==e)return 0;let t=0;return e.forEach(e=>t+=e.length),t}function ks(e){return"string"===typeof e||e instanceof String}function Ns(e){return"boolean"===typeof e}function _s(e){return"number"===typeof e}function Ss(e){return Array.isArray(e)?Ss(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":_s(e)?"float32":ks(e)?"string":Ns(e)?"bool":"float32"}function Cs(e){return!!(e&&e.constructor&&e.call&&e.apply)}function js(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function Ts(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let a=t-3;a>=0;--a)n[a]=n[a+1]*e[a+1];return n}function Is(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=new Array;if(1===t.length){const r=t[0]*(a?2:1);for(let t=0;t<r;t++)s[t]=n[e+t]}else{const r=t[0],i=t.slice(1),o=i.reduce((e,t)=>e*t)*(a?2:1);for(let t=0;t<r;t++)s[t]=Is(e+t*o,i,n,a)}return s}function Es(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];const a=e.reduce((e,t)=>e*t)*(n?2:1);if(0===a)return[];if(a!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return Is(0,e,t,n)}function As(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}function Rs(e,t){const n=Ms(e,t);for(let a=0;a<n.length;a++)n[a]=1;return n}function Ms(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function Ls(e,t){const n=e.reduce((e,t)=>e*t,1);if(null==t||"float32"===t)return Es(e,new Float32Array(n));if("int32"===t)return Es(e,new Int32Array(n));if("bool"===t)return Es(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function Ds(e){e.forEach(t=>{$a(Number.isInteger(t)&&t>=0,()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"]."))})}function Os(e,t,n){if(0===t)return 0;if(1===t)return e[0];let a=e[e.length-1];for(let s=0;s<e.length-1;++s)a+=n[s]*e[s];return a}function Fs(e,t,n){if(0===t)return[];if(1===t)return[e];const a=new Array(t);for(let s=0;s<a.length-1;++s)a[s]=Math.floor(e/n[s]),e-=a[s]*n[s];return a[a.length-1]=e,a}function Ps(e){return e&&e.then&&"function"===typeof e.then}const zs="tfjsflags";class Bs{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Ws,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(Vs().getBool("IS_TEST")||Vs().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];Vs().getBool("IS_TEST")||Vs().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(t,".")),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Ps(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);if(zs in e){e[zs].split(",").forEach(e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){const n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,n)})}}}function Ws(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,a[0],a[1]),a.join("=")}),t}function Vs(){return Hs}let Us,Hs=null;function Gs(){if(null==Us){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}Us=e}return Us}function qs(e,t){const n=function(){const e=Gs();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const a=t();return n.set(e,a),n.get(e)}}const Ks="Abs",Zs="Acos",Xs="Acosh",Ys="Add",Js="AddN",Qs="All",$s="Any",er="ArgMax",tr="ArgMin",nr="Asin",ar="Asinh",sr="Atan",rr="Atanh",ir="Atan2",or="AvgPool",lr="AvgPoolGrad",cr="AvgPool3D",ur="AvgPool3DGrad",dr="BatchMatMul",hr="BatchToSpaceND",pr="Bincount",mr="BitwiseAnd",fr="BroadcastTo",gr="BroadcastArgs",xr="Cast",yr="Ceil",br="ClipByValue",vr="Complex",wr="ComplexAbs",kr="Concat",Nr="Conv2D",_r="Conv2DBackpropFilter",Sr="Conv2DBackpropInput",Cr="Conv3D",jr="Conv3DBackpropFilterV2",Tr="Conv3DBackpropInputV2",Ir="Cos",Er="Cosh",Ar="Cumprod",Rr="Cumsum",Mr="CropAndResize",Lr="DenseBincount",Dr="DepthToSpace",Or="DepthwiseConv2dNative",Fr="DepthwiseConv2dNativeBackpropFilter",Pr="DepthwiseConv2dNativeBackpropInput",zr="Diag",Br="Dilation2D",Wr="Dilation2DBackpropInput",Vr="Dilation2DBackpropFilter",Ur="Draw",Hr="RealDiv",Gr="Einsum",qr="Elu",Kr="EluGrad",Zr="Erf",Xr="Equal",Yr="Exp",Jr="ExpandDims",Qr="Expm1",$r="FFT",ei="Fill",ti="FlipLeftRight",ni="Floor",ai="FloorDiv",si="FusedBatchNorm",ri="GatherV2",ii="GatherNd",oi="Greater",li="GreaterEqual",ci="Identity",ui="IFFT",di="Imag",hi="IsFinite",pi="IsInf",mi="IsNan",fi="LeakyRelu",gi="Less",xi="LessEqual",yi="LinSpace",bi="Log",vi="Log1p",wi="LogicalAnd",ki="LogicalNot",Ni="LogicalOr",_i="LogicalXor",Si="LogSoftmax",Ci="LowerBound",ji="LRN",Ti="LRNGrad",Ii="MatrixBandPart",Ei="Max",Ai="Maximum",Ri="MaxPool",Mi="MaxPoolGrad",Li="MaxPool3D",Di="MaxPool3DGrad",Oi="MaxPoolWithArgmax",Fi="Mean",Pi="Min",zi="Minimum",Bi="MirrorPad",Wi="Mod",Vi="Multinomial",Ui="Multiply",Hi="Neg",Gi="NotEqual",qi="NonMaxSuppressionV3",Ki="NonMaxSuppressionV4",Zi="NonMaxSuppressionV5",Xi="OnesLike",Yi="OneHot",Ji="Pack",Qi="PadV2",$i="Pool",eo="Pow",to="Prelu",no="Prod",ao="RaggedGather",so="RaggedRange",ro="RaggedTensorToTensor",io="Range",oo="Real",lo="Reciprocal",co="Relu",uo="Reshape",ho="ResizeNearestNeighbor",po="ResizeNearestNeighborGrad",mo="ResizeBilinear",fo="ResizeBilinearGrad",go="Relu6",xo="Reverse",yo="Round",bo="Rsqrt",vo="ScatterNd",wo="TensorScatterUpdate",ko="SearchSorted",No="Select",_o="Selu",So="Slice",Co="Sin",jo="Sinh",To="Sign",Io="Sigmoid",Eo="Softplus",Ao="Sqrt",Ro="Sum",Mo="SpaceToBatchND",Lo="SplitV",Do="Softmax",Oo="SparseFillEmptyRows",Fo="SparseReshape",Po="SparseSegmentMean",zo="SparseSegmentSum",Bo="SparseToDense",Wo="SquaredDifference",Vo="Square",Uo="StaticRegexReplace",Ho="StridedSlice",Go="StringNGrams",qo="StringSplit",Ko="StringToHashBucketFast",Zo="Sub",Xo="Tan",Yo="Tanh",Jo="Tile",Qo="TopK",$o="Transform",el="Transpose",tl="Unique",nl="Unpack",al="UnsortedSegmentSum",sl="UpperBound",rl="ZerosLike",il="Step",ol="FromPixels",ll="RotateWithOffset",cl="_FusedMatMul",ul="FusedConv2D",dl="FusedDepthwiseConv2D";function hl(){Vs().getBool("IS_TEST")||Vs().getBool("PROD")||console.warn(...arguments)}function pl(){Vs().getBool("IS_TEST")||Vs().getBool("PROD")||console.log(...arguments)}const ml=qs("kernelRegistry",()=>new Map),fl=qs("gradRegistry",()=>new Map);function gl(e,t){const n=_l(e,t);return ml.get(n)}function xl(e){return fl.get(e)}function yl(e){const t=ml.entries(),n=[];for(;;){const{done:a,value:s}=t.next();if(a)break;const[r,i]=s,[o]=r.split("_");o===e&&n.push(i)}return n}function bl(e){const{kernelName:t,backendName:n}=e,a=_l(t,n);ml.has(a)&&hl("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),ml.set(a,e)}function vl(e){const{kernelName:t}=e;fl.has(t)&&Vs().getBool("DEBUG")&&hl("Overriding the gradient for '".concat(t,"'")),fl.set(t,e)}function wl(e,t){const n=_l(e,t);if(!ml.has(n))throw new Error("The kernel '".concat(e,"' for backend ")+"'".concat(t,"' is not registered"));ml.delete(n)}function kl(e){if(!fl.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));fl.delete(e)}function Nl(e,t){yl(e).forEach(e=>{bl(Object.assign({},e,{backendName:t}))})}function _l(e,t){return"".concat(t,"_").concat(e)}function Sl(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var Cl=n(353);const jl=n.n(Cl)()||Cl;function Tl(e){return jl.fromString(e,!0,16)}const Il=Tl("c3a5c85c97cb3127"),El=Tl("b492b66fbe98f273"),Al=Tl("9ae16a3b2f90404f");function Rl(e){return e.xor(e.shru(47))}function Ml(e,t,n){const a=e.slice(t,t+n);return jl.fromBytes(Array.from(a),!0,!0)}function Ll(e,t){return Ml(e,t,8)}function Dl(e,t){return Ml(e,t,4)}function Ol(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function Fl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tl("9ddfea08eb382d69"),a=e.xor(t).mul(n);a=a.xor(a.shru(47));let s=t.xor(a).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function Pl(e,t,n,a){return function(e,t,n,a,s,r){s=s.add(e),r=Ol(r.add(s).add(a),21);const i=s;return s=(s=s.add(t)).add(n),r=r.add(Ol(s,44)),[s.add(a),r.add(i)]}(Ll(e,t),Ll(e,t+8),Ll(e,t+16),Ll(e,t+24),n,a)}function zl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=jl.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){const n=Al.add(2*t),a=Ll(e,0).add(Al),s=Ll(e,t-8);return Fl(Ol(s,37).mul(n).add(a),Ol(a,25).add(s).mul(n),n)}if(t>=4){const n=Al.add(2*t);return Fl(Dl(e,0).shl(3).add(t),Dl(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),a=t+(e[t-1]<<2);return Rl(Al.mul(n).xor(Il.mul(a))).mul(Al)}return Al}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=Al.add(2*t),a=Ll(e,0).mul(El),s=Ll(e,8),r=Ll(e,t-8).mul(n),i=Ll(e,t-16).mul(Al);return Fl(Ol(a.add(s),43).add(Ol(r,30)).add(i),a.add(Ol(s.add(Al),18)).add(r),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=Al.add(2*t),a=Ll(e,0).mul(Al),s=Ll(e,8),r=Ll(e,t-8).mul(n),i=Ll(e,t-16).mul(Al),o=Ol(a.add(s),43).add(Ol(r,30)).add(i),l=Fl(o,a.add(Ol(s.add(Al),18)).add(r),n),c=Ll(e,16).mul(n),u=Ll(e,24),d=o.add(Ll(e,t-32)).mul(n),h=l.add(Ll(e,t-24)).mul(n);return Fl(Ol(c.add(u),43).add(Ol(d,30)).add(h),c.add(Ol(u.add(a),18)).add(d),n)}(e,t);let a=n,s=n.mul(El).add(113),r=Rl(s.mul(Al).add(113)).mul(Al),i=[jl.UZERO,jl.UZERO],o=[jl.UZERO,jl.UZERO];a=a.mul(Al).add(Ll(e,0));let l=0;const c=64*(t-1>>6),u=c+(t-1&63)-63;do{a=Ol(a.add(s).add(i[0]).add(Ll(e,l+8)),37).mul(El),s=Ol(s.add(i[1]).add(Ll(e,l+48)),42).mul(El),a=a.xor(o[1]),s=s.add(i[0]).add(Ll(e,l+40)),r=Ol(r.add(o[0]),33).mul(El),i=Pl(e,l,i[1].mul(El),a.add(o[0])),o=Pl(e,l+32,r.add(o[1]),s.add(Ll(e,l+16))),[r,a]=[a,r],l+=64}while(l!==c);const d=El.add(r.and(255).shl(1));return l=u,o[0]=o[0].add(t-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),a=Ol(a.add(s).add(i[0]).add(Ll(e,l+8)),37).mul(d),s=Ol(s.add(i[1]).add(Ll(e,l+48)),42).mul(d),a=a.xor(o[1].mul(9)),s=s.add(i[0].mul(9).add(Ll(e,l+40))),r=Ol(r.add(o[0]),33).mul(d),i=Pl(e,l,i[1].mul(d),a.add(o[0])),o=Pl(e,l+32,r.add(o[1]),s.add(Ll(e,l+16))),[r,a]=[a,r],Fl(Fl(i[0],o[0],d).add(Rl(s).mul(Il)).add(r),Fl(i[1],o[1],d).add(a),d)}function Bl(e,t){return"string"===t?Hl(e):Wl([e],t)}function Wl(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Kl(e)),Vs().getBool("DEBUG")&&xs(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error("Unknown data type ".concat(t))}function Vl(){return Vs().platform.now()}function Ul(e,t){return Vs().platform.fetch(e,t)}function Hl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Vs().platform.encode(e,t)}function Gl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Vs().platform.decode(e,t)}function ql(e){return null!=Vs().platform.isTypedArray?Vs().platform.isTypedArray(e):Sl(e)}function Kl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||Ps(e)||null==e||ql(e)&&n)t.push(e);else if(Array.isArray(e)||ql(e))for(let a=0;a<e.length;++a)Kl(e[a],t,n);else{let a=-1;for(const t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(a=Math.max(a,Number(t)));for(let s=0;s<=a;s++)Kl(e[s],t,n)}return t}class Zl{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new Yl)}profileKernel(e,t,n){let a;const s=()=>{a=n()};let r;const i=Vl();if(this.backendTimer.timerAvailable())r=this.backendTimer.time(s);else{s();for(const e of a)e.dataSync();r=Promise.resolve({kernelMs:Vl()-i})}if(Vs().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let o=0;o<a.length;o++){const t=a[o];t.data().then(n=>{Xl(n,t.dtype,e)})}return{kernelName:e,outputs:a,inputs:t,timeMs:r.then(e=>e.kernelMs),extraInfo:r.then(e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:a,inputs:s,extraInfo:r}=e;n.forEach(e=>{Promise.all([e.data(),a,r]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],s,n[2])})})}}function Xl(e,t,n){if("float32"!==t)return!1;for(let a=0;a<e.length;a++){const t=e[a];if(isNaN(t)||!isFinite(t))return console.warn("Found ".concat(t," in the result of '").concat(n,"'")),!0}return!1}class Yl{logKernelProfile(e,t,n,a,s,r){const i="number"===typeof a?us("".concat(a,"ms"),9):a.error,o=us(e,25),l=t.rank,c=t.size,u=us(t.shape.toString(),14);let d="";for(const h in s){const e=s[h];if(null!=e){const n=e.shape||t.shape,a=n.length;d+="".concat(h,": ").concat(a,"D ").concat(a>0?n:""," ")}}console.log("%c".concat(o,"\t%c").concat(i,"\t%c").concat(l,"D ").concat(u,"\t%c").concat(c,"\t%c").concat(d,"\t%c").concat(r),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function Jl(e,t,n,a){const s=Ts(t),r=function(e,t,n,a){const s=ns(t),r=a[a.length-1],i=new Array(r).fill(0),o=t.length,l="complex64"===n?tc(e):e;if(o>1)for(let c=0;c<s/r;c++){const e=c*r;for(let t=0;t<r;t++)i[t]=Math.max(i[t],Ql(l[e+t],0,n).length)}return i}(e,t,n,s),i=t.length,o=ec(e,t,n,s,r),l=["Tensor"];return a&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(i)),l.push("  shape: [".concat(t,"]")),l.push("  values:")),l.push(o.map(e=>"    "+e).join("\n")),l.join("\n")}function Ql(e,t,n){let a;return a=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):ks(e)?"'".concat(e,"'"):"bool"===n?$l(e):parseFloat(e.toFixed(7)).toString(),us(a,t)}function $l(e){return 0===e?"false":"true"}function ec(e,t,n,a,s){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const i="complex64"===n?2:1,o=t[0],l=t.length;if(0===l){if("complex64"===n){return[Ql(tc(e)[0],0,n)]}return"bool"===n?[$l(e[0])]:[e[0].toString()]}if(1===l){if(o>20){const t=3*i;let a=Array.from(e.slice(0,t)),r=Array.from(e.slice((o-3)*i,o*i));return"complex64"===n&&(a=tc(a),r=tc(r)),["["+a.map((e,t)=>Ql(e,s[t],n)).join(", ")+", ..., "+r.map((e,t)=>Ql(e,s[o-3+t],n)).join(", ")+"]"]}return["["+("complex64"===n?tc(e):Array.from(e)).map((e,t)=>Ql(e,s[t],n)).join(", ")+"]"]}const c=t.slice(1),u=a.slice(1),d=a[0]*i,h=[];if(o>20){for(let t=0;t<3;t++){const a=t*d,r=a+d;h.push(...ec(e.slice(a,r),c,n,u,s,!1))}h.push("...");for(let t=o-3;t<o;t++){const a=t*d,r=a+d;h.push(...ec(e.slice(a,r),c,n,u,s,t===o-1))}}else for(let f=0;f<o;f++){const t=f*d,a=t+d;h.push(...ec(e.slice(t,a),c,n,u,s,f===o-1))}const p=2===l?",":"";h[0]="["+(o>0?h[0]+p:"");for(let f=1;f<h.length-1;f++)h[f]=" "+h[f]+p;let m=",\n";for(let f=2;f<l;f++)m+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(r?"":m),h}function tc(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class nc{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=ns(e),null!=n){const e=n.length;$a(e===this.size,()=>"Length of values '".concat(e,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'."))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||gs(t,this.size),this.strides=Ts(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];0===n.length&&(n=[0]),$a(n.length===this.rank,()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")"));const s=this.locToIndex(n);this.values[s]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let a=0;for(const r of t){if(r<0||r>=this.shape[a]){const e="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(e)}a++}let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=this.strides[r]*t[r];return this.values[s]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return ac().makeTensor(this.values,this.shape,this.dtype)}}let ac=null,sc=null,rc=null;class ic{constructor(e,t,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=ns(e),this.strides=Ts(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return sc.buffer(this.shape,this.dtype,e)}bufferSync(){return sc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Es(this.shape,e,"complex64"===this.dtype)}arraySync(){return Es(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=ac().read(this.dataId);if("string"===this.dtype){const n=await e;try{return n.map(e=>Gl(e))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ac().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ac().readSync(this.dataId);if("string"===this.dtype)try{return e.map(e=>Gl(e))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ac().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),ac().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return sc.print(this,e)}clone(){return this.throwIfDisposed(),sc.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Jl(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),sc.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),ac().makeVariable(this,e,t,n)}}function oc(){return qs("Tensor",()=>ic)}Object.defineProperty(ic,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),oc();class lc extends ic{constructor(e,t,n,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!rs(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));ac().disposeTensor(this),this.dataId=e.dataId,ac().incRef(this,null)}dispose(){ac().disposeVariable(this),this.isDisposedInternal=!0}}var cc,uc,dc,hc,pc;Object.defineProperty(lc,Symbol.hasInstance,{value:e=>e instanceof ic&&null!=e.assign&&e.assign instanceof Function}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(cc||(cc={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(uc||(uc={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(dc||(dc={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(hc||(hc={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(pc||(pc={}));const mc={float32:hc,int32:uc,bool:dc,complex64:pc};function fc(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return mc[e][t]}function gc(e){return fc(e,"int32")}function xc(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function yc(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function bc(e,t){if(e.dtype===t.dtype)return[e,t];const n=fc(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function vc(e,t){$a(e.dtype===t.dtype,()=>"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match"))}function wc(e,t){return t.some(t=>t.id===e.id)}function kc(e){const t=[];return Nc(e,t,new Set),t}function Nc(e,t,n){if(null==e)return;if(e instanceof ic)return void t.push(e);if(a=e,!Array.isArray(a)&&"object"!==typeof a)return;var a;const s=e;for(const r in s){const e=s[r];n.has(e)||(n.add(e),Nc(e,t,n))}}function _c(e){return null!=e.kernelName}class Sc{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Cc{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Sc}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(hl("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Zl(this.backendInstance),!0}setupRegisteredKernels(){yl(this.backendName).forEach(e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){yl(e).forEach(t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{const n=t.factory();if(!n||n instanceof Ua||"function"!==typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,a=n.then(n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0)).catch(n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,hl("Initialization of backend ".concat(e," failed")),hl(n.stack||n.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}}catch(n){return hl("Initialization of backend ".concat(e," failed")),hl(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:a,asyncInit:s}=this.initializeBackend(n);if(s||a)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),a=n.backend,s=this.readSync(t),r=a.refCount(t);a.disposeData(t,!0),n.backend=e,e.move(t,s,n.shape,n.dtype,r),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun(()=>this.startScope(a),()=>this.endScope(n),()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(a){throw t(),a}}nextTensorId(){return Cc.nextTensorId++}nextVariableId(){return Cc.nextVariableId++}clone(e){const t=Tc.runKernel(ci,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],e=>({x:()=>{const t={x:e},n={dtype:"float32"};return Tc.runKernel(xr,t,n)}}),[],{}),t}runKernel(e,t,n){null==this.backendName&&this.backend;if(!(null!=gl(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const a=this.backend.numDataIds();let s=0;n.forEach(e=>{s+="complex64"===e.dtype?3:1});const r=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=a-t-s-r;if(i>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(i," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n=[];const a=this.isTapeOn(),s=this.state.numBytes,r=this.state.numTensors;let i,o;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const l=_c(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(_c(e)){const{kernelName:t,inputs:s,attrs:r}=e;null==this.backendName&&this.backend;const l=gl(t,this.backendName);$a(null!=l,()=>"Cannot find registered kernel '".concat(t,"' for backend '").concat(this.backendName,"'")),i=()=>{const e=this.backend.numDataIds();o=l.kernelFunc({inputs:s,attrs:r,backend:this.backend});const i=Array.isArray(o)?o:[o];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,i);const c=i.map(e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e));if(a){const e=this.getTensorsForGradient(t,s,c);n=this.saveTensorsForBackwardMode(e)}return c}}else{const{forwardFunc:t}=e,s=e=>{a&&(n=e.map(e=>this.keep(this.clone(e))))};i=()=>{const e=this.backend.numDataIds();o=this.tidy(()=>t(this.backend,s));const n=Array.isArray(o)?o:[o];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,n),n}}const{inputs:c,attrs:u}=e,d=_c(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(h=this.profiler.profileKernel(l,c,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),t=h.outputs):t=i()}),a&&this.addTapeNode(l,c,t,d,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-r,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(e=>null!=c[e]?c[e].shape:null),outputShapes:t.map(e=>e.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(o)?t:t[0]}saveTensorsForBackwardMode(e){const t=e.map(e=>this.keep(this.clone(e)));return t}getTensorsForGradient(e,t,n){const a=xl(e);if(null!=a){const e=a.inputsToSave||[],s=a.outputsToSave||[];let r;a.saveAllInputs?($a(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),r=Object.keys(t).map(e=>t[e])):r=e.map(e=>t[e]);const i=n.filter((e,t)=>s[t]);return r.concat(i)}return[]}makeTensor(e,t,n,a){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;let s=e;"string"===n&&ks(e[0])&&(s=e.map(e=>Hl(e)));const r=a.write(s,t,n),i=new ic(t,n,r,this.nextTensorId());if(this.trackTensor(i,a),"string"===n){const e=this.state.tensorInfo.get(r),t=ws(s);this.state.numBytes+=t-e.bytes,e.bytes=t}return i}makeTensorFromDataId(e,t,n,a){const s={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(s,a)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:a,dtype:s}=e,r=new ic(a,s,n,this.nextTensorId());return this.trackTensor(r,t),r}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=a&&a!==e.dtype&&(e=e.cast(a));const s=new lc(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[s.name])throw new Error("Variable with name ".concat(s.name," was already registered"));return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*vs(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof lc||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*vs(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,a,s,r){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:s},o=xl(e);null!=o&&(a=o.gradFunc),null!=a&&(i.gradient=e=>(e=e.map((e,t)=>{if(null==e){const e=n[t],a=Ms(e.size,e.dtype);return this.makeTensor(a,e.shape,e.dtype)}return e}),a(e.length>1?e:e[0],s,r))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=kc(e),n=new Set(t.map(e=>e.id));for(let s=0;s<this.state.activeScope.track.length;s++){const e=this.state.activeScope.track[s];e.kept||n.has(e.id)||e.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{e.kept||e.scopeId!==a.id||this.track(e)})}gradients(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if($a(t.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));$a(s instanceof ic,()=>"The result y returned by f() must be a tensor.");const r=function(e,t,n){const a={},s={};for(let l=0;l<t.length;l++)a[t[l].id]=!0;for(let l=0;l<e.length;l++){const n=e[l],r=n.inputs;for(const e in r){const i=r[e];let o=!1;for(let e=0;e<t.length;e++)if(a[i.id]){n.outputs.forEach(e=>a[e.id]=!0),o=!0,s[n.id]=!0;break}if(o)break}}const r={};r[n.id]=!0;const i={};for(let l=e.length-1;l>=0;l--){const t=e[l],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(r[t.outputs[e].id]){for(const e in n)r[n[e].id]=!0,i[t.id]=!0;break}}const o=[];for(let l=0;l<e.length;l++){const t=e[l];if(s[t.id]&&i[t.id]){const e={};for(const s in t.inputs){const n=t.inputs[s];a[n.id]&&(e[s]=n)}const n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,o.push(n)}}return o}(this.state.activeTape,t,s);if(!a&&0===r.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const e={};e[s.id]=null==n?function(e){const t=Rs(ns(e),"float32");return Tc.makeTensor(t,e,"float32")}(s.shape):n,function(e,t,n,a){for(let s=t.length-1;s>=0;s--){const r=t[s],i=[];if(r.outputs.forEach(t=>{const n=e[t.id];null!=n?i.push(n):i.push(null)}),null==r.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(r.kernelName,"."));const o=r.gradient(i);for(const t in r.inputs){if(!(t in o))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(o),"."));const s=n(()=>o[t]());if("float32"!==s.dtype)throw new Error("Error in gradient for op ".concat(r.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(s.dtype,"'"));const i=r.inputs[t];if(!rs(s.shape,i.shape))throw new Error("Error in gradient for op ".concat(r.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(s.shape,"', which does not match ")+"the shape of the input '".concat(i.shape,"'"));if(null==e[i.id])e[i.id]=s;else{const t=e[i.id];e[i.id]=a(t,s),t.dispose()}}}}(e,r,e=>this.tidy(e),Ic);const a=t.map(t=>e[t.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(e=>{for(const t of e.saved)t.dispose()}),this.state.activeTape=null),{value:s,grads:a}})}customGrad(e){var t=this;return $a(Cs(e),()=>"The f passed in customGrad(f) must be a function."),function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];let r;$a(a.every(e=>e instanceof ic),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const i={};a.forEach((e,t)=>{i[t]=e});return t.runKernelFunc({forwardFunc:(t,n)=>(r=e(...a,n),$a(r.value instanceof ic,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),$a(Cs(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),backwardsFunc:(e,t)=>{const n=r.gradFunc(e,t),s=Array.isArray(n)?n:[n];$a(s.length===a.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),$a(s.every(e=>e instanceof ic),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const i={};return s.forEach((e,t)=>{i[t]=()=>e}),i},inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Vl(),n=await this.backend.time(e);return n.wallMs=Vl()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Sc;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function jc(){const e=Gs();if(null==e._tfengine){const t=new Bs(e);e._tfengine=new Cc(t)}var t;return t=e._tfengine.ENV,Hs=t,ac=()=>e._tfengine,e._tfengine}Cc.nextTensorId=0,Cc.nextVariableId=0;const Tc=jc();function Ic(e,t){const n={a:e,b:t};return Tc.runKernel(Ys,n)}let Ec;function Ac(e){Ec=e}function Rc(e){if(void 0!==Ec)return Ec;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function Mc(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const Lc=Vs();function Dc(e,t){let n=e;if(ql(e))return"string"===t?[]:[e.length];if(xc(e)){const t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(yc(e))return[e.buffer.size/(null==t?4:vs(t))];if(!Array.isArray(e))return[];const a=[];for(;Array.isArray(n)||ql(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&Vs().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Oc(e,a,[]),a}function Oc(e,t,n){if(n=n||[],!Array.isArray(e)&&!ql(e))return void $a(0===t.length,()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements"));$a(t.length>0,()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")),$a(e.length===t[0],()=>"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements"));const a=t.slice(1);for(let s=0;s<e.length;++s)Oc(e[s],a,n.concat(s))}function Fc(e,t,n,a){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(a,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function Pc(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof oc())return Fc(a,e.dtype,t,n),e;let s=Ss(e);if("string"!==s&&["bool","int32","float32"].indexOf(a)>=0&&(s=a),Fc(a,s,t,n),null==e||!ql(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){const a=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(a,"'"))}const r=Dc(e,s);ql(e)||Array.isArray(e)||(e=[e]);const i="string"!==s?Wl(e,s):Kl(e,[],!0);return Tc.makeTensor(i,r,s)}function zc(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((e,s)=>Pc(e,"".concat(t,"[").concat(s,"]"),n,a))}Lc.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Lc.registerFlag("IS_BROWSER",()=>Mc()),Lc.registerFlag("IS_NODE",()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node),Lc.registerFlag("IS_CHROME",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),Lc.registerFlag("IS_SAFARI",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),Lc.registerFlag("PROD",()=>!1),Lc.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Lc.getBool("DEBUG")),Lc.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),Lc.registerFlag("IS_TEST",()=>!1),Lc.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Lc.getBool("DEBUG")),Lc.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),Lc.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),Lc.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);const Bc="__op";function Wc(e){const t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));let n=t[0];const a=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=Bc;const s=function(){Tc.startScope(n);try{const e=a(...arguments);return Ps(e)&&console.error("Cannot return a Promise inside of tidy."),Tc.endScope(e),e}catch(e){throw Tc.endScope(null),e}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}const Vc=Wc({complex_:function(e,t){const n=Pc(e,"real","complex"),a=Pc(t,"imag","complex");es(n.shape,a.shape,"real and imag shapes, ".concat(n.shape," and ").concat(a.shape,", ")+"must match in call to tf.complex().");const s={real:n,imag:a};return Tc.runKernel(vr,s)}});function Uc(e,t,n,a){if(null==a)a=Ss(e);else if("complex64"===a)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(yc(e)||xc(e)){if("float32"!==a&&"int32"!==a)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(a,"."));return Tc.backend.createTensorFromGPUData(e,t||n,a)}if(!ql(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Ds(t);const e=ns(t),a=ns(n);$a(e===a,()=>"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(e," values but has ").concat(a));for(let s=0;s<n.length;++s){const e=n[s],a=s!==n.length-1||e!==ns(t.slice(s));$a(n[s]===t[s]||!a,()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). "))}}return ql(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==a?Wl(e,a):Kl(e,[],!0),Tc.makeTensor(e,t,a)}function Hc(e,t,n){return Uc(e,t,Dc(e,n),n)}const Gc={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class qc{static join(e){return new qc(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e)return;if(e instanceof Array||(e=[e]),0===(e=e.map(e=>ql(e)?e.buffer:e)).length)return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const a=e[n];n!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=t+a.byteLength;this.shards.push({buffer:a,start:t,end:s}),t=s}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));const a=new ArrayBuffer(t-e),s=new Uint8Array(a);let r=0;for(let i=n;i<this.shards.length;i++){const n=this.shards[i],a=e+r-n.start,o=r,l=Math.min(t,n.end)-n.start,c=new Uint8Array(n.buffer,a,l-a);if(s.set(c,o),r+=c.length,t<n.end)break}return a}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(e,t){let n=0,a=e.length;for(;n<=a;){const s=Math.floor((a-n)/2)+n,r=t(e[s]);if(0===r)return s;r<0?a=s:n=s+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function Kc(){Vs().set("PROD",!0)}function Zc(){Vs().set("DEBUG",!0)}function Xc(){Vs().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Yc(e){Vs().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Jc(){Tc.disposeVariables()}function Qc(){return Tc}function $c(){return Tc.memory()}function eu(e){return Tc.profile(e)}function tu(e,t){return Tc.tidy(e,t)}function nu(e){kc(e).forEach(e=>e.dispose())}function au(e){return Tc.keep(e)}function su(e){return Tc.time(e)}function ru(e){return Tc.setBackend(e)}function iu(){return Tc.ready()}function ou(){return Tc.backendName}function lu(e){Tc.removeBackend(e)}function cu(e){return Tc.findBackend(e)}function uu(e){return Tc.findBackendFactory(e)}function du(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Tc.registerBackend(e,t,n)}function hu(){return Tc.backend}function pu(e,t){Vs().setPlatform(e,t)}rc=Yc;const mu=4;async function fu(e,t){const n=[],a=[],s=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let r=0;r<s.length;++r){const i=s[r],o=Array.isArray(e)?e[r].tensor:e[i];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw new Error("Unsupported dtype in weight '".concat(i,"': ").concat(o.dtype));const l={name:i,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){const e=new Promise(async e=>{const t=await o.bytes(),n=t.reduce((e,t)=>e+t.length,0)+mu*t.length,a=new Uint8Array(n);let s=0;for(let r=0;r<t.length;r++){const e=t[r],n=new Uint8Array(new Uint32Array([e.length]).buffer);a.set(n,s),s+=mu,a.set(e,s),s+=e.length}e(a)});a.push(e)}else a.push(o.data());null!=t&&(l.group=t),n.push(l)}return{data:ku(await Promise.all(a)),specs:n}}function gu(e,t){const n=new qc(e),a={};let s=0;for(const r of t){const e=xu(r,(e,t)=>n.slice(s+e,s+t));a[r.name]=bu(r,n.slice(s,s+e)),s+=e}return a}function xu(e,t){const n=ns(e.shape);let a;if("quantization"in e){const t=e.quantization;a=Gc[t.dtype]}else{if("string"===e.dtype){let e=0;for(let a=0;a<n;a++)e+=mu+new Uint32Array(t(e,e+mu))[0];return e}a=Gc[e.dtype]}return n*a}async function yu(e,t){const n=ns(e.shape);let a;if("quantization"in e){const t=e.quantization;a=Gc[t.dtype]}else{if("string"===e.dtype){let e=0;for(let a=0;a<n;a++)e+=mu+new Uint32Array(await t(e,e+mu))[0];return e}a=Gc[e.dtype]}return n*a}function bu(e,t){const n=e.name,a=e.dtype,s=e.shape,r=ns(s);let i,o=0;if("quantization"in e){const s=e.quantization;if("uint8"===s.dtype||"uint16"===s.dtype){if(!("min"in s)||!("scale"in s))throw new Error("Weight ".concat(e.name," with quantization ").concat(s.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==s.dtype)throw new Error("Weight ".concat(e.name," has unknown ")+"quantization dtype ".concat(s.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==a)throw new Error("Weight ".concat(e.name," is quantized with ").concat(s.dtype," ")+"which only supports weights of type float32 not ".concat(a,"."))}const l=Gc[s.dtype],c="uint8"===s.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===a)if("uint8"===s.dtype||"uint16"===s.dtype){i=new Float32Array(c.length);for(let e=0;e<c.length;e++){const t=c[e];i[e]=t*s.scale+s.min}}else{if("float16"!==s.dtype)throw new Error("Unsupported quantization type ".concat(s.dtype," ")+"for weight type float32.");{const e=function(){const e=function(){const e=e=>{let t=e<<13,n=0;for(;0===(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return a=>{const s=new ArrayBuffer(4*a.length),r=new Uint32Array(s);for(let i=0;i<a.length;i++){const s=a[i],o=e[n[s>>10]+(1023&s)]+t[s>>10];r[i]=o}return new Float32Array(s)}}();i=e(c)}}else{if("int32"!==a)throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(a));if("uint8"!==s.dtype&&"uint16"!==s.dtype)throw new Error("Unsupported quantization type ".concat(s.dtype," ")+"for weight type int32.");i=new Int32Array(c.length);for(let e=0;e<c.length;e++){const t=c[e];i[e]=Math.round(t*s.scale+s.min)}}o+=r*l}else if("string"===a){const n=ns(e.shape);i=[];for(let e=0;e<n;e++){const e=new Uint32Array(t.slice(o,o+mu))[0];o+=mu;const n=new Uint8Array(t.slice(o,o+e));i.push(n),o+=e}}else{const e=Gc[a];if("float32"===a)i=new Float32Array(t);else if("int32"===a)i=new Int32Array(t);else{if("bool"!==a){if("complex64"===a){i=new Float32Array(t);const e=new Float32Array(i.length/2),n=new Float32Array(i.length/2);for(let t=0;t<e.length;t++)e[t]=i[2*t],n[t]=i[2*t+1];const a=Hc(e,s,"float32"),r=Hc(n,s,"float32"),o=Vc(a,r);return a.dispose(),r.dispose(),o}throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(a))}i=new Uint8Array(t)}o+=r*e}return Hc(i,s,a)}async function vu(e,t,n){let a=new Uint8Array(t);for(;a.byteLength<n;){const{done:t,value:s}=await e.read();if(t&&null==s){const e=n-a.byteLength;throw new Error("Reader is done but ".concat(e," bytes are still expected"))}const r=new Uint8Array(a.length+s.byteLength);r.set(a,0),r.set(new Uint8Array(s),a.length),a=r}return a.buffer}async function wu(e,t){const n={},a=e.getReader();let s=new ArrayBuffer(0);for(const r of t){const e=await yu(r,async(e,t)=>(s=await vu(a,s,t),s.slice(e,t)));s=await vu(a,s,e);const t=s.slice(0,e);s=s.slice(e);const i=bu(r,t);if(n[r.name]=i,"webgpu"===ou()){const e=hu();"uploadToGPU"in e&&ns(i.shape)>=Vs().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&e.uploadToGPU(i.dataId)}}return n}function ku(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0;const n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))});const a=new Uint8Array(t);let s=0;return n.forEach(e=>{a.set(new Uint8Array(e.buffer),s),s+=e.byteLength}),a.buffer}const Nu="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function _u(e){return Nu?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function Su(e){return qc.join(e)}function Cu(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);const t=e.split("/");return t[t.length-1]}function ju(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function Tu(e,t,n){const a={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(a.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");a.weightSpecs=t,a.weightData=n}return null!=e.signature&&(a.signature=e.signature),null!=e.userDefinedMetadata&&(a.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(a.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(a.initializerSignature=e.initializerSignature),a}async function Iu(e,t){let n,a;return null!=e.weightsManifest&&([n,a]=await t(e.weightsManifest)),Tu(e,n,a)}function Eu(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:_u(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:_u(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new qc(e.weightData).byteLength}}function Au(e){const t=[];for(const n of e)t.push(...n.weights);return t}class Ru{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Ru.instance&&(Ru.instance=new Ru),Ru.instance}static registerSaveRouter(e){Ru.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Ru.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Ru.getHandlers(e,"save")}static getLoadHandlers(e,t){return Ru.getHandlers(e,"load",t)}static getHandlers(e,t,n){const a=[];return("load"===t?Ru.getInstance().loadRouters:Ru.getInstance().saveRouters).forEach(t=>{const s=t(e,n);null!==s&&a.push(s)}),a}}const Mu=e=>Ru.registerSaveRouter(e),Lu=e=>Ru.registerLoadRouter(e),Du=e=>Ru.getSaveHandlers(e),Ou=(e,t)=>Ru.getLoadHandlers(e,t),Fu="tensorflowjs",Pu="models_store",zu="model_info_store";function Bu(){if(!Vs().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Wu(e){const t=e.result;t.createObjectStore(Pu,{keyPath:"modelPath"}),t.createObjectStore(zu,{keyPath:"modelPath"})}class Vu{constructor(e){if(this.indexedDB=Bu(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{const a=this.indexedDB.open(Fu,1);a.onupgradeneeded=()=>Wu(a),a.onsuccess=()=>{const s=a.result;if(null==t){const t=s.transaction(Pu,"readonly"),a=t.objectStore(Pu).get(this.modelPath);a.onsuccess=()=>{if(null==a.result)return s.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));e(a.result.modelArtifacts)},a.onerror=e=>(s.close(),n(a.error)),t.oncomplete=()=>s.close()}else{t.weightData=qc.join(t.weightData);const a=Eu(t),i=s.transaction(zu,"readwrite");let o,l,c=i.objectStore(zu);try{o=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(r){return n(r)}o.onsuccess=()=>{l=s.transaction(Pu,"readwrite");const o=l.objectStore(Pu);let u;try{u=o.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a})}catch(r){return n(r)}u.onsuccess=()=>e({modelArtifactsInfo:a}),u.onerror=e=>{c=i.objectStore(zu);const t=c.delete(this.modelPath);t.onsuccess=()=>(s.close(),n(u.error)),t.onerror=e=>(s.close(),n(u.error))}},o.onerror=e=>(s.close(),n(o.error)),i.oncomplete=()=>{null==l?s.close():l.oncomplete=()=>s.close()}}},a.onerror=e=>n(a.error)})}}Vu.URL_SCHEME="indexeddb://";const Uu=e=>{return Vs().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Vu.URL_SCHEME)?(t=e.slice(Vu.URL_SCHEME.length),new Vu(t)):null;var t};Ru.registerSaveRouter(Uu),Ru.registerLoadRouter(Uu);class Hu{constructor(){this.indexedDB=Bu()}async listModels(){return new Promise((e,t)=>{const n=this.indexedDB.open(Fu,1);n.onupgradeneeded=()=>Wu(n),n.onsuccess=()=>{const a=n.result,s=a.transaction(zu,"readonly"),r=s.objectStore(zu).getAll();r.onsuccess=()=>{const t={};for(const e of r.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},r.onerror=e=>(a.close(),t(r.error)),s.oncomplete=()=>a.close()},n.onerror=e=>t(n.error)})}async removeModel(e){var t;return e=(t=e).startsWith(Vu.URL_SCHEME)?t.slice(Vu.URL_SCHEME.length):t,new Promise((t,n)=>{const a=this.indexedDB.open(Fu,1);a.onupgradeneeded=()=>Wu(a),a.onsuccess=()=>{const s=a.result,r=s.transaction(zu,"readwrite"),i=r.objectStore(zu),o=i.get(e);let l;o.onsuccess=()=>{if(null==o.result)return s.close(),n(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));{const a=i.delete(e),r=()=>{l=s.transaction(Pu,"readwrite");const a=l.objectStore(Pu).delete(e);a.onsuccess=()=>t(o.result.modelArtifactsInfo),a.onerror=e=>n(o.error)};a.onsuccess=r,a.onerror=e=>(r(),s.close(),n(o.error))}},o.onerror=e=>(s.close(),n(o.error)),r.oncomplete=()=>{null==l?s.close():l.oncomplete=()=>s.close()}},a.onerror=e=>n(a.error)})}}const Gu="/",qu="tensorflowjs_models",Ku="info",Zu="model_topology",Xu="weight_specs",Yu="weight_data",Ju="model_metadata";function Qu(e){return{info:[qu,e,Ku].join(Gu),topology:[qu,e,Zu].join(Gu),weightSpecs:[qu,e,Xu].join(Gu),weightData:[qu,e,Yu].join(Gu),modelMetadata:[qu,e,Ju].join(Gu)}}function $u(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function ed(e){const t=e.split(Gu);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(Gu)}class td{constructor(e){if(!Vs().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Qu(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),a=JSON.stringify(e.weightSpecs),s=Eu(e),r=qc.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,a),this.LS.setItem(this.keys.weightData,function(e){if(Nu)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let a=0,s=t.length;a<s;a++)n+=String.fromCharCode(t[a]);return btoa(n)}(r));const t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:s}}catch(t){throw $u(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(s.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(s.weightSpecsBytes,", ")+"weightDataBytes=".concat(s.weightDataBytes,"."))}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");t.modelTopology=n;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==a)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");t.weightSpecs=a;const s=this.LS.getItem(this.keys.modelMetadata);if(null!=s){const e=JSON.parse(s);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const r=this.LS.getItem(this.keys.weightData);if(null==r)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return t.weightData=function(e){if(Nu){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let a=0;a<t.length;++a)n.set([t.charCodeAt(a)],a);return n.buffer}(r),t}}td.URL_SCHEME="localstorage://";const nd=e=>{return Vs().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(td.URL_SCHEME)?(t=e.slice(td.URL_SCHEME.length),new td(t)):null;var t};Ru.registerSaveRouter(nd),Ru.registerLoadRouter(nd);class ad{constructor(){$a(Vs().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),$a("undefined"===typeof window||"undefined"!==typeof window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=qu+Gu,n=Gu+Ku;for(let a=0;a<this.LS.length;++a){const s=this.LS.key(a);if(s.startsWith(t)&&s.endsWith(n)){e[ed(s)]=JSON.parse(this.LS.getItem(s))}}return e}async removeModel(e){var t;const n=Qu(e=(t=e).startsWith(td.URL_SCHEME)?t.slice(td.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(e,"'"));const a=JSON.parse(this.LS.getItem(n.info));return $u(n),a}}const sd="://";class rd{constructor(){this.managers={}}static getInstance(){return null==rd.instance&&(rd.instance=new rd),rd.instance}static registerManager(e,t){$a(null!=e,()=>"scheme must not be undefined or null."),e.endsWith(sd)&&(e=e.slice(0,e.indexOf(sd))),$a(e.length>0,()=>"scheme must not be an empty string.");const n=rd.getInstance();$a(null==n.managers[e],()=>"A model store manager is already registered for scheme '".concat(e,"'.")),n.managers[e]=t}static getManager(e){const t=rd.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(rd.getInstance().managers)}}function id(e){if(-1===e.indexOf(sd))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(rd.getSchemes().join(",")));return{scheme:e.split(sd)[0],path:e.split(sd)[1]}}async function od(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];$a(e!==t,()=>"Old path and new path are the same: '".concat(e,"'"));const a=Ru.getLoadHandlers(e);$a(a.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(e,".")),$a(a.length<2,()=>"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(e,"."));const s=a[0],r=Ru.getSaveHandlers(t);$a(r.length>0,()=>"Copying failed because no save handler is found for destination "+"URL ".concat(t,".")),$a(r.length<2,()=>"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(t,"."));const i=r[0],o=id(e).scheme,l=id(e).path,c=o===id(e).scheme,u=await s.load();n&&c&&await rd.getManager(o).removeModel(l);const d=await i.save(u);return n&&!c&&await rd.getManager(o).removeModel(l),d.modelArtifactsInfo}async function ld(){const e=rd.getSchemes(),t={};for(const n of e){const e=await rd.getManager(n).listModels();for(const a in e){t[n+sd+a]=e[a]}}return t}async function cd(e){const t=id(e);return rd.getManager(t.scheme).removeModel(t.path)}async function ud(e,t){return od(e,t,!1)}async function dd(e,t){return od(e,t,!0)}class hd{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!==typeof window&&Vs().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))):setTimeout(e,t)}isTypedArray(e){return Sl(e)}}if(Vs().get("IS_BROWSER")){Vs().setPlatform("browser",new hd);try{rd.registerManager(td.URL_SCHEME,new ad)}catch(wq){}try{rd.registerManager(Vu.URL_SCHEME,new Hu)}catch(wq){}}const pd=()=>n(817);let md;class fd{constructor(){this.util=n(590),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=Vs().global.fetch?Vs().global.fetch(e,t):(null==md&&(md=pd()),md(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}function gd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",Ds(e),new nc(e,t,n)}Vs().get("IS_NODE")&&!Vs().get("IS_BROWSER")&&Vs().setPlatform("node",new fd);const xd=Wc({cast_:function(e,t){const n=Pc(e,"x","cast");if(!ys(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const a={x:n},s={dtype:t};return Tc.runKernel(xr,a,s)}});const yd=Wc({clone_:function(e){const t={x:Pc(e,"x","clone","string_or_numeric")};return Tc.runKernel(ci,t)}});function bd(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}jc();sc={buffer:gd,cast:xd,clone:yd,print:bd};const vd=Wc({add_:function(e,t){let n=Pc(e,"a","add"),a=Pc(t,"b","add");[n,a]=bc(n,a);const s={a:n,b:a};return Tc.runKernel(Ys,s)}});const wd=Wc({floorDiv_:function(e,t){let n=Pc(e,"a","floorDiv"),a=Pc(t,"b","floorDiv");[n,a]=bc(n,a);const s={a:n,b:a};return Tc.runKernel(ai,s)}});const kd=Wc({div_:function(e,t){let n=Pc(e,"a","div"),a=Pc(t,"b","div");if([n,a]=bc(n,a),"int32"===n.dtype&&"int32"===a.dtype)return wd(n,a);const s={a:n,b:a};return Tc.runKernel(Hr,s,{})}});const Nd=Wc({mul_:function(e,t){let n=Pc(e,"a","mul"),a=Pc(t,"b","mul");[n,a]=bc(n,a);const s={a:n,b:a};return Tc.runKernel(Ui,s)}});const _d=Wc({sqrt_:function(e){const t={x:Pc(e,"x","sqrt","float32")};return Tc.runKernel(Ao,t)}});const Sd=Wc({square_:function(e){const t=Pc(e,"x","square");return Tc.runKernel("Square",{x:t},{})}});const Cd=Wc({zerosLike_:function(e){const t={x:Pc(e,"x","zerosLike")};return Tc.runKernel(rl,t)}});function jd(e){return $a(Cs(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{const a=Pc(t,"x","tf.grad","string_or_numeric"),s=null!=n?Pc(n,"dy","tf.grad"):null;return Tc.tidy(()=>{const{value:t,grads:n}=Tc.gradients(()=>e(a),[a],s);return null!=s&&es(t.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Md(n),n[0]})}}function Td(e){return $a(Cs(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{$a(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const a=zc(t,"args","tf.grads","string_or_numeric"),s=null!=n?Pc(n,"dy","tf.grads"):null;return Tc.tidy(()=>{const{value:t,grads:n}=Tc.gradients(()=>e(...a),a,s);return null!=s&&es(t.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Md(n),n})}}function Id(e){return $a(Cs(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{$a(t instanceof ic,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),$a(null==n||n instanceof ic,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:a,value:s}=Tc.gradients(()=>e(t),[t],n);return Md(a),{grad:a[0],value:s}}}function Ed(e){return $a(Cs(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{$a(Array.isArray(t)&&t.every(e=>e instanceof ic),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),$a(null==n||n instanceof ic,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const a=Tc.gradients(()=>e(...t),t,n);return null!=n&&es(a.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Md(a.grads),a}}function Ad(e,t){$a(Cs(e),()=>"The f passed in variableGrads(f) must be a function"),$a(null==t||Array.isArray(t)&&t.every(e=>e instanceof lc),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=t;if(!n){t=[];for(const e in Tc.registeredVariables)t.push(Tc.registeredVariables[e])}const a=n?t.filter(e=>!e.trainable):null,s=t.length;t=t.filter(e=>e.trainable),$a(t.length>0,()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(s," variables is ")+"trainable.");const{value:r,grads:i}=Tc.gradients(e,t,null,!0);$a(i.some(e=>null!=e),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),$a(0===r.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(r.rank," tensor"));const o={};return t.forEach((e,t)=>{null!=i[t]&&(o[e.name]=i[t])}),null!=a&&a.forEach(e=>o[e.name]=null),{value:r,grads:o}}function Rd(e){return Tc.customGrad(e)}function Md(e){if(e.filter(e=>null==e).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}function Ld(e,t){if((ql(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&ql(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Uc(e,[],[],t)}const Dd=new Map,Od=new Map;class Fd{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class Pd{constructor(){this.classNameMap={}}static getMap(){return null==Pd.instance&&(Pd.instance=new Pd),Pd.instance}static register(e){Pd.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function zd(e,t,n){$a(null!=e.className,()=>"Class being registered does not have the static className property defined."),$a("string"===typeof e.className,()=>"className is required to be a string, but got type "+typeof e.className),$a(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);const a=t+">"+n;return Pd.register(e),Dd.set(a,e),Od.set(e,a),e}function Bd(e){return Od.has(e)?Od.get(e):e.className}class Wd extends Fd{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:a,grads:s}=this.computeGradients(e,n);if(null!=n){const e=n.map(e=>({name:e.name,tensor:s[e.name]}));this.applyGradients(e)}else this.applyGradients(s);return nu(s),t?a:(a.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return Ad(e,t)}dispose(){null!=this.iterations_&&nu(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Ld(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Wd,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});class Vd extends Wd{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=Tc.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const a=Tc.registeredVariables[t],s=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:tu(()=>Cd(a).variable(s))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:tu(()=>Cd(a).variable(s))});const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const i=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;tu(()=>{const e=vd(Nd(i,this.rho),Nd(Sd(r),1-this.rho)),t=Nd(kd(_d(vd(o,this.epsilon)),_d(vd(i,this.epsilon))),r),n=vd(Nd(o,this.rho),Nd(Sd(t),1-this.rho));i.assign(e),o.assign(n);const s=vd(Nd(t,-this.learningRate),a);a.assign(s)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(nu(this.accumulatedGrads.map(e=>e.variable)),nu(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){const t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}function Ud(e,t,n){Ds(e);const a={shape:e,value:t,dtype:n=n||Ss(t)};return Tc.runKernel(ei,{},a)}class Hd extends Wd{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const a=Tc.registeredVariables[t];if(null==this.accumulatedGrads[n]){const e=!1;this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:tu(()=>Ud(a.shape,this.initialAccumulatorValue).variable(e))}}const s=Array.isArray(e)?e[n].tensor:e[t];if(null==s)return;const r=this.accumulatedGrads[n].variable;tu(()=>{const e=vd(r,Sd(s));r.assign(e);const t=vd(Nd(kd(s,_d(vd(e,Tc.backend.epsilon()))),-this.learningRate),a);a.assign(t)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&nu(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}const Gd=Wc({pow_:function(e,t){let n=Pc(e,"base","pow"),a=Pc(t,"exp","pow");[n,a]=bc(n,a);const s={a:n,b:a};return Tc.runKernel(eo,s)}});const qd=Wc({sub_:function(e,t){let n=Pc(e,"a","sub"),a=Pc(t,"b","sub");[n,a]=bc(n,a);const s={a:n,b:a};return Tc.runKernel(Zo,s)}});class Kd extends Wd{static get className(){return"Adam"}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],tu(()=>{this.accBeta1=Ld(t).variable(),this.accBeta2=Ld(n).variable()}),null==a&&(this.epsilon=Tc.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);tu(()=>{const n=qd(1,this.accBeta1),a=qd(1,this.accBeta2);t.forEach((t,s)=>{const r=Tc.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[s]&&(this.accumulatedFirstMoment[s]={originalName:"".concat(t,"/m"),variable:tu(()=>Cd(r).variable(i))}),null==this.accumulatedSecondMoment[s]&&(this.accumulatedSecondMoment[s]={originalName:"".concat(t,"/v"),variable:tu(()=>Cd(r).variable(i))});const o=Array.isArray(e)?e[s].tensor:e[t];if(null==o)return;const l=this.accumulatedFirstMoment[s].variable,c=this.accumulatedSecondMoment[s].variable,u=vd(Nd(l,this.beta1),Nd(o,1-this.beta1)),d=vd(Nd(c,this.beta2),Nd(Sd(o),1-this.beta2)),h=kd(u,n),p=kd(d,a);l.assign(u),c.assign(d);const m=vd(Nd(kd(h,vd(_d(p),this.epsilon)),-this.learningRate),r);r.assign(m)}),this.accBeta1.assign(Nd(this.accBeta1,this.beta1)),this.accBeta2.assign(Nd(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&nu(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedSecondMoment&&nu(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),tu(()=>{this.accBeta1.assign(Gd(this.beta1,this.iterations_+1)),this.accBeta2.assign(Gd(this.beta2,this.iterations_+1))});const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}const Zd=Wc({abs_:function(e){const t=Pc(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return Tc.runKernel(wr,e)}{const e={x:t};return Tc.runKernel(Ks,e)}}});function Xd(e,t){const n=e.length,a=[];for(let s=0;s<n;s++){const r=n-1-s,i=e[r]||1;(t[t.length-1-s]||1)>1&&1===i&&a.unshift(r)}return a}function Yd(e,t){const n=[];for(let a=0;a<t.length;a++){const s=e[e.length-a-1],r=t.length-a-1,i=t[r];(null==s||1===s&&i>1)&&n.unshift(r)}return n}function Jd(e,t){const n=Math.max(e.length,t.length),a=new Array(n);for(let s=0;s<n;s++){let r=e[e.length-s-1];null==r&&(r=1);let i=t[t.length-s-1];if(null==i&&(i=1),1===r)a[n-s-1]=i;else if(1===i)a[n-s-1]=r;else{if(r!==i){const n="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(n)}a[n-s-1]=r}}return a}const Qd=Wc({maximum_:function(e,t){let n=Pc(e,"a","maximum"),a=Pc(t,"b","maximum");[n,a]=bc(n,a),"bool"===n.dtype&&(n=xd(n,"int32"),a=xd(a,"int32")),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(Ai,s)}});class $d extends Wd{static get className(){return"Adamax"}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=a,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],tu(()=>{this.iteration=Ld(0).variable(),this.accBeta1=Ld(t).variable()}),null==a&&(this.epsilon=Tc.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);tu(()=>{const n=qd(1,this.accBeta1),a=kd(-this.learningRate,vd(Nd(this.iteration,this.decay),1));t.forEach((t,s)=>{const r=Tc.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[s]&&(this.accumulatedFirstMoment[s]={originalName:"".concat(t,"/m"),variable:Cd(r).variable(i)}),null==this.accumulatedWeightedInfNorm[s]&&(this.accumulatedWeightedInfNorm[s]={originalName:"".concat(t,"/v"),variable:Cd(r).variable(i)});const o=Array.isArray(e)?e[s].tensor:e[t];if(null==o)return;const l=this.accumulatedFirstMoment[s].variable,c=this.accumulatedWeightedInfNorm[s].variable,u=vd(Nd(l,this.beta1),Nd(o,1-this.beta1)),d=Nd(c,this.beta2),h=Zd(o),p=Qd(d,h);l.assign(u),c.assign(p);const m=vd(Nd(kd(a,n),kd(u,vd(p,this.epsilon))),r);r.assign(m)}),this.iteration.assign(vd(this.iteration,1)),this.accBeta1.assign(Nd(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&nu(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedWeightedInfNorm&&nu(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class eh extends Wd{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;const s=Tc.registeredVariables[t];tu(()=>{const e=vd(Nd(this.c,a),s);s.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=au(Ld(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class th extends eh{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=Ld(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const a=Tc.registeredVariables[t];if(null==this.accumulations[n]){const e=!1;this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:tu(()=>Cd(a).variable(e))}}const s=this.accumulations[n].variable,r=Array.isArray(e)?e[n].tensor:e[t];null!=r&&tu(()=>{let e;const t=vd(Nd(this.m,s),r);e=this.useNesterov?vd(Nd(this.c,vd(r,Nd(t,this.m))),a):vd(Nd(this.c,t),a),s.assign(t),a.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&nu(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class nh extends Wd{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,null==a&&(this.epsilon=Tc.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const a=Tc.registeredVariables[t],s=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:tu(()=>Cd(a).variable(s))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:tu(()=>Cd(a).variable(s))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:tu(()=>Cd(a).variable(s))});const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const i=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;tu(()=>{const e=vd(Nd(i,this.decay),Nd(Sd(r),1-this.decay));if(this.centered){const t=this.accumulatedMeanGrads[n].variable,s=vd(Nd(t,this.decay),Nd(r,1-this.decay)),l=kd(Nd(r,this.learningRate),_d(qd(e,vd(Sd(s),this.epsilon)))),c=vd(Nd(o,this.momentum),l);i.assign(e),t.assign(s),o.assign(c);const u=qd(a,c);a.assign(u)}else{const e=vd(Nd(i,this.decay),Nd(Sd(r),1-this.decay)),t=vd(Nd(o,this.momentum),kd(Nd(r,this.learningRate),_d(vd(e,this.epsilon))));i.assign(e),o.assign(t);const n=qd(a,t);a.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&nu(this.accumulatedMeanSquares.map(e=>e.variable)),null!=this.accumulatedMeanGrads&&this.centered&&nu(this.accumulatedMeanGrads.map(e=>e.variable)),null!=this.accumulatedMoments&&nu(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const ah=[Vd,Hd,Kd,$d,th,nh,eh];function sh(e){return new Promise(e=>setTimeout(e)).then(e)}class rh{constructor(e){if(!Vs().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(rh.URL_SCHEME)&&(e=e.slice(rh.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=qc.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const t=ju(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),a=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),s=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(s.download=this.modelJsonFileName,s.href=a,await sh(()=>s.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await sh(()=>e.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Eu(e)}}}}rh.URL_SCHEME="downloads://";class ih{constructor(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const n=new FileReader;n.onload=n=>{const a=JSON.parse(n.target.result),s=a.modelTopology;if(null==s)return void t(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==a.weightsManifest)return void t(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void e({modelTopology:s});const r=Iu(a,e=>this.loadWeights(e));e(r)},n.onerror=e=>t("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)})}loadWeights(e){const t=[],n=[];for(const r of e)t.push(...r.weights),n.push(...r.paths);const a=this.checkManifestAndWeightFiles(e),s=n.map(e=>this.loadWeightsFile(e,a[e]));return Promise.all(s).then(e=>[t,e])}loadWeightsFile(e,t){return new Promise((n,a)=>{const s=new FileReader;s.onload=e=>{const t=e.target.result;n(t)},s.onerror=t=>a("Failed to weights data from file of path '".concat(e,"'.")),s.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],n=this.weightsFiles.map(e=>Cu(e.name)),a={};for(const s of e)s.paths.forEach(e=>{const s=Cu(e);if(-1!==t.indexOf(s))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(s,"'"));if(t.push(s),-1===n.indexOf(s))throw new Error("Weight file with basename '".concat(s,"' is not provided."));a[e]=this.weightsFiles[n.indexOf(s)]});if(t.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(t.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return a}}function oh(e){return new ih(e)}function lh(e,t,n,a){!function(e){$a(null!=e&&Array.isArray(e)&&e.length>0,()=>"promises must be a none empty array")}(e),function(e,t){$a(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)),$a(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)),$a(t>=e,()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t))}(n=null==n?0:n,a=null==a?1:a);let s=0;return Promise.all(e.map(r=>(r.then(r=>{const i=n+ ++s/e.length*(a-n);return t(i),r}),r)))}async function ch(e,t){null==t&&(t={});const n=null==t.fetchFunc?Vs().platform.fetch:t.fetchFunc,a=e.map(e=>n(e,t.requestInit,{isBinary:!0})),s=(null==t.onProgress?await Promise.all(a):await lh(a,t.onProgress,0,.5)).map(e=>e.arrayBuffer());return null==t.onProgress?await Promise.all(s):await lh(s,t.onProgress,.5,1)}async function uh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return dh(e=>ch(e,{requestInit:a}))(e,t,n)}function dh(e){return async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;const s=t.map(()=>!1),r={},i=null!=a?a.map(()=>!1):[],o=[];if(t.forEach((e,t)=>{let n=0;e.weights.forEach(e=>{const l="quantization"in e?e.quantization.dtype:e.dtype,c=Gc[l]*ns(e.shape),u=()=>{s[t]=!0,null==r[t]&&(r[t]=[]),r[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((t,n)=>{t===e.name&&(u(),i[n]=!0)}):u(),o.push(e.name),n+=c})}),!i.every(e=>e)){const e=a.filter((e,t)=>!i[t]);throw new Error("Could not find weights in manifest with names: "+"".concat(e.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(o.join(", "),"."))}const l=s.reduce((e,t,n)=>(t&&e.push(n),e),[]),c=[];l.forEach(e=>{t[e].paths.forEach(e=>{const t=n+(n.endsWith("/")?"":"/")+e;c.push(t)})});const u=await e(c),d={};let h=0;return l.forEach(e=>{const n=t[e].paths.length,a=new qc(u.slice(h,h+n));r[e].forEach(e=>{const t=gu(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(const n in t)d[n]=t[n]}),h+=n}),d}}Ru.registerSaveRouter(e=>Vs().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(rh.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new rh(e)}(e.slice(rh.URL_SCHEME.length)):null);class hh{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?($a("function"===typeof t.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=Vs().platform.fetch,$a(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&$a(2===e.length,()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=ju(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){const n=qc.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:Eu(e),responses:[a]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(a.status,"."))}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let t;try{t=await e.json()}catch(vq){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,a=t.weightsManifest;if(null==n&&null==a)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return Iu(await this.loadModelJSON(),e=>this.loadWeights(e))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=Au(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;const a=null==t.fetchFunc?Vs().platform.fetch:t.fetchFunc;let s,r=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var i;r<e.length;){if(!s){const n=(await a(e[r],t.requestInit,{isBinary:!0})).body;s=n.getReader()}const{done:o,value:l}=await s.read();if(!o)return void n.enqueue(l);r++,s=void 0,null===(i=t.onProgress)||void 0===i||i.call(t,r/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,a]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),a=e.substring(0,t),s=n>t?e.substring(n):"";return[a+"/",s]}(t),s=this.weightPathPrefix||n,r=[],i=[];for(const o of e)for(const e of o.paths)null!=this.weightUrlConverter?i.push(this.weightUrlConverter(e)):r.push(s+e+a);return this.weightUrlConverter&&r.push(...await Promise.all(i)),r}async loadWeights(e){const t=await this.getWeightUrls(e);return[Au(e),await ch(t,this.loadOptions)]}}function ph(e){return null!=e.match(hh.URL_SCHEME_REGEX)}hh.URL_SCHEME_REGEX=/^https?:\/\//;const mh=(e,t)=>{if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every(e=>ph(e)):ph(e),n)return fh(e,t)}return null};function fh(e,t){return new hh(e,t)}function gh(e,t){return fh(e,t)}Ru.registerSaveRouter(mh),Ru.registerLoadRouter(mh);class xh{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class yh{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class bh{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function vh(e,t,n,a){return new bh(wh(...arguments))}function wh(e,t,n,a){if(1===arguments.length){return null!=e.modelTopology||null!=e.weightSpecs?new xh(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new xh({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new xh({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:a})}function kh(e){return new yh(e)}function Nh(e){return new yh(e)}const _h=Wc({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=Pc(e,"a","matMul"),r=Pc(t,"b","matMul");[s,r]=bc(s,r);const i={a:s,b:r},o={transposeA:n,transposeB:a};return Tc.runKernel(dr,i,o)}});const Sh=Wc({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));const r={indices:Pc(e,"indices","oneHot","int32")},i={dtype:s,depth:t,onValue:n,offValue:a};return Tc.runKernel(Yi,r,i)}});const Ch=Wc({imag_:function(e){const t={input:Pc(e,"input","imag")};return Tc.runKernel(di,t)}});const jh=Wc({neg_:function(e){const t={x:Pc(e,"x","neg")};return Tc.runKernel(Hi,t)}});const Th=Wc({real_:function(e){const t={input:Pc(e,"input","real")};return Tc.runKernel(oo,t)}});const Ih=Wc({transpose_:function(e,t,n){const a=Pc(e,"x","transpose");if(null==t&&(t=a.shape.map((e,t)=>t).reverse()),$a(a.rank===t.length,()=>"Error in transpose: rank of input ".concat(a.rank," ")+"must match length of perm ".concat(t,".")),t.forEach(e=>{$a(e>=0&&e<a.rank,()=>"All entries in 'perm' must be between 0 and ".concat(a.rank-1)+" but got ".concat(t))}),a.rank<=1)return a.clone();const s={x:a},r={perm:t};return"complex64"===a.dtype?tu(()=>{let e=Th(a),t=Ch(a);return e=Tc.runKernel(el,{x:e},r),t=Tc.runKernel(el,{x:t},r),n&&(t=jh(t)),Vc(e,t)}):Tc.runKernel(el,s,r)}});const Eh=Wc({confusionMatrix_:function(e,t,n){const a=Pc(e,"labels","confusionMatrix"),s=Pc(t,"predictions","confusionMatrix");$a(null==n||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, "+"but got ".concat(n)),$a(1===a.rank,()=>"Expected the rank of labels to be 1, but got ".concat(a.rank)),$a(1===s.rank,()=>"Expected the rank of predictions to be 1, "+"but got ".concat(s.rank)),$a(a.shape[0]===s.shape[0],()=>"Mismatch in the number of examples: "+"".concat(a.shape[0]," vs. ").concat(s.shape[0],". ")+"Labels and predictions should have the same number of elements."),$a(n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got "+"".concat(n));const r=Sh(xd(a,"int32"),n),i=Sh(xd(s,"int32"),n),o=Ih(r),l=_h(o,i);return xd(l,"int32")}});function Ah(e,t,n){if(ts(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const a=Dc(e,n);if(3!==a.length&&1!==a.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Uc(e,t,a,n)}let Rh,Mh=!1;function Lh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,a=!1,s=!1,r=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)a=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)s=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)r=!0;else if(null!=e.getContext)i=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));o=!0}if(null!=gl(ol,Tc.backendName)){const n={pixels:e},a={numChannels:t};return Tc.runKernel(ol,n,a)}const[l,c]=s?[e.videoWidth,e.videoHeight]:[e.width,e.height];let u,d;if(i)u=e.getContext("2d").getImageData(0,0,l,c).data;else if(a||n)u=e.data;else if(r||s||o){if(null==Rh)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Rh=new OffscreenCanvas(1,1).getContext("2d")}else Rh=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Rh.canvas.width=l,Rh.canvas.height=c,Rh.drawImage(e,0,0,l,c),u=Rh.getImageData(0,0,l,c).data}if(4===t)d=new Int32Array(u);else{const e=l*c;d=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)d[n*t+e]=u[4*n+e]}return Ah(d,[c,l,t],"int32")}function Dh(e){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}async function Oh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=null;if(Vs().getBool("WRAP_TO_IMAGEBITMAP")&&Dh(e)){let t;try{t=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch(vq){t=null}n=null!=t&&t.width===e.width&&t.height===e.height?t:e}else n=e;return Lh(n,t)}function Fh(e){if(2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(e.rank,"."));const t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(t));if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error("Unsupported type for toPixels: ".concat(e.dtype,".")+" Please use float32 or int32 tensors.")}async function Ph(e,t){let n=Pc(e,"img","toPixels");if(!(e instanceof ic)){const e=n;n=xd(e,"int32"),e.dispose()}Fh(n);const[a,s]=n.shape.slice(0,2),r=2===n.rank?1:n.shape[2],i=await n.data(),o="float32"===n.dtype?255:1,l=new Uint8ClampedArray(s*a*4);for(let c=0;c<a*s;++c){const e=[0,0,0,255];for(let a=0;a<r;a++){const t=i[c*r+a];if("float32"===n.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===n.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(t,"."));1===r?(e[0]=t*o,e[1]=t*o,e[2]=t*o):e[a]=t*o}const t=4*c;l[t+0]=Math.round(e[0]),l[t+1]=Math.round(e[1]),l[t+2]=Math.round(e[2]),l[t+3]=Math.round(e[3])}if(null!=t){if(!Mh){null!=gl(Ur,Tc.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),Mh=!0)}t.width=s,t.height=a;const e=t.getContext("2d"),n=new ImageData(l,s,a);e.putImageData(n,0,0)}return n!==e&&n.dispose(),l}function zh(e,t,n){let a=Pc(e,"img","draw");if(!(e instanceof ic)){const e=a;a=xd(e,"int32"),e.dispose()}Fh(a),function(e){const t=(null===e||void 0===e?void 0:e.alpha)||1;if(t>1||t<0)throw new Error("Alpha value ".concat(t," is suppoed to be in range [0 - 1]."))}(null===n||void 0===n?void 0:n.imageOptions);const s={image:a},r={canvas:t,options:n};Tc.runKernel(Ur,s,r)}const Bh=Wc({fromPixels_:Lh});function Wh(e,t){const n=e.shape.length,a=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(a<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(a,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[a-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[a-1]," vs. ").concat(n));if(0===ns(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));const s=t.shape,r=s[s.length-1];let i=1;for(let d=0;d<s.length-1;++d)i*=s[d];const o=e.shape,l=s.slice();l.pop();let c=1;for(let d=r;d<n;++d)c*=o[d],l.push(o[d]);const u=[...Ts(e.shape).map(e=>e/c),1].slice(0,r);return[l,i,c,u]}function Vh(e,t,n){const a=t.rank>1?t.shape[t.rank-1]:1,s=t.rank>1?t.rank-1:1,r="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(a,", and batchDim: ").concat(s,".");if(n.rank<s)throw new Error(r+" update.rank < ".concat(s,". "));if(e.length<a+(n.rank-s))throw new Error(r+" Output shape length < ".concat(a+(n.rank-s)));if(n.rank!==s+e.length-a)throw new Error(r+" update.rank != ".concat(s+e.length-a));for(let i=0;i<s;++i)if(n.shape[i]!==t.shape[i])throw new Error(r+" updates.shape[".concat(i,"] (").concat(n.shape[i],") != indices.shape[").concat(i,"] (").concat(t.shape[i],")."));for(let i=0;i<n.rank-s;++i)if(n.shape[i+s]!==e[i+a])throw new Error(r+" updates.shape[".concat(i+s,"] (").concat(n.shape[i+s],") != shape[").concat(i+s,"] (").concat(e[i+s],")"))}function Uh(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}Vh(n,t,e)}function Hh(e,t,n){const a=t.shape.length,s=a>1?t.shape[a-1]:1,r=n.length;let i=1;for(let l=s;l<r;++l)i*=n[l];const o=s<1?1:s;return{sliceRank:s,numUpdates:ns(t.shape)/o,sliceSize:i,strides:[...Ts(n.slice(0,s)),1],outputSize:ns(n)}}const Gh=-2,qh=-1;function Kh(e,t,n){const a=e.shape.length;$a(a===t.length,()=>"Error in slice".concat(a,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(a,").")),$a(a===n.length,()=>"Error in slice".concat(a,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(a,")."));for(let s=0;s<a;++s)$a(t[s]+n[s]<=e.shape[s],()=>"Error in slice".concat(a,"D: begin[").concat(s,"] + size[").concat(s,"] ")+"(".concat(t[s]+n[s],") would overflow input.shape[").concat(s,"] (").concat(e.shape[s],")"))}function Zh(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Xh(e,t,n){const a=[];for(let s=0;s<e.length;s++)a[s]=Math.ceil((t[s]-e[s])/n[s]);return a}function Yh(e,t,n,a){const s=[...e];for(let r=s.length;r<a.length;r++)s.push(1);for(let r=0;r<n;r++)0===r?s[t]=1:(s.splice(t,0,1),s.pop());return s}function Jh(e,t,n){return n<=e?n:n-(t-1)}function Qh(e,t){const n=[];for(let a=0;a<e;a++)n.push(t+a);return n}function $h(e,t,n,a,s,r,i,o,l){const c=e.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(t.length&&n>0){const l=t[0],c=n+1;u=ep(i,l,c,a,e),d=tp(o,l,c,s,e),h=Yh(r,l,c,e)}else for(let p=0;p<c;p++)u[p]=ap(i,a,r,e,p,l),d[p]=sp(o,s,r,e,p,l),h[p]=np(r,p,l);return{begin:u,end:d,strides:h}}function ep(e,t,n,a,s){const r=[...s],i=Qh(n,t);for(let o=0;o<r.length;o++)if(i.indexOf(o)>-1)r[o]=0;else{const s=Jh(t,n,o);let i=a[s];e&1<<s&&(i=0),r[o]=i}return r}function tp(e,t,n,a,s){const r=[...s],i=Qh(n,t);for(let o=0;o<r.length;o++)if(i.indexOf(o)>-1)r[o]=Number.MAX_SAFE_INTEGER;else{const s=Jh(t,n,o);let i=a[s];e&1<<s&&(i=Number.MAX_SAFE_INTEGER),r[o]=i}for(let o=0;o<r.length;o++){const e=s[o];r[o]<0&&(r[o]+=e),r[o]=Ka(0,r[o],s[o])}return r}function np(e,t,n){let a=e[t];return(n&1<<t||null==a)&&(a=1),a}function ap(e,t,n,a,s,r){let i=t[s];const o=n[s]||1;(e&1<<s||r&1<<s||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=a[s];return i<0&&(i+=l),i=Ka(0,i,l-1),i}function sp(e,t,n,a,s,r){let i=t[s];const o=n[s]||1;(e&1<<s||r&1<<s||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=a[s];return i<0&&(i+=l),i=o>0?Ka(0,i,l):Ka(-1,i,l-1),i}function rp(e,t,n){let a=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){a=s;break}for(let s=a+1;s<n.length;s++)if(t[s]>0||n[s]!==e[s])return!1;return!0}function ip(e,t){let n=e.length>0?e[e.length-1]:1;for(let a=0;a<e.length-1;a++)n+=e[a]*t[a];return n}function op(e,t,n){let a;const s=e.shape.length;let r;return a="number"===typeof t?[t,...new Array(s-1).fill(0)]:t.length<s?t.concat(new Array(s-t.length).fill(0)):t.slice(),a.forEach(e=>{$a(-1!==e,()=>"slice() does not support negative begin indexing.")}),r=null==n?new Array(s).fill(-1):"number"===typeof n?[n,...new Array(s-1).fill(-1)]:n.length<s?n.concat(new Array(s-n.length).fill(-1)):n,r=r.map((t,n)=>t>=0?t:($a(-1===t,()=>"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")),e.shape[n]-a[n])),[a,r]}function lp(e,t,n,a,s,r,i,o,l){let c;if(null==a?(c=new Array(t.length),c.fill(1)):c=a,null!=i&&0!==(i&i-1))throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:s,endMask:r,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let y=0;y<d.dims;y++)u&&0!==(1<<y&o)&&d.numAddAxisAfterEllipsis++,1<<y&i&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let a=0;a<e.dims;a++)if(1<<a&e.ellipsisMask){const s=Math.min(t.dims-(e.dims-a)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<s;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=a}else if(1<<a&e.newAxisMask)t.finalShapeGatherIndices.push(Gh),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[a]),null!=e.end&&(t.end[n]=e.end[a]),t.strides[n]=e.strides[a],e.beginMask&1<<a&&(t.beginMask|=1<<n),e.endMask&1<<a&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<a?(t.finalShapeGatherIndices.push(qh),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(a)),t.inputShapeGatherIndicesSparse[n]=a,n++}}(d,h);let p=!0,m=!0,f=!0;const g=[],x=[];for(let y=0;y<e.length;++y){if(0===h.strides[y])throw Error("strides[".concat(y,"] must be non-zero"));const t=!!(h.shrinkAxisMask&1<<y),n=e[y];if(-1===n){g.push(t?1:-1);continue}const a=[h.beginMask&1<<y,h.endMask&1<<y],s=[h.strides[y]>0?0:-1,h.strides[y]>0?n:n-1];if(t&&h.strides[y]<=0)throw Error("only stride 1 allowed on non-range indexing.");f=f&&1===h.strides[y];const r=!!(h.beginMask&1<<y&&h.endMask&1<<y);if(h.beginValid&&h.endValid){if(t){const e=h.begin[y]<0?n+h.begin[y]:h.begin[y];if(h.begin[y]=e,h.end[y]=h.begin[y]+1,e<0||e>=n)throw Error("slice index ".concat(h.begin[y]," of dimension ").concat(y," out of bounds."))}else h.begin[y]=cp(h.begin[y],0,h.strides[y],n,a,s),h.end[y]=cp(h.end[y],1,h.strides[y],n,a,s);const e=1===h.strides[y]&&0===h.begin[y]&&h.end[y]===n;p=p&&e,m=m&&(0===y&&1===h.strides[y]||e)}else p=p&&1===h.strides[y]&&r,m=m&&(0===y&&1===h.strides[y]||r);let i,o=!1;if(h.beginValid&&h.endValid?(i=h.end[y]-h.begin[y],o=!0):t?(i=1,o=!0):r&&n>=0&&(i=h.strides[y]<0?-n:n,o=!0),o){let e;e=0===i||i<0!==h.strides[y]<0?0:Math.trunc(i/h.strides[y])+(i%h.strides[y]!==0?1:0),g.push(e)}else g.push(-1)}for(let y=0;y<h.finalShapeGatherIndices.length;++y){const e=h.finalShapeGatherIndices[y];e>=0?x.push(g[e]):e===Gh&&x.push(1)}return{finalShapeSparse:x.filter((e,t)=>h.finalShapeGatherIndices[t]!==Gh),finalShape:x,isIdentity:p,sliceDim0:m,isSimpleSlice:f,begin:h.begin,end:h.end,strides:h.strides}}function cp(e,t,n,a,s,r){if(s[t])return n>0?r[t]:r[t+1&1];{const t=e<0?a+e:e;return t<r[0]?r[0]:t>r[1]?r[1]:t}}const up=.001,dp=.1;function hp(e,t,n){return null==n&&(n=pp()),mp(e,t,(e,t)=>yp(e,t,n))}function pp(){return 32===Tc.backend.floatPrecision()?up:dp}function mp(e,t,n){let a=!0;if((ql(e)||ql(t))&&(a=!1),ql(e)&&ql(t)&&(a=!0),a){const n=e.constructor.name,a=t.constructor.name;if(n!==a)throw new Error("Arrays are of different type. Actual: ".concat(n,". ")+"Expected: ".concat(a))}if(Array.isArray(e)&&Array.isArray(t)){const n=Dc(e),a=Dc(t);if(!rs(n,a))throw new Error("Arrays have different shapes. "+"Actual: [".concat(n,"]. Expected: [").concat(a,"]"))}const s=ql(e)?e:Kl(e),r=ql(t)?t:Kl(t);if(s.length!==r.length)throw new Error("Arrays have different lengths actual: ".concat(s.length," vs ")+"expected: ".concat(r.length,".\n")+"Actual:   ".concat(s,".\n")+"Expected: ".concat(r,"."));for(let i=0;i<r.length;++i){const e=s[i],t=r[i];if(!n(e,t))throw new Error("Arrays differ: actual[".concat(i,"] = ").concat(e,", expected[").concat(i,"] = ").concat(t,".\n")+"Actual:   ".concat(s,".\n")+"Expected: ".concat(r,"."))}"undefined"!==typeof expect&&expect().nothing()}function fp(e,t){e().then(()=>t.fail(),()=>t()),"undefined"!==typeof expect&&expect().nothing()}function gp(e,t){const n="string"===typeof t||"number"===typeof t||"boolean"===typeof t?[t]:t;return ks(e)||ks(e[0])||ks(t)||ks(t[0])?mp(e,n,(e,t)=>e==t):mp(e,t,(e,t)=>yp(e,t,0))}function xp(e,t,n){if(null==n&&(n=pp()),!yp(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t));"undefined"!==typeof expect&&expect().nothing()}function yp(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function bp(e,t,n){for(let a=0;a<e.length;a++)if(e[a]<t||e[a]>n)throw new Error("Value out of range:".concat(e[a]," low: ").concat(t,", high: ").concat(n))}function vp(e,t){const n=new Float32Array(e),a=new Float32Array(t);if(n.length!==a.length)throw new Error("Expected ArrayBuffer to be of length "+"".concat(a.length,", but it was ").concat(n.length));for(let s=0;s<a.length;s++)if(n[s]!==a[s])throw new Error("Expected ArrayBuffer value at ".concat(s," to be ")+"".concat(a[s]," but got ").concat(n[s]," instead"))}function wp(e){for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(n)?wp(n):e[t]=Hl(n)}return e}function kp(e){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(e=>{t.addEventListener("loadeddata",n=>e(t)),t.load()})}async function Np(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}const _p="4.22.0";class Sp{static sgd(e){return new eh(e)}static momentum(e,t){return new th(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(e){return new nh(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new Kd(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new Vd(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new $d(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(e){return new Hd(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}}const Cp=Wc({acos_:function(e){const t={x:Pc(e,"x","acos")};return Tc.runKernel(Zs,t)}});const jp=Wc({acosh_:function(e){const t={x:Pc(e,"x","acosh")};return Tc.runKernel(Xs,t)}});const Tp=Wc({addN_:function(e){$a(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),$a(e.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length));const t=e.map((e,t)=>Pc(e,"tensors".concat(t),"addN")),n=t[0];t.forEach(e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(e=>{if(!rs(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const a=t;return Tc.runKernel(Js,a)}});const Ip=Wc({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a={x:Pc(e,"x","all","bool")},s={axis:t,keepDims:n};return Tc.runKernel(Qs,a,s)}});const Ep=Wc({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a={x:Pc(e,"x","any","bool")},s={axis:t,keepDims:n};return Tc.runKernel($s,a,s)}});const Ap=Wc({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:Pc(e,"x","argMax")},a={axis:t};return Tc.runKernel(er,n,a)}});const Rp=Wc({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:Pc(e,"x","argMin")},a={axis:t};return Tc.runKernel(tr,n,a)}});const Mp=Wc({asin_:function(e){const t={x:Pc(e,"x","asin")};return Tc.runKernel(nr,t)}});const Lp=Wc({asinh_:function(e){const t={x:Pc(e,"x","asinh")};return Tc.runKernel(ar,t)}});const Dp=Wc({atan_:function(e){const t={x:Pc(e,"x","atan")};return Tc.runKernel(sr,t)}});const Op=Wc({atan2_:function(e,t){let n=Pc(e,"a","atan2"),a=Pc(t,"b","atan2");[n,a]=bc(n,a);const s={a:n,b:a};return Tc.runKernel(ir,s)}});const Fp=Wc({atanh_:function(e){const t={x:Pc(e,"x","atanh")};return Tc.runKernel(rr,t)}});function Pp(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",r=arguments.length>5?arguments[5]:void 0;return Wp(e,[...t,e[3]],n,r,a,null,null,Jp(s))}function zp(e,t,n,a,s,r){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[o,l]=Hp(t);let c;if("channelsLast"===i)c=[o,l,e[3],e[3]];else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat ".concat(i));c=[o,l,e[1],e[1]]}return Wp(e,c,n,a,s,r,!1,i)}function Bp(e,t,n,a,s,r){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[o,l,c]=Gp(t);let u,d;if("NDHWC"===i)d="channelsLast",u=[o,l,c,e[4],e[4]];else{if("NCDHW"!==i)throw new Error("Unknown dataFormat ".concat(i));d="channelsFirst",u=[o,l,c,e[1],e[1]]}return Vp(e,u,n,a,s,!1,d,r)}function Wp(e,t,n,a,s,r){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[l,c,u,d]=[-1,-1,-1,-1];if("channelsLast"===o)[l,c,u,d]=e;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[l,d,c,u]=e}const[h,p,,m]=t,[f,g]=Hp(n),[x,y]=Hp(a),b=qp(h,x),v=qp(p,y),{padInfo:w,outHeight:k,outWidth:N}=function(e,t,n,a,s,r,i,o,l){let c,u,d;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const s=function(e,t,n,a,s){null==a&&(a=Up(e,t,n));const r=e[0],i=e[1],o=Kp((r-t+2*a)/n+1,s),l=Kp((i-t+2*a)/n+1,s);return[o,l]}([t,n],r,a,e,o);u=s[0],d=s[1]}else if("same"===e){u=Math.ceil(t/a),d=Math.ceil(n/s);const e=Math.max(0,(u-1)*a+r-t),o=Math.max(0,(d-1)*s+i-n),l=Math.floor(e/2),h=e-l,p=Math.floor(o/2);c={top:l,bottom:h,left:p,right:o-p,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-r+1)/a),d=Math.ceil((n-i+1)/s);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));{const h="channelsLast"===l?e[1][0]:e[2][0],p="channelsLast"===l?e[1][1]:e[2][1],m="channelsLast"===l?e[2][0]:e[3][0],f="channelsLast"===l?e[2][1]:e[3][1];c={top:h,bottom:p,left:m,right:f,type:0===h&&0===p&&0===m&&0===f?"VALID":"EXPLICIT"},u=Kp((t-r+h+p)/a+1,o),d=Kp((n-i+m+f)/s+1,o)}}return{padInfo:c,outHeight:u,outWidth:d}}(s,c,u,f,g,b,v,r,o),_=i?m*d:m;let S;return"channelsFirst"===o?S=[l,_,k,N]:"channelsLast"===o&&(S=[l,k,N,_]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:u,inChannels:d,outHeight:k,outWidth:N,outChannels:_,padInfo:w,strideHeight:f,strideWidth:g,filterHeight:h,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:v,dilationHeight:x,dilationWidth:y,inShape:e,outShape:S,filterShape:t}}function Vp(e,t,n,a,s){let r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",o=arguments.length>7?arguments[7]:void 0,[l,c,u,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===i)[l,c,u,d,h]=e;else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat ".concat(i));[l,h,c,u,d]=e}const[p,m,f,,g]=t,[x,y,b]=Gp(n),[v,w,k]=Gp(a),N=qp(p,v),_=qp(m,w),S=qp(f,k),{padInfo:C,outDepth:j,outHeight:T,outWidth:I}=function(e,t,n,a,s,r,i,o,l,c,u){let d,h,p,m;"valid"===e&&(e=0);if("number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const f=function(e,t,n,a,s,r){null==s&&(s=Up(e,t[0],a[0]));const i=[0,0,0,n];for(let o=0;o<3;o++)e[o]+2*s>=t[o]&&(i[o]=Kp((e[o]-t[o]+2*s)/a[o]+1,r));return i}([t,n,a,1],[o,l,c],1,[s,r,i],e,u);h=f[0],p=f[1],m=f[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));{h=Math.ceil(t/s),p=Math.ceil(n/r),m=Math.ceil(a/i);const e=(h-1)*s+o-t,u=(p-1)*r+l-n,f=(m-1)*i+c-a,g=Math.floor(e/2),x=e-g,y=Math.floor(u/2),b=u-y,v=Math.floor(f/2);d={top:y,bottom:b,left:v,right:f-v,front:g,back:x,type:"SAME"}}}return{padInfo:d,outDepth:h,outHeight:p,outWidth:m}}(s,c,u,d,x,y,b,N,_,S,o),E=r?g*h:g;let A;return"channelsFirst"===i?A=[l,E,j,T,I]:"channelsLast"===i&&(A=[l,j,T,I,E]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:j,outHeight:T,outWidth:I,outChannels:E,padInfo:C,strideDepth:x,strideHeight:y,strideWidth:b,filterDepth:p,filterHeight:m,filterWidth:f,effectiveFilterDepth:N,effectiveFilterHeight:_,effectiveFilterWidth:S,dilationDepth:v,dilationHeight:w,dilationWidth:k,inShape:e,outShape:A,filterShape:t}}function Up(e,t,n){const a=qp(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+a)/2)}function Hp(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Gp(e){return"number"===typeof e?[e,e,e]:e}function qp(e,t){return t<=1?e:e+(e-1)*(t-1)}function Kp(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function Zp(e){const[t,n,a]=Hp(e);return 1===t&&1===n&&1===a}function Xp(e,t){return Zp(e)||Zp(t)}function Yp(e){return Hp(e).every(e=>e>0)}function Jp(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function Qp(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)$a(is(t),()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach(t=>{t.forEach(t=>{$a(is(t),()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."))})})}}}const $p=Wc({reshape_:function(e,t){const n={x:Pc(e,"x","reshape","string_or_numeric")},a={shape:t};return Tc.runKernel(uo,n,a)}});const em=Wc({avgPool_:function(e,t,n,a,s){const r=Pc(e,"x","avgPool","float32");$a(Xp(n,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"));let i=r,o=!1;3===r.rank&&(o=!0,i=$p(r,[1,r.shape[0],r.shape[1],r.shape[2]])),$a(4===i.rank,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(i.rank,".")),Qp("avgPool",a,s);const l={x:i},c={filterSize:t,strides:n,pad:a,dimRoundingMode:s};let u=Tc.runKernel(or,l,c);return u=xd(u,r.dtype),o?$p(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const tm=Wc({avgPool3d_:function(e,t,n,a,s){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const i=Pc(e,"x","avgPool3d","float32");let o=i,l=!1;4===i.rank&&(l=!0,o=$p(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),$a(5===o.rank,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),$a("NDHWC"===r,()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(r)),$a("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")),Qp("avgPool3d",a,s);const c={x:o},u={filterSize:t,strides:n,pad:a,dimRoundingMode:s,dataFormat:r};let d=Tc.runKernel(cr,c,u);return d=xd(d,o.dtype),l?$p(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const nm=Wc({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;$a(e.length>=1,()=>"Pass at least one tensor to concat");const n=zc(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(e=>{if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}),1===n.length)return yd(n[0]);const a=n,s={axis:t};return Tc.runKernel(kr,a,s)}});const am=Wc({sigmoid_:function(e){const t={x:Pc(e,"x","sigmoid","float32")};return Tc.runKernel(Io,t)}});const sm=Wc({slice_:function(e,t,n){const a=Pc(e,"x","slice","string_or_numeric");if(0===a.rank)throw new Error("Slicing scalar is not possible");const s={x:a},r={begin:t,size:n};return Tc.runKernel(So,s,r)}});const rm=Wc({tanh_:function(e){const t={x:Pc(e,"x","tanh","float32")};return Tc.runKernel(Yo,t)}});const im=Wc({basicLSTMCell_:function(e,t,n,a,s,r){const i=Pc(e,"forgetBias","basicLSTMCell"),o=Pc(t,"lstmKernel","basicLSTMCell"),l=Pc(n,"lstmBias","basicLSTMCell"),c=Pc(a,"data","basicLSTMCell"),u=Pc(s,"c","basicLSTMCell"),d=Pc(r,"h","basicLSTMCell"),h=nm([c,d],1),p=_h(h,o),m=vd(p,l),f=m.shape[0],g=m.shape[1]/4,x=[f,g],y=sm(m,[0,0],x),b=sm(m,[0,g],x),v=sm(m,[0,2*g],x),w=sm(m,[0,3*g],x),k=vd(Nd(am(y),rm(b)),Nd(u,am(vd(i,v))));return[k,Nd(rm(k),am(w))]}});const om=Wc({batchToSpaceND_:function(e,t,n){const a=Pc(e,"x","batchToSpaceND"),s=t.reduce((e,t)=>e*t);$a(a.rank>=1+t.length,()=>"input rank is ".concat(a.rank," but should be > than blockShape.length ").concat(t.length)),$a(n.length===t.length,()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)),$a(a.shape[0]%s===0,()=>"input tensor batch is ".concat(a.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(s));const r={x:a},i={blockShape:t,crops:n};return Tc.runKernel(hr,r,i)}});const lm=Wc({batchNorm_:function(e,t,n,a,s,r){null==r&&(r=.001);const i=Pc(e,"x","batchNorm"),o=Pc(t,"mean","batchNorm"),l=Pc(n,"variance","batchNorm");let c,u;null!=s&&(c=Pc(s,"scale","batchNorm")),null!=a&&(u=Pc(a,"offset","batchNorm")),$a(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),$a(null==u||o.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),$a(null==c||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:function(e){let t;return t=0===e.rank||1===e.rank?$p(e,[1,1,1,e.size]):2===e.rank?$p(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?$p(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(i),scale:c,offset:u,mean:o,variance:l},h={varianceEpsilon:r},p=Tc.runKernel(si,d,h);return $p(p,i.shape)}});const cm=Wc({batchNorm2d_:function(e,t,n,a,s,r){const i=Pc(e,"x","batchNorm"),o=Pc(t,"mean","batchNorm"),l=Pc(n,"variance","batchNorm");let c,u;return null!=s&&(c=Pc(s,"scale","batchNorm")),null!=a&&(u=Pc(a,"offset","batchNorm")),$a(2===i.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(i.rank,".")),$a(2===o.rank||1===o.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(o.rank,".")),$a(2===l.rank||1===l.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=c&&$a(2===c.rank||1===c.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=u&&$a(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")),lm(i,o,l,u,c,r)}});const um=Wc({batchNorm3d_:function(e,t,n,a,s,r){const i=Pc(e,"x","batchNorm"),o=Pc(t,"mean","batchNorm"),l=Pc(n,"variance","batchNorm");let c,u;return null!=s&&(c=Pc(s,"scale","batchNorm")),null!=a&&(u=Pc(a,"offset","batchNorm")),$a(3===i.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(i.rank,".")),$a(3===o.rank||1===o.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(o.rank,".")),$a(3===l.rank||1===l.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=c&&$a(3===c.rank||1===c.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=u&&$a(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")),lm(i,o,l,u,c,r)}});const dm=Wc({batchNorm4d_:function(e,t,n,a,s,r){const i=Pc(e,"x","batchNorm"),o=Pc(t,"mean","batchNorm"),l=Pc(n,"variance","batchNorm");let c,u;return null!=s&&(c=Pc(s,"scale","batchNorm")),null!=a&&(u=Pc(a,"offset","batchNorm")),$a(4===i.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(i.rank,".")),$a(4===o.rank||1===o.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(o.rank,".")),$a(4===l.rank||1===l.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=c&&$a(4===c.rank||1===c.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=u&&$a(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")),lm(i,o,l,u,c,r)}});const hm=Wc({bincount_:function(e,t,n){const a=Pc(e,"x","bincount"),s=Pc(t,"weights","bincount");$a("int32"===a.dtype,()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(a.dtype)),$a(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),$a(s.size===a.size||0===s.size,()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(a.shape,", weights shape: ")+"".concat(s.shape,"."));const r={x:a,weights:s},i={size:n};return Tc.runKernel(pr,r,i)}});const pm=Wc({bitwiseAnd_:function(e,t){const n=Pc(e,"x","bitwiseAnd"),a=Pc(t,"y","bitwiseAnd");if(!rs(n.shape,a.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(a.shape));if("int32"!==n.dtype||"int32"!==a.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(a.dtype));const s={a:n,b:a};return Tc.runKernel(mr,s)}});const mm=Wc({broadcastArgs_:function(e,t){const n=Pc(e,"s0","broadcastArgs","int32"),a=Pc(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==a.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(a.rank));const s={s0:n,s1:a};return Tc.runKernel(gr,s)}});const fm=Wc({broadcastTo_:function(e,t){let n=Pc(e,"broadcastTo","x");const a=n.shape;if(Ds(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=$p(n,e)}const s=n.shape,r=Array.from(t);for(let l=t.length-1;l>=0;l--)if(s[l]===t[l])r[l]=1;else if(1!==n.shape[l])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(t,"]."));if(0===r.map((e,t)=>e>1?t:-1).filter(e=>e>=0).length)return yd(n);const i={x:n},o={reps:r};return Tc.runKernel(Jo,i,o)}});const gm=Wc({ceil_:function(e){const t={x:Pc(e,"x","ceil","float32")};return Tc.runKernel(yr,t)}});const xm=Wc({clipByValue_:function(e,t,n){const a=Pc(e,"x","clipByValue");if($a(t<=n,()=>"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")),t===n)return Ud(a.shape,t,a.dtype);const s={x:a},r={clipValueMin:t,clipValueMax:n};return Tc.runKernel(br,s,r)}});const ym=Wc({concat1d_:function(e){return nm(e,0)}});const bm=Wc({concat2d_:function(e,t){return nm(e,t)}});const vm=Wc({concat3d_:function(e,t){return nm(e,t)}});const wm=Wc({concat4d_:function(e,t){return nm(e,t)}});const km=Wc({conv2d_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0;const o=Pc(e,"x","conv2d","float32"),l=Pc(t,"filter","conv2d","float32");let c=o,u=!1;3===o.rank&&(u=!0,c=$p(o,[1,o.shape[0],o.shape[1],o.shape[2]])),$a(4===c.rank,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")),$a(4===l.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(l.rank,".")),Qp("conv2d",a,i);const d="NHWC"===s?c.shape[3]:c.shape[1];$a(d===l.shape[2],()=>"Error in conv2d: depth of input (".concat(d,") must match ")+"input depth for filter ".concat(l.shape[2],".")),$a(Xp(n,r),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(r,"'")),$a(Yp(r),()=>"Error in conv2D: Dilated rates should be larger than 0."),$a(Yp(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},p={strides:n,pad:a,dataFormat:s,dilations:r,dimRoundingMode:i},m=Tc.runKernel(Nr,h,p);return u?$p(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const Nm=Wc({conv1d_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6?arguments[6]:void 0;const o=Pc(e,"x","conv1d"),l=Pc(t,"filter","conv1d");let c=o,u=!1;2===o.rank&&(u=!0,c=$p(o,[1,o.shape[0],o.shape[1]])),$a(3===c.rank,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")),$a(3===l.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(l.rank,".")),Qp("conv1d",a,i),$a(c.shape[2]===l.shape[1],()=>"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(l.shape[1],".")),$a(Xp(n,r),()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(r,"'")),$a(Yp(r),()=>"Error in conv1D: Dilated rates should be larger than 0."),$a(Yp(n),()=>"Error in conv1D: Stride should be larger than 0."),$a("NWC"===s,()=>"Error in conv1d: got dataFormat of ".concat(s," but only NWC is currently supported."));const d=$p(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=$p(c,[c.shape[0],1,c.shape[1],c.shape[2]]),p=km(h,d,[1,n],a,"NHWC",[1,r],i);return $p(p,u?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});const _m=Wc({conv2DBackpropInput_:function(e,t,n,a,s){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0;$a(e.length===t.rank,()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let o=e,l=t,c=!1;3===t.rank&&(c=!0,l=$p(t,[1,t.shape[0],t.shape[1],t.shape[2]]),o=[1,e[0],e[1],e[2]]),$a(4===o.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(o.length,".")),$a(4===l.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(l.rank)),$a(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank));const u="NHWC"===r?o[3]:o[1],d="NHWC"===r?l.shape[3]:l.shape[1];$a(u===n.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[2],".")),$a(d===n.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(d,") must ")+"match output depth for filter ".concat(n.shape[3],".")),Qp("conv2dDerInput",s,i);const h={dy:l,filter:n},p={strides:a,pad:s,dataFormat:r,dimRoundingMode:i,inputShape:o},m=Tc.runKernel(Sr,h,p);return c?$p(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const Sm=Wc({conv2dTranspose_:function(e,t,n,a,s,r){const i=Pc(e,"x","conv2dTranspose"),o=Pc(t,"filter","conv2dTranspose");return _m(n,i,o,a,s,"NHWC",r)}});const Cm=Wc({conv3d_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const i=Pc(e,"x","conv3d"),o=Pc(t,"filter","conv3d");let l=i,c=!1;4===i.rank&&(c=!0,l=$p(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),$a(5===l.rank,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(l.rank,".")),$a(5===o.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(o.rank,".")),$a(l.shape[4]===o.shape[3],()=>"Error in conv3d: depth of input (".concat(l.shape[4],") must match ")+"input depth for filter ".concat(o.shape[3],".")),$a(Xp(n,r),()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(r,"'")),$a("NDHWC"===s,()=>"Error in conv3d: got dataFormat of ".concat(s," but only NDHWC is currently supported.")),$a(Yp(r),()=>"Error in conv3D: Dilated rates should be larger than 0."),$a(Yp(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:o},d={strides:n,pad:a,dataFormat:s,dilations:r},h=Tc.runKernel(Cr,u,d);return c?$p(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const jm=Wc({conv3DBackpropInput_:function(e,t,n,a,s){$a(e.length===t.rank,()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let r=e,i=t,o=!1;4===t.rank&&(o=!0,i=$p(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),r=[1,e[0],e[1],e[2],e[3]]);const l=r[4],c=i.shape[4];$a(5===r.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(r.length,".")),$a(5===i.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(i.rank)),$a(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)),$a(l===n.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[3],".")),$a(c===n.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],"."));const u={dy:i,filter:n},d={pad:s,strides:a,inputShape:r},h=Tc.runKernel(Tr,u,d);return o?$p(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const Tm=Wc({conv3dTranspose_:function(e,t,n,a,s){const r=Pc(e,"x","conv3dTranspose"),i=Pc(t,"filter","conv3dTranspose");return jm(n,r,i,a,s)}});const Im=Wc({cos_:function(e){const t={x:Pc(e,"x","cos","float32")};return Tc.runKernel(Ir,t)}});const Em=Wc({cosh_:function(e){const t={x:Pc(e,"x","cosh","float32")};return Tc.runKernel(Er,t)}});const Am=Wc({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s={x:Pc(e,"x","cumprod")},r={axis:t,exclusive:n,reverse:a};return Tc.runKernel(Ar,s,r)}});const Rm=Wc({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s={x:Pc(e,"x","cumsum")},r={axis:t,exclusive:n,reverse:a};return Tc.runKernel(Rr,s,r)}});const Mm=Wc({denseBincount_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=Pc(e,"x","denseBincount"),r=Pc(t,"weights","denseBincount");$a("int32"===s.dtype,()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(s.dtype)),$a(s.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(s.rank,".")),$a(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),$a(r.size===s.size||0===r.size,()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(s.shape,", weights shape: ")+"".concat(r.shape,"."));const i={x:s,weights:r},o={size:n,binaryOutput:a};return Tc.runKernel(Lr,i,o)}});const Lm=Wc({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const a=Pc(e,"x","depthToSpace","float32"),s="NHWC"===n?a.shape[1]:a.shape[2],r="NHWC"===n?a.shape[2]:a.shape[3],i="NHWC"===n?a.shape[3]:a.shape[1];$a(t>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t)),$a(s*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(a.shape)),$a(r*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(r," and ").concat(t," for depthToSpace with input shape\n        ").concat(a.shape)),$a(i%(t*t)===0,()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(i," for depthToSpace with input shape ").concat(a.shape));const o={x:a},l={blockSize:t,dataFormat:n};return Tc.runKernel(Dr,o,l)}});const Dm=Wc({depthwiseConv2d_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0;const o=Pc(e,"x","depthwiseConv2d","float32"),l=Pc(t,"filter","depthwiseConv2d","float32");let c=o,u=!1;3===o.rank&&(u=!0,c=$p(o,[1,o.shape[0],o.shape[1],o.shape[2]])),$a(4===c.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")),$a(4===l.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(l.rank,"."));const d="NHWC"===s?c.shape[3]:c.shape[1];$a(d===l.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(d,") must match the inChannels dimension in ")+"filter ".concat(l.shape[2],".")),Qp("depthwiseConv2d",a,i);const h={x:c,filter:l},p={strides:n,pad:a,dataFormat:s,dilations:r,dimRoundingMode:i},m=Tc.runKernel(Or,h,p);return u?$p(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const Om=Wc({diag_:function(e){const t={x:Pc(e,"x","diag")};return Tc.runKernel(zr,t)}});const Fm=Wc({dilation2d_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const i=Pc(e,"x","dilation2d"),o=Pc(t,"filter","dilation2d");$a(3===i.rank||4===i.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(i.rank,".")),$a(3===o.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(o.rank,".")),$a("NHWC"===r,()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(r));let l=i,c=!1;3===i.rank&&(l=$p(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),$a(l.shape[3]===o.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(l.shape[3]," vs ").concat(o.shape[2]));const u={x:l,filter:o},d={strides:n,pad:a,dilations:s},h=Tc.runKernel(Br,u,d);return c?$p(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const Pm=Wc({equal_:function(e,t){let n=Pc(e,"a","equal","string_or_numeric"),a=Pc(t,"b","equal","string_or_numeric");[n,a]=bc(n,a),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(Xr,s)}});const zm=Wc({where_:function(e,t,n){const a=Pc(t,"a","where"),s=Pc(n,"b","where"),r=Pc(e,"condition","where","bool"),i=Jd(Jd(r.shape,a.shape),s.shape),o={condition:fm(r,i),t:fm(a,i),e:fm(s,i)};return Tc.runKernel(No,o)}});const Bm=Wc({divNoNan_:function(e,t){let n=Pc(e,"a","div"),a=Pc(t,"b","div");[n,a]=bc(n,a);const s=kd(n,a),r=Cd(s),i=Pm(a,r);return zm(i,r,s)}});const Wm=Wc({dot_:function(e,t){const n=Pc(e,"t1","dot"),a=Pc(t,"t2","dot");$a((1===n.rank||2===n.rank)&&(1===a.rank||2===a.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(a.rank,"."));const s=1===n.rank?n.size:n.shape[1],r=1===a.rank?a.size:a.shape[0];if($a(s===r,()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(s," and ").concat(r,".")),1===n.rank&&1===a.rank){const e=$p(n,[1,-1]),t=$p(a,[-1,1]),s=_h(e,t);return $p(s,[])}if(1===n.rank&&2===a.rank){const e=$p(n,[1,-1]),t=$p(a,[a.shape[0],a.shape[1]]),s=_h(e,t);return $p(s,[s.size])}if(2===n.rank&&1===a.rank){const e=$p(a,[-1,1]),t=_h(n,e);return $p(t,[t.size])}{const e=$p(a,[a.shape[0],a.shape[1]]);return _h(n,e)}}});const Vm=Wc({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];const s=n.map((e,t)=>Pc(e,"tensors".concat(t),"einsum")),r={equation:e};return Tc.runKernel(Gr,s,r)}});const Um=Wc({elu_:function(e){const t={x:Pc(e,"x","elu","float32")};return Tc.runKernel(qr,t)}});const Hm=Wc({ensureShape_:function(e,t){const n=Pc(e,"x","ensureShape","string_or_numeric");if(!ss(n.shape,t))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}});const Gm=Wc({erf_:function(e){let t=Pc(e,"x","erf");$a("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=xd(t,"float32"));const n={x:t};return Tc.runKernel(Zr,n)}});function qm(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Km(e,t,n){const a=e.length+t.length,s=[];let r=0,i=0;for(let o=0;o<a;o++)-1===n.indexOf(o)?s.push(e[r++]):s.push(t[i++]);return s}function Zm(e,t){const n=[],a=e.length;for(let s=0;s<a;s++)-1===t.indexOf(s)&&n.push(e[s]);return[n,t.map(t=>e[t])]}function Xm(e,t){return Km(e,t.map(e=>1),t)}function Ym(e,t,n){$a(qm(t,n),()=>"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input."))}function Jm(e,t){if(qm(e,t))return null;const n=[];for(let a=0;a<t;++a)-1===e.indexOf(a)&&n.push(a);return e.forEach(e=>n.push(e)),n}function Qm(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function $m(e,t){const n=[];for(let a=t-e;a<t;++a)n.push(a);return n}const ef=Wc({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a={x:Pc(e,"x","max")},s={reductionIndices:t,keepDims:n};return Tc.runKernel(Ei,a,s)}});const tf=Wc({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a={x:Pc(e,"x","min")},s={axis:t,keepDims:n};return Tc.runKernel(Pi,a,s)}});const nf=Wc({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Pc(e,"x","sum");"bool"===a.dtype&&(a=xd(a,"int32"));const s={x:a},r={axis:t,keepDims:n};return Tc.runKernel(Ro,s,r)}});function af(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return Zd(e);if(1!==e.rank&&null===n)return af($p(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return nf(Zd(e),n);if(t===1/0)return ef(Zd(e),n);if(t===-1/0)return tf(Zd(e),n);if("euclidean"===t||2===t)return _d(nf(Gd(Zd(e),Ld(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return ef(nf(Zd(e),n[0]),n[1]-1);if(t===1/0)return ef(nf(Zd(e),n[1]),n[0]);if(t===-1/0)return tf(nf(Zd(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return _d(nf(Sd(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}const sf=Wc({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=af(e=Pc(e,"x","norm"),t,n);let r=s.shape;if(a){const t=ps(n,e.shape);r=Xm(s.shape,t)}return $p(s,r)}});const rf=Wc({euclideanNorm_:function(e){return sf(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});const of=Wc({exp_:function(e){const t={x:Pc(e,"x","exp")};return Tc.runKernel(Yr,t)}});const lf=Wc({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Pc(e,"x","expandDims","string_or_numeric");$a(t<=n.rank,()=>"Axis must be <= rank of the tensor");const a={input:n},s={dim:t};return Tc.runKernel(Jr,a,s)}});const cf=Wc({expm1_:function(e){const t={x:Pc(e,"x","expm1")};return Tc.runKernel(Qr,t)}});const uf=Wc({tile_:function(e,t){const n=Pc(e,"x","tile","string_or_numeric");$a(n.rank===t.length,()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,"."));const a={x:n},s={reps:t};return Tc.runKernel(Jo,a,s)}});const df=Wc({eye_:function(e,t,n){null==t&&(t=e);const a=gd([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),s=e<=t?e:t;for(let i=0;i<s;++i)a.set(1,i,i);const r=$p(a.toTensor(),[e,t]);if(null==n)return r;if(1===n.length)return uf(lf(r,0),[n[0],1,1]);if(2===n.length)return uf(lf(lf(r,0),0),[n[0],n[1],1,1]);if(3===n.length)return uf(lf(lf(lf(r,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});const hf=Wc({floor_:function(e){const t={x:Pc(e,"x","floor","float32")};return Tc.runKernel(ni,t)}});const pf=Wc({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s={x:Pc(e,"x","gather"),indices:Pc(t,"indices","gather","int32")},r={axis:n,batchDims:a};return Tc.runKernel(ri,s,r)}});const mf=Wc({greater_:function(e,t){let n=Pc(e,"a","greater","string_or_numeric"),a=Pc(t,"b","greater","string_or_numeric");[n,a]=bc(n,a),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(oi,s)}});const ff=Wc({greaterEqual_:function(e,t){let n=Pc(e,"a","greaterEqual","string_or_numeric"),a=Pc(t,"b","greaterEqual","string_or_numeric");[n,a]=bc(n,a),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(li,s)}});const gf=Wc({isFinite_:function(e){const t={x:Pc(e,"x","isFinite")};return Tc.runKernel(hi,t)}});const xf=Wc({isInf_:function(e){const t={x:Pc(e,"x","isInf")};return Tc.runKernel(pi,t)}});const yf=Wc({isNaN_:function(e){const t={x:Pc(e,"x","isNaN")};return Tc.runKernel(mi,t)}});const bf=Wc({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:Pc(e,"x","leakyRelu")},a={alpha:t};return Tc.runKernel(fi,n,a)}});const vf=Wc({less_:function(e,t){let n=Pc(e,"a","less","string_or_numeric"),a=Pc(t,"b","less","string_or_numeric");[n,a]=bc(n,a),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(gi,s)}});const wf=Wc({lessEqual_:function(e,t){let n=Pc(e,"a","lessEqual","string_or_numeric"),a=Pc(t,"b","lessEqual","string_or_numeric");[n,a]=bc(n,a),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(xi,s)}});function kf(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const a={start:e,stop:t,num:n};return Tc.runKernel(yi,{},a)}const Nf=Wc({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const r=Pc(e,"x","localResponseNormalization");$a(4===r.rank||3===r.rank,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(r.rank,".")),$a(is(t),()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,"."));let i=r,o=!1;3===r.rank&&(o=!0,i=$p(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={x:i},c={depthRadius:t,bias:n,alpha:a,beta:s},u=Tc.runKernel(ji,l,c);return o?$p(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const _f=Wc({log_:function(e){const t={x:Pc(e,"x","log","float32")};return Tc.runKernel(bi,t)}});const Sf=Wc({log1p_:function(e){const t={x:Pc(e,"x","log1p")};return Tc.runKernel(vi,t)}});const Cf=Wc({softplus_:function(e){const t={x:Pc(e,"x","softplus")};return Tc.runKernel(Eo,t)}});const jf=Wc({logSigmoid_:function(e){const t=Pc(e,"x","logSigmoid");return Rd(e=>({value:jh(Cf(jh(e))),gradFunc:t=>Nd(t,am(jh(e)))}))(t)}});const Tf=Wc({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=Pc(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));const a=Rd((e,n)=>{const a=ef(e,t,!0),s=qd(e,a),r=qd(xd(s,"float32"),_f(nf(of(s),t,!0)));n([r]);return{value:r,gradFunc:(e,n)=>{const[a]=n,s=of(a);return qd(e,Nd(nf(e,t,!0),s))}}});return a(n)}});const If=Wc({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=Pc(e,"x","logSumExp"),s=ps(t,a.shape),r=ef(a,s,!0),i=qd(a,r),o=of(i),l=nf(o,s),c=_f(l),u=vd($p(r,c.shape),c);if(n){const e=Xm(u.shape,s);return $p(u,e)}return u}});const Ef=Wc({logicalAnd_:function(e,t){const n=Pc(e,"a","logicalAnd","bool"),a=Pc(t,"b","logicalAnd","bool");Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(wi,s)}});const Af=Wc({logicalNot_:function(e){const t={x:Pc(e,"x","logicalNot","bool")};return Tc.runKernel(ki,t)}});const Rf=Wc({logicalOr_:function(e,t){const n=Pc(e,"a","logicalOr","bool"),a=Pc(t,"b","logicalOr","bool");Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(Ni,s)}});const Mf=Wc({logicalXor_:function(e,t){const n=Pc(e,"a","logicalXor","bool"),a=Pc(t,"b","logicalXor","bool");return Jd(n.shape,a.shape),Ef(Rf(e,t),Af(Ef(e,t)))}}),Lf=2147483648;const Df=Wc({searchSorted_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";const a=Pc(e,"sortedSequence","searchSorted"),s=Pc(t,"values","searchSorted"),r=a.shape[a.shape.length-1],i=s.shape[s.shape.length-1],o=$p(a,[-1,r]),l=$p(s,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(ns(l.shape)>=Lf)throw new Error("values tensor size must less than ".concat(Lf));if(o.shape[1]>=Lf)throw new Error("trailing dim_size must less than ".concat(Lf," for int32 output type, was ").concat(o.shape[1]));const c={sortedSequence:o,values:l},u={side:n};return Tc.runKernel(ko,c,u)}});function Of(e,t){return Df(e,t,"left")}const Ff=Wc({maxPool_:function(e,t,n,a,s){const r=Pc(e,"x","maxPool");let i=r,o=!1;3===r.rank&&(o=!0,i=$p(r,[1,r.shape[0],r.shape[1],r.shape[2]])),$a(4===i.rank,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(i.rank,".")),$a(Xp(n,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")),Qp("maxPool",a,s);const l={x:i},c={filterSize:t,strides:n,pad:a,dimRoundingMode:s},u=Tc.runKernel(Ri,l,c);return o?$p(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const Pf=Wc({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const i=Pc(e,"x","maxPool3d");let o=i,l=!1;4===i.rank&&(l=!0,o=$p(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),$a(5===o.rank,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(o.rank,".")),$a("NDHWC"===r,()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(r)),Qp("maxPool3d",a,s);const c={x:o},u={filterSize:t,strides:n,pad:a,dimRoundingMode:s,dataFormat:r},d=Tc.runKernel(Li,c,u);return l?$p(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const zf=Wc({maxPoolWithArgmax_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const r={x:Pc(e,"x","maxPoolWithArgmax")},i={filterSize:t,strides:n,pad:a,includeBatchInIndex:s},o=Tc.runKernel(Oi,r,i);return{result:o[0],indexes:o[1]}}});const Bf=Wc({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a={x:Pc(e,"x","mean")},s={axis:t,keepDims:n};return Tc.runKernel(Fi,a,s)}});function Wf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(Ds(e),"complex64"===t){const t=Wf(e,"float32"),n=Wf(e,"float32");return Vc(t,n)}const n=Ms(ns(e),t);return Tc.makeTensor(n,e,t)}function Vf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(Ds(e),"complex64"===t){const t=Vf(e,"float32"),n=Wf(e,"float32");return Vc(t,n)}const n=Rs(ns(e),t);return Tc.makeTensor(n,e,t)}function Uf(e,t){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===e)return[];let a=Pc(e,"x","meshgrid",e instanceof ic?e.dtype:"float32");if(void 0===t)return[a];let s=Pc(t,"y","meshgrid",t instanceof ic?t.dtype:"float32");const r=ns(a.shape),i=ns(s.shape);return"xy"===n?(a=$p(a,[1,-1]),s=$p(s,[-1,1]),[_h(Vf([i,1],a.dtype),a),_h(s,Vf([1,r],s.dtype))]):(a=$p(a,[-1,1]),s=$p(s,[1,-1]),[_h(a,Vf([1,i],a.dtype)),_h(Vf([r,1],s.dtype),s)])}const Hf=Wc({minimum_:function(e,t){let n=Pc(e,"a","minimum"),a=Pc(t,"b","minimum");[n,a]=bc(n,a),"bool"===n.dtype&&(n=xd(n,"int32"),a=xd(a,"int32")),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(zi,s)}});const Gf=Wc({mirrorPad_:function(e,t,n){$a("reflect"===n||"symmetric"===n,()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,"."));const a=Pc(e,"x","mirrorPad");if(0===a.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");$a(t.length===a.rank,()=>"Padding doesn't match input. Must be ".concat(a.rank,". ")+"Got ".concat(t.length,"."));const s="reflect"===n?1:0;for(let o=0;o<a.rank;o++)$a(2===t[o].length,()=>"Invalid number of paddings. Must be length of 2 each."),$a(t[o][0]>=0&&t[o][0]<=a.shape[o]-s&&t[o][1]>=0&&t[o][1]<=a.shape[o]-s,()=>"Padding in dimension ".concat(o," cannot be greater than or equal ")+"to ".concat(a.shape[o]-s," or less than 0 for input of ")+"shape ".concat(a.shape));const r={paddings:t,mode:n},i={x:a};return Tc.runKernel(Bi,i,r)}});const qf=Wc({mod_:function(e,t){let n=Pc(e,"a","mod"),a=Pc(t,"b","mod");[n,a]=bc(n,a);const s={a:n,b:a};return Tc.runKernel(Wi,s)}});const Kf=Wc({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=ps(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=Pc(e,"x","moments")).shape),a=Bf(e,n,t);let s=a.shape;t||(s=Xm(a.shape,n));const r=Sd(qd(xd(e,"float32"),$p(a,s)));return{mean:a,variance:Bf(r,n,t)}}});const Zf=Wc({multiRNNCell_:function(e,t,n,a){const s=Pc(t,"data","multiRNNCell"),r=zc(n,"c","multiRNNCell"),i=zc(a,"h","multiRNNCell");let o=s;const l=[];for(let d=0;d<e.length;d++){const t=e[d](o,r[d],i[d]);l.push(t[0]),l.push(t[1]),o=t[1]}const c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}});const Xf=Wc({multinomial_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=Pc(e,"logits","multinomial"),r=s.size,i=s.rank;if(r<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(r,"."));if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(i));n=n||Math.random();const o={logits:1===i?$p(s,[1,-1]):s},l={numSamples:t,seed:n,normalized:a},c=Tc.runKernel(Vi,o,l);return 1===i?$p(c,[c.size]):c}});const Yf=Wc({notEqual_:function(e,t){let n=Pc(e,"a","notEqual","string_or_numeric"),a=Pc(t,"b","notEqual","string_or_numeric");[n,a]=bc(n,a),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(Gi,s)}});const Jf=Wc({onesLike_:function(e){const t={x:Pc(e,"x","onesLike")};return Tc.runKernel(Xi,t)}});const Qf=Wc({outerProduct_:function(e,t){const n=Pc(e,"v1","outerProduct"),a=Pc(t,"v2","outerProduct");$a(1===n.rank&&1===a.rank,()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(a.rank,"."));const s=$p(n,[-1,1]),r=$p(a,[1,-1]);return _h(s,r)}});const $f=Wc({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=Pc(e,"x","pad");if(0===a.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:t,constantValue:n},r={x:a};return Tc.runKernel(Qi,r,s)}});const eg=Wc({pad1d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $a(2===t.length,()=>"Invalid number of paddings. Must be length of 2."),$f(e,[t],n)}});const tg=Wc({pad2d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $a(2===t.length&&2===t[0].length&&2===t[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),$f(e,t,n)}});const ng=Wc({pad3d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $a(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),$f(e,t,n)}});const ag=Wc({pad4d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $a(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),$f(e,t,n)}});const sg=Wc({spaceToBatchND_:function(e,t,n){const a=Pc(e,"x","spaceToBatchND");$a(a.rank>=1+t.length,()=>"input rank ".concat(a.rank," should be > than [blockShape] ").concat(t.length)),$a(n.length===t.length,()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)),$a(a.shape.reduce((e,a,s)=>s>0&&s<=t.length?e&&(a+n[s-1][0]+n[s-1][1])%t[s-1]===0:e,!0),()=>"input spatial dimensions ".concat(a.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString()));const s={x:a},r={blockShape:t,paddings:n};return Tc.runKernel(Mo,s,r)}});const rg=Wc({pool_:function(e,t,n,a,s,r,i){null==s&&(s=[1,1]),null==r&&(r=1),0===a&&(a="valid");const o=Pc(e,"x","maxPool");let l=o,c=!1;3===o.rank&&(c=!0,l=$p(o,[1,o.shape[0],o.shape[1],o.shape[2]])),$a(Xp(r,s),()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(s,"'"));const u=zp(l.shape,t,r,s,a),d=[u.dilationHeight,u.dilationWidth];let h;h="same"===a?function(e,t){const n=e.map((e,n)=>e+(e-1)*(t[n]-1)),a=n.map(e=>e-1),s=a.map(e=>Math.floor(e/2)),r=a.map((e,t)=>e-s[t]);return a.map((e,t)=>[s[t],r[t]])}([u.filterHeight,u.filterWidth],d):[[0,0],[0,0]];const p=1===d[0]&&1===d[1],[m,f]=function(e,t,n){const a=n.map(e=>e[0]),s=n.map(e=>e[1]),r=e.concat(a,s),i=t.map((e,t)=>(e-r[t]%e)%e),o=s.map((e,t)=>e+i[t]),l=t.map((e,t)=>[a[t],o[t]]),c=t.map((e,t)=>[0,i[t]]);return[l,c]}([u.inHeight,u.inWidth],d,h),g=p?a:"valid",x=p?l:sg(l,d,m),y=("avg"===n?()=>em(x,t,r,g,i):()=>Ff(x,t,r,g,i))(),b=p?y:om(y,d,f);return c?$p(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});const ig=Wc({prelu_:function(e,t){const n={x:Pc(e,"x","prelu"),alpha:Pc(t,"alpha","prelu")};return Tc.runKernel(to,n)}});const og=Wc({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=Pc(e,"x","prod");"bool"===a.dtype&&(a=xd(a,"int32"));const s={x:a},r={axis:t,keepDims:n};return Tc.runKernel(no,s,r)}});const lg=Wc({raggedGather_:function(e,t,n,a){const s={paramsNestedSplits:e.map((e,t)=>Pc(e,"tensors".concat(t),"raggedGather","int32")),paramsDenseValues:Pc(t,"paramsDenseValues","raggedGather"),indices:Pc(n,"indices","raggedGather","int32")},r={outputRaggedRank:a},i=Tc.runKernel(ao,s,r);return{outputNestedSplits:i.slice(0,i.length-1),outputDenseValues:i[i.length-1]}}});const cg=Wc({raggedRange_:function(e,t,n){const a=Pc(e,"starts","raggedRange"),s={starts:a,limits:Pc(t,"limits","raggedRange",a.dtype),deltas:Pc(n,"deltas","raggedRange",a.dtype)},r=Tc.runKernel(so,s);return{rtNestedSplits:r[0],rtDenseValues:r[1]}}});const ug=Wc({raggedTensorToTensor_:function(e,t,n,a,s){const r=Pc(e,"shape","raggedTensorToTensor","int32"),i=Pc(t,"values","raggedTensorToTensor"),o={shape:r,values:i,defaultValue:Pc(n,"defaultValue","raggedTensorToTensor",i.dtype),rowPartitionTensors:a.map((e,t)=>Pc(e,"tensors".concat(t),"raggedTensorToTensor","int32"))},l={rowPartitionTypes:s};return Tc.runKernel(ro,o,l)}});const dg=Wc({rand_:function(e,t,n){Ds(e);const a=ns(e);let s=null;if(null==n||"float32"===n)s=new Float32Array(a);else if("int32"===n)s=new Int32Array(a);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));s=new Uint8Array(a)}for(let r=0;r<a;r++)s[r]=t();return Tc.makeTensor(s,e,n)}});var hg=n(334);class pg{constructor(e,t,n,a,s){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const r=s||Math.random();this.random=hg.alea(r.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let a,s,r;do{a=2*this.random()-1,s=2*this.random()-1,r=a*a+s*s}while(r>=1||0===r);const i=Math.sqrt(-2*Math.log(r)/r);e=this.mean+this.stdDev*a*i,t=this.mean+this.stdDev*s*i,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class mg{constructor(e,t,n,a){this.alpha=e,this.beta=1/t,this.dtype=n;const s=a||Math.random();this.randu=hg.alea(s.toString()),this.randn=new pg(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,a,s,r;for(;;){do{a=this.randn.nextValue(),r=1+this.c*a}while(r<=0);if(r*=r*r,e=a*a,t=1-.331*e*e,n=.5*e+this.d*(1-r+Math.log(r)),s=this.randu(),s<t||Math.log(s)<n)break}return r=1/this.beta*this.d*r,this.alpha<1&&(r*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(r)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}}class fg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==a&&(a=Math.random()),"number"===typeof a&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=hg.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const gg=Wc({randomGamma_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",s=arguments.length>4?arguments[4]:void 0;if(Ds(e),null==n&&(n=1),null==a&&(a="float32"),"float32"!==a&&"int32"!==a)throw new Error("Unsupported data type ".concat(a));const r=new mg(t,n,a,s),i=gd(e,a);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}});const xg=Wc({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(Ds(e),null!=a&&"bool"===a)throw new Error("Unsupported data type ".concat(a));const r=new pg(t,n,a,!1,s),i=gd(e,a);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}});const yg=Wc({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return xg(e,0,1,t,n)}});const bg=Wc({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",s=arguments.length>4?arguments[4]:void 0;Ds(e);const r=gd(e,a),i=new fg(t,n,null,s);for(let o=0;o<r.values.length;o++)r.values[o]=i.nextValue();return r.toTensor()}});const vg=Wc({randomUniformInt_:function(e,t,n,a){return bg(e,t,n,"int32",a)}});function wg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const s={start:e,stop:t,step:n,dtype:a};return Tc.runKernel(io,{},s)}const kg=Wc({reciprocal_:function(e){const t={x:Pc(e,"x","reciprocal")};return Tc.runKernel(lo,t)}});const Ng=Wc({relu_:function(e){const t={x:Pc(e,"x","relu")};return Tc.runKernel(co,t)}});const _g=Wc({relu6_:function(e){const t={x:Pc(e,"x","relu6")};return Tc.runKernel(go,t)}});const Sg=Wc({reverse_:function(e,t){const n={x:Pc(e,"x","reverse")},a={dims:t};return Tc.runKernel(xo,n,a)}});const Cg=Wc({reverse1d_:function(e){const t=Pc(e,"x","reverse");return $a(1===t.rank,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")),Sg(t,0)}});const jg=Wc({reverse2d_:function(e,t){const n=Pc(e,"x","reverse");return $a(2===n.rank,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")),Sg(n,t)}});const Tg=Wc({reverse3d_:function(e,t){const n=Pc(e,"x","reverse");return $a(3===n.rank,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")),Sg(n,t)}});const Ig=Wc({reverse4d_:function(e,t){const n=Pc(e,"x","reverse");return $a(4===n.rank,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")),Sg(n,t)}});const Eg=Wc({round_:function(e){const t={x:Pc(e,"x","round")};return Tc.runKernel(yo,t)}});const Ag=Wc({rsqrt_:function(e){const t={x:Pc(e,"x","rsqrt","float32")};return Tc.runKernel(bo,t)}});const Rg=Wc({selu_:function(e){const t={x:Pc(e,"x","selu")};return Tc.runKernel(_o,t)}});const Mg=Wc({separableConv2d_:function(e,t,n,a,s){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const o=Pc(e,"x","separableConv2d"),l=Pc(t,"depthwiseFilter","separableConv2d"),c=Pc(n,"pointwiseFilter","separableConv2d");let u=o,d=!1;if(3===o.rank&&(d=!0,u=$p(o,[1,o.shape[0],o.shape[1],o.shape[2]])),"NCHW"===i)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");$a(4===u.rank,()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(u.rank,".")),$a(4===l.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(l.rank,".")),$a(4===c.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(l.rank,".")),$a(1===c.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")),$a(1===c.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],"."));const h=l.shape[2],p=l.shape[3];$a(c.shape[2]===h*p,()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(h*p,", ")+"but got ".concat(c.shape[2],"."));const m=Dm(u,l,a,s,i,r),f=km(m,c,1,"valid",i);return d?$p(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const Lg=async function(e,t){const n=Pc(e,"x","setdiff1d"),a=Pc(t,"y","setdiff1d");$a(n.dtype===a.dtype,()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(a.dtype,").")),$a(1===n.rank,()=>"x should be 1D tensor, but got x (".concat(n.shape,").")),$a(1===a.rank,()=>"y should be 1D tensor, but got y (".concat(a.shape,")."));const s=await n.data(),r=await a.data(),i=new Set(r);let o=0;for(let u=0;u<s.length;u++)i.has(s[u])||o++;const l=new nc([o],n.dtype),c=new nc([o],"int32");for(let u=0,d=0;u<s.length;u++)i.has(s[u])||(l.values[d]=s[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]};const Dg=Wc({sign_:function(e){const t={x:Pc(e,"x","sign")};return Tc.runKernel(To,t)}});const Og=Wc({sin_:function(e){const t={x:Pc(e,"x","sin","float32")};return Tc.runKernel(Co,t)}});const Fg=Wc({sinh_:function(e){const t={x:Pc(e,"x","sinh")};return Tc.runKernel(jo,t)}});const Pg=Wc({slice1d_:function(e,t,n){const a=Pc(e,"x","slice1d");return $a(1===a.rank,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(a.rank," tensor")),sm(a,[t],[n])}});const zg=Wc({slice2d_:function(e,t,n){const a=Pc(e,"x","slice2d");return $a(2===a.rank,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(a.rank," tensor")),sm(a,t,n)}});const Bg=Wc({slice3d_:function(e,t,n){const a=Pc(e,"x","slice3d");return $a(3===a.rank,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(a.rank," tensor")),sm(a,t,n)}});const Wg=Wc({slice4d_:function(e,t,n){const a=Pc(e,"x","slice4d");return $a(4===a.rank,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(a.rank," tensor")),sm(a,t,n)}});const Vg=Wc({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=Pc(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));const a={logits:n},s={dim:t};return Tc.runKernel(Do,a,s)}});const Ug=Wc({fft_:function(e){$a("complex64"===e.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,"."));const t={input:e};return Tc.runKernel($r,t)}});const Hg=Wc({ifft_:function(e){$a("complex64"===e.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,"."));const t={input:e};return Tc.runKernel(ui,t)}});const Gg=Wc({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let a;if(t<=2){const s=$p(e,[n,t]);a=Hg(s)}else{const s=[n,2*(t-1)],r=$p(Th(e),[n,t]),i=$p(Ch(e),[n,t]),o=Sg(sm(r,[0,1],[n,t-2]),1),l=Nd(Sg(sm(i,[0,1],[n,t-2]),1),Ld(-1)),c=nm([r,o],1),u=nm([i,l],1),d=$p(Vc(c,u),[s[0],s[1]]);a=Hg(d)}if(a=Th(a),3===e.rank&&0!==e.shape[0]){const t=a,n=e.shape[0];a=$p(a,[n,a.shape[0]/n,a.shape[1]]),t.dispose()}return a}});const qg=Wc({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a={x:Pc(e,"x","split")},s={numOrSizeSplits:t,axis:n};return Tc.runKernel(Lo,a,s)}});const Kg=Wc({rfft_:function(e,t){$a("float32"===e.dtype,()=>"The dtype for rfft() must be real value but got ".concat(e.dtype));let n=e.shape[e.shape.length-1];const a=e.size/n;let s;if(null!=t&&t<n){const a=e.shape.map(e=>0),r=e.shape.map(e=>e);r[e.shape.length-1]=t,s=sm(e,a,r),n=t}else if(null!=t&&t>n){const a=e.shape.map(e=>e);a[e.shape.length-1]=t-n,s=nm([e,Wf(a)],e.shape.length-1),n=t}else s=e;const r=Cd(s),i=$p(Vc(s,r),[a,n]),o=Ug(i),l=Math.floor(n/2)+1,c=Th(o),u=Ch(o),d=qg(c,[l,n-l],c.shape.length-1),h=qg(u,[l,n-l],u.shape.length-1),p=s.shape.slice();return p[s.shape.length-1]=l,$p(Vc(d[0],h[0]),p)}});const Zg=Wc({squaredDifference_:function(e,t){let n=Pc(e,"a","squaredDifference"),a=Pc(t,"b","squaredDifference");[n,a]=bc(n,a),Jd(n.shape,a.shape);const s={a:n,b:a};return Tc.runKernel(Wo,s,{})}});const Xg=Wc({squeeze_:function(e,t){const n=Pc(e,"x","squeeze","string_or_numeric");return $p(n,ms(n.shape,t).newShape)}});const Yg=Wc({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=zc(e,"tensors","stack","string_or_numeric");$a(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&$a(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const a=n,s={axis:t};return Tc.runKernel(Ji,a,s)}});const Jg=Wc({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:Pc(e,"x","step")},a={alpha:t};return Tc.runKernel(il,n,a)}});const Qg=Wc({stridedSlice_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const c={x:Pc(e,"x","stridedSlice","string_or_numeric")},u={begin:t,end:n,strides:a,beginMask:s,endMask:r,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return Tc.runKernel(Ho,c,u)}});const $g=Wc({tan_:function(e){const t={x:Pc(e,"x","tan","float32")};return Tc.runKernel(Xo,t)}});function ex(e,t){ts(e);const n=Dc(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Uc(e,null,n,t)}function tx(e,t,n){if(ts(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const a=Dc(e,n);if(2!==a.length&&1!==a.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Uc(e,t,a,n)}function nx(e,t,n){if(ts(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");const a=Dc(e,n);if(4!==a.length&&1!==a.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Uc(e,t,a,n)}function ax(e,t,n){if(ts(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");const a=Dc(e,n);if(5!==a.length&&1!==a.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Uc(e,t,a,n)}function sx(e,t,n){if(ts(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");const a=Dc(e,n);if(6!==a.length&&1!==a.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Uc(e,t=t||a,a,n)}const rx=Wc({tensorScatterUpdate_:function(e,t,n){const a=Pc(e,"tensor","tensorScatterupdate"),s=Pc(t,"indices","tensorScatterupdate","int32"),r=Pc(n,"updates","tensorScatterupdate");if(Uh(r,s,a.shape),a.dtype!==r.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(a.dtype," and ").concat(r.dtype,"."));const i={tensor:a,indices:s,updates:r};return Tc.runKernel(wo,i,{})}});const ix=Wc({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=Pc(e,"x","topk");if(0===a.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const s=a.shape[a.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>s)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(s,") ")+"but got ".concat(t));const r={x:a},i={k:t,sorted:n},[o,l]=Tc.runKernel(Qo,r,i);return{values:o,indices:l}}});const ox=Wc({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(Ds(e),null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");const r=new pg(t,n,a,!0,s),i=gd(e,a);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}});const lx=Wc({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Pc(e,"x","unique","string_or_numeric");$a(n.rank>0,()=>"The input tensor must be at least 1D");const a={x:n},s={axis:t},[r,i]=Tc.runKernel(tl,a,s);return{values:r,indices:i}}});const cx=Wc({unsortedSegmentSum_:function(e,t,n){const a=Pc(e,"x","unsortedSegmentSum"),s=Pc(t,"segmentIds","unsortedSegmentSum","int32");$a(is(n),()=>"numSegments must be of dtype int");const r={x:a,segmentIds:s},i={numSegments:n};return Tc.runKernel(al,r,i)}});const ux=Wc({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Pc(e,"x","unstack","string_or_numeric");$a(t>=-n.shape.length&&t<n.shape.length,()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")"));const a={value:n},s={axis:t};return Tc.runKernel(nl,a,s)}});function dx(e,t){return Df(e,t,"right")}function hx(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return Tc.makeVariable(e,t,n,a)}function px(e,t){const n=[];for(let r=0;r<t.length;r++)t[r]&&n.push(r);const a=gd(e,"int32"),s=gd([n.length,e.length],"int32");for(let r=0;r<n.length;r++){const t=a.indexToLoc(n[r]),i=r*e.length;s.values.set(t,i)}return s.toTensor()}const mx=async function(e){const t=Pc(e,"condition","whereAsync","bool"),n=await t.data(),a=px(t.shape,n);return e!==t&&t.dispose(),a};const fx=async function(e,t,n){const a=Pc(e,"tensor","boolMask"),s=Pc(t,"mask","boolMask","bool"),r=null==n?0:n,i=s.rank,o=a.shape;$a(i>0,()=>"mask cannot be scalar"),es(o.slice(r,r+i),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let f=r;f<r+i;f++)l*=o[f];const c=o.slice(0,r).concat([l],o.slice(r+i)),u=$p(a,c),d=$p(s,[-1]),h=await mx(d),p=Xg(h,[1]),m=pf(u,p,r);return e!==a&&a.dispose(),t!==s&&s.dispose(),p.dispose(),u.dispose(),d.dispose(),h.dispose(),m};const gx=Wc({movingAverage_:function(e,t,n,a){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const r=Pc(e,"v","movingAverage"),i=Pc(t,"x","movingAverage"),o=Pc(n,"decay","movingAverage");vc(r,i),$a(rs(r.shape,i.shape),()=>"Shape mismatch in v and x");const l=Ld(1),c=qd(l,o);let u=Nd(qd(i,r),c);if(s){$a(null!=a,()=>"When using zeroDebias: true, step is required.");const e=Pc(a,"step","movingAverage");u=kd(u,qd(l,Gd(o,e)))}return vd(r,u)}});const xx=Wc({scatterND_:function(e,t,n){Ds(n);const a=Pc(e,"indices","scatterND","int32"),s=Pc(t,"updates","scatterND");Uh(s,a,n);const r={indices:a,updates:s},i={shape:n};return Tc.runKernel(vo,r,i)}});const yx=Wc({sparseToDense_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Ds(n);const s=Pc(e,"sparseIndices","sparseToDense","int32"),r=Pc(t,"sparseValues","sparseToDense","string_or_numeric"),i=Pc(a,"defaultValue","sparseToDense",r.dtype);!function(e,t,n,a){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));const s=e.rank>0?e.shape[0]:1,r=e.rank>1?e.shape[1]:1;if(n.length!==r)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(r,"."));const i=t.size;if(0!==t.rank&&(1!==t.rank||i!==s))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(s,"]"));if(t.dtype!==a.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(s,r,n,i);const o={sparseIndices:s,sparseValues:r,defaultValue:i},l={outputShape:n};return Tc.runKernel(Bo,o,l)}});const bx=Wc({gatherND_:function(e,t){const n=Pc(t,"indices","gatherND","int32"),a={params:Pc(e,"x","gatherND","string_or_numeric"),indices:n};return Tc.runKernel(ii,a)}});const vx=Wc({dropout_:function(e,t,n,a){const s=Pc(e,"x","dropout");if($a("float32"===s.dtype,()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(s.dtype," tensor instead.")),$a(t>=0&&t<1,()=>"rate must be a float in the range [0, 1), but got ".concat(t,".")),0===t)return e instanceof ic?s.clone():s;const r=function(e,t){if(null==t)return e.shape.slice();if(rs(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let a=0;a<e.shape.length;a++)null==t[a]&&null!=e.shape[a]?n.push(e.shape[a]):n.push(t[a]);return n}return t}(s,n),i=1-t,o=kd(hf(vd(bg(r,0,1,"float32",a),i)),i);return Nd(s,o)}});function wx(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function kx(e,t,n){const a=1-e%2,s=new Float32Array(e);for(let r=0;r<e;++r){const i=2*Math.PI*r/(e+a-1);s[r]=t-n*Math.cos(i)}return ex(s,"float32")}const Nx=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const a=Pc(e,"predictions","inTopK"),s=Pc(t,"targets","inTopK");$a(a.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)),$a(a.rank-1===s.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(s.rank)),es(a.shape.slice(0,a.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const r=a.shape[a.shape.length-1];$a(n>0&&n<=r,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(r,"), but got ").concat(n));const i=await a.data(),o=await s.data(),[l,c]=[i.length/r,r],u=fs("bool",l);for(let d=0;d<l;d++){const e=d*c,t=i.subarray(e,e+c),a=[];for(let n=0;n<t.length;n++)a.push({value:t[n],index:n});a.sort((e,t)=>t.value-e.value),u[d]=0;for(let s=0;s<n;s++)if(a[s].index===o[d]){u[d]=1;break}}return e!==a&&a.dispose(),t!==s&&s.dispose(),Hc(u,s.shape,"bool")};const _x=Wc({conv2DBackpropFilter_:function(e,t,n,a,s){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=$p(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=$p(t,[1,t.shape[0],t.shape[1],t.shape[2]])),$a(4===o.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(o.shape,".")),$a(4===l.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(l.shape,".")),$a(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,"."));const c="NHWC"===r?o.shape[3]:o.shape[1],u="NHWC"===r?l.shape[3]:l.shape[1];$a(c===n[2],()=>"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")),$a(u===n[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must ")+"match output depth for filter (".concat(n[3],").")),Qp("conv2dDerFilter",s,i);const d={x:o,dy:l},h={strides:a,pad:s,dataFormat:r,dimRoundingMode:i,filterShape:n};return Tc.runKernel(_r,d,h)}});function Sx(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Nd(e,Jg(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function Cx(e,t){let n=t;const a=Yd(e.shape,t.shape);return a.length>0&&(n=nf(n,a)),$p(n,e.shape)}function jx(e,t,n,a){if("linear"===t)return e;if("relu"===t)return Ng(e);if("elu"===t)return Um(e);if("relu6"===t)return _g(e);if("prelu"===t)return ig(e,n);if("leakyrelu"===t)return bf(e,a);if("sigmoid"===t)return am(e);throw new Error("Unknown fused activation ".concat(t,"."))}const Tx=(e,t)=>!(e>0)||"linear"===t;const Ix=Wc({fusedConv2d_:function(e){let{x:t,filter:n,strides:a,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:d}=e;if(c=c||"linear",!1===Tx(Tc.state.gradientDepth,c)){$a("NHWC"===r,()=>"Error in fused conv2d: got dataFormat of ".concat(r," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.");let e=km(t,n,a,s,r,i,o);return null!=l&&(e=vd(e,l)),jx(e,c,u,d)}const h=Pc(t,"x","conv2d","float32"),p=Pc(n,"filter","conv2d","float32");let m=h,f=!1;3===h.rank&&(f=!0,m=$p(h,[1,h.shape[0],h.shape[1],h.shape[2]])),$a(4===m.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(m.rank,".")),$a(4===p.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")),Qp("fused conv2d",s,o);const g="NHWC"===r?m.shape[3]:m.shape[1];$a(p.shape[2]===g,()=>"Error in conv2d: depth of input (".concat(g,") must match ")+"input depth for filter ".concat(p.shape[2],".")),$a(Xp(a,i),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(i,"'"));const x=Wp(m.shape,p.shape,a,i,s,o);let y,b;if(null!=l&&(y=Pc(l,"bias","fused conv2d"),[y]=bc(y,h),"NHWC"===r?Jd(x.outShape,y.shape):($a(y.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(y.shape.length,".")),$a(0===y.shape.length||y.shape[0]===x.outChannels||1===y.shape[0],()=>"Error in fused conv2d: bias shape (".concat(y.shape,") is not ")+"compatible with the number of output channels "+"(".concat(x.outChannels,")")))),null!=u){const e=u.shape;if($a(e.length<=1||3===e.length,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(e.length,".")),1===e.length)$a(1===e[0]||e[0]===x.outChannels,()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(e,") is not compatible with the number of output ")+"channels (".concat(x.outChannels,")."));else if(3===e.length)try{Jd(e,x.outShape)}catch(vq){const n="Error in fused conv2d: PReLU activation weights (".concat(e,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(x.outShape,").");throw Error(n)}b=Pc(u,"prelu weights","fused conv2d")}const v=(e,t)=>{$a("NHWC"===r,()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(r," but only NHWC is currently supported."));const[n,o,l,u]=t,d=Sx(e,l,c);$a(Zp(i),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(i,"'"));const h=[_m(o.shape,d,n,a,s),_x(o,d,n.shape,a,s)];if(null!=u){const e=Cx(u,d);h.push(e)}return h},w={x:m,filter:p,bias:y,preluActivationWeights:b},k={strides:a,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:c,leakyreluAlpha:d};if(null==l){const e=Rd((e,t,n)=>{let a=Tc.runKernel(ul,w,k);return n([t,e,a]),f&&(a=$p(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:v}});return e(m,p)}{const e=Rd((e,t,n,a)=>{let s=Tc.runKernel(ul,w,k);return a([t,e,s,n]),f&&(s=$p(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:v}});return e(m,p,y)}}});const Ex=Wc({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,a,s){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,o=e;3===e.rank&&(o=$p(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=$p(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:o,dy:l},u={strides:a,pad:s,dimRoundingMode:i,dilations:r,filterShape:n};return Tc.runKernel(Fr,c,u)}});const Ax=Wc({depthwiseConv2dNativeBackpropInput_:function(e,t,n,a,s){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,o=t,l=!1;3===t.rank&&(l=!0,o=$p(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:o,filter:n},u={strides:a,pad:s,dimRoundingMode:i,dilations:r,inputShape:e},d=Tc.runKernel(Pr,c,u);return l?$p(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});const Rx=Wc({fusedDepthwiseConv2d_:function(e){let{x:t,filter:n,strides:a,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:d}=e;if(!1===Tx(Tc.state.gradientDepth,c)){let e=Dm(t,n,a,s,r,i,o);return null!=l&&(e=vd(e,l)),jx(e,c,u,d)}const h=Pc(t,"x","depthwiseConv2d","float32"),p=Pc(n,"filter","depthwiseConv2d","float32");let m=h,f=!1;3===h.rank&&(f=!0,m=$p(h,[1,h.shape[0],h.shape[1],h.shape[2]])),$a(4===m.rank,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(m.rank,".")),$a(4===p.rank,()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(p.rank,".")),$a(m.shape[3]===p.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(m.shape[3],") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],".")),null==i&&(i=[1,1]),$a(Xp(a,i),()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(a," and dilations '").concat(i,"'")),Qp("fused depthwiseConv2d",s,o);const g=Wp(m.shape,p.shape,a,i,s,o,!0);let x,y;null!=l&&(x=Pc(l,"bias","fused conv2d"),[x]=bc(x,h),Jd(g.outShape,x.shape)),null!=u&&(y=Pc(u,"prelu weights","fused depthwiseConv2d"));const b=(e,t)=>{$a(Zp(i),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(i,"'"));const[n,r,l,u]=t,d=Sx(e,l,c),h=Ax(r.shape,d,n,a,s,i,o),p=Ex(r,d,n.shape,a,s,i,o);if(null!=u){return[h,p,Cx(x,d)]}return[h,p]},v={x:m,filter:p,bias:x,preluActivationWeights:y},w={strides:a,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:c,leakyreluAlpha:d};if(null==l){const e=Rd((e,t,n)=>{let a=Tc.runKernel(dl,v,w);return n([t,e,a]),f&&(a=$p(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:b}});return e(m,p)}{const e=Rd((e,t,n,a)=>{let s=Tc.runKernel(dl,v,w);return a([t,e,s,n]),f&&(s=$p(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:b}});return e(m,p,x)}}});const Mx=Wc({fusedMatMul_:function(e){let{a:t,b:n,transposeA:a=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:l=.2}=e;if(!1===Tx(Tc.state.gradientDepth,i)){let e=_h(t,n,a,s);return null!=r&&(e=vd(e,r)),jx(e,i,o,l)}let c=Pc(t,"a","fused matMul"),u=Pc(n,"b","fused matMul");[c,u]=bc(c,u);const d=a?c.shape[c.rank-2]:c.shape[c.rank-1],h=s?u.shape[u.rank-1]:u.shape[u.rank-2],p=a?c.shape[c.rank-1]:c.shape[c.rank-2],m=s?u.shape[u.rank-2]:u.shape[u.rank-1],f=c.shape.slice(0,-2),g=u.shape.slice(0,-2),x=ns(f),y=ns(g);$a(d===h,()=>"Error in fused matMul: inner shapes (".concat(d,") and (")+"".concat(h,") of Tensors with shapes ").concat(c.shape," and ")+"".concat(u.shape," and transposeA=").concat(a)+" and transposeB=".concat(s," must match."));const b=Jd(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,m]),v=$p(c,a?[x,d,p]:[x,p,d]),w=$p(u,s?[y,m,h]:[y,h,m]);let k,N;null!=r&&(k=Pc(r,"bias","fused matMul"),[k]=bc(k,c),Jd(b,k.shape)),null!=o&&(N=Pc(o,"prelu weights","fused matMul"));const _=(e,t)=>{const[n,o,l,c]=t,u=Sx($p(e,l.shape),l,i);let d,h;if(a||s?!a&&s?(d=_h(u,o,!1,!1),h=_h(u,n,!0,!1)):a&&!s?(d=_h(o,u,!1,!0),h=_h(n,u,!1,!1)):(d=_h(o,u,!0,!0),h=_h(u,n,!0,!0)):(d=_h(u,o,!1,!0),h=_h(n,u,!0,!1)),null!=r){return[d,h,Cx(c,u)]}return[d,h]},S={a:v,b:w,bias:k,preluActivationWeights:N},C={transposeA:a,transposeB:s,activation:i,leakyreluAlpha:l};if(null==r){const e=Rd((e,t,n)=>{const a=Tc.runKernel(cl,S,C);return n([e,t,a]),{value:$p(a,b),gradFunc:_}});return e(v,w)}{const e=Rd((e,t,n,a)=>{const s=Tc.runKernel(cl,S,C);return a([e,t,s,n]),{value:$p(s,b),gradFunc:_}});return e(v,w,k)}}});const Lx=Wc({hammingWindow_:function(e){return kx(e,.54,.46)}});const Dx=Wc({hannWindow_:function(e){return kx(e,.5,.5)}});const Ox=Wc({frame_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=0;const i=[];for(;r+t<=e.size;)i.push(sm(e,r,t)),r+=n;if(a)for(;r<e.size;){const a=r+t-e.size,o=nm([sm(e,r,t-a),Ud([a],s)]);i.push(o),r+=n}return 0===i.length?tx([],[0,t]):$p(nm(i),[i.length,t])}});const Fx=Wc({stft_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Dx;null==a&&(a=wx(t));const r=Ox(e,t,n),i=Nd(r,s(t));return Kg(i,a)}});const Px=Wc({cropAndResize_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=Pc(e,"image","cropAndResize"),o=Pc(t,"boxes","cropAndResize","float32"),l=Pc(n,"boxInd","cropAndResize","int32"),c=o.shape[0];$a(4===i.rank,()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(i.rank,".")),$a(2===o.rank&&4===o.shape[1],()=>"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(o.shape,".")),$a(1===l.rank&&l.shape[0]===c,()=>"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(o.shape,".")),$a(2===a.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(a.length,".")),$a(a[0]>=1&&a[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(a)),$a("bilinear"===s||"nearest"===s,()=>"method must be bilinear or nearest, but was ".concat(s));const u={image:i,boxes:o,boxInd:l},d={method:s,extrapolationValue:r,cropSize:a};return Tc.runKernel(Mr,u,d)}});const zx=Wc({flipLeftRight_:function(e){const t=Pc(e,"image","flipLeftRight","float32");$a(4===t.rank,()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,"."));const n={image:t};return Tc.runKernel(ti,n,{})}});const Bx=Wc({grayscaleToRGB_:function(e){const t=Pc(e,"image","grayscaleToRGB"),n=t.rank-1,a=t.shape[n];$a(t.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")),$a(1===a,()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(a,"."));const s=new Array(t.rank);return s.fill(1,0,n),s[n]=3,uf(t,s)}});const Wx=Wc({rgbToGrayscale_:function(e){const t=Pc(e,"image","RGBToGrayscale"),n=t.rank-1,a=t.shape[n];$a(t.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")),$a(3===a,()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(a,"."));const s=t.dtype,r=xd(t,"float32"),i=ex([.2989,.587,.114]);let o;switch(t.rank){case 2:o=Vm("ij,j->i",r,i);break;case 3:o=Vm("ijk,k->ij",r,i);break;case 4:o=Vm("ijkl,l->ijk",r,i);break;case 5:o=Vm("ijklm,m->ijkl",r,i);break;case 6:o=Vm("ijklmn,n->ijklm",r,i);break;default:throw new Error("Not a valid tensor rank.")}return o=lf(o,-1),xd(o,s)}});const Vx=Wc({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const s=Pc(e,"image","rotateWithOffset","float32");$a(4===s.rank,()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(s.rank,"."));const r={image:s},i={radians:t,fillValue:n,center:a};return Tc.runKernel(ll,r,i)}});function Ux(e,t,n,a,s,r){null==a&&(a=.5),null==s&&(s=Number.NEGATIVE_INFINITY),null==r&&(r=0);const i=e.shape[0];return n=Math.min(n,i),$a(0<=a&&a<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(a,"'")),$a(2===e.rank,()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")),$a(4===e.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])),$a(1===t.rank,()=>"scores must be a 1D tensor"),$a(t.shape[0]===i,()=>"scores has incompatible shape with boxes. Expected ".concat(i,", ")+"but was ".concat(t.shape[0])),$a(0<=r&&r<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(r,"'")),{maxOutputSize:n,iouThreshold:a,scoreThreshold:s,softNmsSigma:r}}const Hx=Wc({nonMaxSuppression_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const r=Pc(e,"boxes","nonMaxSuppression","float32"),i=Pc(t,"scores","nonMaxSuppression","float32"),o=Ux(r,i,n,a,s);n=o.maxOutputSize,a=o.iouThreshold,s=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:a,scoreThreshold:s};return Tc.runKernel(qi,{boxes:r,scores:i},l)}});function Gx(e,t,n){const a=function(e,t,n){return function(e,t,n){let a=0,s=e.length,r=0,i=!1;for(;a<s;){r=a+(s-a>>>1);const o=n(t,e[r]);o>0?a=r+1:(s=r,i=!o)}return i?a:-a-1}(e,t,n||qx)}(e,t,n),s=a<0?-(a+1):a;e.splice(s,0,t)}function qx(e,t){return e>t?1:e<t?-1:0}function Kx(e,t,n,a,s){return Yx(e,t,n,a,s,0)}function Zx(e,t,n,a,s,r){return Yx(e,t,n,a,s,0,!1,r,!0)}function Xx(e,t,n,a,s,r){return Yx(e,t,n,a,s,r,!0)}function Yx(e,t,n,a,s,r){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const c=[];for(let g=0;g<t.length;g++)t[g]>s&&c.push({score:t[g],boxIndex:g,suppressBeginIndex:0});c.sort($x);const u=r>0?-.5/r:0,d=[],h=[];for(;d.length<n&&c.length>0;){const t=c.pop(),{score:n,boxIndex:r,suppressBeginIndex:i}=t;if(n<s)break;let o=!1;for(let l=d.length-1;l>=i;--l){const n=Jx(e,r,d[l]);if(n>=a){o=!0;break}if(t.score=t.score*Qx(a,u,n),t.score<=s)break}t.suppressBeginIndex=d.length,o||(t.score===n?(d.push(r),h.push(t.score)):t.score>s&&Gx(c,t,$x))}const p=d.length,m=n-p;o&&m>0&&(d.push(...new Array(m).fill(0)),h.push(...new Array(m).fill(0)));const f={selectedIndices:d};return i&&(f.selectedScores=h),l&&(f.validOutputs=p),f}function Jx(e,t,n){const a=e.subarray(4*t,4*t+4),s=e.subarray(4*n,4*n+4),r=Math.min(a[0],a[2]),i=Math.min(a[1],a[3]),o=Math.max(a[0],a[2]),l=Math.max(a[1],a[3]),c=Math.min(s[0],s[2]),u=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),h=Math.max(s[1],s[3]),p=(o-r)*(l-i),m=(d-c)*(h-u);if(p<=0||m<=0)return 0;const f=Math.max(r,c),g=Math.max(i,u),x=Math.min(o,d),y=Math.min(l,h),b=Math.max(x-f,0)*Math.max(y-g,0);return b/(p+m-b)}function Qx(e,t,n){const a=Math.exp(t*n*n);return n<=e?a:0}function $x(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const ey=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const r=Pc(e,"boxes","nonMaxSuppressionAsync"),i=Pc(t,"scores","nonMaxSuppressionAsync"),o=Ux(r,i,n,a,s);n=o.maxOutputSize,a=o.iouThreshold,s=o.scoreThreshold;const l=await Promise.all([r.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:d}=Kx(c,u,n,a,s);return r!==e&&r.dispose(),i!==t&&i.dispose(),ex(d,"int32")};const ty=Wc({nonMaxSuppressionWithScore_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=Pc(e,"boxes","nonMaxSuppression"),o=Pc(t,"scores","nonMaxSuppression"),l=Ux(i,o,n,a,s,r);n=l.maxOutputSize,a=l.iouThreshold,s=l.scoreThreshold,r=l.softNmsSigma;const c={boxes:i,scores:o},u={maxOutputSize:n,iouThreshold:a,scoreThreshold:s,softNmsSigma:r},d=Tc.runKernel(Zi,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}});const ny=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=Pc(e,"boxes","nonMaxSuppressionAsync"),o=Pc(t,"scores","nonMaxSuppressionAsync"),l=Ux(i,o,n,a,s,r);n=l.maxOutputSize,a=l.iouThreshold,s=l.scoreThreshold,r=l.softNmsSigma;const c=await Promise.all([i.data(),o.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:p}=Xx(u,d,n,a,s,r);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:ex(h,"int32"),selectedScores:ex(p)}};const ay=Wc({nonMaxSuppressionPadded_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=Pc(e,"boxes","nonMaxSuppression"),o=Pc(t,"scores","nonMaxSuppression"),l=Ux(i,o,n,a,s,null),c={boxes:i,scores:o},u={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:r},d=Tc.runKernel(Ki,c,u);return{selectedIndices:d[0],validOutputs:d[1]}}});const sy=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=Pc(e,"boxes","nonMaxSuppressionAsync"),o=Pc(t,"scores","nonMaxSuppressionAsync"),l=Ux(i,o,n,a,s,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,p]=await Promise.all([i.data(),o.data()]),{selectedIndices:m,validOutputs:f}=Zx(h,p,c,u,d,r);return i!==e&&i.dispose(),o!==t&&o.dispose(),{selectedIndices:ex(m,"int32"),validOutputs:Ld(f,"int32")}};const ry=Wc({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=Pc(e,"images","resizeBilinear");$a(3===s.rank||4===s.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(s.rank,".")),$a(2===t.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")),$a(!1===a||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let r=s,i=!1;3===s.rank&&(i=!0,r=$p(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const[]=t,o={images:r},l={alignCorners:n,halfPixelCenters:a,size:t},c=Tc.runKernel(mo,o,l);return i?$p(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const iy=Wc({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=Pc(e,"images","resizeNearestNeighbor");$a(3===s.rank||4===s.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(s.rank,".")),$a(2===t.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")),$a("float32"===s.dtype||"int32"===s.dtype,()=>"`images` must have `int32` or `float32` as dtype"),$a(!1===a||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let r=s,i=!1;3===s.rank&&(i=!0,r=$p(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const[]=t,o={images:r},l={alignCorners:n,halfPixelCenters:a,size:t},c=Tc.runKernel(ho,o,l);return i?$p(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const oy=Wc({threshold_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const s=Pc(e,"image","threshold"),r=s.shape[0]*s.shape[1];let i,o,l,c,u=Nd(ex([a]),255);if($a(3===s.rank,()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(s.rank,".")),$a(3===s.shape[2]||1===s.shape[2],()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(s.shape[2],".")),$a("int32"===s.dtype||"float32"===s.dtype,()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(s.dtype,".")),$a("otsu"===t||"binary"===t,()=>"Method must be binary or otsu, but was ".concat(t)),3===s.shape[2]){[i,o,l]=qg(s,[1,1,1],-1);const e=Nd(i,.2989),t=Nd(o,.587),n=Nd(l,.114);c=vd(vd(e,t),n)}else c=e;if("otsu"===t){u=function(e,t){let n,a,s,r,i,o,l=ex([-1]),c=ex([0]),u=ex([0]);for(let d=0;d<e.size-1;d++){n=sm(e,0,d+1),a=sm(e,d+1),i=kd(nf(n),t),o=kd(nf(a),t);const h=nf(Nd(n,wg(0,n.size)));s=kd(h,nf(n));const p=Ud(a.shape,n.size),m=vd(wg(0,a.size),p),f=Nd(a,m);r=kd(nf(f),nf(a));const g=qd(s,r),x=qd(s,r),y=Nd(i,o);u=Nd(Nd(y,g),x);const b=mf(u,c);c=zm(b,u,c),l=zm(b,ex([d]),l)}return l}(hm(xd(Eg(c),"int32"),Hc([]),256),r)}const d=n?wf(c,u):mf(c,u);return xd(Nd(d,255),"int32")}});const ly=Wc({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5?arguments[5]:void 0;const i=Pc(e,"image","transform","float32"),o=Pc(t,"transforms","transform","float32");$a(4===i.rank,()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(i.rank,".")),$a(2===o.rank&&(o.shape[0]===i.shape[0]||1===o.shape[0])&&8===o.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),$a(null==r||2===r.length,()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(r,"."));const l={image:i,transforms:o},c={interpolation:n,fillMode:a,fillValue:s,outputShape:r};return Tc.runKernel($o,l,c)}});const cy=Wc({bandPart_:function(e,t,n){const a=Pc(e,"a","bandPart");$a(a.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(a.rank,"."));const s=a.shape,[r,i]=a.shape.slice(-2);let o,l;"number"===typeof t?($a(t%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(t,".")),$a(t<=r,()=>"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(r,").")),o=Pc(t<0?r:t,"numLower","bandPart")):($a("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),o=zm(vf(t,0),r,Hf(t,r))),"number"===typeof n?($a(n%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")),$a(n<=i,()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(i,").")),l=Pc(n<0?i:n,"numUpper","bandPart")):($a("int32"===n.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),l=zm(vf(n,0),i,Hf(n,i)));const c=$p(wg(0,r,1,"int32"),[-1,1]),u=wg(0,i,1,"int32"),d=qd(c,u),h=Ef(wf(d,o),ff(d,jh(l))),p=Wf([r,i],a.dtype);return $p(Yg(ux($p(a,[-1,r,i])).map(e=>zm(h,e,p))),s)}});const uy=Wc({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,$a(null!=e&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=e[0].shape[0];for(let t=1;t<e.length;++t)$a(e[t].shape[0]===n,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")"))}else t=!0,e=qg(e,e.shape[0],0).map(e=>Xg(e,[0]));$a(e.length<=e[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],")."));const n=[],a=e;for(let s=0;s<e.length;++s)n.push(Tc.tidy(()=>{let e=a[s];if(s>0)for(let t=0;t<s;++t){const a=Nd(nf(Nd(n[t],e)),n[t]);e=qd(e,a)}return kd(e,sf(e,"euclidean"))}));return t?Yg(n,0):n}});function dy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Tc.tidy(()=>{$a(2===e.shape.length,()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor."));const n=e.shape[0],a=e.shape[1];let s=df(n),r=yd(e);const i=tx([[1]],[1,1]);let o=yd(i);const l=n>=a?a:n;for(let e=0;e<l;++e){const t=r,l=o,c=s;[o,r,s]=Tc.tidy(()=>{const t=sm(r,[e,e],[n-e,1]),l=sf(t),c=sm(r,[e,e],[1,1]),u=zm(mf(c,0),tx([[-1]]),tx([[1]])),d=qd(c,Nd(u,l)),h=kd(t,d);o=1===h.shape[0]?yd(i):nm([i,sm(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const p=jh(kd(_h(u,d),l)),m=sm(r,[e,0],[n-e,a]),f=Nd(p,o),g=Ih(o);if(0===e)r=qd(m,_h(f,_h(g,m)));else{const t=qd(m,_h(f,_h(g,m)));r=nm([sm(r,[0,0],[e,a]),t],0)}const x=Ih(f),y=sm(s,[0,e],[n,s.shape[1]-e]);if(0===e)s=qd(y,_h(_h(y,o),x));else{const t=qd(y,_h(_h(y,o),x));s=nm([sm(s,[0,0],[n,e]),t],1)}return[o,r,s]}),nu([t,l,c])}return!t&&n>a&&(s=sm(s,[0,0],[n,a]),r=sm(r,[0,0],[a,a])),[s,r]})}const hy=Wc({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if($a(e.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)),2===e.rank)return dy(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),a=ux($p(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),s=[],r=[];a.forEach(e=>{const[n,a]=dy(e,t);s.push(n),r.push(a)});return[$p(Yg(s,0),e.shape),$p(Yg(r,0),e.shape)]}}});var py;!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(py||(py={}));const my=Wc({computeWeightedLoss_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:py.SUM_BY_NONZERO_WEIGHTS;const a=Pc(e,"losses","computeWeightedLoss");let s=null;null!=t&&(s=Pc(t,"weights","computeWeightedLoss"));const r=null==s?a:Nd(a,s);if(n===py.NONE)return r;if(n===py.SUM)return nf(r);if(n===py.MEAN){if(null==s)return Bf(r);{const e=a.size/s.size,t=kd(nf(r),nf(s));return e>1?kd(t,Ld(e)):t}}if(n===py.SUM_BY_NONZERO_WEIGHTS){if(null==s)return kd(nf(r),Ld(a.size));{const e=Nd(s,Vf(a.shape)),t=xd(nf(Yf(e,Ld(0))),"float32");return kd(nf(r),t)}}throw Error("Unknown reduction: ".concat(n))}});const fy=Wc({absoluteDifference_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:py.SUM_BY_NONZERO_WEIGHTS;const s=Pc(e,"labels","absoluteDifference"),r=Pc(t,"predictions","absoluteDifference");let i=null;null!=n&&(i=Pc(n,"weights","absoluteDifference")),es(s.shape,r.shape,"Error in absoluteDifference: ");const o=Zd(qd(s,r));return my(o,i,a)}});const gy=Wc({cosineDistance_:function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:py.SUM_BY_NONZERO_WEIGHTS;const r=Pc(e,"labels","cosineDistance"),i=Pc(t,"predictions","cosineDistance");let o=null;null!=a&&(o=Pc(a,"weights","cosineDistance")),es(r.shape,i.shape,"Error in cosineDistance: ");const l=Ld(1),c=qd(l,nf(Nd(r,i),n,!0));return my(c,o,s)}});const xy=Wc({hingeLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:py.SUM_BY_NONZERO_WEIGHTS,s=Pc(e,"labels","hingeLoss");const r=Pc(t,"predictions","hingeLoss");let i=null;null!=n&&(i=Pc(n,"weights","hingeLoss")),es(s.shape,r.shape,"Error in hingeLoss: ");const o=Ld(1);s=qd(Nd(Ld(2),s),o);const l=Ng(qd(o,Nd(s,r)));return my(l,i,a)}});const yy=Wc({huberLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:py.SUM_BY_NONZERO_WEIGHTS;const r=Pc(e,"labels","huberLoss"),i=Pc(t,"predictions","huberLoss");let o=null;null!=n&&(o=Pc(n,"weights","huberLoss")),es(r.shape,i.shape,"Error in huberLoss: ");const l=Ld(a),c=Zd(qd(i,r)),u=Hf(c,l),d=qd(c,u),h=vd(Nd(Ld(.5),Sd(u)),Nd(l,d));return my(h,o,s)}});const by=Wc({logLoss_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:py.SUM_BY_NONZERO_WEIGHTS;const r=Pc(e,"labels","logLoss"),i=Pc(t,"predictions","logLoss");let o=null;null!=n&&(o=Pc(n,"weights","logLoss")),es(r.shape,i.shape,"Error in logLoss: ");const l=Ld(1),c=Ld(a),u=jh(Nd(r,_f(vd(i,c)))),d=Nd(qd(l,r),_f(vd(qd(l,i),c))),h=qd(u,d);return my(h,o,s)}});const vy=Wc({meanSquaredError_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:py.SUM_BY_NONZERO_WEIGHTS;const s=Pc(e,"labels","meanSquaredError"),r=Pc(t,"predictions","meanSquaredError");let i=null;null!=n&&(i=Pc(n,"weights","meanSquaredError")),es(s.shape,r.shape,"Error in meanSquaredError: ");const o=Zg(s,r);return my(o,i,a)}});const wy=Wc({sigmoidCrossEntropy_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:py.SUM_BY_NONZERO_WEIGHTS,r=Pc(e,"multiClassLabels","sigmoidCrossEntropy");const i=Pc(t,"logits","sigmoidCrossEntropy");let o=null;if(null!=n&&(o=Pc(n,"weights","sigmoidCrossEntropy")),es(r.shape,i.shape,"Error in sigmoidCrossEntropy: "),a>0){const e=Ld(a),t=Ld(1),n=Ld(.5);r=vd(Nd(r,qd(t,e)),Nd(n,e))}const l=function(e,t){const n=Pc(e,"labels","sigmoidCrossEntropyWithLogits"),a=Pc(t,"logits","sigmoidCrossEntropyWithLogits");es(n.shape,a.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=Ng(a),r=Nd(a,n),i=Sf(of(jh(Zd(a))));return vd(qd(s,r),i)}(r,i);return my(l,o,s)}});const ky=Wc({softmaxCrossEntropy_:function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:py.SUM_BY_NONZERO_WEIGHTS,r=Pc(e,"onehotLabels","softmaxCrossEntropy");const i=Pc(t,"logits","softmaxCrossEntropy");let o=null;if(null!=n&&(o=Pc(n,"weights","softmaxCrossEntropy")),es(r.shape,i.shape,"Error in softmaxCrossEntropy: "),a>0){const e=Ld(a),t=Ld(1),n=Ld(r.shape[1]);r=vd(Nd(r,qd(t,e)),kd(e,n))}const l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));const a=Rd((e,t,a)=>{const s=If(t,[n],!0),r=qd(xd(t,"float32"),s);a([e,r]);const i=jh(Nd(r,e));return{value:nf(i,[n]),gradFunc:(e,t)=>{const[a,s]=t,r=Xm(e.shape,[n]);return[Nd($p(e,r),qd(xd(a,"float32"),of(s))),Nd($p(e,r),qd(of(s),xd(a,"float32")))]}}});return a(e,t)}(r,i);return my(l,o,s)}});const Ny=Wc({sparseFillEmptyRows_:function(e,t,n,a){const s=Pc(e,"indices","sparseFillEmptyRows","int32"),r=Pc(t,"values","sparseFillEmptyRows"),i=Pc(n,"denseShape","sparseFillEmptyRows","int32"),o=Pc(a,"defaultValue","sparseFillEmptyRows",r.dtype);if(2!==s.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(s.shape));if(1!==r.rank)throw new Error("Values should be Tensor1D but received shape ".concat(r.shape));if(1!==i.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(i.shape));if(0!==o.rank)throw new Error("Default value should be a scalar but received shape ".concat(o.shape));const l={indices:s,values:r,denseShape:i,defaultValue:o},c=Tc.runKernel(Oo,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}});const _y=Wc({sparseReshape_:function(e,t,n){const a=Pc(e,"inputIndices","sparseReshape","int32"),s=Pc(t,"inputShape","sparseReshape","int32"),r=Pc(n,"newShape","sparseReshape","int32");if(2!==a.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==s.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(s.shape));if(1!==r.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(r.shape));const i={inputIndices:a,inputShape:s,newShape:r},o=Tc.runKernel(Fo,i);return{outputIndices:o[0],outputShape:o[1]}}});const Sy=Wc({sparseSegmentMean_:function(e,t,n){const a=Pc(e,"data","sparseSegmentMean"),s=Pc(t,"indices","sparseSegmentMean","int32"),r=Pc(n,"segmentIds","sparseSegmentMean","int32");if(a.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(s.shape));if(1!==r.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(r.shape));const i={data:a,indices:s,segmentIds:r};return Tc.runKernel(Po,i)}});const Cy=Wc({sparseSegmentSum_:function(e,t,n){const a=Pc(e,"data","sparseSegmentSum"),s=Pc(t,"indices","sparseSegmentSum","int32"),r=Pc(n,"segmentIds","sparseSegmentSum","int32");if(a.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(s.shape));if(1!==r.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(r.shape));const i={data:a,indices:s,segmentIds:r};return Tc.runKernel(zo,i)}});const jy=Wc({stringNGrams_:function(e,t,n,a,s,r,i,o){const l=Pc(e,"data","stringNGrams","string");if("string"!==l.dtype)throw new Error("Data must be of datatype string");if(1!==l.shape.length)throw new Error("Data must be a vector, saw: ".concat(l.shape));const c=Pc(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:a,leftPad:s,rightPad:r,padWidth:i,preserveShortSequences:o},d={data:l,dataSplits:c},h=Tc.runKernel(Go,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}});const Ty=Wc({stringSplit_:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=Pc(e,"input","stringSplit","string"),s=Pc(t,"delimiter","stringSplit","string");if(1!==a.rank)throw new Error("Input should be Tensor1D but received shape ".concat(a.shape));if(0!==s.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(s.shape));const r={skipEmpty:n},i={input:a,delimiter:s},o=Tc.runKernel(qo,i,r);return{indices:o[0],values:o[1],shape:o[2]}}});const Iy=Wc({stringToHashBucketFast_:function(e,t){const n=Pc(e,"input","stringToHashBucketFast","string"),a={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return Tc.runKernel(Ko,s,a)}});const Ey=Wc({staticRegexReplace_:function(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const s=Pc(e,"input","staticRegexReplace","string"),r={pattern:t,rewrite:n,replaceGlobal:a};return Tc.runKernel(Uo,{x:s},r)}}),Ay={fft:Ug,ifft:Hg,rfft:Kg,irfft:Gg},Ry={hammingWindow:Lx,hannWindow:Dx,frame:Ox,stft:Fx},My={flipLeftRight:zx,grayscaleToRGB:Bx,resizeNearestNeighbor:iy,resizeBilinear:ry,rgbToGrayscale:Wx,rotateWithOffset:Vx,cropAndResize:Px,nonMaxSuppression:Hx,nonMaxSuppressionAsync:ey,nonMaxSuppressionWithScore:ty,nonMaxSuppressionWithScoreAsync:ny,nonMaxSuppressionPadded:ay,nonMaxSuppressionPaddedAsync:sy,threshold:oy,transform:ly},Ly={bandPart:cy,gramSchmidt:uy,qr:hy},Dy={absoluteDifference:fy,computeWeightedLoss:my,cosineDistance:gy,hingeLoss:xy,huberLoss:yy,logLoss:by,meanSquaredError:vy,sigmoidCrossEntropy:wy,softmaxCrossEntropy:ky},Oy={sparseFillEmptyRows:Ny,sparseReshape:_y,sparseSegmentMean:Sy,sparseSegmentSum:Cy},Fy={stringNGrams:jy,stringSplit:Ty,stringToHashBucketFast:Iy,staticRegexReplace:Ey},Py=Sp,zy="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:e=>e();function By(){return new Promise(e=>zy(()=>e()))}function Wy(e,t){const n=e[0].length;e.forEach((e,t)=>{$a(e.length===n,()=>"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")"))}),$a(t>=0&&t<n,()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,"."));const a=e[0];e.forEach((e,s)=>{for(let r=0;r<n;r++)$a(r===t||e[r]===a[r],()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(s,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(a,") ")+"along the non-concatenated axis ".concat(s,"."))})}function Vy(e,t){const n=e[0].slice();for(let a=1;a<e.length;a++)n[t]+=e[a][t];return n}var Uy;function Hy(e,t,n){let a=new Array;if(null==n&&null==t)return a;if(null==t)for(;a.length<e+n.length;)a.push(-1);else a=t.slice();if(null==n)return a;if(e+n.length!==a.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(a.length));for(let s=1;s<n.length;++s){const r=n[s],i=a[a.length-n.length+s],o=a[i];if(r>=0)if(o>=0){if(o!==r)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(s+e,"] = ").concat(r," but shape[").concat(s+e,"] = ").concat(o))}else a[i]=r}return a}function Gy(e){const t={FIRST_DIM_SIZE:Uy.FIRST_DIM_SIZE,VALUE_ROWIDS:Uy.VALUE_ROWIDS,ROW_LENGTHS:Uy.ROW_LENGTHS,ROW_SPLITS:Uy.ROW_SPLITS,ROW_LIMITS:Uy.ROW_LIMITS,ROW_STARTS:Uy.ROW_STARTS},n=[];for(const a of e){if(!(a in t))break;n.push(t[a])}return n}function qy(e){return 0===e.length?0:e[0]===Uy.FIRST_DIM_SIZE?e.length-1:e.length}function Ky(e,t){if(null==e||null==t)return;const n=e.length,a=t.length;if(n>=a)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(a,")"));for(let s=0;s<Math.min(n,a-1);++s){const n=e[s],a=t[s+1];if(n>=0&&a>=0&&1!==n&&n!==a)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(s-e.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(s-e.length,"] = ").concat(a))}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(Uy||(Uy={}));const Zy=30;function Xy(e){return e<=Zy?e:js(e,Math.floor(Math.sqrt(e)))}function Yy(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function Jy(e,t,n){let a=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])a=a.concat(t.slice(0)),a.push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);const n=t.length;for(let s=0;s<n;++s)a=a.concat([e[s+1]/t[s],t[s]]);a=a.concat(e.slice(n+1))}return a}function Qy(e,t){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let a=t+1;a<e;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{const a=[],s=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?s.push(n):a.push(n);n.push(...a),n.push(0),n.push(...s)}return n}function $y(e,t,n){let a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const s=[];a?s.push(e[0]/n):s.push(e[0]*n);for(let r=1;r<e.length;++r)r<=t.length?a?s.push(t[r-1]*e[r]):s.push(e[r]/t[r-1]):s.push(e[r]);return s}function eb(e,t){const n=[0];for(let a=0;a<t;++a)n.push(e[a][0]);return n}function tb(e,t,n){const a=e.slice(0,1);for(let s=0;s<n;++s)a.push(e[s+1]-t[s][0]-t[s][1]);return a}const nb=1.7580993408473768,ab=1.0507009873554805,sb=.3275911,rb=.254829592,ib=-.284496736,ob=1.421413741,lb=-1.453152027,cb=1.061405429;function ub(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));const n=new Float32Array(2*e.length);for(let a=0;a<n.length;a+=2)n[a]=e[a/2],n[a+1]=t[a/2];return n}function db(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let a=0;a<e.length;a+=2)t[a/2]=e[a],n[a/2]=e[a+1];return{real:t,imag:n}}function hb(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),a=new Float32Array(t);for(let s=0;s<e.length;s+=4)n[Math.floor(s/4)]=e[s],a[Math.floor(s/4)]=e[s+1];return{real:n,imag:a}}function pb(e){const t=Math.floor(e.length/4),n=new Float32Array(t),a=new Float32Array(t);for(let s=2;s<e.length;s+=4)n[Math.floor(s/4)]=e[s],a[Math.floor(s/4)]=e[s+1];return{real:n,imag:a}}function mb(e,t){return{real:e[2*t],imag:e[2*t+1]}}function fb(e,t,n,a){e[2*a]=t,e[2*a+1]=n}function gb(e,t){const n=new Float32Array(e/2),a=new Float32Array(e/2);for(let s=0;s<Math.ceil(e/2);s++){const r=(t?2:-2)*Math.PI*(s/e);n[s]=Math.cos(r),a[s]=Math.sin(r)}return{real:n,imag:a}}function xb(e,t,n){const a=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(a),imag:Math.sin(a)}}const yb="->",bb=/->/g,vb=",",wb="...";function kb(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(bb,"").length)/yb.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(yb,'").'));const[a,s]=e.split(yb);$a(-1===a.indexOf(wb),()=>'The ellipsis notation ("'.concat(wb,'") is not supported yet.'));const r=a.split(vb),i=r.length;if(t!==i)throw new Error("Expected ".concat(i," input tensors, received ").concat(t));if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let d=0;d<s.length;++d){const e=s[d];if(!r.some(t=>-1!==t.indexOf(e)))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===o.indexOf(e)&&o.push(e)}for(let d=0;d<a.length;++d){const e=a[d];-1===o.indexOf(e)&&e!==vb&&o.push(e)}const l=new Array(r.length);for(let d=0;d<i;++d){if(new Set(r[d].split("")).size!==r[d].length)throw new Error("Found duplicate axes in input component ".concat(r[d],". ")+"Support for duplicate axes in input is not implemented yet.");l[d]=[];for(let e=0;e<r[d].length;++e)l[d].push(o.indexOf(r[d][e]))}const c=o.length,u=[];for(let d=s.length;d<c;++d)u.push(d);return{allDims:o,summedDims:u,idDims:l}}function Nb(e,t){let n=new Array(e);n.fill(-1);for(let s=0;s<t.length;++s)n[t[s]]=s;const a=[];for(let s=0;s<e;++s)-1===n[s]&&a.push(s);return n=n.filter(e=>-1!==e),{permutationIndices:n,expandDims:a}}function _b(e,t,n){const a=new Array(e);for(let s=0;s<n.length;++s){const e=n[s].shape;for(let n=0;n<t[s].length;++n)void 0===a[t[s][n]]?a[t[s][n]]=e[n]:$a(a[t[s][n]]===e[n],()=>"Expected dimension ".concat(a[t[s][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(e),", ")+"but got dimension ".concat(e[n]))}}function Sb(e,t){const n=e,a=[];let s=0;0===e.length&&n.push(-1),s=e.length+1;for(let i=0;i<s;++i)a.push([]);const r=[];for(let i=0;i<n.length;++i){const e=jb(t,n[i]);for(const t of e)-1===r.indexOf(t)&&(a[i].push(t),r.push(t))}return{path:n,steps:a}}function Cb(e){return e.every((e,t)=>e===t)}function jb(e,t){const n=[];for(let a=0;a<e.length;++a)0!==e[a].length&&-1===e[a].indexOf(t)&&-1!==t||n.push(a);return n}function Tb(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=[];if("number"===typeof t)$a(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),a=new Array(t).fill(e.shape[n]/t);else{const s=t.reduce((e,t)=>(-1===t&&(e+=1),e),0);$a(s<=1,()=>"There should be only one negative value in split array.");const r=t.indexOf(-1);if(-1!==r){const a=t.reduce((e,t)=>t>0?e+t:e);t[r]=e.shape[n]-a}$a(e.shape[n]===t.reduce((e,t)=>e+t),()=>"The sum of sizes must match the size of the axis dimension."),a=t}return a}function Ib(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function Eb(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function Ab(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function Rb(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function Mb(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function Lb(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Db(e,t){const n=ns(e),a=ns(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(a,". inputShape=").concat(e," outputShape= ").concat(t)}function Ob(e,t){const n=ns(e),a=ns(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(a,". inputShape=").concat(e," outputShape=").concat(t)}function Fb(){return"segment ids must be >= 0"}function Pb(){return"segment ids are not increasing"}function zb(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function Bb(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function Wb(e,t){let n,a=!1;for(e<=Zy?(n=e,a=!0):n=js(e,Math.floor(Math.sqrt(e)));!a;)n>t||n===e?a=!0:n=js(e,n+1);return n}function Vb(e,t,n){const a=[],s=e.length;for(let r=0;r<s;r++)r!==t?a.push(e[r]):a.push(n);return a}function Ub(e,t,n,a){const s=t.shape.length,r=e.shape.length;if(0!==a&&(a<-s||a>s))throw new Error("Expect batchDims in the range of [-".concat(s,", ").concat(s,"], but got ").concat(a));if(a<0&&(a+=s),a>r)throw new Error("batchDims (".concat(a,") must be less than rank(x) (\n    ").concat(r,")."));if(n<a)throw new Error("batchDims (".concat(a,") must be less than or equal to axis (").concat(n,")."));for(let d=0;d<a;++d)if(e.shape[d]!==t.shape[d])throw new Error("x.shape[".concat(d,"]: ").concat(e.shape[d]," should be equal to indices.shape[").concat(d,"]: ").concat(t.shape[d],"."));const i=e.shape[n],o=[];let l=1,c=1,u=1;for(let d=0;d<a;++d)o.push(e.shape[d]),l*=e.shape[d];for(let d=a;d<n;d++)o.push(e.shape[d]),c*=e.shape[d];for(let d=a;d<s;d++)o.push(t.shape[d]);for(let d=n+1;d<r;d++)o.push(e.shape[d]),u*=e.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:o}}function Hb(e){try{return e.map(e=>Gl(e))}catch(wq){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(wq))}}function Gb(e){return e.map(e=>Hl(e))}!function(){for(const e of ah)zd(e)}();const qb={kernelName:Ks,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(e,Jg(xd(n,"float32"),-1))}}},Kb={kernelName:Zs,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=Sd(xd(n,"float32")),a=_d(qd(Ld(1),t));return jh(kd(e,a))}}}},Zb={kernelName:Xs,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=_d(qd(Sd(xd(n,"float32")),1));return kd(e,t)}}}},Xb={kernelName:Ys,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t,s=Jd(n.shape,a.shape);return{a:()=>{let t=e;const a=Yd(n.shape,s);return a.length>0&&(t=nf(t,a)),$p(t,n.shape)},b:()=>{let t=e;const n=Yd(a.shape,s);return n.length>0&&(t=nf(t,n)),$p(t,a.shape)}}}},Yb={kernelName:Js,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((t,a)=>{n[a]=()=>e.clone()}),n}},Jb={kernelName:er,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Cd(n)}}},Qb={kernelName:tr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Cd(n)}}},$b={kernelName:nr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kd(e,_d(qd(Ld(1),Sd(xd(n,"float32")))))}}},ev={kernelName:ar,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=_d(vd(Ld(1),Sd(xd(n,"float32"))));return kd(e,t)}}}},tv={kernelName:ir,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t,s=Jd(n.shape,a.shape);return{a:()=>{const t=vd(Sd(n),Sd(a));let r=Nd(e,kd(a,t));const i=Yd(n.shape,s);return i.length>0&&(r=nf(r,i)),$p(r,n.shape)},b:()=>{const t=vd(Sd(n),Sd(a));let r=jh(Nd(e,kd(n,t)));const i=Yd(a.shape,s);return i.length>0&&(r=nf(r,i)),$p(r,a.shape)}}}},nv={kernelName:sr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kd(e,vd(Sd(xd(n,"float32")),1))}}},av={kernelName:rr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kd(e,qd(Ld(1),Sd(xd(n,"float32"))))}}};const sv=Wc({avgPool3dGrad_:function(e,t,n,a,s,r){const i=Pc(e,"dy","avgPool3dGrad"),o=Pc(t,"input","avgPool3dGrad");let l=i,c=o,u=!1;4===o.rank&&(u=!0,l=$p(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=$p(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),$a(5===l.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")),$a(5===c.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")),Qp("avgPool3dGrad",s,r);const d={dy:l,input:c},h={filterSize:n,strides:a,pad:s,dimRoundingMode:r},p=Tc.runKernel(ur,d,h);return u?$p(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),rv={kernelName:cr,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{filterSize:s,strides:r,pad:i,dimRoundingMode:o}=n;return{x:()=>sv(e,a,s,r,i,o)}}};const iv=Wc({avgPoolGrad_:function(e,t,n,a,s){const r=Pc(e,"dy","avgPoolGrad"),i=Pc(t,"input","avgPoolGrad");$a(i.rank===r.rank,()=>"Rank of input (".concat(i.rank,") does not match rank of dy (").concat(r.rank,")"));let o=i,l=r,c=!1;3===i.rank&&(c=!0,o=$p(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=$p(r,[1,r.shape[0],r.shape[1],r.shape[2]])),$a(4===l.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(l.rank,".")),$a(4===o.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(o.rank,"."));const u={dy:l,input:o},d={filterSize:n,strides:a,pad:s},h=Tc.runKernel(lr,u,d);return c?$p(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),ov={kernelName:or,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{filterSize:s,strides:r,pad:i}=n;return{x:()=>iv(e,a,s,r,i)}}},lv={kernelName:dr,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[a,s]=t,{transposeA:r,transposeB:i}=n;return r||i?!r&&i?{a:()=>_h(e,s,!1,!1),b:()=>_h(e,a,!0,!1)}:r&&!i?{a:()=>_h(s,e,!1,!0),b:()=>_h(a,e,!1,!1)}:{a:()=>_h(s,e,!0,!0),b:()=>_h(e,a,!0,!0)}:{a:()=>_h(e,s,!1,!0),b:()=>_h(a,e,!0,!1)}}},cv={kernelName:hr,gradFunc:(e,t,n)=>{const{blockShape:a,crops:s}=n;return{x:()=>sg(e,a,s)}}},uv={kernelName:fr,gradFunc:(e,t,n)=>{const a=n,s=a.inputShape,r=a.shape,i=Array.from(r);for(let l=s.length-1;l>=0;l--)if(s[l]===r[l])i[l]=1;else if(1!==s[l])throw new Error("broadcastTo(): [".concat(s,"] cannot be broadcast to [").concat(r,"]."));const o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>nf(e,o,!0)}}},dv={kernelName:xr,gradFunc:e=>({x:()=>e.clone()})},hv={kernelName:yr,gradFunc:e=>({x:()=>Cd(e)})},pv={kernelName:br,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{clipValueMin:s,clipValueMax:r}=n;return{x:()=>zm(Ef(ff(a,s),wf(a,r)),e,Cd(e))}}},mv={kernelName:wr,inputsToSave:["x"],gradFunc:qb.gradFunc},fv={kernelName:kr,saveAllInputs:!0,gradFunc:(e,t,n)=>{const a=t.map(e=>e.shape),{axis:s}=n,r=ps(s,t[0].shape)[0],i=a.map(e=>e[r]);return qg(e,i,r).map(e=>()=>e)}},gv={kernelName:Nr,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[a,s]=t,{dilations:r,strides:i,pad:o,dataFormat:l}=n;return $a(Zp(r),()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(r,"'")),{x:()=>_m(a.shape,e,s,i,o,l),filter:()=>_x(a,e,s.shape,i,o,l)}}},xv={kernelName:Sr,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[a,s]=t,{strides:r,pad:i,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>km(e,s,r,i,o,1,l),filter:()=>_x(e,a,s.shape,r,i,o,l)}}};const yv=Wc({conv3DBackpropFilter_:function(e,t,n,a,s){let r=e;4===e.rank&&(r=$p(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let i=t;4===i.rank&&(i=$p(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),$a(5===r.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(r.shape,".")),$a(5===i.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(i.shape,".")),$a(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")),$a(r.shape[4]===n[3],()=>"Error in conv3dDerFilter: depth of input ".concat(r.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")),$a(i.shape[4]===n[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(i.shape[4],") must ")+"match output depth for filter (".concat(n[4],")."));const o={x:r,dy:i},l={strides:a,pad:s,filterShape:n};return Tc.runKernel(jr,o,l)}}),bv={kernelName:Cr,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:a,strides:s,pad:r}=n;$a(Zp(a),()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(a,"'"));const[i,o]=t;return{x:()=>jm(i.shape,e,o,s,r),filter:()=>yv(i,e,o.shape,s,r)}}},vv={kernelName:Ir,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(jh(Og(xd(n,"float32"))),e)}}},wv={kernelName:Er,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(Fg(xd(n,"float32")),e)}}},kv={kernelName:Rr,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{axis:s,exclusive:r,reverse:i}=n;return{x:()=>{const t=Jm([s],a.rank);let n=Rm(e,s,r,!i);return null!=t&&(n=Ih(n,t)),n}}}},Nv={kernelName:Or,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:a,strides:s,pad:r,dimRoundingMode:i}=n,o=null==a?[1,1]:a;$a(Zp(o),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'"));const[l,c]=t;return $a(4===l.rank,()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(l.rank,".")),$a(4===c.rank,()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(c.rank,".")),$a(l.shape[3]===c.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(l.shape[3],") must match the inChannels dimension ")+"in filter ".concat(c.shape[2],".")),$a(Xp(s,o),()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(s," and dilations ")+"'".concat(o,"'.")),Qp("depthwiseConv2d",r,i),{x:()=>Ax(l.shape,e,c,s,r,o,i),filter:()=>Ex(l,e,c.shape,s,r,o,i)}}},_v={kernelName:Br,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[a,s]=t,r={x:a,filter:s,dy:e},i={x:a,filter:s,dy:e};return{x:()=>Tc.runKernel(Wr,r,n),filter:()=>Tc.runKernel(Vr,i,n)}}},Sv={kernelName:qr,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,a={dy:e,y:n};return{x:()=>Tc.runKernel(Kr,a)}}},Cv={kernelName:Zr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,a=Nd(of(jh(Sd(n))),2/Math.sqrt(Math.PI));return{x:()=>Nd(e,a)}}},jv={kernelName:Yr,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(e,n)}}},Tv={kernelName:Jr,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>$p(e,n.shape)}}},Iv={kernelName:Qr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(e,of(n))}}},Ev={kernelName:ni,gradFunc:e=>({x:()=>Cd(e)})},Av={kernelName:ai,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t,s=Jd(n.shape,a.shape);return{a:()=>{const t=kd(e,xd(a,"float32")),r=Yd(n.shape,s);return r.length>0?$p(nf(t,r),n.shape):t},b:()=>{let t=Nd(e,xd(n,"float32"));const r=Yd(a.shape,s);r.length>0&&(t=$p(nf(t,r),a.shape));const i=Sd(a);return jh(kd(t,xd(i,"float32")))}}}},Rv={kernelName:si,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:a}=n,[s,r,i,o]=t,l=null==o?Ld(1):o,c=Yd(r.shape,s.shape),u=[];if(1===r.rank){for(let e=0;e<s.shape.length-1;++e)u.push(s.shape[e]);u.push(1)}const d=qd(s,r),h=Nd(e,l),p=Ag(vd(i,Ld(a))),m=Nd(Nd(Nd(p,p),p),Ld(-.5));return{x:()=>1===r.rank?$p(Nd(Nd(e,uf($p(p,[1,1,1,r.shape[0]]),u)),l),s.shape):$p(Nd(Nd(e,p),l),s.shape),mean:()=>{let e=Nd(Nd(p,Ld(-1)),h);return 1===r.rank&&(e=nf(e,c)),$p(e,r.shape)},variance:()=>{let e=Nd(Nd(m,d),h);return 1===r.rank&&(e=nf(e,c)),$p(e,r.shape)},scale:()=>{const t=Nd(d,p);let n=Nd(e,t);return 1===r.rank&&(n=nf(n,c)),$p(n,r.shape)},offset:()=>{let t=e;return 1===r.rank&&(t=nf(t,c)),$p(t,r.shape)}}}},Mv={kernelName:ri,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[a,s]=t,{axis:r,batchDims:i}=n,o=ps(r,a.shape)[0],l=(e,t,n)=>()=>{const a=e.shape,s=t.size,i=a.slice(0,o),l=i.length,c=a.slice(r,a.length).slice(1),u=c.length,d=Lv(0,l),h=Lv(l+1,l+1+u),p=Dv([i,[s],c]),m=$p(n,p),f=$p(t,[s]),g=Dv([[l],d,h]),x=Ih(m,g);let y=cx(x,f,e.shape[o]);const b=Qm(g);return y=Ih(y,b),y};if(1===i){const t=a.shape[0],n=a.split(t,0);return{x:()=>{const t=Yg(n.map((t,n)=>l(t,s.slice(n,1),e.slice(n,1))()));return t.reshape(a.shape)},indices:()=>s}}return{x:l(a,s,e),indices:()=>s}}};function Lv(e,t){const n=[];for(let a=e;a<t;++a)n.push(a);return n}function Dv(e){const t=[];for(let n=0;n<e.length;++n)for(let a=0;a<e[n].length;++a)t.push(e[n][a]);return t}const Ov={kernelName:li,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t;return{a:()=>Cd(n),b:()=>Cd(a)}}},Fv={kernelName:ci,gradFunc:e=>({x:()=>xd(e,"float32")})},Pv={kernelName:hi,gradFunc:e=>({x:()=>Cd(e)})},zv={kernelName:pi,gradFunc:e=>({x:()=>Cd(e)})},Bv={kernelName:mi,gradFunc:e=>({x:()=>Cd(e)})},Wv={kernelName:fi,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{alpha:s}=n,r=mf(a,0);return{x:()=>zm(r,e,Nd(e,s))}}},Vv={kernelName:vi,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kd(e,vd(n,1))}}},Uv={kernelName:bi,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kd(e,xd(n,"float32"))}}},Hv={kernelName:Si,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[a]=t,{axis:s}=n;return{logits:()=>{const t=of(a);return qd(e,Nd(nf(e,s,!0),t))}}}};const Gv=Wc({localResponseNormalizationBackprop_:function(e,t,n){const a={x:e,y:t,dy:n},s={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return Tc.runKernel(Ti,a,s)}}),qv={kernelName:ji,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[a,s]=t,{depthRadius:r,bias:i,alpha:o,beta:l}=n;return{x:()=>Gv(a,s,e,r,i,o,l)}}};function Kv(e,t,n,a){return t.rank<n.rank&&(t=$p(t,Xm(t.shape,a))),e.rank<n.rank&&(e=$p(e,Xm(e.shape,a))),{x:()=>Nd(e,xd(Pm(n,t),e.dtype))}}const Zv={kernelName:Ei,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const a=n,{reductionIndices:s}=a,r=t[0],i=Kv(e,t[1],r,ps(s,r.shape));return{x:()=>i.x()}}},Xv={kernelName:Ai,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t;return{a:()=>Nd(e,xd(ff(n,a),"float32")),b:()=>Nd(e,xd(vf(n,a),"float32"))}}};const Yv=Wc({maxPool3dGrad_:function(e,t,n,a,s,r,i){const o=Pc(e,"dy","maxPool3dGrad"),l=Pc(t,"input","maxPool3dGrad"),c=Pc(n,"output","maxPool3dGrad");let u=o,d=l,h=c,p=!1;4===l.rank&&(p=!0,u=$p(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=$p(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=$p(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),$a(5===u.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")),$a(5===d.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(d.rank,".")),$a(5===h.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(h.rank,".")),Qp("maxPool3dGrad",r,i);const m={dy:u,input:d,output:h},f={filterSize:a,strides:s,pad:r,dimRoundingMode:i},g=Tc.runKernel(Di,m,f);return p?$p(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),Jv={kernelName:Li,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[a,s]=t,{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=n;return{x:()=>Yv(e,a,s,r,i,o,l)}}};const Qv=Wc({maxPoolGrad_:function(e,t,n,a,s,r,i){const o=Pc(e,"dy","maxPoolGrad"),l=Pc(t,"input","maxPoolGrad"),c=Pc(n,"output","maxPoolGrad");$a(l.rank===o.rank,()=>"Rank of input (".concat(l.rank,") does not match rank of dy ")+"(".concat(o.rank,")")),$a(4===o.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(o.rank,".")),$a(4===l.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(l.rank,".")),Qp("maxPoolGrad",r,i);const u={dy:o,input:l,output:c},d={filterSize:a,strides:s,pad:r,dimRoundingMode:i};return Tc.runKernel(Mi,u,d)}}),$v={kernelName:Ri,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[a,s]=t,{filterSize:r,strides:i,pad:o}=n;return{x:()=>Qv(e,a,s,r,i,o)}}},ew={kernelName:Pi,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const a=n,{axis:s}=a,[r,i]=t,o=Kv(e,i,r,ps(s,r.shape));return{x:()=>o.x()}}},tw={kernelName:Bi,inputsToSave:["x"],gradFunc:(e,t,n)=>{const a=t[0],{paddings:s}=n,r=s.map(e=>e[0]);return{x:()=>sm(e,r,a.shape)}}},nw={kernelName:Qi,inputsToSave:["x"],gradFunc:(e,t,n)=>{const a=t[0],{paddings:s}=n,r=s.map(e=>e[0]);return{x:()=>sm(e,r,a.shape)}}},aw={kernelName:eo,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,a,s]=t,r=n,i=a,o=Jd(r.shape,i.shape);return{a:()=>{const t=xd(i,"float32");let n=Nd(e,Nd(t,Gd(r,qd(t,Ld(1)))));const a=Yd(r.shape,o);return a.length>0&&(n=nf(n,a)),$p(n,r.shape)},b:()=>{const t=mf(r,0),n=zm(t,_f(r),Cd(r));let a=Nd(e,Nd(s,n));const l=Yd(i.shape,o);return l.length>0&&(a=nf(a,l)),$p(a,i.shape)}}}};function sw(e,t,n){const a=e.shape.length,s=a-n.length,r=Jm(n,a);let i=e;null!=r&&(i=Ih(e,r));const o=i.shape.slice(),l=o.splice(a-n.length,n.length).reduce((e,t)=>e*t,1);o.push(l);let c=function(e,t,n){const a=e.shape.slice();a[n]=1;const s=$p(t,a),r=Am(e,n,!0,!1),i=Am(e,n,!0,!0),o=Nd(r,i);return Nd(s,o)}(i.reshape(o),t,s);if(c=c.reshape(i.shape),null!=r){const e=Qm(r);c=Ih(c,e)}return c}const rw={kernelName:_o,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=mf(n,Ld(0)),a=Ld(nb),s=Ld(ab),r=Nd(e,s),i=Nd(Nd(e,a),of(xd(n,"float32")));return zm(t,r,i)}}}},iw={kernelName:Io,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(e,Nd(n,qd(Ld(1),n)))}}},ow={kernelName:Do,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[a]=t,{dim:s}=n,r=Nd(e,a);return{logits:()=>qd(r,Nd(nf(r,[s],true),a))}}},lw={kernelName:Mo,gradFunc:(e,t,n)=>{const{blockShape:a,paddings:s}=n;return{x:()=>om(e,a,s)}}},cw={kernelName:Lo,gradFunc:(e,t,n)=>{const{axis:a}=n;return{x:()=>nm(e,a)}}},uw={kernelName:Yo,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(qd(Ld(1),Sd(n)),e)}}};const dw=[qb,Kb,Zb,Xb,Yb,Jb,Qb,$b,ev,tv,nv,av,rv,ov,lv,cv,uv,dv,hv,pv,mv,fv,xv,gv,bv,vv,wv,kv,Nv,_v,{kernelName:Hr,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t,s=Jd(n.shape,a.shape);return{a:()=>{const t=kd(e,xd(a,"float32")),r=Yd(n.shape,s);return r.length>0?$p(nf(t,r),n.shape):t},b:()=>{let t=Nd(e,xd(n,"float32"));const r=Yd(a.shape,s);r.length>0&&(t=$p(nf(t,r),a.shape));const i=Sd(a);return jh(kd(t,xd(i,"float32")))}}}},Sv,Cv,jv,Tv,Iv,Av,Ev,Rv,Mv,Ov,Fv,Pv,zv,Bv,Wv,Vv,Uv,Hv,qv,Zv,Zv,Xv,Jv,$v,{kernelName:Fi,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{axis:s}=n,r=ps(s,a.shape),i=ns(Zm(a.shape,r)[1]);return{x:()=>{const t=a.shape.slice();r.forEach(e=>{t[e]=1});const n=$p(e,t);return kd(Nd(n,Vf(a.shape,"float32")),i)}}}},ew,{kernelName:zi,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t;return{a:()=>Nd(e,xd(wf(n,a),"float32")),b:()=>Nd(e,xd(mf(n,a),"float32"))}}},tw,{kernelName:Wi,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t,s=Jd(n.shape,a.shape);return{a:()=>{const t=Yd(n.shape,s);return t.length>0?$p(nf(e,t),n.shape):e},b:()=>{const t=Nd(e,jh(hf(kd(n,a)))),r=Yd(a.shape,s);return r.length>0?$p(nf(t,r),a.shape):t}}}},{kernelName:Ui,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t,s=Jd(n.shape,a.shape);return{a:()=>{const t=Nd(e,xd(a,"float32")),r=Yd(n.shape,s);return r.length>0?$p(nf(t,r),n.shape):t},b:()=>{const t=Nd(e,xd(n,"float32")),r=Yd(a.shape,s);return r.length>0?$p(nf(t,r),a.shape):t}}}},{kernelName:Hi,gradFunc:e=>({x:()=>jh(e)})},{kernelName:Yi,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>Wf(n.shape,"float32")}}},{kernelName:Xi,gradFunc:e=>({x:()=>Cd(e)})},{kernelName:Ji,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:a}=n;return ux(e,a).map(e=>()=>e)}},nw,nw,aw,{kernelName:to,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,a]=t,s=mf(n,0);return{x:()=>zm(s,e,Nd(e,a)),alpha:()=>{let t=zm(s,Cd(e),Nd(e,n));const r=Yd(a.shape,e.shape);return r.length>0&&(t=nf(t,r)),$p(t,a.shape)}}}},{kernelName:no,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{axis:s}=n;let r=[];return r=void 0===s||null===s?a.shape.map((e,t)=>t):"number"===typeof s?[s]:s,{x:()=>sw(a,e,r)}}},{kernelName:lo,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kd(e,jh(Sd(n)))}}},{kernelName:go,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,a=Nd(wf(n,6),Jg(n));return{x:()=>Nd(e,xd(a,"float32"))}}},{kernelName:co,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(e,xd(Jg(n),"float32"))}}},{kernelName:uo,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>$p(e,n.shape)}}},{kernelName:mo,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[a]=t,s={dy:e,images:a};return{images:()=>Tc.runKernel(fo,s,n)}}},{kernelName:ho,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[a]=t,s={dy:e,images:a};return{images:()=>Tc.runKernel(po,s,n)}}},{kernelName:xo,gradFunc:(e,t,n)=>{const{dims:a}=n,s=ps(a,e.shape);return{x:()=>Sg(e,s)}}},{kernelName:yo,gradFunc:e=>({x:()=>Cd(e)})},{kernelName:bo,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>jh(kd(e,Nd(Gd(n,1.5),2)))}}},{kernelName:No,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>xd(Cd(n),"float32"),t:()=>Nd(e,xd(n,e.dtype)),e:()=>Nd(e,xd(Af(n),e.dtype))}}},rw,iw,{kernelName:To,gradFunc:e=>({x:()=>Cd(e)})},{kernelName:Co,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(Im(xd(n,"float32")),e)}}},{kernelName:jo,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(Em(xd(n,"float32")),e)}}},{kernelName:So,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{begin:s,size:r}=n,i=a.shape,[o,l]=op(a,s,r),c=[];for(let u=0;u<e.rank;u++)c.push([o[u],i[u]-o[u]-l[u]]);return{x:()=>$f(e,c)}}},ow,{kernelName:Eo,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(e,am(n))}}},lw,lw,cw,cw,{kernelName:Ao,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kd(e,Nd(_d(xd(n,"float32")),2))}}},{kernelName:Wo,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t,s=Ld(2);return{a:()=>Nd(e,Nd(s,qd(n,a))),b:()=>Nd(e,Nd(s,qd(a,n)))}}},{kernelName:Vo,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Nd(e,Nd(xd(n,"float32"),2))}}},{kernelName:il,gradFunc:e=>({x:()=>Cd(e)})},{kernelName:Zo,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,a]=t,s=Jd(n.shape,a.shape);return{a:()=>{let t=e;const a=Yd(n.shape,s);return a.length>0&&(t=nf(t,a)),$p(t,n.shape)},b:()=>{let t=e;const n=Yd(a.shape,s);return n.length>0&&(t=nf(t,n)),$p(jh(t),a.shape)}}}},{kernelName:Ro,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,s=a.shape.slice(),{axis:r}=n;ps(r,a.shape).forEach(e=>{s[e]=1});const i=$p(e,s),o=Nd(i,Vf(a.shape,"float32"));return{x:()=>o}}},{kernelName:Xo,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>kd(e,Sd(Im(n)))}}},uw,{kernelName:Jo,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[a]=t,{reps:s}=n;return{x:()=>{let t=Cd(a);if(1===a.rank)for(let n=0;n<s[0];++n)t=vd(t,sm(e,[n*a.shape[0]],[a.shape[0]]));else if(2===a.rank)for(let n=0;n<s[0];++n)for(let r=0;r<s[1];++r)t=vd(t,sm(e,[n*a.shape[0],r*a.shape[1]],[a.shape[0],a.shape[1]]));else if(3===a.rank)for(let n=0;n<s[0];++n)for(let r=0;r<s[1];++r)for(let i=0;i<s[2];++i)t=vd(t,sm(e,[n*a.shape[0],r*a.shape[1],i*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(4!==a.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(a.rank," tensors yet."));for(let n=0;n<s[0];++n)for(let r=0;r<s[1];++r)for(let i=0;i<s[2];++i)for(let o=0;o<s[3];++o)t=vd(t,sm(e,[n*a.shape[0],r*a.shape[1],i*a.shape[2],o*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return t}}}},{kernelName:el,gradFunc:(e,t,n)=>{const a=n,{perm:s}=a,r=Qm(s);return{x:()=>Ih(e,r)}}},{kernelName:nl,gradFunc:(e,t,n)=>{const a=n,{axis:s}=a;return{value:()=>Yg(e,s)}}},{kernelName:al,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>function(e,t){const n=Qd(t,Cd(t)),a=pf(e,n);let s=ff(t,Ld(0,"int32"));const r=a.rank-s.rank;for(let o=0;o<r;++o)s=lf(s,o+1);s=Ef(s,Vf(a.shape,"bool"));const i=Cd(a);return zm(s,a,i)}(e,n)}}},{kernelName:rl,gradFunc:e=>({x:()=>Cd(e)})}];for(const n of dw)vl(n);oc().prototype.abs=function(){return this.throwIfDisposed(),Zd(this)},oc().prototype.acos=function(){return this.throwIfDisposed(),Cp(this)},oc().prototype.acosh=function(){return this.throwIfDisposed(),jp(this)},oc().prototype.add=function(e){return this.throwIfDisposed(),vd(this,e)},oc().prototype.all=function(e,t){return this.throwIfDisposed(),Ip(this,e,t)},oc().prototype.any=function(e,t){return this.throwIfDisposed(),Ep(this,e,t)},oc().prototype.argMax=function(e){return this.throwIfDisposed(),Ap(this,e)},oc().prototype.argMin=function(e){return this.throwIfDisposed(),Rp(this,e)},oc().prototype.asScalar=function(){return this.throwIfDisposed(),$a(1===this.size,()=>"The array must have only 1 element."),$p(this,[])},oc().prototype.asType=function(e){return this.throwIfDisposed(),xd(this,e)},oc().prototype.as1D=function(){return this.throwIfDisposed(),$p(this,[this.size])},oc().prototype.as2D=function(e,t){return this.throwIfDisposed(),$p(this,[e,t])},oc().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),$p(this,[e,t,n])},oc().prototype.as4D=function(e,t,n,a){return this.throwIfDisposed(),$p(this,[e,t,n,a])},oc().prototype.as5D=function(e,t,n,a,s){return this.throwIfDisposed(),$p(this,[e,t,n,a,s])},oc().prototype.asin=function(){return this.throwIfDisposed(),Mp(this)},oc().prototype.asinh=function(){return this.throwIfDisposed(),Lp(this)},oc().prototype.atan=function(){return this.throwIfDisposed(),Dp(this)},oc().prototype.atan2=function(e){return this.throwIfDisposed(),Op(this,e)},oc().prototype.atanh=function(){return this.throwIfDisposed(),Fp(this)},oc().prototype.avgPool=function(e,t,n,a){return this.throwIfDisposed(),em(this,e,t,n,a)},oc().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),om(this,e,t)},oc().prototype.batchNorm=function(e,t,n,a,s){return this.throwIfDisposed(),lm(this,e,t,n,a,s)},oc().prototype.broadcastTo=function(e){return this.throwIfDisposed(),fm(this,e)},oc().prototype.cast=function(e){return this.throwIfDisposed(),xd(this,e)},oc().prototype.ceil=function(){return this.throwIfDisposed(),gm(this)},oc().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),xm(this,e,t)},oc().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof ic&&(e=[e]),nm([this,...e],t)},oc().prototype.conv1d=function(e,t,n,a,s,r){return this.throwIfDisposed(),Nm(this,e,t,n,a,s,r)},oc().prototype.conv2dTranspose=function(e,t,n,a,s){return this.throwIfDisposed(),Sm(this,e,t,n,a,s)},oc().prototype.conv2d=function(e,t,n,a,s,r){return this.throwIfDisposed(),km(this,e,t,n,a,s,r)},oc().prototype.cos=function(){return this.throwIfDisposed(),Im(this)},oc().prototype.cosh=function(){return this.throwIfDisposed(),Em(this)},oc().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),Am(this,e,t,n)},oc().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Rm(this,e,t,n)},oc().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Lm(this,e,t)},oc().prototype.depthwiseConv2d=function(e,t,n,a,s,r){return this.throwIfDisposed(),Dm(this,e,t,n,a,s,r)},oc().prototype.dilation2d=function(e,t,n,a,s){return this.throwIfDisposed(),Fm(this,e,t,n,a,s)},oc().prototype.divNoNan=function(e){return this.throwIfDisposed(),Bm(this,e)},oc().prototype.div=function(e){return this.throwIfDisposed(),kd(this,e)},oc().prototype.dot=function(e){return this.throwIfDisposed(),Wm(this,e)},oc().prototype.elu=function(){return this.throwIfDisposed(),Um(this)},oc().prototype.equal=function(e){return this.throwIfDisposed(),Pm(this,e)},oc().prototype.erf=function(){return this.throwIfDisposed(),Gm(this)},oc().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),rf(this,e,t)},oc().prototype.exp=function(){return this.throwIfDisposed(),of(this)},oc().prototype.expandDims=function(e){return this.throwIfDisposed(),lf(this,e)},oc().prototype.expm1=function(){return this.throwIfDisposed(),cf(this)},oc().prototype.fft=function(){return this.throwIfDisposed(),Ug(this)},oc().prototype.flatten=function(){return this.throwIfDisposed(),$p(this,[this.size])},oc().prototype.floor=function(){return this.throwIfDisposed(),hf(this)},oc().prototype.floorDiv=function(e){return this.throwIfDisposed(),wd(this,e)},oc().prototype.gather=function(e,t,n){return this.throwIfDisposed(),pf(this,e,t,n)},oc().prototype.greaterEqual=function(e){return this.throwIfDisposed(),ff(this,e)},oc().prototype.greater=function(e){return this.throwIfDisposed(),mf(this,e)},oc().prototype.ifft=function(){return this.throwIfDisposed(),Hg(this)},oc().prototype.irfft=function(){return this.throwIfDisposed(),Gg(this)},oc().prototype.isFinite=function(){return this.throwIfDisposed(),gf(this)},oc().prototype.isInf=function(){return this.throwIfDisposed(),xf(this)},oc().prototype.isNaN=function(){return this.throwIfDisposed(),yf(this)},oc().prototype.leakyRelu=function(e){return this.throwIfDisposed(),bf(this,e)},oc().prototype.lessEqual=function(e){return this.throwIfDisposed(),wf(this,e)},oc().prototype.less=function(e){return this.throwIfDisposed(),vf(this,e)},oc().prototype.localResponseNormalization=function(e,t,n,a){return this.throwIfDisposed(),Nf(this,e,t,n,a)},oc().prototype.logSigmoid=function(){return this.throwIfDisposed(),jf(this)},oc().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Tf(this,e)},oc().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),If(this,e,t)},oc().prototype.log=function(){return this.throwIfDisposed(),_f(this)},oc().prototype.log1p=function(){return this.throwIfDisposed(),Sf(this)},oc().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Ef(this,e)},oc().prototype.logicalNot=function(){return this.throwIfDisposed(),Af(this)},oc().prototype.logicalOr=function(e){return this.throwIfDisposed(),Rf(this,e)},oc().prototype.logicalXor=function(e){return this.throwIfDisposed(),Mf(this,e)},oc().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),_h(this,e,t,n)},oc().prototype.maxPool=function(e,t,n,a){return this.throwIfDisposed(),Ff(this,e,t,n,a)},oc().prototype.max=function(e,t){return this.throwIfDisposed(),ef(this,e,t)},oc().prototype.maximum=function(e){return this.throwIfDisposed(),Qd(this,e)},oc().prototype.mean=function(e,t){return this.throwIfDisposed(),Bf(this,e,t)},oc().prototype.min=function(e,t){return this.throwIfDisposed(),tf(this,e,t)},oc().prototype.minimum=function(e){return this.throwIfDisposed(),Hf(this,e)},oc().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),Gf(this,e,t)},oc().prototype.mod=function(e){return this.throwIfDisposed(),qf(this,e)},oc().prototype.mul=function(e){return this.throwIfDisposed(),Nd(this,e)},oc().prototype.neg=function(){return this.throwIfDisposed(),jh(this)},oc().prototype.norm=function(e,t,n){return this.throwIfDisposed(),sf(this,e,t,n)},oc().prototype.notEqual=function(e){return this.throwIfDisposed(),Yf(this,e)},oc().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),Sh(this,e,t,n)},oc().prototype.onesLike=function(){return this.throwIfDisposed(),Jf(this)},oc().prototype.pad=function(e,t){return this.throwIfDisposed(),$f(this,e,t)},oc().prototype.pool=function(e,t,n,a,s,r){return this.throwIfDisposed(),rg(this,e,t,n,a,s,r)},oc().prototype.pow=function(e){return this.throwIfDisposed(),Gd(this,e)},oc().prototype.prelu=function(e){return this.throwIfDisposed(),ig(this,e)},oc().prototype.prod=function(e,t){return this.throwIfDisposed(),og(this,e,t)},oc().prototype.reciprocal=function(){return this.throwIfDisposed(),kg(this)},oc().prototype.relu=function(){return this.throwIfDisposed(),Ng(this)},oc().prototype.relu6=function(){return this.throwIfDisposed(),_g(this)},oc().prototype.reshapeAs=function(e){return this.throwIfDisposed(),$p(this,e.shape)},oc().prototype.reshape=function(e){return this.throwIfDisposed(),$p(this,e)},oc().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),ry(this,e,t,n)},oc().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),iy(this,e,t,n)},oc().prototype.reverse=function(e){return this.throwIfDisposed(),Sg(this,e)},oc().prototype.rfft=function(){return this.throwIfDisposed(),Kg(this)},oc().prototype.round=function(){return this.throwIfDisposed(),Eg(this)},oc().prototype.rsqrt=function(){return this.throwIfDisposed(),Ag(this)},oc().prototype.selu=function(){return this.throwIfDisposed(),Rg(this)},oc().prototype.separableConv2d=function(e,t,n,a,s,r){return this.throwIfDisposed(),Mg(this,e,t,n,a,s,r)},oc().prototype.sigmoid=function(){return this.throwIfDisposed(),am(this)},oc().prototype.sign=function(){return this.throwIfDisposed(),Dg(this)},oc().prototype.sin=function(){return this.throwIfDisposed(),Og(this)},oc().prototype.sinh=function(){return this.throwIfDisposed(),Fg(this)},oc().prototype.slice=function(e,t){return this.throwIfDisposed(),sm(this,e,t)},oc().prototype.softmax=function(e){return this.throwIfDisposed(),Vg(this,e)},oc().prototype.softplus=function(){return this.throwIfDisposed(),Cf(this)},oc().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),sg(this,e,t)},oc().prototype.split=function(e,t){return this.throwIfDisposed(),qg(this,e,t)},oc().prototype.sqrt=function(){return this.throwIfDisposed(),_d(this)},oc().prototype.square=function(){return this.throwIfDisposed(),Sd(this)},oc().prototype.squaredDifference=function(e){return this.throwIfDisposed(),Zg(this,e)},oc().prototype.squeeze=function(e){return this.throwIfDisposed(),Xg(this,e)},oc().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof ic?[this,e]:[this,...e];return Yg(n,t)},oc().prototype.step=function(e){return this.throwIfDisposed(),Jg(this,e)},oc().prototype.stridedSlice=function(e,t,n,a,s,r,i,o){return this.throwIfDisposed(),Qg(this,e,t,n,a,s,r,i,o)},oc().prototype.sub=function(e){return this.throwIfDisposed(),qd(this,e)},oc().prototype.sum=function(e,t){return this.throwIfDisposed(),nf(this,e,t)},oc().prototype.tan=function(){return this.throwIfDisposed(),$g(this)},oc().prototype.tanh=function(){return this.throwIfDisposed(),rm(this)},oc().prototype.tile=function(e){return this.throwIfDisposed(),uf(this,e)},oc().prototype.toBool=function(){return this.throwIfDisposed(),xd(this,"bool")},oc().prototype.toFloat=function(){return this.throwIfDisposed(),xd(this,"float32")},oc().prototype.toInt=function(){return this.throwIfDisposed(),xd(this,"int32")},oc().prototype.topk=function(e,t){return this.throwIfDisposed(),ix(this,e,t)},oc().prototype.transpose=function(e){return this.throwIfDisposed(),Ih(this,e)},oc().prototype.unique=function(e){return this.throwIfDisposed(),lx(this,e)},oc().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),cx(this,e,t)},oc().prototype.unstack=function(e){return this.throwIfDisposed(),ux(this,e)},oc().prototype.where=function(e,t){return this.throwIfDisposed(),zm(e,this,t)},oc().prototype.zerosLike=function(){return this.throwIfDisposed(),Cd(this)};class hw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,hw.prototype)}}class pw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,pw.prototype)}}class mw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,mw.prototype)}}class fw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,fw.prototype)}}class gw extends Error{constructor(e){super(e),Object.setPrototypeOf(this,gw.prototype)}}Error;class xw{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}}function yw(e,t){if(Array.isArray(e)){let n=[];for(let a=0;a<t;a++)n=n.concat(e);return n}{const n=new Array(t);return n.fill(e),n}}function bw(e,t){if(!e)throw new gw(t)}function vw(e,t){let n=0;for(const a of e)a===t&&n++;return n}function ww(e){return 1===e.length?e[0]:e}function kw(e){return Array.isArray(e)?e:[e]}function Nw(e){const t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function _w(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let Sw={};function Cw(e){if(null===e||void 0===e)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function jw(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach(e=>jw(e));else{const t=Object.keys(e);for(const n of t){const t=e[n];null!=t&&"object"===typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!==typeof t.value?jw(t):e[n]=t.value)}}}function Tw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){const s=e;let r;if(s in n)r=n[s];else if(s in Sw)r=Sw[s];else if(r=t[s],null==r)throw new mw("Unknown ".concat(a,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(a," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(a," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return r}{const r=e;if(null==r.className||null==r.config)throw new mw("".concat(a,": Improper config format: ")+"".concat(JSON.stringify(r),".\n")+"'className' and 'config' must set.");const i=r.className;let o,l;if(i in n?[o,l]=n[i]:i in Sw?[o,l]=Sw.className:i in t&&([o,l]=t[i]),null==o)throw new mw("Unknown ".concat(a,": ").concat(i,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(a," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(a," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=l){const e={};for(const n of Object.keys(Sw))e[n]=Sw[n];for(const s of Object.keys(n))e[s]=n[s];r.config.customObjects=e;const t=Object.assign({},Sw);for(const s of Object.keys(n))Sw[s]=n[s];jw(r.config);const a=l(o,r.config,n,s);return Sw=Object.assign({},t),a}{const e=Object.assign({},Sw);for(const a of Object.keys(n))Sw[a]=n[a];const t=new o(r.config);return Sw=Object.assign({},e),t}}}function Iw(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function Ew(e){if(null==e)return e;const t=[];for(const n of e)-1===t.indexOf(n)&&t.push(n);return t}function Aw(e){if(null==e)throw new mw("Invalid value in obj: ".concat(JSON.stringify(e)));for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function Rw(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new mw("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function Mw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return bw(n>=0),bw(a>=n),Array.isArray(e)&&e.length>=n&&e.length<=a&&e.every(e=>typeof e===t)}function Lw(e,t){Array.isArray(e)?($a(e.length>0,()=>"".concat(t," is unexpectedly an empty array.")),e.forEach((e,n)=>Lw(e,"element ".concat(n+1," of ").concat(t)))):$a(Number.isInteger(e)&&e>0,()=>"Expected ".concat(t," to be a positive integer, but got ")+"".concat(Dw(e),"."))}function Dw(e){return null===e?"null":Array.isArray(e)?"["+e.map(e=>Dw(e)).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function Ow(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}let Fw=0;function Pw(){return Fw++}const zw={};function Bw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in zw||(zw[e]=0),zw[e]+=1,e+zw[e].toString()}const Ww=["channelsFirst","channelsLast"],Vw=["nearest","bilinear"],Uw=["valid","same","causal"],Hw=["max","avg"],Gw=["sum","mul","concat","ave"],qw=new Map;function Kw(e){Rw(Ww,"DataFormat",e)}function Zw(e){Rw(Uw,"PaddingMode",e)}function Xw(e){Rw(Hw,"PoolMode",e)}const Yw=[];function Jw(e,t){Yw.push(e);try{const e=t();return Yw.pop(),e}catch(vq){throw Yw.pop(),vq}}function Qw(e){if(!tk(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===Yw.length?"":Yw.join("/")+"/")+e}function $w(e){if(!tk(e))throw new Error("Not a valid tensor name: '"+e+"'");qw.has(e)||qw.set(e,0);const t=qw.get(e);if(qw.set(e,qw.get(e)+1),t>0){const n="".concat(e,"_").concat(t);return qw.set(n,1),n}return e}const ek=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function tk(e){return!!e.match(ek)}function nk(e){return e===parseInt(e.toString(),10)}function ak(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let a=1;for(let s=t;s<n;++s)a*=e[s];return a}function sk(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const a=e[n];a<t&&(t=a)}return t}function rk(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const a=e[n];a>t&&(t=a)}return t}function ik(e,t){if(t<e)throw new mw("end (".concat(t,") < begin (").concat(e,") is forbidden."));const n=[];for(let a=e;a<t;++a)n.push(a);return n}let ok;function lk(){return null==ok&&(ok=hu().epsilon()),ok}function ck(e,t){return xd(e,t)}function uk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),$p(e,n)}function dk(e,t,n){return tu(()=>{switch(e.rank){case 1:return Pg(e,t,n);case 2:return zg(e,[t,0],[n,e.shape[1]]);case 3:return Bg(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return Wg(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return sm(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return sm(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new mw("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function hk(e,t,n){return tu(()=>{switch(e.rank){case 1:return Pg(e,t,n);case 2:return zg(e,[0,t],[e.shape[0],n]);case 3:return Bg(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return Wg(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new mw("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function pk(e,t,n,a){return tu(()=>{switch(e.rank){case 1:return Pg(e,t,n);case 2:switch(a){case 1:return dk(e,t,n);case 2:return hk(e,t,n);default:throw new mw("The axis is not within the rank of the tensor "+"".concat(a))}case 3:switch(a){case 1:return dk(e,t,n);case 2:return Bg(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return hk(e,t,n);default:throw new mw("The axis is not within the rank of the tensor "+"".concat(a))}case 4:switch(a){case 1:return dk(e,t,n);case 2:return Wg(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return Wg(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return hk(e,t,n);default:throw new mw("The axis is not within the rank of the tensor "+"".concat(a))}default:throw new mw("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function mk(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(t=e[0].rank,n=0!==t?t:0),n===e[0].rank&&(n=-1),nm(e,n)}function fk(e,t){switch(e.rank){case 1:return ym([e,t]);case 2:return bm([e,t],0);case 3:return vm([e,t],0);case 4:return wm([e,t],0);default:throw new mw("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function gk(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new mw("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return uf(e,t)}function xk(e){return xg(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function yk(e,t,n,a){if(e.rank<2||t.rank<2)throw new fw("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3){if(e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new fw("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape))}if(2===e.rank&&2===t.rank){return Mx({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?wk(e.rank,a,"channelsLast"):null,activation:n})}{const s=e.shape.slice(),r=s.pop();e=$p(e,[-1,r]);const i=t.shape.slice(),o=i.pop(),l=i.pop(),c=[...i,o],u=Array.from({length:t.rank},(e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n);t=$p(Ih(t,u),[l,-1]);const d=[...s,...c];return $p(Mx({a:e,b:t,transposeA:!1,transposeB:!1,bias:a?wk(e.rank,a,"channelsLast"):null,activation:n}),d)}}function bk(e,t,n){return tu(()=>(t=Array.isArray(t)?ex(t,"int32"):xd(t,"int32"),pf(e,t,n)))}function vk(e){return Nd(e,e)}function wk(e,t,n){const a=t.shape;if(1!==t.rank&&t.rank!==e)throw new mw("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===a.length?$p(t,[1,a[0],1,1,1]):$p(t,[1,a[3],a[0],a[1],a[2]]);if("channelsLast"===n)return 1===a.length?$p(t,[1,1,1,1,a[0]]):$p(t,[1].concat(a))}else if(4===e){if("channelsFirst"===n)return 1===a.length?$p(t,[1,a[0],1,1]):$p(t,[1,a[2],a[0],a[1]]);if("channelsLast"===n)return 1===a.length?$p(t,[1,1,1,a[0]]):$p(t,[1].concat(a))}else if(3===e){if("channelsFirst"===n)return 1===a.length?$p(t,[1,a[0],1]):$p(t,[1,a[1],a[0]]);if("channelsLast"===n)return 1===a.length?$p(t,[1,1,a[0]]):$p(t,[1].concat(a))}else if(e<3)return t;throw new mw("Unsupported input rank by biasAdd: ".concat(t.rank))}function kk(e,t,n){return tu(()=>(null==n&&(n="channelsLast"),Kw(n),vd(e,wk(e.rank,t,n))))}function Nk(e,t,n,a){return tu(()=>vx(e,t,n,a))}function _k(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}const Sk=["fanIn","fanOut","fanAvg"],Ck=["normal","uniform","truncatedNormal"];class jk extends Fd{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Tk extends jk{apply(e,t){return Wf(e,t)}}Tk.className="Zeros",zd(Tk);class Ik extends jk{apply(e,t){return Vf(e,t)}}Ik.className="Ones",zd(Ik);class Ek extends jk{constructor(e){if(super(),"object"!==typeof e)throw new mw("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new mw("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return tu(()=>Nd(Ld(this.value),Vf(e,t)))}getConfig(){return{value:this.value}}}Ek.className="Constant",zd(Ek);class Ak extends jk{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return bg(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Ak.className="RandomUniform",zd(Ak);class Rk extends jk{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new fw("randomNormal does not support dType ".concat(t,"."));return xk(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Rk.className="RandomNormal",zd(Rk);class Mk extends jk{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new fw("truncatedNormal does not support dType ".concat(t,"."));return ox(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Mk.className="TruncatedNormal",zd(Mk);class Lk extends jk{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return tu(()=>{if(2!==e.length||e[0]!==e[1])throw new mw("Identity matrix initializer can only be used for 2D square matrices.");return Nd(this.gain,df(e[0]))})}getConfig(){return{gain:this.gain}}}Lk.className="Identity",zd(Lk);class Dk extends jk{constructor(e){if(super(),e.scale<0)throw new mw("scale must be a positive float. Got: ".concat(e.scale));var t;this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,t=this.mode,Rw(Sk,"FanMode",t),this.distribution=null==e.distribution?"normal":e.distribution,function(e){Rw(Ck,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){const n=function(e){let t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(Kw(a),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===a){const a=ak(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===a){const a=ak(e,0,e.length-2);t=e[e.length-2]*a,n=e[e.length-1]*a}}else{const a=ak(e);t=Math.sqrt(a),n=Math.sqrt(a)}return[t,n]}(e),a=n[0],s=n[1];let r=this.scale;if("fanIn"===this.mode?r/=Math.max(1,a):"fanOut"===this.mode?r/=Math.max(1,s):r/=Math.max(1,(a+s)/2),"normal"===this.distribution){const n=Math.sqrt(r);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new fw("".concat(this.getClassName()," does not support dType ").concat(t,"."));return ox(e,0,n,t,this.seed)}{const n=Math.sqrt(3*r);return bg(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Dk.className="VarianceScaling",zd(Dk);class Ok extends Dk{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return Dk.className}}Ok.className="GlorotUniform",zd(Ok);class Fk extends Dk{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return Dk.className}}Fk.className="GlorotNormal",zd(Fk);class Pk extends Dk{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return Dk.className}}Pk.className="HeNormal",zd(Pk);class zk extends Dk{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return Dk.className}}zk.className="HeUniform",zd(zk);class Bk extends Dk{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return Dk.className}}Bk.className="LeCunNormal",zd(Bk);class Wk extends Dk{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return Dk.className}}Wk.className="LeCunUniform",zd(Wk);class Vk extends jk{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return tu(()=>{if(e.length<2)throw new fw("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError("Unsupported data type ".concat(t,"."));const n=ns(e.slice(0,-1)),a=e[e.length-1],s=n*a;s>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(s,") elements: ")+"Slowness may result.");const r=xk([Math.max(a,n),Math.min(a,n)],0,1,t,this.seed),i=Ly.qr(r,!1);let o=i[0];const l=i[1].flatten().stridedSlice([0],[Math.min(a,n)*Math.min(a,n)],[Math.min(a,n)+1]);return o=Nd(o,l.sign()),n<a&&(o=o.transpose()),Nd(Ld(this.gain),o.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}Vk.className="Orthogonal",zd(Vk);const Uk={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Hk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Tw(e,Pd.getMap().classNameMap,t,"initializer")}function Gk(e){return Cw(e)}function qk(e){if("string"===typeof e){const t=e in Uk?Uk[e]:e;if("GlorotNormal"===t)return new Fk;if("GlorotUniform"===t)return new Ok;if("HeNormal"===t)return new Pk;if("HeUniform"===t)return new zk;if("LeCunNormal"===t)return new Bk;if("LeCunUniform"===t)return new Wk;{const e={};return e.className=t,e.config={},Hk(e)}}return e instanceof jk?e:Hk(e)}function Kk(e){return Array.isArray(e)&&Array.isArray(e[0])}function Zk(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function Xk(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new mw("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function Yk(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new mw("Expected exactly 1 Shape; got ".concat(e.length))}return e}function Jk(e){let t=0;for(const n of e)0===n.shape.length?t+=1:t+=n.shape.reduce((e,t)=>e*t);return t}const Qk="Variable";class $k{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qk,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=Pw(),n=null==n?Qk:n,this.originalName=Qw(n),this.name=$w(this.originalName),this.trainable_=a,this.constraint=s,this.val=hx(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function eN(e){return e.map(e=>e.read())}function tN(e){e.forEach(e=>{e[0].write(e[1])})}class nN{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class aN{constructor(e,t,n,a,s,r,i){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=a,this.callArgs=s,this.outputTensorIndex=i,this.id=Pw(),null!=r&&(this.originalName=Qw(r),this.name=$w(this.originalName)),this.rank=t.length}}let sN=0;class rN{constructor(e,t){this.callArgs=t,this.id=sN++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let iN=0;class oN extends Fd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=iN++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const e=this.getClassName();t=Nw(e)+"_"+Bw(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new pw("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new mw("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return ww(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return ww(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new hw("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new hw("Layer ".concat(this.name)+" is not connected, no input to return.");return ww(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new hw("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new hw("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return ww(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=kw(e);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=kw(this.inputSpec);if(t.length!==n.length)throw new mw("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(e));for(let a=0;a<t.length;a++){const e=t[a],s=n[a];if(null==s)continue;const r=e.rank;if(null!=s.ndim&&r!==s.ndim)throw new mw("Input ".concat(a," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(s.ndim,", found ndim=").concat(r));if(null!=s.maxNDim&&r>s.maxNDim)throw new mw("Input ".concat(a," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(s.maxNDim,", found ndim=").concat(r));if(null!=s.minNDim&&r<s.minNDim)throw new mw("Input ".concat(a," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(s.minNDim,", found ndim=").concat(r,"."));if(null!=s.dtype&&e.dtype!==s.dtype)throw new mw("Input ".concat(a," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(s.dtype,", found dtype=").concat(e.dtype,"."));if(s.axes){const t=e.shape;for(const e in s.axes){const n=Number(e),r=s.axes[e],i=n>=0?t[n]:t[t.length+n];if(null!=r&&-1===[r,null].indexOf(i))throw new mw("Input ".concat(a," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(n," of input shape to ")+"have value ".concat(r," but got shape ").concat(t,"."))}}if(null!=s.shape)for(let t=0;t<s.shape.length;++t){const n=s.shape[t],r=e.shape[t];if(null!=n&&null!=r&&n!==r)throw new mw("Input ".concat(a," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(s.shape,", ")+"found shape=".concat(e.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=kw(e),a=function(e){let t=!0;for(const n of kw(e))if(!(n instanceof aN)){t=!1;break}return t}(e),s=function(e){let t=!0;for(const n of kw(e))if(n instanceof aN){t=!1;break}return t}(e);if(a===s)throw new mw("Arguments to apply() must be all SymbolicTensors or all Tensors");return Jw(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const t=[];for(const n of kw(e))t.push(n.shape);this.build(ww(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&s&&(this._refCount=1)}if(this.assertInputCompatibility(e),s){let a=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,a);const s=kw(a),r=[];for(let e of s)-1!==n.indexOf(e)&&(e=e.clone()),r.push(e);if(a=ww(r),null!=this.activityRegularizer)throw new fw("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}{const n=function(e){e=kw(e);const t=[];for(const n of e)t.push(n.shape);return ww(t)}(e),a=this.computeOutputShape(n);let s;const r="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?n[0]:n),s=null!=a&&a.length>0&&Array.isArray(a[0])?a.map((n,a)=>new aN(r,n,this,kw(e),t,this.name,a)):new aN(r,a,this,kw(e),t,this.name),this.addInboundNode(e,s,null,null,n,a,t),this._refCount++,null!=this.activityRegularizer)throw new fw("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return s}})}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let t=!1;this.batchInputShape.forEach((n,a)=>{null!=n&&null!=e[a]&&e[a]!==n&&(t=!0)}),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new hw("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new hw("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new pw("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Jk(this.weights)}build(e){this.built=!0}getWeights(){return eN(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(e){tu(()=>{const t=this.weights;if(t.length!==e.length)throw new mw('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(t.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0===t.length)return;const n=[],a=eN(t);for(let s=0;s<a.length;++s){const r=a[s],i=t[s],o=e[s];if(!rs(r.shape,o.shape))throw new mw("Layer weight shape ".concat(r.shape," ")+"not compatible with provided weight shape ".concat(o.shape));n.push([i,o])}tN(n)})}addWeight(e,t,n,a,s,r,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new mw("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(a=null!=o?o():qk("zeros"));const l=a.apply(t,n),c=new $k(l,n,e,r,i);return l.dispose(),null!=s&&this.addLoss(()=>s.apply(c.read())),null==r&&(r=!0),r?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=kw(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach(e=>{if(null!=e)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")})}return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;const a=this.computeMask(e,n),s=kw(t),r=kw(a);if(s.length!==r.length)throw new Error("".concat(this.name," outputs ").concat(s.length," tensors ")+"but ".concat(s.length," masks for those tensors"));for(let i=0;i<s.length;i++)s[i].kerasMask=r[i]}addInboundNode(e,t,n,a,s,r){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const o=kw(e);t=kw(t),n=kw(n),a=kw(a),s=Zk(s),r=Zk(r);const l=[],c=[],u=[];for(const d of o)l.push(d.sourceLayer),c.push(d.nodeIndex),u.push(d.tensorIndex);new rN({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:u,inputTensors:o,outputTensors:t,inputMasks:n,outputMasks:a,inputShapes:s,outputShapes:r},i);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function lN(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{const e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{const t=[];for(let n=0;n<e.inboundLayers.length;n++){const a=lN(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(const e of a)-1===t.indexOf(e)&&t.push(e)}return t}}}class cN extends oN{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:Bw("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new mw("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new mw("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new mw("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const a=new aN(this.dtype,this.batchInputShape,this,[],{},this.name);a.nodeIndex=0,a.tensorIndex=0,new rN({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new mw("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}cN.className="InputLayer",zd(cN);class uN{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof uN)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new mw("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return xd(t,e.dtype)}catch(wq){throw new mw("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof aN){if(null==this.id2Value[e.id])throw new mw("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}{const t=this.name2Id[e];if(null==t)throw new mw("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof aN){if(null==this.id2Value[e.id])throw new mw("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}{const t=this.name2Id[e];if(null==t)throw new mw("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&nu(this.id2Mask)}}const dN=new xw,hN=new xw;function pN(e,t,n,a){const s=null!=n&&n.training,r=Array.isArray(e),i=r?e:[e],o=i.map(e=>e.name),l=[],c=t.names();for(const m of o)-1!==c.indexOf(m)?l.push(t.getValue(m)):l.push(null);null!=a&&(a.maxNumTensors=-1/0,a.minNumTensors=1/0);const u=o.join(",")+"|"+t.names().sort().join(",");let d,h=dN.get(u);if(null==h){const e=function(e,t){$a(null!=e&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],a={};if(1===e.length){const s=fN(e[0],t);n=s.sorted,a=s.recipientMap}else{const s=new Set;for(const r of e){const{sorted:e,recipientMap:i}=fN(r,t);for(const t of e)s.has(t.name)||(n.push(t),s.add(t.name));for(const t in i)null==a[t]&&(a[t]=new Set),i[t].forEach(e=>a[t].add(e))}}return{sorted:n,recipientCounts:mN(a)}}(i,t);h=e.sorted,d=e.recipientCounts,dN.put(u,h),hN.put(u,d)}d={},s||Object.assign(d,hN.get(u));const p=new uN(t);for(let m=0;m<h.length;++m){if(null!=a){const e=$c().numTensors;e>a.maxNumTensors&&(a.maxNumTensors=e),e<a.minNumTensors&&(a.minNumTensors=e)}const e=h[m],r=e.sourceLayer;if(r instanceof cN)continue;const i=[],c=[],u=[];let f=!1;for(const n of e.inputs){const e=p.getValue(n),a=p.getMask(n);i.push(e),c.push(a),null!=a&&(f=!0),s||(d[n.name]--,0!==d[n.name]||t.hasKey(n)||-1!==o.indexOf(n.name)||e.isDisposed||!0===n.sourceLayer.stateful||u.push(e))}f&&((n=n||{}).mask=c[0]);const g=kw(r.apply(i,n));let x=null;r.supportsMasking&&(x=r.computeMask(i,c));const y=gN(e),b=Array.isArray(y)?y:[y];for(let t=0;t<b.length;++t){p.hasKey(b[t])||p.add(b[t],g[t],Array.isArray(x)?x[0]:x);const e=o.indexOf(b[t].name);-1!==e&&(l[e]=g[t])}s||nu(u)}return p.disposeMasks(),r?l:l[0]}function mN(e){const t={};for(const n in e)t[n]=e[n].size;return t}function fN(e,t){const n=new Set,a=[],s={};for(const o of t.names())n.add(o);const r=[],i=[];for(r.push(e);r.length>0;){const e=r[r.length-1];if(n.has(e.name)){r.pop();continue}const t=i[i.length-1]===r.length-1;if(0===e.inputs.length||t)r.pop(),a.push(e),n.add(e.name),t&&i.pop();else{i.push(r.length-1);for(const t of e.inputs)null==s[t.name]&&(s[t.name]=new Set),s[t.name].add(e.name),n.has(t.name)||r.push(t)}}return{sorted:a,recipientMap:s}}function gN(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(const a of e.sourceLayer.inboundNodes[t].outputTensors)if(a.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}function xN(e,t){return tu(()=>_d(nf(Nd(e,e),t,!0)))}Vs().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function(e){null!=dN&&dN.setMaxEntries(e),null!=hN&&hN.setMaxEntries(e)});class yN extends Fd{getConfig(){return{}}}class bN extends yN{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return tu(()=>{const t=xN(e,this.axis),n=xm(t,0,this.maxValue);return Nd(e,kd(n,vd(lk(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}bN.className="MaxNorm",zd(bN);class vN extends yN{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return tu(()=>kd(e,vd(lk(),xN(e,this.axis))))}getConfig(){return{axis:this.axis}}}vN.className="UnitNorm",zd(vN);class wN extends yN{apply(e){return Ng(e)}}wN.className="NonNeg",zd(wN);class kN extends yN{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return tu(()=>{const t=xN(e,this.axis),n=vd(Nd(this.rate,xm(t,this.minValue,this.maxValue)),Nd(1-this.rate,t));return Nd(e,kd(n,vd(lk(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}kN.className="MinMaxNorm",zd(kN);const NN={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function _N(e){return Cw(e)}function SN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Tw(e,Pd.getMap().classNameMap,t,"constraint")}function CN(e){if(null==e)return null;if("string"===typeof e){return SN({className:e in NN?NN[e]:e,config:{}})}return e instanceof yN?e:SN(e)}async function jN(e){if(null==e)return;const t=[],n=[],a=[];for(const s in e){const r=e[s];if("number"!==typeof r){const e=r;t.push(e.data()),n.push(s),a.push(e)}}if(t.length>0){const s=await Promise.all(t);for(let t=0;t<s.length;++t)e[n[t]]=s[t][0];nu(a)}}function TN(e){if(null!=e)for(const t in e){const n=e[t];"number"!==typeof n&&n.dispose()}}var IN;!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(IN||(IN={}));class EN{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class AN{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class RN extends EN{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});const n=null==t.size?0:t.size;this.seen+=n;for(const a in t){const e=t[a];if("number"===typeof e)this.totals.hasOwnProperty(a)||(this.totals[a]=0),this.totals[a]=this.totals[a]+e*n;else{let t;a in this.totals?t=this.totals[a]:this.totals[a]=0;const s=tu(()=>vd(this.totals[a],Nd(e,n)));this.totals[a]=s,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?t[n]=this.totals[n]/this.seen:tu(()=>{const e=Nd(kd(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),au(t[n])}))}}class MN extends EN{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(const n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const s in this.history){const a=this.history[s];for(let r=0;r<a.length;++r)if("number"!==typeof a[r]){const i=a[r];e.push(i.data()),t.push(s),n.push(r)}}const a=await Promise.all(e);for(let s=0;s<a.length;++s){this.history[t[s]][n[s]].dispose(),this.history[t[s]][n[s]]=a[s][0]}}}class LN extends EN{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||By,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");_s(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let a,s=null!=n?n():Vl();return function(){const r=null!=n?n():Vl();return r-s<t||(s=r,a=e(...arguments)),a}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const a=[];null!=this.yield&&(await jN(n),a.push(this.yield(e,t,n))),a.push(this.nextFrameFunc()),await Promise.all(a)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await jN(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];null!=this.epochEnd&&(await jN(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await jN(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];null!=this.batchEnd&&(await jN(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):_s(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await jN(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await jN(e),await this.trainEnd(e))}}function DN(e,t){if(null==e&&(e={}),e instanceof EN)return[e];if(Array.isArray(e)&&e[0]instanceof EN)return e;return kw(e).map(e=>new LN(e,t))}class ON{constructor(){}static registerCallbackConstructor(e,t){$a(e>=0&&Number.isInteger(e),()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e)),ON.checkForDuplicate(t),null==ON.constructors[e]&&(ON.constructors[e]=[]),ON.constructors[e].push(t)}static checkForDuplicate(e){for(const t in ON.constructors){ON.constructors[+t].forEach(t=>{if(t===e)throw new mw("Duplicate callback constructor.")})}}static clear(){ON.constructors={}}static createCallbacks(e){const t=[];for(const n in ON.constructors){const a=+n;e>=a&&t.push(...ON.constructors[a])}return t.map(e=>new e)}}function FN(e,t,n,a,s,r,i,o,l){const c=new MN,u=[new RN,...ON.createCallbacks(t)];null!=e&&u.push(...e),u.push(c);const d=new AN(u);return d.setParams({epochs:n,initialEpoch:a,samples:s,steps:r,batchSize:i,verbose:t,doValidation:o,metrics:l}),{callbackList:d,history:c}}function PN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Tw(e,Pd.getMap().classNameMap,t,"layer",n)}function zN(e,t){return tu(()=>{"float32"!==e.dtype&&(e=xd(e,"float32"));const n=nf(vk(e),t,!0),a=Ud(n.shape,lk()),s=_d(Qd(n,a));return kd(e,s)})}function BN(e,t){return tu(()=>Bf(vk(qd(t,e)),-1))}function WN(e,t){return tu(()=>Bf(Zd(qd(t,e)),-1))}function VN(e,t){return tu(()=>{const n=qd(e,t),a=xm(Zd(e),lk(),Number.MAX_VALUE),s=Zd(kd(n,a));return Nd(100,Bf(s,-1))})}function UN(e,t){return tu(()=>{const n=xm(t,lk(),Number.MAX_VALUE),a=_f(vd(1,n)),s=xm(e,lk(),Number.MAX_VALUE),r=_f(vd(1,s));return Bf(vk(qd(a,r)),-1)})}function HN(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tu(()=>{if(n)t=Vg(t);else{const e=nf(t,t.shape.length-1,!0);t=kd(t,e)}return t=xm(t,lk(),1-lk()),jh(nf(Nd(xd(e,"float32"),_f(t)),t.shape.length-1))})}function GN(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tu(()=>{const a=xd(hf(function(e){const t=[ak(e.shape)];return $p(e,t)}(e)),"int32"),s=(t=xm(t,lk(),1-lk())).shape;return HN($p(Sh(a,s[s.length-1]),s),t,n)})}function qN(e,t){return tu(()=>{let n;return n=xm(t,lk(),1-lk()),n=_f(kd(n,qd(1,n))),Bf(function(e,t){if(!rs(e.shape,t.shape))throw new mw("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return tu(()=>{const n=Ng(t),a=jh(Zd(t));return vd(qd(n,Nd(t,e)),Sf(of(a)))})}(e,n),-1)})}function KN(e,t){return tu(()=>{const n=xm(e,lk(),1),a=xm(t,lk(),1);return nf(Nd(e,_f(kd(n,a))),-1)})}function ZN(e,t){return tu(()=>{const n=zN(e,-1),a=zN(t,-1),s=Nd(n,a);return jh(nf(s,-1))})}ON.constructors={};const XN={meanSquaredError:BN,meanAbsoluteError:WN,meanAbsolutePercentageError:VN,meanSquaredLogarithmicError:UN,squaredHinge:function(e,t){return tu(()=>{const n=Qd(0,qd(1,Nd(e,t)));return Bf(vk(n),-1)})},hinge:function(e,t){return tu(()=>{const n=Qd(0,qd(1,Nd(e,t)));return Bf(n,-1)})},categoricalHinge:function(e,t){return tu(()=>{const n=nf(Nd(e,t),-1),a=ef(Nd(qd(1,e),t),-1);return Qd(0,vd(1,qd(a,n)))})},logcosh:function(e,t){return tu(()=>{const n=Math.log(2),a=qd(t,e),s=qd(vd(a,Cf(Nd(-2,a))),n);return Bf(s,-1)})},categoricalCrossentropy:HN,sparseCategoricalCrossentropy:GN,binaryCrossentropy:qN,kullbackLeiblerDivergence:KN,poisson:function(e,t){return tu(()=>{const n=_f(vd(lk(),t));return Bf(qd(t,Nd(e,n)),-1)})},cosineProximity:ZN};function YN(e){if("string"===typeof e){if(e in XN)return XN[e];let t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new mw(t)}return e}function JN(e,t){return tu(()=>{const n=Nd(.5,Jf(t)),a=ck(mf(t,n),e.dtype);return Bf(Pm(e,a),-1)})}function QN(e,t){return tu(()=>ck(Pm(Ap(e,-1),Ap(t,-1)),"float32"))}function $N(e,t){return tu(()=>xd(nf(Ef(Pm(e,1),Pm(t,1))),"float32"))}function e_(e,t){return qN(e,t)}function t_(e,t){return e.rank===t.rank&&(e=Xg(e,[e.rank-1])),(t=Ap(t,-1)).dtype!==e.dtype&&(t=xd(t,e.dtype)),xd(Pm(e,t),"float32")}const n_=HN,a_=GN,s_={binaryAccuracy:JN,categoricalAccuracy:QN,precision:function(e,t){return tu(()=>{const n=$N(e,t),a=function(e,t){return tu(()=>xd(nf(Ef(Pm(e,0),Pm(t,1))),"float32"))}(e,t),s=vd(n,a);return xd(zm(mf(s,0),kd(n,s),0),"float32")})},categoricalCrossentropy:n_,sparseCategoricalCrossentropy:a_,mse:BN,MSE:BN,mae:WN,MAE:WN,mape:VN,MAPE:VN,cosine:ZN};function r_(e){if("string"===typeof e&&e in s_)return s_[e];if("string"!==typeof e&&null!=e)return e;throw new mw("Unknown metric ".concat(e))}function i_(e){if(bw(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;{let t;for(const n of Object.keys(XN))if(XN[n]===e){t=n;break}if(void 0!==t)return t;for(const n of Object.keys(s_))if(s_[n]===e){t=n;break}return void 0!==t?t:e.name}}const o_=1048576;function l_(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!c_(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(e);n.length>o_&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(o_,"."))}}function c_(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t){if("string"!==typeof n)return!1;if(!c_(e[n]))return!1}return!0}if(Array.isArray(e)){for(const t of e)if(!c_(t))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function u_(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const s=function(e){let t=!0;const n=[],a=[];for(const s in e.nodesByDepth)n.push(e.nodesByDepth[s]);for(const s of n){if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}a.push(...s)}if(t)for(const s of e.layers){let e=!1;for(const n of s.inboundNodes)if(-1!==a.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),r=["Layer (type)","Input Shape","Output shape","Param #"];let i;if(s?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(e=>Math.floor(t*e))),!s){r.push("Receives inputs"),i=[];for(const t in e.nodesByDepth)i.push(...e.nodesByDepth[t])}a("_".repeat(t)),d_(r,n,a),a("=".repeat(t));const o=e.layers;for(let u=0;u<o.length;++u)s?h_(o[u],n,a):p_(o[u],n,i,a),a((u===o.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=function(e){let t;t=null!=e.collectedTrainableWeights?Jk(e.collectedTrainableWeights):Jk(e.trainableWeights);return t}(e),c=Jk(e.nonTrainableWeights);a("Total params: ".concat(l+c)),a("Trainable params: ".concat(l)),a("Non-trainable params: ".concat(c)),a("_".repeat(t))}function d_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,a="";for(let s=0;s<e.length;++s)s>0&&(a=a.slice(0,a.length-1)+" "),a+=e[s],a=a.slice(0,t[s]),a+=" ".repeat(t[s]-a.length);n(a)}function h_(e,t,n){let a,s;try{s=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(wq){s="multiple"}try{a=JSON.stringify(e.outputShape)}catch(wq){a="multiple"}const r=e.name,i=e.getClassName();d_(["".concat(r," (").concat(i,")"),s,a,e.countParams().toString()],t,n)}function p_(e,t,n,a){let s,r;try{r=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(wq){r="multiple"}try{s=JSON.stringify(e.outputShape)}catch(wq){s="multiple"}const i=[];for(const u of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(let e=0;e<u.inboundLayers.length;++e){const t=u.inboundLayers[e].name,n=u.nodeIndices[e],a=u.tensorIndices[e];i.push("".concat(t,"[").concat(n,"][").concat(a,"]"))}const o=e.name,l=e.getClassName(),c=0===i.length?"":i[0];d_(["".concat(o," (").concat(l,")"),r,s,e.countParams().toString(),c],t,a);for(let u=1;u<i.length;++u)d_(["","","","",i[u]],t,a)}function m_(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function f_(e,t){if(null===e)return null;if("string"===typeof e)return _w(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],a=e.length;for(let s=0;s<a;++s){const a=e[s];m_(t,s,a)?n.push(a):n.push(f_(a,t))}return n}{const t={};for(const n of Object.keys(e)){const a=e[n];if("name"===n&&"string"===typeof a)t[n]=a;else{const e=_w(n);t[e]=f_(a,e)}}return t}}function g_(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return Nw(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],a=e.length;for(let s=0;s<a;++s){const a=e[s];m_(t,s,a)?n.push(a):n.push(g_(a,t))}return n}{const t={};for(const n of Object.keys(e)){const a=e[n],s=Nw(n);t[s]="name"!==n&&"className"!==n||"string"!==typeof a?g_(a,n):a}return t}}const x_="4.22.0";class y_ extends oN{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){const e=this.getClassName().toLowerCase();this.name=Bw(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Ew(this.inputs).length!==this.inputs.length)throw new mw("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map(e=>e.name)));Ew(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map(e=>e.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const x of this.outputs){const e=x.sourceLayer,t=x.nodeIndex,n=x.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(n)}for(const x of this.inputs){const e=x.sourceLayer,t=x.nodeIndex,n=x.tensorIndex;bw(0===t,"input layer has >1 nodes"),bw(0===n,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(t),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){const t=this.inputLayers[x];if(!(t instanceof cN))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(x," (0-based) originates ")+"from layer type ".concat(t.getClassName(),"."));this.inputNames.push(t.name),this.feedInputShapes.push(t.batchInputShape),this.feedInputNames.push(t.name)}for(const x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(e=>e.shape),this.internalOutputShapes=this.outputs.map(e=>e.shape);const t={},n={},a={},s={},r={},i=[],o=(e,t,n,a,s,l)=>{null!=a&&null!=s&&null!=l||(a=e.sourceLayer,s=e.nodeIndex,l=e.tensorIndex);const c=a.inboundNodes[s];if(-1!==n.indexOf(c))throw new pw("The tensor ".concat(e.name,' at layer "').concat(a.name,'" ')+"is part of a cycle.");if(-1!==t.indexOf(c))return;this.containerNodes.add(y_.nodeKey(a,s)),a.id in r||(r[a.id]=Object.keys(r).length),-1===n.indexOf(c)&&n.push(c);const u=c.inboundLayers.length;for(let r=0;r<u;r++){const e=c.inputTensors[r],a=c.inboundLayers[r],s=c.nodeIndices[r],i=c.tensorIndices[r];o(e,t,n,a,s,i)}for(t.push(c);n.indexOf(c)>=0;)n.splice(n.indexOf(c),1);i.push(c)},l=[],c=[];for(const x of this.outputs)o(x,l,c);const u=i.slice().reverse();for(const x of u){n[x.id]=x,x.id in t||(t[x.id]=0);let e=t[x.id];const r=null==a[x.outboundLayer.id]?0:a[x.outboundLayer.id];e=Math.max(e,r),a[x.outboundLayer.id]=e,s[x.outboundLayer.id]=x.outboundLayer,t[x.id]=e;for(let a=0;a<x.inboundLayers.length;a++){const s=x.inboundLayers[a],r=x.nodeIndices[a],i=s.inboundNodes[r],o=null==t[i.id]?0:t[i.id];t[i.id]=Math.max(e+1,o),n[i.id]=i}}const d={};for(const x in t){const e=t[x];e in d||(d[e]=[]),d[e].push(n[x])}const h={};for(const x in a){const e=a[x];e in h||(h[e]=[]),h[e].push(s[x])}let p=Object.keys(h).map(e=>parseInt(e,10)).sort(Iw);this.layers=[];for(const x of p){const e=h[x];e.sort((e,t)=>{const n=r[e.id],a=r[t.id];return n<a?-1:n>a?1:0});for(const t of e)t instanceof y_&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=h,p=Object.keys(d).map(e=>parseInt(e,10)).sort(Iw);const m=this.inputs.slice(),f=[];for(const x of p)for(const e of d[x]){const t=e.outboundLayer;if(null!=t){for(const n of e.inputTensors)if(-1===m.indexOf(n))throw new pw("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(t.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(f));for(const t of e.outputTensors)m.push(t);f.push(t.name)}}this.nodesByDepth=d;const g=this.layers.map(e=>e.name);for(const x of g){const e=g.filter(e=>e===x).length;if(1!==e)throw new pw('The name "'.concat(x,'" is used ').concat(e," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new rN({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(e=>null),outputMasks:this.outputs.map(e=>null),inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs.map(e=>e.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(t=>t.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new mw("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let a=0;const s=(e=>{const t=Object.keys(e);if(0===t.length)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);s&&this.parseWeights(e);for(const i of this.layers)for(const[e,t]of i.weights.entries()){const r=s?"".concat(t.name.split("/").slice(0,-1).join("/")+"/").concat(e):t.originalName;if(null!=n[r])throw new mw("Duplicate weight name: ".concat(r));n[r]=t,a++}const r=[];for(const i in e){let a=i;if(null==n[i]){const e=i.split("/");a=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[a])r.push([n[a],e[i]]);else if(t)throw new mw("Provided weight data has no target variable: ".concat(i));delete n[a]}if(t){const e=[];for(const t in n)e.push(t);if(e.length>0)throw new mw("".concat(e.length," of ").concat(a," weights are not set: ")+"".concat(e))}tN(r)}parseWeights(e){for(const t in Object.keys(e)){const n=t.split("/"),a=["vars","layer_checkpoint_dependencies"],s=n.map(e=>e.startsWith("_")?e.slice(1):e).filter(e=>!a.includes(e)).join("/");s!==t&&(e[s]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(x_),t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=g_(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return tu(()=>{e=kw(e);const n=new uN;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return pN(this.outputs,n,t)})}computeMask(e,t){return tu(()=>{let n;return e=kw(e),n=null==t?yw(null,e.length):kw(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){const t=Zk(e);if(t.length!==this.inputLayers.length)throw new mw("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let i=0;i<t.length;i++){const e=this.inputLayers[i],a=t[i];n[e.name+"_0_0"]=a}const a=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(Iw);if(a.length>1)for(const i of a){const e=this.nodesByDepth[i];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map(e=>e.id).indexOf(e.id))continue;const a=[];for(let i=0;i<t.inboundLayers.length;i++){const e=t.inboundLayers[i],s=t.nodeIndices[i],r=t.tensorIndices[i],o=n["".concat(e.name,"_").concat(s,"_").concat(r)];a.push(o)}const s=Zk(e.computeOutputShape(ww(a))),r=e.inboundNodes.indexOf(t);for(let t=0;t<s.length;t++){n["".concat(e.name,"_").concat(r,"_").concat(t)]=s[t]}}}const s=[],r=[];for(let i=0;i<this.outputLayers.length;i++){const e=this.outputLayers[i],t=this.outputLayersNodeIndices[i],n=this.outputLayersTensorIndices[i],a="".concat(e.name,"_").concat(t,"_").concat(n);r.push(a)}for(let i=0;i<r.length;i++){const e=r[i];bw(e in n),s.push(n[e])}return ww(s)}runInternalGraph(e,t){null==t&&(t=yw(null,e.length));const n={};for(let o=0;o<this.inputs.length;++o){const a=this.inputs[o],s=e[o],r=t[o];n[a.id]=[s,r]}const a=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(Iw);for(const o of a){const e=this.nodesByDepth[o];for(const t of e){const e=t.outboundLayer,a=t.inputTensors,s=t.outputTensors,r=new Array;for(const t of a)t.id in n&&r.push(n[t.id]);if(r.length===a.length){let a,i,o,l,c={};if(null!=t.callArgs&&(c=t.callArgs),1===r.length){const[t,n]=r[0];null==c.mask&&(c.mask=n),o=kw(e.call(t,c)),l=kw(e.computeMask(t,n)),a=[t],i=[n]}else a=r.map(e=>e[0]),i=r.map(e=>e[1]),null==c.mask&&(c.mask=i),o=kw(e.call(a,c)),l=kw(e.computeMask(a,i));if(e.activityRegularizer)throw new fw("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<s.length;++e){const t=s[e],a=o[e],r=l[e];n[t.id]=[a,r]}}}}const s=[],r=[],i=[];for(const o of this.outputs){bw(o.id in n,"Could not compute output ".concat(o.name," : ").concat(o.id));const[e,t]=n[o.id];i.push(e.shape),s.push(e),r.push(t)}return[s,r,i]}buildNodeConversionMap(e){const t={};let n;for(const a of this.layers){n=a instanceof y_?1:0;for(let e=0;e<a.inboundNodes.length;e++){const s=y_.nodeKey(a,e);this.containerNodes.has(s)&&(t[s]=n,n+=1)}}return t}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new mw("Provide either a layer name or layer index");if("number"===typeof e)return this.findLayer(e);for(const n of this.layers)if(n.name===e)return n;throw new mw("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new mw("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return tu(()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const a=y_.nodeKey(t,n);this.containerNodes.has(a)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const r of this.layers){const e=r.getClassName(),a=r.getConfig(),s=[];for(let n=0;n<r.inboundNodes.length;n++){const e=r.inboundNodes[n],a=y_.nodeKey(r,n);let i={};if(this.containerNodes.has(a)){if(e.callArgs)try{JSON.stringify(e.callArgs),i=e.callArgs}catch(wq){console.warn("Layer ".concat(r.name," was passed ")+"non-serializable keyword arguments: "+"".concat(e.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),i={}}if(e.inboundLayers.length>0){const n=[];for(let a=0;a<e.inboundLayers.length;a++){const s=e.inboundLayers[a],r=e.nodeIndices[a],o=e.tensorIndices[a];let l=t[y_.nodeKey(s,r)];null==l&&(l=0),n.push([s.name,l,o,i])}s.push(n)}}}const i={};i.name=r.name,i.className=e,i.config=a,i.inboundNodes=s,n.push(i)}e.layers=n;const a=[];for(let r=0;r<this.inputLayers.length;r++){const e=this.inputLayers[r],n=this.inputLayersNodeIndices[r],s=y_.nodeKey(e,n);if(!this.containerNodes.has(s))continue;let i=t[s];null!==i&&void 0!==i||(i=0);const o=this.inputLayersTensorIndices[r];a.push([e.name,i,o])}e.inputLayers=a;const s=[];for(let r=0;r<this.outputLayers.length;r++){const e=this.outputLayers[r],n=this.outputLayersNodeIndices[r],a=y_.nodeKey(e,n);if(!this.containerNodes.has(a))continue;let i=t[a];null!==i&&void 0!==i||(i=0);const o=this.outputLayersTensorIndices[r];s.push([e.name,i,o])}return e.outputLayers=s,e}static fromConfig(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={},s={};function r(e,t){e.name in s?s[e.name].push(t):s[e.name]=[t]}function i(e,t){const n=[];let s;for(const i of t){const o=i[0],l=i[1],c=i[2];if(s=null==i[3]?{}:i[3],!(o in a))return void r(e,t);const u=a[o];if(u.inboundNodes.length<=l)return void r(e,t);const d=u.inboundNodes[l];n.push(d.outputTensors[c])}n.length>0&&e.apply(ww(n),s)}function o(e){const s=e.name,i=PN(e,null!=t.customObjects?t.customObjects:{});i.setFastWeightInitDuringBuild(n),a[s]=i;e.inboundNodes.forEach(e=>{if(!(e instanceof Array))throw new mw("Corrupted configuration, expected array for nodeData: ".concat(e));r(i,e)})}const l=t.name,c=t.layers;for(const m of c)o(m);for(;!Aw(s);)for(const e of c){const t=a[e.name];if(t.name in s){const e=s[t.name];delete s[t.name];for(const n of e)i(t,n)}}const u=[],d=[],h=t.inputLayers;for(const m of h){const e=m[0],t=m[1],n=m[2];bw(e in a);const s=a[e].inboundNodes[t].outputTensors;u.push(s[n])}const p=t.outputLayers;for(const m of p){const e=m[0],t=m[1],n=m[2];bw(e in a);const s=a[e].inboundNodes[t].outputTensors;d.push(s[n])}return new e({inputs:u,outputs:d,name:l})}get stateful(){if(this._stateful)throw new mw("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){tu(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}function b_(e,t,n){const a=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>null);if(1===a)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==a)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(a," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){const n=[];return t.forEach(t=>{t in e?n.push(e[t]):n.push(null)}),n}throw new Error("The model has multiple (".concat(a,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(a," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function v_(e,t){return b_(e,t,"classWeight")}async function w_(e,t,n,a){if(null!=t||null!=a)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const t=tu(()=>{if(1===e.shape.length)return yd(e);if(2===e.shape.length){if(e.shape[1]>1){return Ap(e,1)}if(1===e.shape[1])return $p(e,[e.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")}),a=Array.from(await t.data());nu(t);const s=[];return a.forEach(e=>{if(null==n[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");s.push(n[e])}),ex(s,"float32")}return null}function k_(e,t){return Nd(e,t)}function N_(e,t){let n,a;const s=t;n=s.xs,a=s.ys,$a(null!=n&&null!=a,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t));const r=__("input",e.inputNames,n),i=__("output",e.outputNames,a),o=r[0].shape[0];$a(r.length===e.inputs.length,()=>"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(r.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")),$a(i.length===e.outputs.length,()=>"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(i.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")"));for(let l=0;l<r.length;l++)$a(r[l].shape[0]===o,()=>"Batch size mismatch: input "+"".concat(e.inputNames[l]," has ").concat(r[l].shape[0],"; ")+"expected  ".concat(o," based on input ").concat(e.inputNames[0],"."));for(let l=0;l<i.length;l++)$a(i[l].shape[0]===o,()=>"Batch size mismatch: output "+"".concat(e.outputNames[l]," has ").concat(i[l].shape[0],"; ")+"expected  ".concat(o," based on input ").concat(e.inputNames[0],"."));return{xs:r,ys:i}}function __(e,t,n){if(n instanceof ic)return[n];if(Array.isArray(n))return $a(n.length===t.length,()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")),n;{const a=[];for(const s of t){if(null==n[s])throw new mw("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(s,"'."));a.push(n[s])}return a}}async function S_(e,t,n){const a=null!=n.batchesPerEpoch;if($a(null!=e.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),$a(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),$a(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs)),$a(!a||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch)),$a(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const s=null!=n.validationData;let r,i;if(s)if(C_(n.validationData))$a(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches));else{const e=function(e){if(3===e.length)throw new fw("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);r=e.xs,i=e.ys}const o=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let c;c=s?l.slice().concat(l.map(e=>"val_"+e)):l.slice();const u=DN(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:h,history:p}=FN(u,d,n.epochs,null,null,function(e,t){let n=null;null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size);return n}(t,n),null,s,c);h.setModel(e),e.history=p,await h.onTrainBegin(),e.stopTraining_=!1;let m=null==n.initialEpoch?0:n.initialEpoch,f=await t.iterator();for(;m<n.epochs;){const c={};await h.onEpochBegin(m);let u=0,d=0;for(a||(f=await t.iterator());!a||u<n.batchesPerEpoch;){const t=await f.next();if(a&&t.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(u," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=t.value){const{xs:a,ys:s}=N_(e,t.value),r={};r.batch=d,r.size=a[0].shape[0],await h.onBatchBegin(d,r);const i=[];if(null!=n.classWeight){const t=v_(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)i.push(await w_(s[e],null,t[e]))}const c=a.concat(s).concat(i),p=o(c);nu(c);for(let e=0;e<l.length;++e){const t=l[e],n=p[e];r[t]=n,au(n)}await h.onBatchEnd(d,r),TN(r),d++,u++}if(a?u>=n.batchesPerEpoch:t.done){if(s){let t;t=C_(n.validationData)?kw(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):kw(e.evaluate(r,i,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)c["val_".concat(e.metricsNames[n])]=t[n]}break}if(e.stopTraining_)break}if(await h.onEpochEnd(m,c),m++,e.stopTraining_)break}return await h.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function C_(e){return"function"===typeof e.iterator}function j_(e){$a(e>0&&Number.isInteger(e),()=>"batchSize is required to be a positive integer, but got ".concat(e))}function T_(e,t,n){return null==e?[null]:Array.isArray(e)?e.map(e=>dk(e,t,n-t)):dk(e,t,n-t)}function I_(e,t){return tu(()=>null==e?null:Array.isArray(e)?e.map(e=>I_(e,t)):bk(e,"int32"===t.dtype?t:xd(t,"int32")))}function E_(e,t){const n=[];let a=0,s=null;for(;a<e;)s=a+t,s>=e&&(s=e),n.push([a,s]),a=s;return n}function A_(e){const t=[];e instanceof ic&&(e=[e]);for(let n=0;n<e.length;++n){const a=e[n];if(1===a.rank)t.push(uk(a,1));else{if(0===a.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(a)}}return t}function R_(e,t){if(null==e)return;const n=[];if(t instanceof ic)n.push(t.id);else if(Array.isArray(t))t.forEach(e=>n.push(e.id));else if(null!=t)for(const s in t){const e=t[s];n.push(e.id)}const a=[];if(e instanceof ic)-1===n.indexOf(e.id)&&a.push(e);else if(Array.isArray(e))e.forEach(e=>{-1===n.indexOf(e.id)&&a.push(e)});else if(null!=e)for(const s in e){const t=e[s];-1===n.indexOf(t.id)&&a.push(t)}a.forEach(e=>{e.isDisposed||e.dispose()})}function M_(e){return Array.isArray(e)}function L_(e){return!function(e){return e instanceof ic}(e)&&!M_(e)}function D_(e,t,n){let a,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(M_(e)&&e.length>0)t=!0;else if(L_(e)){for(const n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new mw("Error when checking model ".concat(r," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map(e=>null);if(L_(e)){a=[];for(const n of t){if(null==e[n])throw new mw('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(t));a.push(e[n])}}else if(M_(e)){if(e.length!==t.length)throw new mw("Error when checking model ".concat(r,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));a=e}else{if(t.length>1)throw new mw("The model ".concat(r," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));a=[e]}if(a=A_(a),null!=n)for(let i=0;i<t.length;++i){if(null==n[i])continue;const e=a[i];if(e.shape.length!==n[i].length)throw new mw("Error when checking ".concat(r,": expected ").concat(t[i]," ")+"to have ".concat(n[i].length," dimension(s). but got array with ")+"shape ".concat(e.shape));for(let t=0;t<n[i].length;++t){if(0===t&&!s)continue;const a=e.shape[t],o=n[i][t];if(null!=o&&o>=0&&a!==o)throw new mw("".concat(r," expected a batch of elements where each ")+"example has shape [".concat(n[i].slice(1,n[i].length),"] ")+"(i.e.,tensor shape [*,".concat(n[i].slice(1,n[i].length),"])")+" but the ".concat(r," received an input with ").concat(e.shape[0])+" examples, each with shape [".concat(e.shape.slice(1,e.shape.length),"]")+" (tensor shape [".concat(e.shape,"])"))}}return a}function O_(e,t,n){let a,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new mw("Error when checking model ".concat(r,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));a=e}else{if(t.length>1)throw new mw("The model expects ".concat(t.length," ").concat(r," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));a=[e]}if(null!=n)for(let i=0;i<t.length;++i){if(null==n[i])continue;const e=a[i];if(e.shape.length!==n[i].length)throw new mw("Error when checking ".concat(r,": expected ").concat(t[i]," ")+"to have ".concat(n[i].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(e.shape)));for(let a=0;a<n[i].length;++a){if(0===a&&!s)continue;const o=e.shape[a],l=n[i][a];if(null!=l&&l!==o)throw new mw("Error when checking ".concat(r,": expected ")+"".concat(t[i]," to have shape ").concat(JSON.stringify(n[i])," but ")+"got array with shape ".concat(JSON.stringify(e.shape),"."))}}}class F_ extends y_{constructor(e){super(e),this.isTraining=!1}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new mw("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");u_(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){const t={Adagrad:()=>Py.adagrad(.01),Adadelta:()=>Py.adadelta(1,.95,lk()),Adam:()=>Py.adam(.001,.9,.999,lk()),Adamax:()=>Py.adamax(.002,.9,.999,lk(),0),RMSProp:()=>Py.rmsprop(.001,.9,0,lk()),SGD:()=>Py.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new mw("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Wd))throw new mw("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new mw("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));const n=e.loss;t=n.map(e=>YN(e))}else{const n=YN(e.loss);this.outputs.forEach(e=>{t.push(n)})}else{e.loss=e.loss;for(const t in e.loss)if(-1===this.outputNames.indexOf(t))throw new mw('Unknown entry in loss dictionary: "'.concat(t,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const n of this.outputNames)null==e.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),t.push(YN(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let r=0;r<this.outputs.length;++r){const e=this.internalOutputShapes[r],t=this.outputNames[r];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[r])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Jw("loss",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;const t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}});const a=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>[]);let n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map(e=>n);{const e=[];for(const a of t){let t=n.hasOwnProperty(a)?n[a]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),s=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};Jw("metric",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;(t=>{let n,a,r;for(const i of t){if("string"===typeof i&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(i)){const t=this.internalOutputShapes[e];let s;1===t[t.length-1]||this.lossFunctions[e]===qN?-1!==["accuracy","acc"].indexOf(i)?a=JN:-1!==["crossentropy","ce"].indexOf(i)&&(a=e_):this.lossFunctions[e]===GN?-1!==["accuracy","acc"].indexOf(i)?a=t_:-1!==["crossentropy","ce"].indexOf(i)&&(a=a_):-1!==["accuracy","acc"].indexOf(i)?a=QN:-1!==["crossentropy","ce"].indexOf(i)&&(a=n_),-1!==["accuracy","acc"].indexOf(i)?s="acc":-1!==["crossentropy","ce"].indexOf(i)&&(s="ce"),r=a,n=""+s}else{const e=r_(i);r=e,n=""+i_(i)}let t;Jw(n,()=>{t=r}),s(e,n,t)}})(a[e])}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=null==n.batchSize?32:n.batchSize;j_(a);const s=this.standardizeUserDataXY(e,t,!0,a);try{const e=s[0].concat(s[1]);this.makeTestFunction();const t=this.testFunction;return ww(this.testLoop(t,e,a,n.verbose,n.steps))}finally{R_(s[0],e),R_(s[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){const a=null!=(n=n||{}).batches,s=e.testFunction;let r=[];if(n.verbose>0)throw new fw("Verbose mode is not implemented yet.");$a(!a||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches)));const i="function"===typeof t.next?t:await t.iterator();let o=0,l=0;for(;!a||l<n.batches;){const t=await i.next();if(r=tu(()=>{if(t.value){const{xs:n,ys:a}=N_(e,t.value),i=n.concat(a),c=tu(()=>s(i));if(nu(i),0===l)for(let e=0;e<c.length;++e)r.push(Ld(0));const u=i[0].shape[0];for(let e=0;e<c.length;++e){const t=c[e],n=r[e];r[e]=tu(()=>vd(r[e],Nd(u,t))),l>0&&nu(n)}nu(c),o+=u,++l}return r}),t.done){a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let c=0;c<r.length;++c){const e=r[c];r[c]=kd(r[c],o),nu(e)}return ww(r)}(this,e,t)}checkNumSamples(e,t,n){let a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(a=null,null!=t)throw new mw("If ".concat(s," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new mw("Either the input data should have a defined shape, or "+"".concat(s," shoud be specified."));a=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return a}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new mw("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),a=n?t:[t],s=this.retrieveSymbolicTensors(a),r=new uN;if(e instanceof ic&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new mw("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let t=0;t<this.inputs.length;++t)r.add(this.inputs[t],e[t])}else for(const o of this.inputs){const t=e[o.name];if(null==t)throw new mw("No value is provided for the model's input ".concat(o.name));r.add(o,t)}const i=pN(s,r);return n?i:i[0]}retrieveSymbolicTensors(e){const t=yw(null,e.length);let n=e.length;for(const a of this.layers){const s=Array.isArray(a.output)?a.output:[a.output],r=s.map(e=>e.name);for(let a=0;a<e.length;++a){const i=r.indexOf(e[a]);if(-1!==i&&(t[a]=s[i],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw t.forEach((t,a)=>{null==t&&n.push(e[a])}),new mw("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tu(()=>{const a=this.checkNumSamples(e);if(n)throw new fw("Verbose predictLoop() is not implemented yet.");const s=E_(a,t),r=this.outputs.map(e=>[]);for(let t=0;t<s.length;++t){tu(()=>{const n=s[t][0],a=s[t][1],r=T_(e,n,a),i=[];if(Array.isArray(r))for(let e=0;e<r.length;++e)i.push({key:this.inputs[e],value:r[e]});else i.push({key:this.inputs[0],value:r});const o=new uN(i);return pN(this.outputs,o)}).forEach((e,t)=>r[t].push(e))}return ww(r.map(e=>nm(e,0)))})}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=A_(e);O_(n,this.inputNames,this.feedInputShapes,!1);try{const e=null==t.batchSize?32:t.batchSize;return j_(e),this.predictLoop(n,e)}finally{R_(n,e)}}predictOnBatch(e){O_(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new pw("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let s=0;s<this.feedOutputShapes.length;++s){const e=this.feedOutputShapes[s];this.feedLossFns[s]===GN?a.push(e.slice(0,e.length-1).concat([1])):a.push(e)}if(function(e,t){const n=Ew(e.map(e=>e.shape[0]));n.sort();const a=Ew(t.map(e=>e.shape[0]));if(a.sort(),n.length>1)throw new mw("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map(e=>e.shape))));if(a.length>1)throw new mw("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map(e=>e.shape))));if(n.length>0&&a.length>0&&!rs(n,a))throw new mw("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(n[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}(e=D_(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=D_(t,this.feedOutputNames,a,!1,"target")),function(e,t,n){const a=[BN,qN,HN];for(let s=0;s<e.length;++s){const r=e[s],i=t[s],o=n[s];if(null!=i){if(i===HN&&1===r.shape[r.shape.length-1])throw new mw("You are passing a target array of shape ".concat(r.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==a.indexOf(i)){const e=r.shape.slice(1),t=o.slice(1);for(let n=0;n<e.length;++n){const a=e[n],s=t[n];if(null!=s&&a!==s)throw new mw("A target Tensor with shape ".concat(r.shape," was passed for an ")+"output of shape ".concat(o,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new mw("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,a){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5?arguments[5]:void 0;const[i,o]=this.standardizeUserDataXY(e,t,s,r);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=a){const e=v_(a,this.outputNames);l=[];for(let t=0;t<e.length;++t)l.push(await w_(o[t],null,e[t]))}return[i,o,l]}testLoop(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0;return tu(()=>{const r=this.checkNumSamples(t,n,s,"steps"),i=[];if(a>0)throw new fw("Verbose mode is not implemented yet.");if(null!=s)throw new fw("steps mode in testLoop() is not implemented yet");{const a=E_(r,n),s=ex(ik(0,r));for(let n=0;n<a.length;++n){const r=a[n][0],o=a[n][1],l=dk(s,r,o-r),c=I_(t,l),u=e(c);if(0===n)for(let e=0;e<u.length;++e)i.push(Ld(0));for(let e=0;e<u.length;++e){const t=u[e];i[e]=vd(i[e],Nd(o-r,t))}}for(let e=0;e<i.length;++e)i[e]=kd(i[e],r)}return i})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const a=e[n];let s=a;if(vw(e,a)>1){const t=vw(e.slice(0,n),a);s+="_".concat(t)}t.push(s)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),r=[],i=this.collectedTrainableWeights.map(e=>e.read());return[this.optimizer_.minimize(()=>{const e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});const i=new uN(e),o=pN(this.outputs,i,{training:!0});let l;for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(a[n],o[n]);null!=s[n]&&(e=k_(e,s[n]));const r=Bf(e);t.push(r),l=0===n?e:vd(l,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{const t=this.metricsTensors[n][0],s=this.metricsTensors[n][1];e=Bf(t(a[s],o[s]))}au(e),r.push(e)}return l=Bf(l),this.calculateLosses().forEach(e=>{l=vd(l,e)}),l},!0,i)].concat(r)}}makeTestFunction(){this.testFunction=e=>tu(()=>{const t=[];let n;const a=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=[];for(let e=0;e<this.inputs.length;++e)r.push({key:this.inputs[e],value:a[e]});const i=new uN(r),o=pN(this.outputs,i);for(let e=0;e<this.lossFunctions.length;++e){const a=this.lossFunctions[e],r=Bf(a(s[e],o[e]));n=0===e?r:vd(n,r),t.push(n)}for(let e=0;e<this.metricsTensors.length;++e){const n=this.metricsTensors[e][0],a=this.metricsTensors[e][1],r=Bf(n(s[a],o[a]));t.push(r)}return t})}async fit(e,t){let n,a,s,r,i,o,l,c,u,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{const h=null==d.batchSize?32:d.batchSize;j_(h);const p=!1,m=await this.standardizeUserData(e,t,d.sampleWeight,d.classWeight,p,h);n=m[0],a=m[1],u=m[2];let f,g=!1;if(null!=d.validationData&&d.validationData.length>0){if(g=!0,2!==d.validationData.length)throw 3===d.validationData.length?new fw("validationData including sample weights is not supported yet."):new mw("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(d.validationData," is invalid."));i=d.validationData[0],o=d.validationData[1];const e=!0,t=await this.standardizeUserData(i,o,null,null,e,h);l=t[0],c=t[1],f=l.concat(c)}else if(null!=d.validationSplit&&d.validationSplit>0&&d.validationSplit<1){g=!0;const e=Math.floor(n[0].shape[0]*(1-d.validationSplit)),t=n[0].shape[0];l=T_(n,e,t),s=n,n=T_(n,0,e),c=T_(a,e,t),r=a,a=T_(a,0,e),f=l.concat(c)}else null!=d.validationSteps&&(g=!0);const x=n.concat(a).concat(u);this.checkTrainableWeightsConsistency();const y=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let v,w;g?(this.makeTestFunction(),v=this.testFunction,w=b.slice().concat(b.map(e=>"val_"+e))):(v=null,f=[],w=b.slice());const k=DN(d.callbacks,d.yieldEvery);return await this.fitLoop(y,x,b,h,d.epochs,d.verbose,k,v,f,d.shuffle,w,d.initialEpoch,null,null)}finally{this.isTraining=!1,R_(n,e),R_(a,t),R_(s,e),R_(r,t),R_(l,i),R_(c,o),null!=u&&nu(u)}}async fitLoop(e,t,n,a,s,r,i,o,l,c,u,d,h,p){null==a&&(a=32),null==s&&(s=1),null==c&&(c=!0),null==d&&(d=0);let m=!1;if(null!=o&&null!=l&&(m=!0),null!=p&&(m=!0,null==h))throw new mw("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const f=this.checkNumSamples(t,a,h,"steps_per_epoch");let g;null!=f&&(g=ik(0,f)),null==r&&(r=1);const{callbackList:x,history:y}=FN(i,r,s,d,f,h,a,m,u);x.setModel(this),this.history=y,await x.onTrainBegin(),this.stopTraining_=!1;for(let b=d;b<s;++b){await x.onEpochBegin(b);const s={};if(null!=h)throw new fw("stepsPerEpoch mode is not implemented yet.");{if("batch"===c)throw new fw("batch shuffling is not implemneted yet");c&&Ga(g);const r=ex(g),i=E_(f,a);for(let c=0;c<i.length;++c){const u={};if(await x.onBatchBegin(c,u),tu(()=>{const d=i[c][0],h=i[c][1],p=dk(r,d,h-d);u.batch=c,u.size=h-d;const f=I_(t,p),g=e(f);for(let e=0;e<n.length;++e){const t=n[e],a=g[e];u[t]=a,au(a)}if(c===i.length-1&&m){const e=this.testLoop(o,l,a);for(let t=0;t<n.length;++t){const a=n[t],r=e[t];au(r),s["val_"+a]=r}}}),await x.onBatchEnd(c,u),TN(u),this.stopTraining_)break}r.dispose()}if(await x.onEpochEnd(b,s),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return S_(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),a=n[0],s=n[1],r=this.makeTrainFunction()(a.concat(s)),i=[];for(const o of r){const e=await o.data();i.push(e[0])}return nu(r),R_(n[0],e),R_(n[1],t),ww(i)}getNamedWeights(e){const t=[],n=null!=e&&e.trainableOnly,a=n?this.trainableWeights:this.weights,s=this.getWeights(n);for(let r=0;r<a.length;++r)n&&!a[r].trainable||t.push({name:a[r].originalName,tensor:s[r]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const t=$c().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-$c().numTensors}return e}getLossIdentifiers(){let e;if("string"===typeof this.loss)e=Nw(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if("string"!==typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(e=>Nw(e))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const a of t){if("string"!==typeof n[a])throw new Error("Serialization of non-string loss is not supported.");e[a]=Nw(n[a])}}return e}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[Nw(i_(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Nw(i_(e)));{const e={};for(const t in this.metrics)e[t]=Nw(i_(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const t=PN(f_(e.optimizer_config));let n,a;if("string"===typeof e.loss)n=_w(e.loss);else if(Array.isArray(e.loss))n=e.loss.map(e=>_w(e));else if(null!=e.loss){n={};for(const t in e.loss)n[t]=_w(e.loss[t])}if(Array.isArray(e.metrics))a=e.metrics.map(e=>_w(e));else if(null!=e.metrics){a={};for(const t in e.metrics)a[t]=_w(e.metrics[t])}this.compile({loss:n,metrics:a,optimizer:t})}async save(e,t){if("string"===typeof e){const t=Du(e);if(0===t.length)throw new mw("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new mw("Found more than one (".concat(t.length,") save handlers for ")+"URL '".concat(e,"'"));e=t[0]}if(null==e.save)throw new mw("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await fu(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(x_),convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){a.trainingConfig=this.getTrainingConfig();const e="optimizer",{data:t,specs:s}=await fu(await this.optimizer.getWeights(),e);n.specs.push(...s),n.data=Su([n.data,t])}if(null!=this.userDefinedMetadata){const e=!0;l_(this.userDefinedMetadata,this.name,e),a.userDefinedMetadata=this.userDefinedMetadata}return a.weightData=n.data,a.weightSpecs=n.specs,e.save(a)}setUserDefinedMetadata(e){l_(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}F_.className="Model",zd(F_);class P_ extends F_{}P_.className="Functional",zd(P_);class z_ extends F_{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:Bw("sequential_"),null!=e.layers)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(e=>e<0))throw new mw("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(e){const t=e instanceof z_||e instanceof F_;let n;if(t){if(n=e,1!==n.outputs.length)throw new mw("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new mw("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new mw("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const t=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new mw("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new cN({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==e.inboundNodes.length)throw new mw("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new mw("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=lN(this.outputs[0])}this.inboundNodes=[],new rN({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:yw(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs[0].shape})}else{const t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(Yk(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new F_({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new pw("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new pw("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new pw("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new pw("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t){let n,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new mw("Legacy serialization format not supported yet.");n=t}else $a(null!=t.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),n=t.layers,delete t.layers,s=t;const r=new e(s);if(!(r instanceof z_))throw new fw("Sequential.fromConfig called on non-Sequential input: ".concat(r));for(const i of n){const e=PN(i,void 0,a);a&&e.setFastWeightInitDuringBuild(!0),r.add(e)}return r}set stopTraining(e){if(null==this.model)throw new mw("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new mw("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}z_.className="Sequential",zd(z_);class B_ extends Fd{getConfig(){return{}}}class W_ extends B_{apply(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new fw("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return Um(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}W_.className="elu",zd(W_);class V_ extends B_{apply(e){return Rg(e)}}V_.className="selu",zd(V_);class U_ extends B_{apply(e){return Ng(e)}}U_.className="relu",zd(U_);class H_ extends B_{apply(e){return tu(()=>Hf(6,Ng(e)))}}H_.className="relu6",zd(H_);class G_ extends B_{apply(e){return e}}G_.className="linear",zd(G_);class q_ extends B_{apply(e){return am(e)}}q_.className="sigmoid",zd(q_);class K_ extends B_{apply(e){return function(e){return tu(()=>{const t=vd(.5,Nd(.2,e));return xm(t,0,1)})}(e)}}K_.className="hardSigmoid",zd(K_);class Z_ extends B_{apply(e){return Cf(e)}}Z_.className="softplus",zd(Z_);class X_ extends B_{apply(e){return function(e){return tu(()=>kd(e,vd(Zd(e),1)))}(e)}}X_.className="softsign",zd(X_);class Y_ extends B_{apply(e){return rm(e)}}Y_.className="tanh",zd(Y_);class J_ extends B_{apply(e){return Vg(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}J_.className="softmax",zd(J_);class Q_ extends B_{apply(e){return Tf(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}Q_.className="logSoftmax",zd(Q_);class $_ extends B_{apply(e){return tu(()=>tu(()=>{const t=Math.sqrt(2),n=Nd(.5,vd(1,Gm(kd(e,t))));return Nd(e,n)}))}}$_.className="gelu",zd($_);class eS extends B_{apply(e){return tu(()=>Nd(.5,Nd(e,vd(1,rm(Nd(_d(kd(2,Math.PI)),vd(e,Nd(.044715,Gd(e,3)))))))))}}eS.className="gelu_new",zd(eS);class tS extends B_{apply(e){return tu(()=>Nd(e,rm(Cf(e))))}}tS.className="mish",zd(tS);class nS extends B_{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return tu(()=>Nd(am(Nd(e,t)),e))}}function aS(e){return e.getClassName()}function sS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Tw(e,Pd.getMap().classNameMap,t,"activation")}function rS(e){if(null==e){const e={className:"linear",config:{}};return sS(e)}if("string"===typeof e){const t={};return t.className=e,t.config={},sS(t)}return e instanceof B_?e:sS(e)}function iS(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}nS.className="swish",zd(nS);class oS extends Fd{}class lS extends oS{constructor(e){super(),iS(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return tu(()=>{let t=Wf([1]);return this.hasL1&&(t=vd(t,nf(Nd(this.l1,Zd(e))))),this.hasL2&&(t=vd(t,nf(Nd(this.l2,vk(e))))),$p(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}lS.className="L1L2",zd(lS);const cS={l1l2:"L1L2"};function uS(e){return Cw(e)}function dS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Tw(e,Pd.getMap().classNameMap,t,"regularizer")}function hS(e){if(null==e)return null;if("string"===typeof e){return dS({className:e in cS?cS[e]:e,config:{}})}return e instanceof oS?e:dS(e)}class pS extends oN{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=Xk(e);let n=Ng(e);return null!=this.maxValue&&(n=xm(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}pS.className="ReLU",zd(pS);class mS extends oN{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=Xk(e);return bf(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}mS.className="LeakyReLU",zd(mS);class fS extends oN{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=qk(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=hS(e.alphaRegularizer),this.alphaConstraint=CN(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new mw("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));this.sharedAxes=[e.sharedAxes]}}build(e){const t=(e=Yk(e)).slice(1);if(null!=this.sharedAxes)for(const a of this.sharedAxes)t[a-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let a=1;a<e.length;++a)n[a]=e[a];this.inputSpec=[new nN({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=Xk(e),ig(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Gk(this.alphaInitializer),alphaRegularizer:uS(this.alphaRegularizer),alphaConstraint:_N(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}fS.className="PReLU",zd(fS);class gS extends oN{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new fw("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=Xk(e);return Um(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}gS.className="ELU",zd(gS);class xS extends oN{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){const n=Xk(e);return Nd(n,xd(mf(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}xS.className="ThresholdedReLU",zd(xS);class yS extends oN{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new J_).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){return tu(()=>{let n=Xk(e);const a=t.mask;if(null!=a){const e=Nd(qd(Vf(n.shape),xd(a,n.dtype)),Ld(-1e9));n=vd(n,e)}return this.axis instanceof Array?this.axis.length>1?of(qd(n,If(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function bS(e,t,n){if("number"===typeof e)return yw(e,t);if(e.length!==t)throw new mw("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(let a=0;a<t;++a){const s=e[a];if(!nk(s))throw new mw("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(s))}return e}function vS(e,t,n,a){if(null==e)return e;let s;return s="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((s+a-1)/a)}function wS(e,t,n,a){if(null==e)return null;if("valid"===a)e=e*t+rk([n-t,0]);else{if("same"!==a)throw new mw("Unsupport padding mode: ".concat(a,"."));e*=t}return e}function kS(e,t){return tu(()=>(Kw(t),"channelsFirst"===t?Ih(e,[0,2,3,1]):e))}function NS(e,t){return tu(()=>(Kw(t),"channelsFirst"===t?Ih(e,[0,2,3,4,1]):e))}function _S(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return tu(()=>{if(null==r&&(r="channelsLast"),Kw(r),3!==e.shape.length)throw new mw("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new mw("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new mw("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(n.shape.length," instead"));if("channelsFirst"===r&&(e=Ih(e,[0,2,1])),"causal"===s)throw new fw("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=Nm(e,t,a,"same"===s?"same":"valid","NWC",i);return null!=n&&(o=kk(o,n)),o})}function SS(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return tu(()=>{if(null==r&&(r="channelsLast"),Kw(r),3!==e.rank&&4!==e.rank)throw new mw("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new mw("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));let l=kS(e,r);if("causal"===s)throw new fw("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Ix({x:l,filter:t,strides:a,pad:"same"===s?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===r&&(l=Ih(l,[0,3,1,2])),l})}function CS(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;return tu(()=>{if(null==r&&(r="channelsLast"),Kw(r),4!==e.rank&&5!==e.rank)throw new mw("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new mw("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));let o=NS(e,r);if("causal"===s)throw new fw("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=Cm(o,t,a,"same"===s?"same":"valid","NDHWC",i),null!=n&&(o=kk(o,n)),"channelsFirst"===r&&(o=Ih(o,[0,4,1,2,3])),o})}yS.className="Softmax",zd(yS);class jS extends oN{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",jS.verifyArgs(t),this.rank=e,Lw(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new fw("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=bS(t.kernelSize,e,"kernelSize"),this.strides=bS(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,Zw(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Kw(this.dataFormat),this.activation=rS(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=qk(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=CN(t.biasConstraint),this.biasRegularizer=hS(t.biasRegularizer),this.activityRegularizer=hS(t.activityRegularizer),this.dilationRate=bS(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new mw("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new mw("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new mw("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(e){if(bw("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!Mw(e.kernelSize,"number",1,3))throw new mw("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:aS(this.activation),useBias:this.useBias,biasInitializer:Gk(this.biasInitializer),biasRegularizer:uS(this.biasRegularizer),activityRegularizer:uS(this.activityRegularizer),biasConstraint:_N(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class TS extends jS{constructor(e,t){super(e,t),this.kernel=null,TS.verifyArgs(t),this.filters=t.filters,Lw(this.filters,"filters"),this.kernelInitializer=qk(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=CN(t.kernelConstraint),this.kernelRegularizer=hS(t.kernelRegularizer)}build(e){e=Yk(e);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new mw("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));const n=e[t],a=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return tu(()=>{let t;e=Xk(e);const n=null==this.bias?null:this.bias.read(),a=Ow(this.activation.getClassName());if(null!=a&&2===this.rank)t=SS(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(1===this.rank)t=_S(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=SS(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new fw("convolutions greater than 3D are not implemented yet.");t=CS(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t})}computeOutputShape(e){e=Yk(e);const t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let s=0;s<n.length;++s){const e=vS(n[s],this.kernelSize[s],this.padding,this.strides[s],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[s]);t.push(e)}let a=[e[0]];return"channelsLast"===this.dataFormat?(a=a.concat(t),a.push(this.filters)):(a.push(this.filters),a=a.concat(t)),a}getConfig(){const e={filters:this.filters,kernelInitializer:Gk(this.kernelInitializer),kernelRegularizer:uS(this.kernelRegularizer),kernelConstraint:_N(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new mw("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}class IS extends TS{constructor(e){super(2,e),IS.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!Mw(e.kernelSize,"number",1,2))throw new mw("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}IS.className="Conv2D",zd(IS);class ES extends TS{constructor(e){super(3,e),ES.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new mw("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}ES.className="Conv3D",zd(ES);class AS extends IS{constructor(e){if(super(e),this.inputSpec=[new nN({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new mw("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(4!==(e=Yk(e)).length)throw new mw("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new mw("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new nN({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return tu(()=>{let t=Xk(e);if(4!==t.shape.length)throw new mw("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));const n=t.shape,a=n[0];let s,r;"channelsFirst"===this.dataFormat?(s=2,r=3):(s=1,r=2);const i=n[s],o=n[r],l=this.kernelSize[0],c=this.kernelSize[1],u=this.strides[0],d=this.strides[1],h=[a,wS(i,u,l,this.padding),wS(o,d,c,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=Ih(t,[0,2,3,1]));let p=Sm(t,this.kernel.read(),h,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=Ih(p,[0,3,1,2])),null!=this.bias&&(p=kk(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p})}computeOutputShape(e){const t=(e=Yk(e)).slice();let n,a,s;"channelsFirst"===this.dataFormat?(n=1,a=2,s=3):(n=3,a=1,s=2);const r=this.kernelSize[0],i=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return t[n]=this.filters,t[a]=wS(t[a],o,r,this.padding),t[s]=wS(t[s],l,i,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}AS.className="Conv2DTranspose",zd(AS);class RS extends ES{constructor(e){if(super(e),this.inputSpec=[new nN({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new mw("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(5!==(e=Yk(e)).length)throw new mw("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new mw("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],a=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new nN({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return tu(()=>{let t=Xk(e);if(5!==t.shape.length)throw new mw("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));const n=t.shape,a=n[0];let s,r,i;"channelsFirst"===this.dataFormat?(i=2,s=3,r=4):(i=1,s=2,r=3);const o=n[i],l=n[s],c=n[r],u=this.kernelSize[0],d=this.kernelSize[1],h=this.kernelSize[2],p=this.strides[0],m=this.strides[1],f=this.strides[2],g=[a,wS(o,p,u,this.padding),wS(l,m,d,this.padding),wS(c,f,h,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=Ih(t,[0,2,3,4,1]));let x=Tm(t,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(x=Ih(x,[0,4,1,2,3])),null!==this.bias&&(x=kk(x,this.bias.read(),this.dataFormat)),null!==this.activation&&(x=this.activation.apply(x)),x})}computeOutputShape(e){const t=(e=Yk(e)).slice();let n,a,s,r;"channelsFirst"===this.dataFormat?(n=1,a=2,s=3,r=4):(n=4,a=1,s=2,r=3);const i=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],u=this.strides[1],d=this.strides[2];return t[n]=this.filters,t[a]=wS(t[a],c,i,this.padding),t[s]=wS(t[s],u,o,this.padding),t[r]=wS(t[r],d,l,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}RS.className="Conv3DTranspose",zd(RS);class MS extends TS{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new mw("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new mw("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new mw("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(t.padding)));this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=qk(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=hS(t.depthwiseRegularizer),this.depthwiseConstraint=CN(t.depthwiseConstraint),this.pointwiseInitializer=qk(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=hS(t.pointwiseRegularizer),this.pointwiseConstraint=CN(t.pointwiseConstraint)}build(e){if((e=Yk(e)).length<this.rank+2)throw new mw("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new mw("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));const n=e[t],a=this.kernelSize.concat([n,this.depthMultiplier]),s=[];for(let i=0;i<this.rank;++i)s.push(1);s.push(n*this.depthMultiplier,this.filters);const r=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,r,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,r,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,r,this.biasConstraint):this.bias=null,this.inputSpec=[new nN({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return tu(()=>{let t;if(e=Xk(e),1===this.rank)throw new fw("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=Ih(e,[0,2,3,1])),t=Mg(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=kk(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=Ih(t,[0,3,1,2])),t})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Gk(this.depthwiseInitializer),e.pointwiseInitializer=Gk(this.pointwiseInitializer),e.depthwiseRegularizer=uS(this.depthwiseRegularizer),e.pointwiseRegularizer=uS(this.pointwiseRegularizer),e.depthwiseConstraint=_N(this.depthwiseConstraint),e.pointwiseConstraint=_N(this.pointwiseConstraint),e}}MS.className="SeparableConv";class LS extends MS{constructor(e){super(2,e)}}LS.className="SeparableConv2D",zd(LS);class DS extends TS{constructor(e){super(1,e),DS.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!Mw(e.kernelSize,"number",1,1))throw new mw("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}DS.className="Conv1D",zd(DS);class OS extends oN{constructor(e){super(e),"number"===typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return tu(()=>{if(e=Xk(e),"channelsLast"===this.dataFormat){const t=pk(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return pk(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const t=pk(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return pk(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}OS.className="Cropping2D",zd(OS);class FS extends oN{constructor(e){var t;super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Kw(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,t=this.interpolation,Rw(Vw,"InterpolationFormat",t)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){const t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{const t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return tu(()=>{let t=Xk(e);const n=t.shape;if("channelsFirst"===this.dataFormat){t=Ih(t,[0,2,3,1]);const e=this.size[0]*n[2],a=this.size[1]*n[3],s="nearest"===this.interpolation?My.resizeNearestNeighbor(t,[e,a]):My.resizeBilinear(t,[e,a]);return Ih(s,[0,3,1,2])}{const e=this.size[0]*n[1],a=this.size[1]*n[2];return"nearest"===this.interpolation?My.resizeNearestNeighbor(t,[e,a]):My.resizeBilinear(t,[e,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}FS.className="UpSampling2D",zd(FS);class PS extends jS{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=qk(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=CN(e.depthwiseConstraint),this.depthwiseRegularizer=hS(e.depthwiseRegularizer)}build(e){if((e=Yk(e)).length<4)throw new mw("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));const t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new mw("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));const n=e[t],a=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return tu(()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;return tu(()=>{null==s&&(s="channelsLast"),Kw(s);let i=kS(e,s);if(4!==e.rank)throw new mw("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new mw("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return i=Dm(i,t,n,"same"===a?"same":"valid","NHWC",r),"channelsFirst"===s&&(i=Ih(i,[0,3,1,2])),i})}(e=Xk(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=kk(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t})}computeOutputShape(e){e=Yk(e);const t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],a="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,s=vS(t,this.kernelSize[0],this.padding,this.strides[0]),r=vS(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],a,s,r]:[e[0],s,r,a]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Gk(this.depthwiseInitializer),e.depthwiseRegularizer=uS(this.depthwiseRegularizer),e.depthwiseConstraint=_N(this.depthwiseRegularizer),e}}function zS(e,t,n,a){if(Array.isArray(e)){if(null!=t||null!=n)throw new mw("When inputs is an array, neither initialState or constants should be provided");null!=a&&(n=e.slice(e.length-a,e.length),e=e.slice(0,e.length-a)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function s(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=s(t),constants:n=s(n)}}function BS(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return tu(()=>{const l=t.shape.length;if(l<3)throw new mw("Input should be at least 3D, but is ".concat(l,"D."));const c=[1,0].concat(ik(2,l));if(t=Ih(t,c),null!=r)throw new fw("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=s&&(s=xd(xd(s,"bool"),"float32"),s.rank===l-1&&(s=lf(s,-1)),s=Ih(s,c)),a&&(t=Sg(t,0),null!=s&&(s=Sg(s,0)));const u=[];let d,h=n;const p=t.shape[0],m=ux(t);let f,g;null!=s&&(f=ux(s));for(let t=0;t<p;++t){const n=m[t],a=tu(()=>e(n,h));if(null==s)d=a[0],h=a[1];else{const e=tu(()=>{const e=f[t],n=qd(Jf(e),e);return{output:vd(Nd(a[0],e),Nd(h[0],n)),newStates:h.map((t,s)=>vd(Nd(a[1][s],e),Nd(t,n)))}});d=e.output,h=e.newStates}o&&u.push(d)}if(o){g=Yg(u,1)}return[d,g,h]})}PS.className="DepthwiseConv2D",zd(PS);class WS extends oN{constructor(e){let t;if(super(e),null==e.cell)throw new mw("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new XS({cells:e.cell}):e.cell,null==t.stateSize)throw new mw("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new nN({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return ik(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(e=>null)}return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Kk(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let a;if(a=this.returnSequences?[e[0],e[1],n]:[e[0],n],this.returnState){const n=[];for(const a of t)n.push([e[0],a]);return[a].concat(n)}return a}computeMask(e,t){return tu(()=>{Array.isArray(t)&&(t=t[0]);const e=this.returnSequences?t:null;if(this.returnState){const t=this.states.map(e=>null);return[e].concat(t)}return e})}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new fw("Constants support is not implemented in RNN yet.");Kk(e)&&(e=e[0]);const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new nN({shape:[t,null,...n]});const a=[e[0]].concat(e.slice(2));let s;if(this.cell.build(a),s=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!rs(this.stateSpec.map(e=>e.shape[e.shape.length-1]),s))throw new mw("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=s.map(e=>new nN({shape:[null,e]}));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];tu(()=>{if(!this.stateful)throw new hw("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new mw("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>Wf([n,e])):this.states_=[Wf([n,this.cell.stateSize])];else if(null==e)nu(this.states_),null!=this.keptStates&&(nu(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>Wf([n,e])):this.states_[0]=Wf([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new mw("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===t?this.keptStates.push(this.states_.slice()):nu(this.states_);for(let t=0;t<this.states_.length;++t){const a=e[t],s=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,r=[n,s];if(!rs(a.shape,r))throw new mw("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(r,", received shape=").concat(a.shape));this.states_[t]=a}}this.states_=this.states_.map(e=>au(e.clone()))})}apply(e,t){let n=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});const s=zS(e,n,a,this.numConstants);e=s.inputs,n=s.initialState,a=s.constants;let r=[],i=[];if(null!=n){t.initialState=n,r=r.concat(n),this.stateSpec=[];for(const e of n)this.stateSpec.push(new nN({shape:e.shape}));i=i.concat(this.stateSpec)}null!=a&&(t.constants=a,r=r.concat(a),this.numConstants=a.length);if(r[0]instanceof aN){const n=[e].concat(r),a=this.inputSpec.concat(i),s=this.inputSpec;this.inputSpec=a;const o=super.apply(n,t);return this.inputSpec=s,o}return super.apply(e,t)}call(e,t){return tu(()=>{const n=null==t?null:t.mask,a=null==t?null:t.training;let s=null==t?null:t.initialState;e=Xk(e),null==s&&(s=this.stateful?this.states_:this.getInitialState(e));const r=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==r)throw new mw("RNN Layer has ".concat(r," state(s) but was passed ")+"".concat(s.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const i={training:a},o=BS((e,t)=>{const n=this.cell.call([e].concat(t),i);return[n[0],n.slice(1)]},e,s,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],c=o[1],u=o[2];this.stateful&&this.resetStates(u,a);const d=this.returnSequences?c:l;return this.returnState?[d].concat(u):d})}getInitialState(e){return tu(()=>{let t=Wf(e.shape);return t=nf(t,[1,2]),t=uk(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(e=>e>1?gk(t,[1,e]):t):this.cell.stateSize>1?[gk(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===WS.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=PN(t.cell,n);return new e(Object.assign(t,{cell:a}))}}WS.className="RNN",zd(WS);class VS extends oN{}class US extends VS{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Lw(this.units,"units"),this.activation=rS(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=qk(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=qk(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=qk(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=hS(e.kernelRegularizer),this.recurrentRegularizer=hS(e.recurrentRegularizer),this.biasRegularizer=hS(e.biasRegularizer),this.kernelConstraint=CN(e.kernelConstraint),this.recurrentConstraint=CN(e.recurrentConstraint),this.biasConstraint=CN(e.biasConstraint),this.dropout=sk([1,rk([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=sk([1,rk([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Yk(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return tu(()=>{if(2!==e.length)throw new mw("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];const a=null!=t.training&&t.training;let s;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=YS({ones:()=>Jf(e),rate:this.dropout,training:a,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=YS({ones:()=>Jf(n),rate:this.recurrentDropout,training:a,dropoutFunc:this.dropoutFunc}));const r=this.dropoutMask,i=this.recurrentDropoutMask;s=yk(null!=r?Nd(e,r):e,this.kernel.read()),null!=this.bias&&(s=kk(s,this.bias.read())),null!=i&&(n=Nd(n,i));let o=vd(s,yk(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:aS(this.activation),useBias:this.useBias,kernelInitializer:Gk(this.kernelInitializer),recurrentInitializer:Gk(this.recurrentInitializer),biasInitializer:Gk(this.biasInitializer),kernelRegularizer:uS(this.kernelRegularizer),recurrentRegularizer:uS(this.recurrentRegularizer),biasRegularizer:uS(this.biasRegularizer),activityRegularizer:uS(this.activityRegularizer),kernelConstraint:_N(this.kernelConstraint),recurrentConstraint:_N(this.recurrentConstraint),biasConstraint:_N(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}US.className="SimpleRNNCell",zd(US);class HS extends WS{constructor(e){e.cell=new US(e),super(e)}call(e,t){return tu(()=>{null!=this.cell.dropoutMask&&(nu(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(nu(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,a=null==t?null:t.training,s=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:s})})}static fromConfig(e,t){return new e(t)}}HS.className="SimpleRNN",zd(HS);class GS extends VS{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new mw("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Lw(this.units,"units"),this.activation=rS(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=rS(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=qk(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=qk(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=qk(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=hS(e.kernelRegularizer),this.recurrentRegularizer=hS(e.recurrentRegularizer),this.biasRegularizer=hS(e.biasRegularizer),this.kernelConstraint=CN(e.kernelConstraint),this.recurrentConstraint=CN(e.recurrentConstraint),this.biasConstraint=CN(e.biasConstraint),this.dropout=sk([1,rk([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=sk([1,rk([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){const t=(e=Yk(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return tu(()=>{if(2!==e.length)throw new mw("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=null!=t.training&&t.training;let a=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=YS({ones:()=>Jf(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=YS({ones:()=>Jf(a),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,r=this.recurrentDropoutMask;let i,o,l;0<this.dropout&&this.dropout<1&&(e=Nd(e,s[0]));let c=yk(e,this.kernel.read());this.useBias&&(c=kk(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(a=Nd(a,r[0]));const u=this.recurrentKernel.read(),[d,h]=qg(u,[2*this.units,this.units],u.rank-1),p=yk(a,d),[m,f,g]=qg(c,3,c.rank-1),[x,y]=qg(p,2,p.rank-1);i=this.recurrentActivation.apply(vd(m,x)),o=this.recurrentActivation.apply(vd(f,y));const b=yk(Nd(o,a),h);l=this.activation.apply(vd(g,b));const v=vd(Nd(i,a),Nd(vd(1,jh(i)),l));return[v,v]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:aS(this.activation),recurrentActivation:aS(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gk(this.kernelInitializer),recurrentInitializer:Gk(this.recurrentInitializer),biasInitializer:Gk(this.biasInitializer),kernelRegularizer:uS(this.kernelRegularizer),recurrentRegularizer:uS(this.recurrentRegularizer),biasRegularizer:uS(this.biasRegularizer),activityRegularizer:uS(this.activityRegularizer),kernelConstraint:_N(this.kernelConstraint),recurrentConstraint:_N(this.recurrentConstraint),biasConstraint:_N(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}GS.className="GRUCell",zd(GS);class qS extends WS{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new GS(e),super(e)}call(e,t){return tu(()=>{null!=this.cell.dropoutMask&&(nu(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(nu(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,a=null==t?null:t.training,s=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:s})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}qS.className="GRU",zd(qS);class KS extends VS{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Lw(this.units,"units"),this.activation=rS(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=rS(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=qk(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=qk(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=qk(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=hS(e.kernelRegularizer),this.recurrentRegularizer=hS(e.recurrentRegularizer),this.biasRegularizer=hS(e.biasRegularizer),this.kernelConstraint=CN(e.kernelConstraint),this.recurrentConstraint=CN(e.recurrentConstraint),this.biasConstraint=CN(e.biasConstraint),this.dropout=sk([1,rk([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=sk([1,rk([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;const n=(e=Yk(e))[e.length-1];let a;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const e=this.biasInitializer,n=this.units;a=new((t=class extends jk{apply(t,a){const s=e.apply([n]),r=(new Ik).apply([n]),i=e.apply([2*n]);return fk(fk(s,r),i)}}).className="CustomInit",t)}else a=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,a,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return tu(()=>{const n=null!=t.training&&t.training;if(3!==e.length)throw new mw("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let a=e[1];const s=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=YS({ones:()=>Jf(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=YS({ones:()=>Jf(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const r=this.dropoutMask,i=this.recurrentDropoutMask;let o,l,c,u;0<this.dropout&&this.dropout<1&&(e=Nd(e,r[0]));let d=yk(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(a=Nd(a,i[0])),d=vd(d,yk(a,this.recurrentKernel.read())),this.useBias&&(d=kk(d,this.bias.read()));const[h,p,m,f]=qg(d,4,d.rank-1);o=this.recurrentActivation.apply(h),l=this.recurrentActivation.apply(p),c=vd(Nd(l,s),Nd(o,this.activation.apply(m))),u=this.recurrentActivation.apply(f);const g=Nd(u,this.activation.apply(c));return[g,g,c]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:aS(this.activation),recurrentActivation:aS(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gk(this.kernelInitializer),recurrentInitializer:Gk(this.recurrentInitializer),biasInitializer:Gk(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:uS(this.kernelRegularizer),recurrentRegularizer:uS(this.recurrentRegularizer),biasRegularizer:uS(this.biasRegularizer),activityRegularizer:uS(this.activityRegularizer),kernelConstraint:_N(this.kernelConstraint),recurrentConstraint:_N(this.recurrentConstraint),biasConstraint:_N(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}KS.className="LSTMCell",zd(KS);class ZS extends WS{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new KS(e),super(e)}call(e,t){return tu(()=>{null!=this.cell.dropoutMask&&(nu(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(nu(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,a=null==t?null:t.training,s=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:s})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}ZS.className="LSTM",zd(ZS);class XS extends VS{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return tu(()=>{let n=e.slice(1);const a=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?a.push(n.splice(0,e.stateSize.length)):a.push(n.splice(0,1));a.reverse();const s=[];let r;for(let i=0;i<this.cells.length;++i){const o=this.cells[i];n=a[i],r=0===i?[e[0]].concat(n):[r[0]].concat(n),r=o.call(r,t),s.push(r.slice(1))}n=[];for(const e of s.slice().reverse())n.push(...e);return[r[0]].concat(n)})}build(e){let t;Kk(e)&&(e=e[0]),this.cells.forEach((n,a)=>{Jw("RNNCell_".concat(a),()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t={cells:this.cells.map(e=>({className:e.getClassName(),config:e.getConfig()}))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=[];for(const s of t.cells)a.push(PN(s,n));return new e({cells:a})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return eN(e)}setWeights(e){const t=[];for(const n of this.cells){const a=n.weights.length,s=e.splice(a);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],s[e]])}tN(t)}}function YS(e){const{ones:t,rate:n,training:a=!1,count:s=1,dropoutFunc:r}=e,i=()=>null!=r?r(t(),n):Nk(t(),n),o=()=>_k(i,t,a);if(!s||s<=1)return au(o().clone());return Array(s).fill(void 0).map(o).map(e=>au(e.clone()))}XS.className="StackedRNNCells",zd(XS);var JS=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]])}return n};class QS extends WS{constructor(e){if(e.unroll)throw new fw("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new fw("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new nN({ndim:5})]}call(e,t){return tu(()=>{if(null!=this.cell.dropoutMask&&(nu(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(nu(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new mw("ConvRNN2D cell does not support constants");const n=null==t?null:t.mask,a=null==t?null:t.training,s=null==t?null:t.initialState;return super.call(e,{mask:n,training:a,initialState:s})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return tu(()=>{const{stateSize:t}=this.cell,n=e.shape,a=this.computeSingleOutputShape(n),s=Wf([a[0],...a.slice(2)]);return Array.isArray(t)?Array(t.length).fill(s):[s]})}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];tu(()=>{if(!this.stateful)throw new hw("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,a=this.computeSingleOutputShape(n),s=[a[0],...a.slice(2)];if(null==n[0])throw new mw("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Wf(s)):this.states_=[Wf(s)];else if(null==e)nu(this.states_),null!=this.keptStates&&(nu(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Wf(s)):this.states_[0]=Wf(s);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new mw("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t?this.keptStates.push(this.states_.slice()):nu(this.states_);for(let t=0;t<this.states_.length;++t){const n=e[t],a=s;if(!rs(n.shape,a))throw new mw("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(a,", received shape=").concat(n.shape));this.states_[t]=n}}this.states_=this.states_.map(e=>au(e.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:a,padding:s,strides:r,dilationRate:i}=this.cell,o="channelsFirst"===t,l=e[o?3:2],c=e[o?4:3],u=vS(l,a[0],s,r[0],i[0]),d=vS(c,a[1],s,r[1],i[1]);return[...e.slice(0,2),...o?[n,u,d]:[u,d,n]]}}QS.className="ConvRNN2D";class $S extends KS{constructor(e){const{filters:t,kernelSize:n,strides:a,padding:s,dataFormat:r,dilationRate:i}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Lw(this.filters,"filters"),this.kernelSize=bS(n,2,"kernelSize"),this.kernelSize.forEach(e=>Lw(e,"kernelSize")),this.strides=bS(a||1,2,"strides"),this.strides.forEach(e=>Lw(e,"strides")),this.padding=s||"valid",Zw(this.padding),this.dataFormat=r||"channelsLast",Kw(this.dataFormat),this.dilationRate=bS(i||1,2,"dilationRate"),this.dilationRate.forEach(e=>Lw(e,"dilationRate"))}build(e){var t;e=Yk(e);const n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new mw("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));const a=e[n],s=this.kernelSize.concat([a,4*this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const r=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",r,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){const n=this.biasInitializer,a=this.filters;e=new((t=class extends jk{apply(e,t){return mk([n.apply([a]),Vf([a]),n.apply([2*a])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return tu(()=>{if(3!==e.length)throw new mw("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=t.training||!1,a=e[0],s=e[1],r=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=YS({ones:()=>Jf(a),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=(e,t,n)=>t&&t[n]?Nd(t[n],e):e;let l=o(a,i,0),c=o(a,i,1),u=o(a,i,2),d=o(a,i,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=YS({ones:()=>Jf(s),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const h=this.recurrentDropoutMask;let p=o(s,h,0),m=o(s,h,1),f=o(s,h,2),g=o(s,h,3);const[x,y,b,v]=qg(this.kernel.read(),4,3),[w,k,N,_]=this.useBias?qg(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,x,w,this.padding),c=this.inputConv(c,y,k,this.padding),u=this.inputConv(u,b,N,this.padding),d=this.inputConv(d,v,_,this.padding);const[S,C,j,T]=qg(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,S),m=this.recurrentConv(m,C),f=this.recurrentConv(f,j),g=this.recurrentConv(g,T);const I=this.recurrentActivation.apply(vd(l,p)),E=this.recurrentActivation.apply(vd(c,m)),A=vd(Nd(E,r),Nd(I,this.activation.apply(vd(u,f)))),R=Nd(this.recurrentActivation.apply(vd(d,g)),this.activation.apply(A));return[R,R,A]})}getConfig(){const e=super.getConfig(),{units:t}=e,n=JS(e,["units"]),a={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),a)}inputConv(e,t,n,a){const s=km(e,t,this.strides,a||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?kk(s,n,this.dataFormat):s}recurrentConv(e,t){return km(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}$S.className="ConvLSTM2DCell",zd($S);class eC extends QS{constructor(e){const t=new $S(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}eC.className="ConvLSTM2D",zd(eC);class tC extends oN{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const t=e.shape,n=[];for(let a=0;a<this.noiseShape.length;++a)n.push(null==this.noiseShape[a]?t[a]:this.noiseShape[a]);return n}call(e,t){return tu(()=>{this.invokeCallHook(e,t);const n=Xk(e);if(0<this.rate&&this.rate<1){const e=null!=t.training&&t.training,a=this.getNoiseShape(n);return _k(()=>Nk(n,this.rate,a,this.seed),()=>n,e)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}tC.className="Dropout",zd(tC);class nC extends tC{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}nC.className="SpatialDropout1D",zd(nC);class aC extends oN{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Lw(this.units,"units"),this.activation=rS(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=qk(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=qk(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=CN(e.kernelConstraint),this.biasConstraint=CN(e.biasConstraint),this.kernelRegularizer=hS(e.kernelRegularizer),this.biasRegularizer=hS(e.biasRegularizer),this.activityRegularizer=hS(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const t=(e=Yk(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){const t=(e=Yk(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return tu(()=>{this.invokeCallHook(e,t);const n=Xk(e),a=Ow(this.activation.getClassName());let s;return null!=a?s=yk(n,this.kernel.read(),a,this.bias?this.bias.read():null):(s=yk(n,this.kernel.read()),null!=this.bias&&(s=kk(s,this.bias.read())),null!=this.activation&&(s=this.activation.apply(s))),s})}getConfig(){const e={units:this.units,activation:aS(this.activation),useBias:this.useBias,kernelInitializer:Gk(this.kernelInitializer),biasInitializer:Gk(this.biasInitializer),kernelRegularizer:uS(this.kernelRegularizer),biasRegularizer:uS(this.biasRegularizer),activityRegularizer:uS(this.activityRegularizer),kernelConstraint:_N(this.kernelConstraint),biasConstraint:_N(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}aC.className="Dense",zd(aC);class sC extends oN{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Yk(e);for(const t of e.slice(1))if(null==t)throw new mw('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],ak(e,1)]}call(e,t){return tu(()=>{this.invokeCallHook(e,t);let n=Xk(e);if("channelsFirst"===this.dataFormat&&n.rank>1){const e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=Ih(n,e)}return function(e){if(e.rank<=1)throw new mw("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));const t=[e.shape[0],ak(e.shape,1)];return $p(e,t)}(n)})}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}sC.className="Flatten",zd(sC);class rC extends oN{constructor(e){super(e),this.supportsMasking=!0,this.activation=rS(e.activation)}call(e,t){return tu(()=>{this.invokeCallHook(e,t);const n=Xk(e);return this.activation.apply(n)})}getConfig(){const e={activation:aS(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}rC.className="Activation",zd(rC);class iC extends oN{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return tu(()=>{return e=Xk(e),t=e,n=this.n,tu(()=>{if(2!==t.shape.length)throw new mw("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return gk(uk(t,1),[1,n,1])});var t,n})}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}iC.className="RepeatVector",zd(iC);class oC extends oN{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",a=t.slice();let s=1,r=null;for(let o=0;o<a.length;++o){const e=a[o];if(this.isUnknown(e)){if(null!==r)throw new mw("Can only specifiy one unknown dimension.");r=o}else s*=e}const i=ak(e);if(null!==r){if(0===s||i%s!==0)throw new mw(n);a[r]=i/s}else if(i!==s)throw new mw(n);return a}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return tu(()=>{this.invokeCallHook(e,t);const n=Xk(e),a=n.shape,s=a.slice(0,1).concat(this.fixUnknownDimension(a.slice(1),this.targetShape));return $p(n,s)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}oC.className="Reshape",zd(oC);class lC extends oN{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));const t=ik(1,e.dims.length+1);if(!rs(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new nN({ndim:this.dims.length+1})]}computeOutputShape(e){const t=(e=Yk(e)).slice();return this.dims.forEach((n,a)=>{t[a+1]=e[n]}),t}call(e,t){return Ih(Xk(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}lC.className="Permute",zd(lC);class cC extends oN{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=Xk(e);return Ep(Yf(n,this.maskValue),-1)}call(e,t){return tu(()=>{this.invokeCallHook(e,t);const n=Xk(e),a=Ep(Yf(n,this.maskValue),-1,!0);return Nd(n,xd(a,n.dtype))})}}cC.className="Masking",zd(cC);class uC extends oN{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(kw(e.inputLength))}this.inputDim=e.inputDim,Lw(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Lw(this.outputDim,"outputDim"),this.embeddingsInitializer=qk(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=hS(e.embeddingsRegularizer),this.activityRegularizer=hS(e.activityRegularizer),this.embeddingsConstraint=CN(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return tu(()=>this.maskZero?(e=Xk(e),Yf(e,Cd(e))):null)}computeOutputShape(e){if(e=Yk(e),null==this.inputLength)return[...e,this.outputDim];const t=kw(this.inputLength);if(t.length!==e.length-1)throw new mw('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));{let n=0;for(let a=0;a<t.length;++a){const s=t[a],r=e[a+1];if(null!=s&&null!=r&&s!==r)throw new mw('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==s&&(t[n]=r),n++}}return[e[0],...t,this.outputDim]}call(e,t){return tu(()=>{this.invokeCallHook(e,t);let n=Xk(e);"int32"!==n.dtype&&(n=ck(n,"int32"));const a=bk(this.embeddings.read(),$p(n,[n.size]));return $p(a,Yk(this.computeOutputShape(n.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Gk(this.embeddingsInitializer),embeddingsRegularizer:uS(this.embeddingsRegularizer),activityRegularizer:uS(this.activityRegularizer),embeddingsConstraint:_N(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}uC.className="Embedding",zd(uC);class dC extends oN{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new fw}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;const n=e.slice(0,e.length-t.length);for(let a=0;a<t.length;++a){const s=e[e.length-t.length+a],r=t[a];if(null==s||null==r||s<0||r<0)n.push(null);else if(1===s)n.push(r);else if(1===r)n.push(s);else{if(s!==r)throw new mw("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(s)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Yk(e)]),e.length<2)throw new mw("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));let t=[];for(const s of e)null!=s&&null!==s[0]&&t.push(s[0]);if(t=Ew(t),t.length>1)throw new mw("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=null==e[0]?null:e[0].slice(1);for(let s=1;s<e.length;++s){const t=null==e[s]?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}const a=e.map(e=>e.length);-1===e.indexOf(null)&&1===Ew(a).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return tu(()=>{if(this.reshapeRequired){const t=[],n=e.map(e=>e.rank);if(-1===n.indexOf(null)){const a=rk(n);for(let n of e){const e=n.rank;for(let t=0;t<a-e;++t)n=uk(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(const r of e){const e=r.rank;if(null==e){const e=r.shape,a=e[0],s=e.slice(1).concat([a]);let i=$p(r,[a].concat(ak(e.slice(1))));i=Ih(i,[1,0]),i=$p(i,s),t.push(i),n=!0}else if(e>1){const a=ik(1,e).concat([0]);t.push(Ih(r,a)),n=!0}else t.push(r)}let a=this.mergeFunction(t);const s=a.rank;if(n)if(null==s){const e=a.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));a=$p(Ih($p(a,[-1,t]),[1,0]),n)}else if(s>1){const e=[s-1].concat(ik(0,s-1));a=Ih(a,e)}return a}}return this.mergeFunction(e)})}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let a=1;a<e.length;++a){const n=null==e[a]?null:e[a].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(const a of e)null!=a&&null!==a[0]&&n.push(a[0]);return n=Ew(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return tu(()=>{if(null==t)return null;if(!Array.isArray(t))throw new mw("`mask` should be an Array");if(!Array.isArray(e))throw new mw("`inputs` should be an Array");if(t.length!==e.length)throw new mw("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every(e=>null==e))return null;let n=(t=t.map(e=>null==e?e:lf(e,0)))[0];for(let e=1;e<t.length-1;++e)n=Ef(n,t[e]);return n})}}class hC extends dC{constructor(e){super(e)}mergeFunction(e){return tu(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=vd(t,e[n]);return t})}}hC.className="Add",zd(hC);class pC extends dC{constructor(e){super(e)}mergeFunction(e){return tu(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Nd(t,e[n]);return t})}}pC.className="Multiply",zd(pC);class mC extends dC{constructor(e){super(e)}mergeFunction(e){return tu(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=vd(t,e[n]);return Nd(1/e.length,t)})}}mC.className="Average",zd(mC);class fC extends dC{constructor(e){super(e)}mergeFunction(e){return tu(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Qd(t,e[n]);return t})}}fC.className="Maximum",zd(fC);class gC extends dC{constructor(e){super(e)}mergeFunction(e){return tu(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=Hf(t,e[n]);return t})}}gC.className="Minimum",zd(gC);class xC extends dC{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new mw("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(const a of e)if(null!=a){t=!1;break}if(t)return;const n=[];for(let a=0;a<e.length;++a){const t=e[a].slice();t.splice(this.axis,1);let s=!1;for(const e of n)if(rs(e,t)){s=!0;break}s||n.push(t)}if(n.length>1)throw new mw("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return tu(()=>mk(e,this.axis))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new mw("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),a=this.axis<0?n.length+this.axis:this.axis;for(const s of t.slice(1)){if(null==n[a]||null==s[a]){n[a]=null;break}n[a]+=s[a]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new mw("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new mw("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new mw("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return tu(()=>{let n=!0;if(t.forEach(e=>{null==e||(n=!1)}),n)return null;const a=[];for(let r=0;r<e.length;++r)null==t[r]?a.push(xd(Jf(e[r]),"bool")):t[r].rank<e[r].rank?a.push(lf(t[r],-1)):a.push(t[r]);const s=nm(a,this.axis);return Ip(s,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function yC(e,t){for(;e<0;)e+=t;return e}xC.className="Concatenate",zd(xC);class bC extends dC{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){$a(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new fw("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(t,n);if(t[a[0]]!==n[a[1]])throw new mw("Dimension incompatibility: "+"".concat(t[a[0]]," !== ").concat(n[a[1]]))}mergeFunction(e){if(2!==e.length)throw new mw("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));let t,n=e[0],a=e[1];return t=Array.isArray(this.axes)?this.axes.map((t,n)=>yC(t,e[n].shape.length)):[yC(this.axes,n.shape.length),yC(this.axes,a.shape.length)],this.normalize&&(n=zN(n,t[0]),a=zN(a,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new fw("batchDot is not implemented for tensors of 4D or higher rank yet");if($a(e.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)),$a(e.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new fw("batchDot is not implemented for complex64-type Tensors yet.");const a=e.shape.length,s=t.shape.length;null==n&&(n=[a-1,s-2]);const r=n;return tu(()=>{let n,i;if(a>s){n=a-s;const e=[];for(let t=0;t<n;++t)e.push(1);t=$p(t,t.shape.concat(e))}else if(s>a){n=s-a;const t=[];for(let e=0;e<n;++e)t.push(1);e=$p(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)i=r[0]===r[1]?nf(Nd(e,t),r[0]):nf(Nd(Ih(e,[1,0]),t),r[1]);else{const n=r[0]!==e.shape.length-1,a=r[1]===t.shape.length-1;i=_h(e,t,n,a)}if(n>0){let e;e=a>s?a+s-3:a-1;const t=[];for(let a=e;a<e+n;++a)t.push(a);i=Xg(i,t)}return 1===i.shape.length&&(i=lf(i,1)),i})}(n,a,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[yC(this.axes,e.length),yC(this.axes,t.length)],n}computeOutputShape(e){$a(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new fw("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(t,n);t.splice(a[0],1),n.splice(a[1],1),n.splice(0,1);const s=t.concat(n);return 1===s.length&&s.push(1),s}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}bC.className="Dot",zd(bC);class vC extends oN{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return tu(()=>{this.invokeCallHook(e,t);const n=Xk(e);return _k(()=>vd(xk(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}}vC.className="GaussianNoise",zd(vC);class wC extends oN{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return tu(()=>{this.invokeCallHook(e,t);const n=Xk(e);if(this.rate>0&&this.rate<1){return _k(()=>{const e=Math.sqrt(this.rate/(1-this.rate));return Nd(n,xk(n.shape,1,e))},()=>n,t.training||!1)}return n})}}wC.className="GaussianDropout",zd(wC);class kC extends oN{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Xk(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return tu(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e),a=()=>{const t=Xk(e),a=-1.7580993408473766;let s=ff(bg(n),this.rate);s=ck(s,"float32");const r=((1-this.rate)*(1+this.rate*a**2))**-.5,i=-r*a*this.rate,o=vd(Nd(t,s),Nd(vd(s,-1),a));return vd(Nd(o,r),i)};return _k(a,()=>Xk(e),t.training||!1)}return e})}}function NC(e,t,n,a,s){let r,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)r=cm(e,t,n,a,s,i);else if(3===e.rank)r=um(e,t,n,a,s,i);else{if(4!==e.rank)throw new fw("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");r=dm(e,t,n,a,s,i)}return r}function _C(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return rs(a.slice().sort(),ik(0,e.rank-1))?function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return tu(()=>{const r=Kf(e,a),i=r.mean,o=r.variance;return[NC(e,i,o,n,t,s),i,o]})}(e,t,n,a,s):function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return tu(()=>{const r=Kf(e,a),i=r.mean,o=r.variance,l=[];for(const t of ik(0,e.rank))-1!==a.indexOf(t)?l.push(1):l.push(e.shape[t]);const c=$p(i,l),u=$p(o,l),d=null==t?null:$p(t,l),h=null==n?null:$p(n,l);return[NC(e,c,u,h,d,s),i,o]})}(e,t,n,a,s)}kC.className="AlphaDropout",zd(kC);class SC extends oN{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=qk(e.betaInitializer||"zeros"),this.gammaInitializer=qk(e.gammaInitializer||"ones"),this.movingMeanInitializer=qk(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=qk(e.movingVarianceInitializer||"ones"),this.betaConstraint=CN(e.betaConstraint),this.gammaConstraint=CN(e.gammaConstraint),this.betaRegularizer=hS(e.betaRegularizer),this.gammaRegularizer=hS(e.gammaRegularizer)}build(e){e=Yk(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new mw("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new nN({ndim:e.length,axes:{[t]:n}})];const a=[n];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return tu(()=>{const n=null!=t.training&&t.training,a=Xk(e),s=a.shape,r=s.length,i=ik(0,r),o=this.axis>=0?this.axis:this.axis+r;i.splice(o,1);const l=yw(1,r);l[o]=s[o];const c=i.slice();c.sort();const u=!rs(c,ik(0,r).slice(0,r-1));if(!n)return(()=>{if(u){const e=$p(this.movingMean.read(),l),t=$p(this.movingVariance.read(),l),n=this.center?$p(this.beta.read(),l):null,s=this.scale?$p(this.gamma.read(),l):null;return NC(a,e,t,n,s,this.epsilon)}return NC(a,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[d,h,p]=_C(a,this.gamma.read(),this.beta.read(),i,this.epsilon),m=(e,t,n)=>{tu(()=>{const a=1-n,s=e.read(),r=Nd(qd(s,t),a);e.write(qd(s,r))})};return(()=>{m(this.movingMean,h,this.momentum),m(this.movingVariance,p,this.momentum)})(),d})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gk(this.betaInitializer),gammaInitializer:Gk(this.gammaInitializer),movingMeanInitializer:Gk(this.movingMeanInitializer),movingVarianceInitializer:Gk(this.movingVarianceInitializer),betaRegularizer:uS(this.betaRegularizer),gammaRegularizer:uS(this.gammaRegularizer),betaConstraint:_N(this.betaConstraint),gammaConstraint:_N(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}SC.className="BatchNormalization",zd(SC);class CC extends oN{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));for(const e of this.axis)if(!Number.isInteger(e))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=qk(e.betaInitializer||"zeros"),this.gammaInitializer=qk(e.gammaInitializer||"ones"),this.betaRegularizer=hS(e.betaRegularizer),this.gammaRegularizer=hS(e.gammaRegularizer),this.supportsMasking=!0}build(e){const t=(e=Yk(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=t);for(const s of this.axis)if(s<0||s>=t)throw new Error("Invalid axis: ".concat(s));if(this.axis.length!==Ew(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map(t=>e[t]),a=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,a):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,a):this.beta=null,this.built=!0}call(e,t){const n=Xk(e),a=n.shape,s=a.length;return tu(()=>{let{mean:e,variance:t}=Kf(n,this.axis,!0);const r=yw(1,s);for(const n of this.axis)r[n]=a[n];const i=e=>null!=e&&e.shape.length!==s?$p(e,r):e;let o=this.scale?i(this.gamma.read()):null,l=this.center?i(this.beta.read()):null;const c=[],u=[];for(let n=0;n<s;++n)-1!==this.axis.indexOf(n)?(c.push(a[n]),u.push(1)):(c.push(1),u.push(a[n]));return e=uf(e,c),t=uf(t,c),null!=o&&(o=uf(o,u)),null!=l&&(l=uf(l,u)),NC(n,e,t,l,o,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gk(this.betaInitializer),gammaInitializer:Gk(this.gammaInitializer),betaRegularizer:uS(this.betaRegularizer),gammaRegularizer:uS(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}CC.className="LayerNormalization",zd(CC);class jC extends oN{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new mw("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));let t,n;if("number"===typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new mw("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],2!==e.padding[1].length)throw new mw("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new nN({ndim:4})]}computeOutputShape(e){let t,n;return e=Yk(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return tu(()=>{return t=Xk(e),n=this.padding,a=this.dataFormat,tu(()=>{if(4!==t.rank)throw new mw("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new mw("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a="channelsLast"),"channelsLast"!==a&&"channelsFirst"!==a)throw new mw("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let e;return e="channelsFirst"===a?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],$f(t,e)});var t,n,a})}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}function TC(e,t,n,a,s,r){return tu(()=>{let i;Kw(s),Xw(r),Zw(a),null==n&&(n=[1,1]),null==a&&(a="valid"),null==s&&(s="channelsLast"),null==r&&(r="max"),e=kS(e,s);const o="same"===a?"same":"valid";return i="max"===r?Ff(e,t,n,o):em(e,t,n,o),"channelsFirst"===s&&(i=Ih(i,[0,3,1,2])),i})}function IC(e,t,n,a,s,r){return tu(()=>{let i;Kw(s),Xw(r),Zw(a),null==n&&(n=[1,1,1]),null==a&&(a="valid"),null==s&&(s="channelsLast"),null==r&&(r="max"),e=NS(e,s);const o="same"===a?"same":"valid";return i="max"===r?Pf(e,t,n,o):tm(e,t,n,o),"channelsFirst"===s&&(i=Ih(i,[0,4,1,2,3])),i})}jC.className="ZeroPadding2D",zd(jC);class EC extends oN{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"===typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new mw("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));this.poolSize=e.poolSize}if(Lw(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"===typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new mw("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));this.strides=e.strides}Lw(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,Zw(this.padding),this.inputSpec=[new nN({ndim:3})]}computeOutputShape(e){const t=vS((e=Yk(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return tu(()=>{this.invokeCallHook(e,t),e=uk(Xk(e),2);const n=this.poolingFunction(Xk(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Xg(n,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class AC extends EC{constructor(e){super(e)}poolingFunction(e,t,n,a,s){return Kw(s),Zw(a),TC(e,t,n,a,s,"max")}}AC.className="MaxPooling1D",zd(AC);class RC extends EC{constructor(e){super(e)}poolingFunction(e,t,n,a,s){return Kw(s),Zw(a),TC(e,t,n,a,s,"avg")}}RC.className="AveragePooling1D",zd(RC);class MC extends oN{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new mw("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];Lw(this.poolSize,"poolSize"),Lw(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Kw(this.dataFormat),Zw(this.padding),this.inputSpec=[new nN({ndim:4})]}computeOutputShape(e){e=Yk(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=vS(t,this.poolSize[0],this.padding,this.strides[0]),n=vS(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return tu(()=>(this.invokeCallHook(e,t),this.poolingFunction(Xk(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class LC extends MC{constructor(e){super(e)}poolingFunction(e,t,n,a,s){return Kw(s),Zw(a),TC(e,t,n,a,s,"max")}}LC.className="MaxPooling2D",zd(LC);class DC extends MC{constructor(e){super(e)}poolingFunction(e,t,n,a,s){return Kw(s),Zw(a),TC(e,t,n,a,s,"avg")}}DC.className="AveragePooling2D",zd(DC);class OC extends oN{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new mw("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Lw(this.poolSize,"poolSize"),Lw(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Kw(this.dataFormat),Zw(this.padding),this.inputSpec=[new nN({ndim:5})]}computeOutputShape(e){e=Yk(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],a="channelsFirst"===this.dataFormat?e[4]:e[3];return t=vS(t,this.poolSize[0],this.padding,this.strides[0]),n=vS(n,this.poolSize[1],this.padding,this.strides[1]),a=vS(a,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,a]:[e[0],t,n,a,e[4]]}call(e,t){return tu(()=>(this.invokeCallHook(e,t),this.poolingFunction(Xk(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class FC extends OC{constructor(e){super(e)}poolingFunction(e,t,n,a,s){return Kw(s),Zw(a),IC(e,t,n,a,s,"max")}}FC.className="MaxPooling3D",zd(FC);class PC extends OC{constructor(e){super(e)}poolingFunction(e,t,n,a,s){return Kw(s),Zw(a),IC(e,t,n,a,s,"avg")}}PC.className="AveragePooling3D",zd(PC);class zC extends oN{constructor(e){super(e),this.inputSpec=[new nN({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new fw}}class BC extends zC{constructor(e){super(e||{})}call(e,t){return tu(()=>{const t=Xk(e);return Bf(t,1)})}}BC.className="GlobalAveragePooling1D",zd(BC);class WC extends zC{constructor(e){super(e||{})}call(e,t){return tu(()=>{const t=Xk(e);return ef(t,1)})}}WC.className="GlobalMaxPooling1D",zd(WC);class VC extends oN{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Kw(this.dataFormat),this.inputSpec=[new nN({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new fw}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class UC extends VC{call(e,t){return tu(()=>{const t=Xk(e);return"channelsLast"===this.dataFormat?Bf(t,[1,2]):Bf(t,[2,3])})}}UC.className="GlobalAveragePooling2D",zd(UC);class HC extends VC{call(e,t){return tu(()=>{const t=Xk(e);return"channelsLast"===this.dataFormat?ef(t,[1,2]):ef(t,[2,3])})}}HC.className="GlobalMaxPooling2D",zd(HC);class GC extends oN{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=PN(t.layer,n);delete t.layer;const s={layer:a};return Object.assign(s,t),new e(s)}}class qC extends GC{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=Yk(e)).length<3)throw new mw("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){const t=[(e=Yk(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),a=e[1];return[n[0],a].concat(n.slice(1))}call(e,t){return tu(()=>BS((e,n)=>[Xk(this.layer.call(e,t)),[]],e=Xk(e),[],!1,null,null,!1,!0)[1])}}qC.className="TimeDistributed",zd(qC);class KC extends GC{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=PN(n),t.goBackwards=!0!==t.goBackwards;const a={};var s;if(a.className=e.layer.getClassName(),a.config=t,this.backwardLayer=PN(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,s=this.mergeMode,Rw(Gw,"BidirectionalMergeMode",s),e.weights)throw new fw("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,a,s=this.forwardLayer.computeOutputShape(e);return Array.isArray(s)&&Array.isArray(s[0])||(s=[s]),this.returnState?(a=s.slice(1),t=s[0]):t=s[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(a).concat(a.slice()):[t].concat(a).concat(a.slice()):ww(n)}apply(e,t){let n=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});const s=zS(e,n,a,this.numConstants);if(e=s.inputs,n=s.initialState,a=s.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==a)return super.apply(e,t);const r=[],i=[];if(null!=n){const e=n.length;if(e%2>0)throw new mw("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,r.push(...n);const a=n.map(e=>new nN({shape:e.shape}));this.forwardLayer.stateSpec=a.slice(0,e/2),this.backwardLayer.stateSpec=a.slice(e/2),i.push(...a)}if(null!=a)throw new fw("Support for constants in Bidirectional layers is not implemented yet.");const o=r[0]instanceof aN;for(const l of r)if(l instanceof aN!==o)throw new mw("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){const n=[e].concat(r),a=this.inputSpec.concat(i),s=this.inputSpec;this.inputSpec=a;const o=super.apply(n,t);return this.inputSpec=s,o}return super.apply(e,t)}call(e,t){return tu(()=>{const n=t.initialState;let a,s,r,i;if(null==n)a=this.forwardLayer.call(e,t),s=this.backwardLayer.call(e,t);else{const r=n.slice(0,n.length/2),i=n.slice(n.length/2);a=this.forwardLayer.call(e,Object.assign(t,{initialState:r})),s=this.backwardLayer.call(e,Object.assign(t,{initialState:i}))}return this.returnState&&(Array.isArray(a)&&(r=a.slice(1).concat(s.slice(1))),a=a[0],s=s[0]),this.returnSequences&&(s=Sg(s,1)),"concat"===this.mergeMode?i=mk([a,s]):"sum"===this.mergeMode?i=vd(a,s):"ave"===this.mergeMode?i=Nd(.5,vd(a,s)):"mul"===this.mergeMode?i=Nd(a,s):null==this.mergeMode&&(i=[a,s]),this.returnState?null==this.mergeMode?i.concat(r):[i].concat(r):i})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Jw(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Jw(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){const e=this.forwardLayer.states.map(e=>null);return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=PN(t.layer);if(delete t.layer,null!=t.numConstants)throw new fw("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const a=t;return a.layer=n,new e(a)}}KC.className="Bidirectional",zd(KC);class ZC extends oN{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return tu(()=>("float32"!==(e=Xk(e)).dtype&&(e=ck(e,"float32")),vd(Nd(e,this.scale),this.offset)))}}ZC.className="Rescaling",zd(ZC);const{resizeBilinear:XC,cropAndResize:YC}=My;class JC extends oN{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,a,s,r,i,o){return tu(()=>{let l,c=!1;const u=[t/r,n/i,(a+t)/r,(s+n)/i],d=[];3===e.rank?(c=!0,l=Yg([e])):l=e;for(let e=0;e<l.shape[0];e++)d.push(u);const h=Hc(d,[d.length,4]),p=wg(0,d.length,1,"int32"),m=YC(l,h,p,[a,s],"nearest");return ck(c?Xk(ux(m)):m,o)})}upsize(e,t,n,a){return tu(()=>ck(XC(e,[t,n]),a))}call(e,t){return tu(()=>{const t=Xk(e),n=t.dtype,a=t.shape,s=a[a.length-3],r=a[a.length-2];let i=0;s!==this.height&&(i=Math.floor((s-this.height)/2));let o=0;return r!==this.width&&(o=Math.floor((r-this.width)/2),0===o&&(o=1)),i>=0&&o>=0?this.centerCrop(t,i,o,this.height,this.width,s,r,n):this.upsize(e,this.height,this.width,n)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=Yk(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}JC.className="CenterCrop",zd(JC);class QC extends oN{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=Yk(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return tu(()=>{let n;if("int32"!==(e=Xk(e)).dtype&&(e=ck(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==this.outputMode)throw new mw("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=Xk(t.countWeights)}const a=ef(e),s=tf(e),r=mf(this.numTokens,a).bufferSync().get(0),i=ff(s,0).bufferSync().get(0);if(!r||!i)throw new mw("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return function(e,t,n,a){let s=Xk(e);if("int32"!==s.dtype&&(s=ck(s,"int32")),"int"===t)return s;const r=s.shape;if(0===s.rank&&(s=lf(s,-1)),"oneHot"===t&&1!==s.shape[s.shape.length-1]&&(s=lf(s,-1)),s.rank>2)throw new mw("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(r)+" which would result in output rank ".concat(s.rank,"."));const i=["multiHot","oneHot"].includes(t),o=s;let l;if(l=Mm(o,"undefined"!==typeof a&&"count"===t?a:[],n,i),"tfIdf"!==t)return l;if(a)return Nd(l,a);throw new mw("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)})}}QC.className="CategoryEncoding",zd(QC);const $C=new Set(["bilinear","nearest"]);class ej extends oN{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!$C.has(e.interpolation))throw new mw("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){const t=(e=Yk(e))[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return tu(()=>{const t=[this.height,this.width];if("bilinear"===this.interpolation)return My.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return My.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...$C]," are supported"))})}}ej.className="Resizing",zd(ej);class tj{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}tj.className="RandomSeed";class nj extends oN{constructor(e){super(e),this.randomGenerator=new tj(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}nj.className="BaseRandomLayer";const aj=new Set(["bilinear","nearest"]);class sj extends nj{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new mw("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new mw("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new mw("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n){if(!aj.has(n))throw new mw("Invalid interpolation parameter: ".concat(n," is not implemented"));this.interpolation=n}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=Yk(e))[2];return[this.imgHeight,-1,t]}call(e,t){return tu(()=>{const t=Xk(e);this.imgHeight=t.shape[t.shape.length-3];const n=t.shape[t.shape.length-2];this.widthFactor=bg([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*n;a=Math.round(a);const s=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return My.resizeBilinear(e,s);case"nearest":return My.resizeNearestNeighbor(e,s);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...aj]," are supported"))}})}}sj.className="RandomWidth",zd(sj);var rj,ij;Vs().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(rj||(rj={})),function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(ij||(ij={}));const oj={};function lj(e){return oj[e]}function cj(e,t,n,a,s){const r=t.inputParams[e];if(r&&void 0!==r.inputIndexStart){const e=r.inputIndexStart,i=0===r.inputIndexEnd?void 0:void 0===r.inputIndexEnd?e+1:r.inputIndexEnd,o=e<0?t.inputNames.length+e:e;if("tensor"===r.type)return uj(t.inputNames[o],n,a,s);if("tensors"===r.type){const r=t.inputs.slice(e,i);return t.inputNames.slice(e,i).filter((e,t)=>{var n;return"NoOp"!==(null===(n=r[t])||void 0===n?void 0:n.op)}).map(e=>uj(e,n,a,s))}const l=uj(t.inputNames[o],n,a,s),c=l.dataSync();return"number"===r.type?c[0]:Es(l.shape,c)}const i=t.attrParams[e];return i&&i.value}function uj(e,t,n,a){const[s,r]=mj(e,n);if(null!=a){const e=a.getHashTableHandleByName(s);if(null!=e)return e}const i=n.currentContextIds.find(e=>!!t[pj(s,e)]);return void 0!==i?t[pj(s,i)][r]:void 0}function dj(e,t,n){return t[pj(e,n.currentContextId)]}function hj(e,t){const[n,a,s]=mj(e,t);return[pj(n,t&&t.currentContextId),a,s]}function pj(e,t){return t?"".concat(e,"-").concat(t):e}function mj(e,t){if(""===e)return["",0,void 0];const n=null!=t&&null!=t.parseNodeNameCache;if(n){const n=t.parseNodeNameCache.get(e);if(null!=n)return n}const a=e.split(":");let s;if(1===a.length)s=[e,0,void 0];else{const e=a[0],t=3===a.length?a[1]:void 0;s=[e,Number(a[a.length-1]),t]}return n&&t.parseNodeNameCache.set(e,s),s}function fj(e,t,n){let a=cj("pad",e,t,n);if("explicit"===a){a=cj("explicitPaddings",e,t,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)s[e][0]=a[2*e],s[e][1]=a[2*e+1];return s}return a}function gj(e){return e.kept?e:yd(e)}const xj=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],yj=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],bj=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],vj=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],wj=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],kj=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Nj=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],_j=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Sj=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Cj=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],jj=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Tj=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Ij=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Ej=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Aj=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Rj=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Mj=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Lj=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Dj=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class Oj{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[y,b,v,w,k,N,_,S,C,j,T,I,E,A,R,M,L,D,O].map(e=>e.json));this.opMappers=e.reduce((e,t)=>(e[t.tfOpName]=t,e),{})}transformGraph(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.node,a=[],s=[],r=[],i=n.reduce((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?a.push(e[t.name]):"Const"===t.op?s.push(e[t.name]):null!=t.input&&0!==t.input.length||r.push(e[t.name]),e),{});let o=[];const l=[];let c={},u={};null!=t&&(c=this.mapSignatureEntries(t.inputs),u=this.mapSignatureEntries(t.outputs));const d=Object.keys(i);d.forEach(e=>{const t=i[e];t.inputNames.forEach((e,n)=>{const[a,,s]=hj(e),r=i[a];if(null!=r.outputs){const e=r.outputs.indexOf(s);if(-1!==e){const s="".concat(a,":").concat(e);t.inputNames[n]=s}}t.inputs.push(r),r.children.push(t)})}),0===Object.keys(u).length?d.forEach(e=>{const t=i[e];0===t.children.length&&l.push(t)}):Object.keys(u).forEach(e=>{const[t]=hj(e),n=i[t];null!=n&&(n.signatureKey=u[e],l.push(n))}),Object.keys(c).length>0?Object.keys(c).forEach(e=>{const[t]=hj(e),n=i[t];n&&(n.signatureKey=c[e],o.push(n))}):o=a;let h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce((e,t)=>(e[t.signature.name]=this.mapFunction(t),e),{}));const p={nodes:i,inputs:o,outputs:l,weights:s,placeholders:a,signature:t,functions:h};return r.length>0&&(p.initNodes=r),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){const t=lj(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(e=>e.startsWith("^")?e.slice(1):e),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((t,n)=>{const a=n.type;let s;switch(n.type){case"string":s=Pj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=Pj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":s=Zj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=Zj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":s=Bj(e.attr,n.tfName,n.defaultValue||0),void 0===s&&n.tfDeprecatedName&&(s=Bj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":s=Kj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=Kj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":s=zj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=zj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":s=Yj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=Yj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":s=qj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=qj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":s=Xj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=Xj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":s=Uj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=Uj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":s=Hj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=Hj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":s=Vj(e.attr,n.tfName,n.defaultValue),void 0===s&&n.tfDeprecatedName&&(s=Vj(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:s,type:a},t},{})),n}mapFunction(e){const t=e.nodeDef,n=[];let a={};null!=t&&(a=t.reduce((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e),{}));const s=[],r=[];e.signature.inputArg.forEach(e=>{const[t]=hj(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Wj(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,s.push(n),a[t]=n});Object.keys(a).forEach(e=>{const t=a[e];t.inputNames.forEach((e,n)=>{const[s,,r]=hj(e),i=a[s];if(null!=i.outputs){const e=i.outputs.indexOf(r);if(-1!==e){const a="".concat(s,":").concat(e);t.inputNames[n]=a}}t.inputs.push(i),i.children.push(t)})});const i=e.ret;e.signature.outputArg.forEach(e=>{const[t,n]=hj(i[e.name]),s=a[t];null!=s&&(s.defaultOutput=n,r.push(s))});const o=this.mapArgsToSignature(e);return{nodes:a,inputs:s,outputs:r,weights:n,placeholders:[],signature:o}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}function Fj(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const t=Vs().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function Pj(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=e[t];return null!=s?Fj(s.s,a):n}function zj(e,t,n){const a=e[t];return a?a.b:n}function Bj(e,t,n){const a=e[t]||{},s=null!=a.i?a.i:null!=a.f?a.f:n;return"number"===typeof s?s:parseInt(s,10)}function Wj(e){switch("string"===typeof e&&(e=rj[e]),e){case rj.DT_FLOAT:case rj.DT_HALF:return"float32";case rj.DT_INT32:case rj.DT_INT64:case rj.DT_INT8:case rj.DT_UINT8:return"int32";case rj.DT_BOOL:return"bool";case rj.DT_DOUBLE:return"float32";case rj.DT_STRING:return"string";case rj.DT_COMPLEX64:case rj.DT_COMPLEX128:return"complex64";default:return null}}function Vj(e,t,n){const a=e[t];return a&&a.func?a.func.name:n}function Uj(e,t,n){const a=e[t];return a&&a.type?Wj(a.type):n}function Hj(e,t,n){const a=e[t];return a&&a.list&&a.list.type?a.list.type.map(e=>Wj(e)):n}function Gj(e){if(!e.unknownRank)return null!=e.dim?e.dim.map(e=>"number"===typeof e.size?e.size:parseInt(e.size,10)):[]}function qj(e,t,n){const a=e[t];return a&&a.shape?Gj(a.shape):n}function Kj(e,t,n){const a=e[t];return a?((a.list.f&&a.list.f.length?a.list.f:a.list.i)||[]).map(e=>"number"===typeof e?e:parseInt(e,10)):n}function Zj(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=e[t];return s&&s.list&&s.list.s?s.list.s.map(e=>Fj(e,a)):n}function Xj(e,t,n){const a=e[t];return a&&a.list&&a.list.shape?a.list.shape.map(e=>Gj(e)):n}function Yj(e,t,n){const a=e[t];return a&&a.list&&a.list.b?a.list.b:n}class Jj{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(e=>this.getInput(e)),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((e,t)=>(e[t]=this.getAttr(t),e),{}))}getInput(e){return uj(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(null!=n.tensor)return uj(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Bj(this.node.rawAttrs,e,t);if(null!=n.s)return Pj(this.node.rawAttrs,e,t);if(null!=n.b)return zj(this.node.rawAttrs,e,t);if(null!=n.shape)return qj(this.node.rawAttrs,e,t);if(null!=n.type)return Uj(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Kj(this.node.rawAttrs,e,t);if(null!=n.list.s)return Zj(this.node.rawAttrs,e,t);if(null!=n.list.shape)return Xj(this.node.rawAttrs,e,t);if(null!=n.list.b)return Yj(this.node.rawAttrs,e,t);if(null!=n.list.type)return Hj(this.node.rawAttrs,e,t)}return t}}function Qj(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){$a(e.length===t.length,()=>n+" Shapes ".concat(e," and ").concat(t," must match"));for(let a=0;a<e.length;a++){const s=e[a],r=t[a];$a(s<0||r<0||s===r,()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}}}function $j(e){return"number"!==typeof e&&!e.some(e=>e<0)}function eT(e,t,n){let a=tT(e,n);const s=!$j(a);if(s&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(a));if(s&&t.forEach(e=>{a=tT(e.shape,a)}),!$j(a))throw new Error("Non-fully-defined elementShape: ".concat(a));return a}function tT(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));const n=[];for(let a=0;a<e.length;++a){const s=e[a],r=t[a];if(s>=0&&r>=0&&s!==r)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[a]=s>=0?s:r}return n}class nT{constructor(e,t,n,a,s,r,i){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=a,this.identicalElementShapes=s,this.dynamicSize=r,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=Ld(0),au(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{null!=e&&e.has(t.tensor.id)||t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));const t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(e=>this.read(e))}write(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),Qj(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,au(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((e,n)=>this.write(e,t[n]))}gather(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return Hc([],[0].concat(this.elementShape));const n=this.readMany(e);return Qj(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Yg(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return Hc([],[0].concat(this.elementShape));const t=[];for(let a=0;a<this.size();a++)t.push(a);const n=this.readMany(t);return Qj(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),nm(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,ux(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));let n=0;const a=e.map(e=>(n+=e,n));if(n!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");const s=0===n?0:t.size/n,r=[];tu(()=>{t=$p(t,[1,n,s]);for(let n=0;n<e.length;++n){const i=[0,0===n?0:a[n-1],0],o=[1,e[n],s];r[n]=$p(sm(t,i,o),this.elementShape)}return r});const i=[];for(let o=0;o<e.length;o++)i[o]=o;this.writeMany(i,r)}}class aT{get id(){return this.idTensor.id}constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach(e=>{if(n!==e.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(e.dtype));Qj(t,e.shape,"TensorList shape mismatch: "),au(e)}),this.idTensor=Ld(0),this.maxNumElements=a,au(this.idTensor)}copy(){return new aT([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{null!=e&&e.has(t.id)||t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));Qj(e,this.elementShape,"TensorList shape mismatch: ");const a=eT(this.elementShape,this.tensors,e);return tu(()=>{const e=this.tensors.map(e=>$p(e,a));return Yg(e,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=eT(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,Qj(a.shape,e,"TensorList shape mismatch: "),$p(a,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(Qj(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");au(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));const t=new aT([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));Qj(this.tensors[e].shape,t,"TensorList shape mismatch: ");const a=eT(this.elementShape,this.tensors,t);return $p(this.tensors[e],a)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));Qj(this.elementShape,t.shape,"TensorList shape mismatch: "),au(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));Qj(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=eT(this.elementShape,this.tensors,n);return 0===e.length?Hc([],[0].concat(a)):tu(()=>{const t=e.map(e=>$p(this.tensors[e],a));return Yg(t,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));Qj(this.elementShape,t,"TensorList shape mismatch: ");const n=eT(this.elementShape,this.tensors,t);return 0===this.size()?Hc([],[0].concat(n)):tu(()=>{const e=this.tensors.map(e=>$p(e,n));return nm(e,0)})}}const sT=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const a=cj("thenBranch",e,t,n),s=cj("elseBranch",e,t,n),r=cj("cond",e,t,n),i=cj("args",e,t,n);return(await r.data())[0]?n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const a=cj("body",e,t,n),s=cj("cond",e,t,n),r=cj("args",e,t,n),i=await n.functionMap[s].executeFunctionAsync(r,n.tensorArrayMap,n.tensorListMap),o=r.map(e=>e.id);let l=await i[0].data();i.forEach(e=>{e.kept||-1!==o.indexOf(e.id)||e.dispose()});let c=r;for(;l[0];){const e=c;c=await n.functionMap[a].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const t=c.map(e=>e.id);e.forEach(e=>{e.kept||-1!==o.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()});const r=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await r[0].data(),r.forEach(e=>{e.kept||-1!==o.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()})}return c}case"LoopCond":return[gj(cj("pred",e,t,n))];case"Switch":{const a=cj("pred",e,t,n);let s=cj("data",e,t,n);return s.kept||(s=gj(s)),(await a.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const a=e.inputNames.find(e=>void 0!==uj(e,t,n));if(a){return[gj(uj(a,t,n))]}return}case"Enter":{const a=cj("frameName",e,t,n),s=cj("tensor",e,t,n);return n.enterFrame(a),[gj(s)]}case"Exit":{const a=cj("tensor",e,t,n);return n.exitFrame(),[gj(a)]}case"NextIteration":{const a=cj("tensor",e,t,n);return n.nextIteration(),[gj(a)]}case"TensorArrayV3":{const a=cj("size",e,t,n),s=cj("dtype",e,t,n),r=cj("elementShape",e,t,n),i=cj("dynamicSize",e,t,n),o=cj("clearAfterRead",e,t,n),l=cj("identicalElementShapes",e,t,n),c=cj("name",e,t,n),u=new nT(c,s,a,r,l,i,o);return n.addTensorArray(u),[u.idTensor,Ld(1)]}case"TensorArrayWriteV3":{const a=cj("tensorArrayId",e,t,n),s=cj("index",e,t,n),r=cj("tensor",e,t,n),i=n.getTensorArray(a.id);return i.write(s,r),[i.idTensor]}case"TensorArrayReadV3":{const a=cj("tensorArrayId",e,t,n),s=cj("index",e,t,n);return[n.getTensorArray(a.id).read(s)]}case"TensorArrayGatherV3":{const a=cj("tensorArrayId",e,t,n),s=cj("indices",e,t,n),r=cj("dtype",e,t,n);return[n.getTensorArray(a.id).gather(s,r)]}case"TensorArrayScatterV3":{const a=cj("tensorArrayId",e,t,n),s=cj("indices",e,t,n),r=cj("tensor",e,t,n),i=n.getTensorArray(a.id);return i.scatter(s,r),[i.idTensor]}case"TensorArrayConcatV3":{const a=cj("tensorArrayId",e,t,n),s=n.getTensorArray(a.id),r=cj("dtype",e,t,n);return[s.concat(r)]}case"TensorArraySplitV3":{const a=cj("tensorArrayId",e,t,n),s=cj("tensor",e,t,n),r=cj("lengths",e,t,n),i=n.getTensorArray(a.id);return i.split(r,s),[i.idTensor]}case"TensorArraySizeV3":{const a=cj("tensorArrayId",e,t,n);return[Ld(n.getTensorArray(a.id).size(),"int32")]}case"TensorArrayCloseV3":{const a=cj("tensorArrayId",e,t,n),s=n.getTensorArray(a.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const a=cj("tensorListId",e,t,n),s=cj("index",e,t,n),r=cj("tensor",e,t,n),i=n.getTensorList(a.id);return i.setItem(s,r),[i.idTensor]}case"TensorListGetItem":{const a=cj("tensorListId",e,t,n),s=cj("index",e,t,n),r=cj("elementShape",e,t,n),i=cj("elementDType",e,t,n);return[n.getTensorList(a.id).getItem(s,r,i)]}case"TensorListScatterV2":case"TensorListScatter":{const a=cj("indices",e,t,n),s=function(e,t,n,a){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));const s=Math.max(...t);if(null!=a&&-1!==a&&s>=a)throw new Error("Max index must be < array size (".concat(s,"  vs. ").concat(a,")"));const r=new aT([],n,e.dtype,a),i=ux(e,0);return t.forEach((e,t)=>{r.setItem(e,i[t])}),r}(cj("tensor",e,t,n),a,cj("elementShape",e,t,n),cj("numElements",e,t,n));return n.addTensorList(s),[s.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const a=cj("elementShape",e,t,n),s=cj("elementDType",e,t,n);let r;r="TensorListReserve"===e.op?"numElements":"maxNumElements";const i=cj(r,e,t,n),o=function(e,t,n,a){return new aT([],e,t,a)}(a,s,0,"TensorListReserve"===e.op?-1:i);return n.addTensorList(o),[o.idTensor]}case"TensorListGather":{const a=cj("tensorListId",e,t,n),s=cj("indices",e,t,n),r=cj("elementShape",e,t,n),i=cj("elementDType",e,t,n);return[n.getTensorList(a.id).gather(s,i,r)]}case"TensorListStack":{const a=cj("tensorListId",e,t,n),s=cj("elementShape",e,t,n),r=cj("elementDType",e,t,n),i=cj("numElements",e,t,n);return[n.getTensorList(a.id).stack(s,r,i)]}case"TensorListFromTensor":{const a=function(e,t,n){const a=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));Qj(e.shape.slice(1),t,"TensorList shape mismatch: ");const s=ux(e);return new aT(s,t,a)}(cj("tensor",e,t,n),cj("elementShape",e,t,n),cj("elementDType",e,t,n));return n.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const a=cj("tensorListId",e,t,n),s=n.getTensorList(a.id),r=cj("dtype",e,t,n),i=cj("elementShape",e,t,n);return[s.concat(r,i)]}case"TensorListPushBack":{const a=cj("tensorListId",e,t,n),s=cj("tensor",e,t,n),r=n.getTensorList(a.id);return r.pushBack(s),[r.idTensor]}case"TensorListPopBack":{const a=cj("tensorListId",e,t,n),s=cj("elementShape",e,t,n),r=cj("elementDType",e,t,n);return[n.getTensorList(a.id).popBack(s,r)]}case"TensorListSplit":{const a=cj("tensor",e,t,n),s=cj("elementShape",e,t,n),r=function(e,t,n){let a=0;const s=t.map(e=>(a+=e,a));if(a!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(a,", and tensor's shape is: ").concat(e.shape));const r=tT(e.shape.slice(1),n),i=0===a?0:e.size/a,o=tu(()=>{const n=[];e=$p(e,[1,a,i]);for(let a=0;a<t.length;++a){const o=[0,0===a?0:s[a-1],0],l=[1,t[a],i];n[a]=$p(sm(e,o,l),r)}return e.dispose(),n}),l=new aT([],n,e.dtype,t.length);for(let c=0;c<o.length;c++)l.setItem(c,o[c]);return l}(a,cj("lengths",e,t,n),s);return n.addTensorList(r),[r.idTensor]}case"TensorListLength":{const a=cj("tensorListId",e,t,n);return[Ld(n.getTensorList(a.id).size(),"int32")]}case"TensorListResize":{const a=cj("tensorListId",e,t,n),s=cj("size",e,t,n),r=n.getTensorList(a.id).resize(s);return n.addTensorList(r),[r.idTensor]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function rT(e,t,n){const[a,s]=cj("fusedOps",e,t,n),r="biasadd"===a,i=!r,o="prelu"===s,l="fusedbatchnorm"===a,c=cj("numArgs",e,t,n);if(r){if(o&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&r&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=cj("strides",e,t,n),d=fj(e,t,n),h=cj("dataFormat",e,t,n).toUpperCase(),p=cj("dilations",e,t,n);let[m,f]=cj("args",e,t,n);i&&(f=m,m=void 0);return{stride:u,pad:d,dataFormat:h,dilations:p,biasArg:m,preluArg:f,activationFunc:s,leakyreluAlpha:cj("leakyreluAlpha",e,t,n)}}function iT(e,t,n){return{boxes:cj("boxes",e,t,n),scores:cj("scores",e,t,n),maxOutputSize:cj("maxOutputSize",e,t,n),iouThreshold:cj("iouThreshold",e,t,n),scoreThreshold:cj("scoreThreshold",e,t,n),softNmsSigma:cj("softNmsSigma",e,t,n)}}class oT{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Ld(0),this.tensorMap=new Map,au(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ld(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),tu(()=>{const e=ux(t),a=n.length,s=e.length;$a(a===s,()=>"The number of elements doesn't match, keys has "+"".concat(a," elements, the values has ").concat(s," ")+"elements.");for(let t=0;t<a;t++){const a=n[t],s=e[t];au(s),this.tensorMap.set(a,s)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return tu(()=>{const e=[];for(let a=0;a<n.length;a++){const s=n[a],r=this.findWithDefault(s,t);e.push(r)}return Yg(e)})}findWithDefault(e,t){const n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}function lT(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:tu;const r=((e,t,n)=>{switch(e.category){case"arithmetic":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[a.add(cj("a",e,t,n),cj("b",e,t,n))];case"AddN":return[a.addN(cj("tensors",e,t,n))];case"FloorMod":case"Mod":return[a.mod(cj("a",e,t,n),cj("b",e,t,n))];case"Mul":return[a.mul(cj("a",e,t,n),cj("b",e,t,n))];case"RealDiv":case"Div":return[a.div(cj("a",e,t,n),cj("b",e,t,n))];case"DivNoNan":return[a.divNoNan(cj("a",e,t,n),cj("b",e,t,n))];case"FloorDiv":return[a.floorDiv(cj("a",e,t,n),cj("b",e,t,n))];case"Sub":return[a.sub(cj("a",e,t,n),cj("b",e,t,n))];case"Minimum":return[a.minimum(cj("a",e,t,n),cj("b",e,t,n))];case"Maximum":return[a.maximum(cj("a",e,t,n),cj("b",e,t,n))];case"Pow":return[a.pow(cj("a",e,t,n),cj("b",e,t,n))];case"SquaredDifference":return[a.squaredDifference(cj("a",e,t,n),cj("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"basic_math":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"Abs":case"ComplexAbs":return[a.abs(cj("x",e,t,n))];case"Acos":return[a.acos(cj("x",e,t,n))];case"Acosh":return[a.acosh(cj("x",e,t,n))];case"Asin":return[a.asin(cj("x",e,t,n))];case"Asinh":return[a.asinh(cj("x",e,t,n))];case"Atan":return[a.atan(cj("x",e,t,n))];case"Atan2":return[a.atan2(cj("x",e,t,n),cj("y",e,t,n))];case"Atanh":return[a.atanh(cj("x",e,t,n))];case"Ceil":return[a.ceil(cj("x",e,t,n))];case"Complex":return[a.complex(cj("real",e,t,n),cj("imag",e,t,n))];case"Cos":return[a.cos(cj("x",e,t,n))];case"Cosh":return[a.cosh(cj("x",e,t,n))];case"Elu":return[a.elu(cj("x",e,t,n))];case"Erf":return[a.erf(cj("x",e,t,n))];case"Exp":return[a.exp(cj("x",e,t,n))];case"Expm1":return[a.expm1(cj("x",e,t,n))];case"Floor":return[a.floor(cj("x",e,t,n))];case"Log":return[a.log(cj("x",e,t,n))];case"Log1p":return[a.log1p(cj("x",e,t,n))];case"Imag":return[a.imag(cj("x",e,t,n))];case"Neg":return[a.neg(cj("x",e,t,n))];case"Reciprocal":return[a.reciprocal(cj("x",e,t,n))];case"Real":return[a.real(cj("x",e,t,n))];case"Relu":return[a.relu(cj("x",e,t,n))];case"Round":return[a.round(cj("x",e,t,n))];case"Selu":return[a.selu(cj("x",e,t,n))];case"Sigmoid":return[a.sigmoid(cj("x",e,t,n))];case"Sin":return[a.sin(cj("x",e,t,n))];case"Sign":return[a.sign(cj("x",e,t,n))];case"Sinh":return[a.sinh(cj("x",e,t,n))];case"Softplus":return[a.softplus(cj("x",e,t,n))];case"Sqrt":return[a.sqrt(cj("x",e,t,n))];case"Square":return[a.square(cj("x",e,t,n))];case"Tanh":return[a.tanh(cj("x",e,t,n))];case"Tan":return[a.tan(cj("x",e,t,n))];case"ClipByValue":return[a.clipByValue(cj("x",e,t,n),cj("clipValueMin",e,t,n),cj("clipValueMax",e,t,n))];case"Relu6":return[a.relu6(cj("x",e,t,n))];case"Rsqrt":return[a.rsqrt(uj(e.inputNames[0],t,n))];case"LeakyRelu":return[a.leakyRelu(cj("x",e,t,n),cj("alpha",e,t,n))];case"Prelu":return[a.prelu(cj("x",e,t,n),cj("alpha",e,t,n))];case"IsNan":return[a.isNaN(uj(e.inputNames[0],t,n))];case"IsInf":return[a.isInf(uj(e.inputNames[0],t,n))];case"IsFinite":return[a.isFinite(uj(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"control":return sT(e,t,n);case"convolution":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"Conv1D":{const s=cj("stride",e,t,n),r=cj("pad",e,t,n),i=cj("dataFormat",e,t,n).toUpperCase(),o=cj("dilation",e,t,n);return[a.conv1d(cj("x",e,t,n),cj("filter",e,t,n),s,r,i,o)]}case"Conv2D":{const s=cj("strides",e,t,n),r=fj(e,t,n),i=cj("dataFormat",e,t,n).toUpperCase(),o=cj("dilations",e,t,n);return[a.conv2d(cj("x",e,t,n),cj("filter",e,t,n),[s[1],s[2]],r,i,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:s,pad:r,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=rT(e,t,n);return[a.fused.conv2d({x:cj("x",e,t,n),filter:cj("filter",e,t,n),strides:[s[1],s[2]],pad:r,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:r,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=rT(e,t,n);return[a.fused.depthwiseConv2d({x:cj("x",e,t,n),filter:cj("filter",e,t,n),strides:[s[1],s[2]],pad:r,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=cj("outputShape",e,t,n),r=cj("strides",e,t,n),i=fj(e,t,n);return[a.conv2dTranspose(cj("x",e,t,n),cj("filter",e,t,n),s,[r[1],r[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=cj("strides",e,t,n),r=fj(e,t,n),i=cj("dilations",e,t,n),o=cj("dataFormat",e,t,n).toUpperCase();return[a.depthwiseConv2d(cj("input",e,t,n),cj("filter",e,t,n),[s[1],s[2]],r,o,[i[1],i[2]])]}case"Conv3D":{const s=cj("strides",e,t,n),r=cj("pad",e,t,n),i=cj("dataFormat",e,t,n).toUpperCase(),o=cj("dilations",e,t,n);return[a.conv3d(cj("x",e,t,n),cj("filter",e,t,n),[s[1],s[2],s[3]],r,i,[o[1],o[2],o[3]])]}case"AvgPool":{const s=cj("strides",e,t,n),r=cj("pad",e,t,n),i=cj("kernelSize",e,t,n);return[a.avgPool(cj("x",e,t,n),[i[1],i[2]],[s[1],s[2]],r)]}case"MaxPool":{const s=cj("strides",e,t,n),r=cj("pad",e,t,n),i=cj("kernelSize",e,t,n);return[a.maxPool(cj("x",e,t,n),[i[1],i[2]],[s[1],s[2]],r)]}case"MaxPoolWithArgmax":{const s=cj("strides",e,t,n),r=cj("pad",e,t,n),i=cj("kernelSize",e,t,n),o=cj("includeBatchInIndex",e,t,n),{result:l,indexes:c}=a.maxPoolWithArgmax(cj("x",e,t,n),[i[1],i[2]],[s[1],s[2]],r,o);return[l,c]}case"AvgPool3D":{const s=cj("strides",e,t,n),r=cj("pad",e,t,n),i=cj("kernelSize",e,t,n);return[a.avgPool3d(cj("x",e,t,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],r)]}case"MaxPool3D":{const s=cj("strides",e,t,n),r=cj("pad",e,t,n),i=cj("kernelSize",e,t,n);return[a.maxPool3d(cj("x",e,t,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],r)]}case"Dilation2D":{const s=cj("strides",e,t,n),r=cj("pad",e,t,n),i=cj("dilations",e,t,n),o=s[1],l=s[2],c=i[1],u=i[2];return[a.dilation2d(cj("x",e,t,n),cj("filter",e,t,n),[o,l],r,[c,u],"NHWC")]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"creation":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"Fill":{const s=cj("shape",e,t,n),r=cj("dtype",e,t,n),i=cj("value",e,t,n);return[a.fill(s,i,r)]}case"LinSpace":{const s=cj("start",e,t,n),r=cj("stop",e,t,n),i=cj("num",e,t,n);return[a.linspace(s,r,i)]}case"Multinomial":{const s=cj("logits",e,t,n),r=cj("numSamples",e,t,n),i=cj("seed",e,t,n);return[a.multinomial(s,r,i)]}case"OneHot":{const s=cj("indices",e,t,n),r=cj("depth",e,t,n),i=cj("onValue",e,t,n),o=cj("offValue",e,t,n),l=cj("dtype",e,t,n);return[a.oneHot(s,r,i,o,l)]}case"Ones":return[a.ones(cj("shape",e,t,n),cj("dtype",e,t,n))];case"OnesLike":return[a.onesLike(cj("x",e,t,n))];case"RandomStandardNormal":return[a.randomStandardNormal(cj("shape",e,t,n),cj("dtype",e,t,n),cj("seed",e,t,n))];case"RandomUniform":return[a.randomUniform(cj("shape",e,t,n),cj("minval",e,t,n),cj("maxval",e,t,n),cj("dtype",e,t,n))];case"RandomUniformInt":return[a.randomUniformInt(cj("shape",e,t,n),cj("minval",e,t,n),cj("maxval",e,t,n),cj("seed",e,t,n))];case"Range":{const s=cj("start",e,t,n),r=cj("stop",e,t,n),i=cj("step",e,t,n);return[a.range(s,r,i,cj("dtype",e,t,n))]}case"TruncatedNormal":{const s=cj("shape",e,t,n),r=cj("mean",e,t,n),i=cj("stdDev",e,t,n),o=cj("seed",e,t,n);return[a.truncatedNormal(s,r,i,cj("dtype",e,t,n),o)]}case"Zeros":return[a.zeros(cj("shape",e,t,n),cj("dtype",e,t,n))];case"ZerosLike":return[a.zerosLike(cj("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"dynamic":return async function(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:F;switch(e.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:r,maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=iT(e,t,n),u=await s.image.nonMaxSuppressionWithScoreAsync(a,r,i,o,l,c);return[u.selectedIndices,u.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:r,maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=iT(e,t,n),c=cj("padToMaxOutputSize",e,t,n),u=await s.image.nonMaxSuppressionPaddedAsync(a,r,i,o,l,c);return[u.selectedIndices,u.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:r,maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=iT(e,t,n);return[await s.image.nonMaxSuppressionAsync(a,r,i,o,l)]}case"Where":{const a=s.cast(cj("condition",e,t,n),"bool"),r=[await s.whereAsync(a)];return a.dispose(),r}case"ListDiff":return s.setdiff1dAsync(cj("x",e,t,n),cj("y",e,t,n));default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n);case"evaluation":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"LowerBound":{const s=cj("sortedSequence",e,t,n),r=cj("values",e,t,n);return[a.lowerBound(s,r)]}case"TopKV2":{const s=cj("x",e,t,n),r=cj("k",e,t,n),i=cj("sorted",e,t,n),o=a.topk(s,r,i);return[o.values,o.indices]}case"UpperBound":{const s=cj("sortedSequence",e,t,n),r=cj("values",e,t,n);return[a.upperBound(s,r)]}case"Unique":{const s=cj("x",e,t,n),r=a.unique(s);return[r.values,r.indices]}case"UniqueV2":{const s=cj("x",e,t,n),r=cj("axis",e,t,n),i=a.unique(s,r);return[i.values,i.indices]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"image":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"ResizeBilinear":{const s=cj("images",e,t,n),r=cj("size",e,t,n),i=cj("alignCorners",e,t,n),o=cj("halfPixelCenters",e,t,n);return[a.image.resizeBilinear(s,[r[0],r[1]],i,o)]}case"ResizeNearestNeighbor":{const s=cj("images",e,t,n),r=cj("size",e,t,n),i=cj("alignCorners",e,t,n),o=cj("halfPixelCenters",e,t,n);return[a.image.resizeNearestNeighbor(s,[r[0],r[1]],i,o)]}case"CropAndResize":{const s=cj("image",e,t,n),r=cj("boxes",e,t,n),i=cj("boxInd",e,t,n),o=cj("cropSize",e,t,n),l=cj("method",e,t,n),c=cj("extrapolationValue",e,t,n);return[a.image.cropAndResize(s,r,i,o,l,c)]}case"ImageProjectiveTransformV3":{const s=cj("images",e,t,n),r=cj("transforms",e,t,n),i=cj("outputShape",e,t,n),o=cj("fillValue",e,t,n),l=cj("interpolation",e,t,n),c=cj("fillMode",e,t,n);return[a.image.transform(s,r,l.toLowerCase(),c.toLowerCase(),o,i)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"graph":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const s=cj("default",e,t,n);return[uj(e.name,t,n)||s];case"Placeholder":return[uj(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[gj(cj("x",e,t,n))];case"IdentityN":return cj("x",e,t,n).map(e=>gj(e));case"Shape":return[a.tensor1d(cj("x",e,t,n).shape,"int32")];case"ShapeN":return cj("x",e,t,n).map(e=>a.tensor1d(e.shape));case"Size":return[a.scalar(cj("x",e,t,n).size,"int32")];case"Rank":return[a.scalar(cj("x",e,t,n).rank,"int32")];case"NoOp":return[a.scalar(1)];case"Print":const r=cj("x",e,t,n),i=cj("data",e,t,n),o=cj("message",e,t,n),l=cj("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(let e=0;e<i.length;e++)console.log(Array.prototype.slice.call(i[e].dataSync()).slice(0,l));return[r];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"logical":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"Equal":return[a.equal(cj("a",e,t,n),cj("b",e,t,n))];case"NotEqual":return[a.notEqual(cj("a",e,t,n),cj("b",e,t,n))];case"Greater":return[a.greater(cj("a",e,t,n),cj("b",e,t,n))];case"GreaterEqual":return[a.greaterEqual(cj("a",e,t,n),cj("b",e,t,n))];case"Less":return[a.less(cj("a",e,t,n),cj("b",e,t,n))];case"LessEqual":return[a.lessEqual(cj("a",e,t,n),cj("b",e,t,n))];case"LogicalAnd":return[a.logicalAnd(cj("a",e,t,n),cj("b",e,t,n))];case"LogicalNot":return[a.logicalNot(cj("a",e,t,n))];case"LogicalOr":return[a.logicalOr(cj("a",e,t,n),cj("b",e,t,n))];case"Select":case"SelectV2":return[a.where(cj("condition",e,t,n),cj("a",e,t,n),cj("b",e,t,n))];case"BitwiseAnd":return[a.bitwiseAnd(cj("a",e,t,n),cj("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"matrices":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[a.matMul(cj("a",e,t,n),cj("b",e,t,n),cj("transposeA",e,t,n),cj("transposeB",e,t,n))];case"Einsum":return[a.einsum(cj("equation",e,t,n),...cj("tensors",e,t,n))];case"Transpose":return[a.transpose(cj("x",e,t,n),cj("perm",e,t,n))];case"_FusedMatMul":const[s,r]=cj("fusedOps",e,t,n),i="biasadd"===s,o="prelu"===r,l=cj("numArgs",e,t,n),c=cj("leakyreluAlpha",e,t,n);if(i){if(o&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=cj("args",e,t,n);return[a.fused.matMul({a:cj("a",e,t,n),b:cj("b",e,t,n),transposeA:cj("transposeA",e,t,n),transposeB:cj("transposeB",e,t,n),bias:u,activation:r,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[a.linalg.bandPart(cj("a",e,t,n),cj("numLower",e,t,n),cj("numUpper",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"normalization":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"EuclideanNorm":return[a.euclideanNorm(cj("x",e,t,n),cj("axis",e,t,n),cj("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[a.batchNorm(cj("x",e,t,n),cj("mean",e,t,n),cj("variance",e,t,n),cj("offset",e,t,n),cj("scale",e,t,n),cj("epsilon",e,t,n))];case"LRN":return[a.localResponseNormalization(cj("x",e,t,n),cj("radius",e,t,n),cj("bias",e,t,n),cj("alpha",e,t,n),cj("beta",e,t,n))];case"Softmax":return[a.softmax(cj("x",e,t,n))];case"LogSoftmax":return[a.logSoftmax(cj("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"ragged":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:r}=a.raggedGather(cj("paramsNestedSplits",e,t,n),cj("paramsDenseValues",e,t,n),cj("indices",e,t,n),cj("outputRaggedRank",e,t,n));return s.concat(r)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:r}=a.raggedRange(cj("starts",e,t,n),cj("limits",e,t,n),cj("splits",e,t,n));return[s,r]}case"RaggedTensorToTensor":return[a.raggedTensorToTensor(cj("shape",e,t,n),cj("values",e,t,n),cj("defaultValue",e,t,n),cj("rowPartitionTensors",e,t,n),cj("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"reduction":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"Max":{const s=cj("axis",e,t,n),r=cj("keepDims",e,t,n);return[a.max(cj("x",e,t,n),s,r)]}case"Mean":{const s=cj("axis",e,t,n),r=cj("keepDims",e,t,n);return[a.mean(cj("x",e,t,n),s,r)]}case"Min":{const s=cj("axis",e,t,n),r=cj("keepDims",e,t,n);return[a.min(cj("x",e,t,n),s,r)]}case"Sum":{const s=cj("axis",e,t,n),r=cj("keepDims",e,t,n);return[a.sum(cj("x",e,t,n),s,r)]}case"All":{const s=cj("axis",e,t,n),r=cj("keepDims",e,t,n);return[a.all(cj("x",e,t,n),s,r)]}case"Any":{const s=cj("axis",e,t,n),r=cj("keepDims",e,t,n);return[a.any(cj("x",e,t,n),s,r)]}case"ArgMax":{const s=cj("axis",e,t,n);return[a.argMax(cj("x",e,t,n),s)]}case"ArgMin":{const s=cj("axis",e,t,n);return[a.argMin(cj("x",e,t,n),s)]}case"Prod":{const s=cj("axis",e,t,n),r=cj("keepDims",e,t,n);return[a.prod(cj("x",e,t,n),s,r)]}case"Cumprod":{const s=cj("axis",e,t,n),r=cj("exclusive",e,t,n),i=cj("reverse",e,t,n);return[a.cumprod(cj("x",e,t,n),s,r,i)]}case"Cumsum":{const s=cj("axis",e,t,n),r=cj("exclusive",e,t,n),i=cj("reverse",e,t,n);return[a.cumsum(cj("x",e,t,n),s,r,i)]}case"Bincount":const s=cj("x",e,t,n),r=cj("weights",e,t,n),i=cj("size",e,t,n);return[a.bincount(s,r,i)];case"DenseBincount":{const s=cj("x",e,t,n),r=cj("weights",e,t,n),i=cj("size",e,t,n),o=cj("binaryOutput",e,t,n);return[a.denseBincount(s,r,i,o)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"slice_join":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"ConcatV2":case"Concat":{const s=cj("n",e,t,n),r=cj("axis",e,t,n);let i=cj("tensors",e,t,n);return i=i.slice(0,s),[a.concat(i,r)]}case"Gather":{const s=cj("x",e,t,n),r=cj("indices",e,t,n);return[a.gather(s,a.cast(r,"int32"),0)]}case"GatherV2":{const s=cj("axis",e,t,n),r=cj("batchDims",e,t,n),i=cj("x",e,t,n),o=cj("indices",e,t,n);return[a.gather(i,a.cast(o,"int32"),s,r)]}case"Reverse":{const s=cj("dims",e,t,n),r=[];for(let e=0;e<s.length;e++)s[e]&&r.push(e);const i=cj("x",e,t,n);return[a.reverse(i,r)]}case"ReverseV2":{const s=cj("axis",e,t,n),r=cj("x",e,t,n);return[a.reverse(r,s)]}case"Slice":{const s=cj("begin",e,t,n),r=cj("size",e,t,n);return[a.slice(cj("x",e,t,n),s,r)]}case"StridedSlice":{const s=cj("begin",e,t,n),r=cj("end",e,t,n),i=cj("strides",e,t,n),o=cj("beginMask",e,t,n),l=cj("endMask",e,t,n),c=cj("ellipsisMask",e,t,n),u=cj("newAxisMask",e,t,n),d=cj("shrinkAxisMask",e,t,n),h=cj("x",e,t,n);return[a.stridedSlice(h,s,r,i,o,l,c,u,d)]}case"Pack":return tu(()=>{const s=cj("axis",e,t,n),r=cj("tensors",e,t,n),i=r[0].shape,o=a.squeeze(r[0]).shape,l=r.map(e=>{const t=rs(e.shape,i);if(!t&&!rs(a.squeeze(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:a.reshape(e,i)});return[a.stack(l,s)]});case"Unpack":{const s=cj("axis",e,t,n),r=cj("tensor",e,t,n);return a.unstack(r,s)}case"Tile":{const s=cj("reps",e,t,n);return[a.tile(cj("x",e,t,n),s)]}case"Split":case"SplitV":{const s=cj("axis",e,t,n),r=cj("numOrSizeSplits",e,t,n),i=cj("x",e,t,n);return a.split(i,r,s)}case"ScatterNd":{const s=cj("indices",e,t,n),r=cj("values",e,t,n),i=cj("shape",e,t,n);return[a.scatterND(s,r,i)]}case"GatherNd":{const s=cj("x",e,t,n),r=cj("indices",e,t,n);return[a.gatherND(s,r)]}case"SparseToDense":{const s=cj("sparseIndices",e,t,n),r=cj("outputShape",e,t,n),i=cj("sparseValues",e,t,n),o=cj("defaultValue",e,t,n);return[a.sparseToDense(s,i,r,i.dtype===o.dtype?o:a.cast(o,i.dtype))]}case"TensorScatterUpdate":{const s=cj("indices",e,t,n),r=cj("values",e,t,n),i=cj("tensor",e,t,n);return[a.tensorScatterUpdate(i,s,r)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"sparse":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:r,emptyRowIndicator:i,reverseIndexMap:o}=a.sparse.sparseFillEmptyRows(cj("indices",e,t,n),cj("values",e,t,n),cj("denseShape",e,t,n),cj("defaultValue",e,t,n));return[s,r,i,o]}case"SparseReshape":{const{outputIndices:s,outputShape:r}=a.sparse.sparseReshape(cj("inputIndices",e,t,n),cj("inputShape",e,t,n),cj("newShape",e,t,n));return[s,r]}case"SparseSegmentMean":return[a.sparse.sparseSegmentMean(cj("data",e,t,n),cj("indices",e,t,n),cj("segmentIds",e,t,n))];case"SparseSegmentSum":return[a.sparse.sparseSegmentSum(cj("data",e,t,n),cj("indices",e,t,n),cj("segmentIds",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"spectral":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"FFT":return[a.fft(cj("x",e,t,n))];case"IFFT":return[a.ifft(cj("x",e,t,n))];case"RFFT":return[a.rfft(cj("x",e,t,n))];case"IRFFT":return[a.irfft(cj("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"string":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"StaticRegexReplace":return[a.string.staticRegexReplace(cj("input",e,t,n),cj("pattern",e,t,n),cj("rewrite",e,t,n),cj("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:r}=a.string.stringNGrams(cj("data",e,t,n),cj("dataSplits",e,t,n),cj("separator",e,t,n),cj("nGramWidths",e,t,n),cj("leftPad",e,t,n),cj("rightPad",e,t,n),cj("padWidth",e,t,n),cj("preserveShortSequences",e,t,n));return[s,r]}case"StringSplit":{const{indices:s,values:r,shape:i}=a.string.stringSplit(cj("input",e,t,n),cj("delimiter",e,t,n),cj("skipEmpty",e,t,n));return[s,r,i]}case"StringToHashBucketFast":return[a.string.stringToHashBucketFast(cj("input",e,t,n),cj("numBuckets",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"transformation":return s(()=>function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F;switch(e.op){case"Cast":return[a.cast(cj("x",e,t,n),cj("dtype",e,t,n))];case"ExpandDims":{const s=cj("axis",e,t,n);return[a.expandDims(cj("x",e,t,n),s)]}case"Squeeze":{const s=cj("axis",e,t,n);return[a.squeeze(cj("x",e,t,n),s)]}case"Reshape":return[a.reshape(cj("x",e,t,n),cj("shape",e,t,n))];case"EnsureShape":return[a.ensureShape(cj("x",e,t,n),cj("shape",e,t,n))];case"MirrorPad":return[a.mirrorPad(cj("x",e,t,n),cj("padding",e,t,n),cj("mode",e,t,n))];case"PadV2":case"Pad":return[a.pad(cj("x",e,t,n),cj("padding",e,t,n),cj("constantValue",e,t,n))];case"SpaceToBatchND":{const s=cj("blockShape",e,t,n),r=cj("paddings",e,t,n);return[a.spaceToBatchND(cj("x",e,t,n),s,r)]}case"BatchToSpaceND":{const s=cj("blockShape",e,t,n),r=cj("crops",e,t,n);return[a.batchToSpaceND(cj("x",e,t,n),s,r)]}case"DepthToSpace":{const s=cj("blockSize",e,t,n),r=cj("dataFormat",e,t,n).toUpperCase();return[a.depthToSpace(cj("x",e,t,n),s,r)]}case"BroadcastTo":return[a.broadcastTo(cj("x",e,t,n),cj("shape",e,t,n))];case"BroadcastArgs":return[a.broadcastArgs(cj("s0",e,t,n),cj("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"hash_table":return(async(e,t,n,a)=>{switch(e.op){case"HashTable":case"HashTableV2":{const s=a.getHashTableHandleByName(e.name);if(null!=s)return[s];{const s=cj("keyDType",e,t,n),r=cj("valueDType",e,t,n),i=new oT(s,r);return a.addHashTable(e.name,i),[i.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=cj("tableHandle",e,t,n,a),r=cj("keys",e,t,n),i=cj("values",e,t,n),o=a.getHashTableById(s.id);return[await o.import(r,i)]}case"LookupTableFind":case"LookupTableFindV2":{const s=cj("tableHandle",e,t,n,a),r=cj("keys",e,t,n),i=cj("defaultValue",e,t,n),o=a.getHashTableById(s.id);return[await o.find(r,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=cj("tableHandle",e,t,n,a);return[a.getHashTableById(s.id).tensorSize()]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}})(e,t,n,a);case"custom":const r=lj(e.op);if(r&&r.customExecutor)return r.customExecutor(new Jj(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(e,t,n);return Ps(r)?r.then(e=>[].concat(e)):[].concat(r)}class cT{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=a,this.parseNodeNameCache=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(e=>0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function uT(e,t,n,a){const s=new Set,r=[];let i=null,o=null;const l=new Set,c=new Set(Object.keys(e).map(e=>mj(e)[0]));a=a||[];const u=new Set(a.map(e=>mj(e.name)[0])),d=[...t];for(;d.length>0;){const e=d.pop();(gT(e)||xT(e)||yT(e))&&null==i&&(i=e,o=i.children.map(e=>e.name).filter(e=>s.has(e))),s.add(e.name),null==n[e.name]&&(c.has(e.name)||u.has(e.name)||(0!==e.inputs.length?e.inputs.forEach(e=>{l.has(e.name)||(l.add(e.name),d.push(e))}):r.push(e.name)))}return{inputs:e,outputs:t,usedNodes:s,missingInputs:r,dynamicNode:i,syncInputs:o}}function dT(e,t){const{usedNodes:n,inputs:a}=t,s=Object.keys(a).map(e=>mj(e)[0]).map(t=>e.nodes[t]),r=e.initNodes||[],i=e=>n.has("string"===typeof e?e:e.name);function o(e){return[...new Map(e.map(e=>[e.name,e])).values()]}const l=o([...s,...e.weights,...r]).filter(i),c=o([...l,...Object.values(e.nodes)]).filter(i),u=new Map(c.map(e=>[e.name,e])),d={};for(const f of c){d[f.name]=d[f.name]||0;for(const e of f.children)i(e)||(d[e.name]=Number.POSITIVE_INFINITY),d[e.name]=(d[e.name]||0)+1}const h=Object.entries(d).filter(e=>{let[,t]=e;return 0===t}).map(e=>{let[t]=e;return t}),p=[...h];for(;h.length>0;){const e=h.pop(),t=u.get(e);for(const n of t.children.filter(i))0===--d[n.name]&&(p.push(n.name),h.push(n.name))}const m=function(e,t){const n=new Map(e.map(e=>[e.name,e])),a=t.map(e=>e.name),s=new Set(a);for(;a.length>0;){const e=a.pop(),t=n.get(e);for(const r of t.children)n.has(r.name)&&!s.has(r.name)&&(s.add(r.name),a.push(r.name))}const r=e.filter(e=>s.has(e.name));return r}(p.map(e=>u.get(e)),l);return function(e,t){const n=new Map(e.map((e,t)=>[e.name,t])),a=new Set(t.map(e=>e.name)),s=e=>a.has("string"===typeof e?e:e.name),r=new Set(e.map(e=>e.name)),i=e=>r.has("string"===typeof e?e:e.name);for(const o of e){for(const e of o.children.filter(i)){if(!n.has(e.name))throw new hT("Child ".concat(e.name," of node ").concat(o.name," is unreachable."));if(n.get(o.name)>n.get(e.name))throw new hT("Node ".concat(o.name," is scheduled to run after its child ").concat(e.name,"."))}if(!s(o))for(const e of o.inputs){if(!n.has(e.name))throw new hT("Input ".concat(e.name," of node ").concat(o.name," is unreachable."));if(n.get(e.name)>n.get(o.name))throw new hT("Node ".concat(o.name," is scheduled to run before its input ").concat(e.name,"."))}}}(m,l),m}class hT extends Error{constructor(e){super("NodesExecutionOrderError: ".concat(e))}}const pT=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),mT=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),fT=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function gT(e){return pT.has(e.op)}function xT(e){return mT.has(e.op)}function yT(e){return fT.has(e.op)}class bT{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(t=>e[t].map(e=>e.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach(t=>{this._functionExecutorMap[t]=new bT(e.functions[t],this)})}getCompilationKey(e,t){const n=e.map(e=>e.name).sort(),a=t.map(e=>e.name).sort();return n.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,t){const n=uT(e,t,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:s,syncInputs:r}=n;if(null!=s)throw new Error("This execution contains the node '".concat(s.name,"', which has ")+"the dynamic op '".concat(s.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(r,"]"));if(a.length>0){const n=t.map(e=>e.name),s=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(n,"] from the provided inputs ")+"[".concat(s,"]. Missing the following inputs: [").concat(a,"]"))}const i=dT(this.graph,n),o=function(e){const t=new Map(e.map((e,t)=>[e.name,t])),n=Number.MAX_SAFE_INTEGER,a=e.map((e,t)=>gT(e)?n:t),s=e=>{const n=a[t.get(e.name)];return null==n?-1:n},r=e.map((e,t)=>e.children.map(s).reduce((e,t)=>Math.max(e,t),a[t])),i=new Map;for(let o=0;o<e.length;++o){const t=r[o];if(t===n)continue;const a=e[o],s=e[t];i.has(s.name)||i.set(s.name,[]),i.get(s.name).push(a)}return i}(i);return{orderedNodes:i,nodeLiveUntilMap:o}}cloneAndKeepTensor(e){if(null==e)return null;const t=e.clone();return au(t),t}cloneTensorList(e){if(!e)return null;const t=e.map(e=>this.cloneAndKeepTensor(e));return t}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(e=>{let[t,n]=e;return[t,this.cloneTensorList(n)]}))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const a=n.map(e=>this.graph.nodes[mj(e)[0]]),s=t.map(e=>mj(e)[0]),r=new Set(s);let i=s.map(e=>this.graph.nodes[e]);0===i.length&&(i=this._outputs);const o=this.getCompilationKey(a,i);let l=this.compiledMap.get(o);null==l&&(l=this.compile(e,i),this.compiledMap.set(o,l));try{this.keepIntermediateTensors=Vs().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(vq){this.keepIntermediateTensors=!1,console.warn(vq.message)}const c={},u={};return tu(()=>{const n=new cT(this.weightMap,c,u,this.functionExecutorMap,this.parseNodeNameCache),a=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(t=>{const[s,r]=mj(t,n),i=[];i[r]=e[t],a[s]=i,this.keepIntermediateTensors&&(this.clonedTensorsMap[s]=this.cloneTensorList(i))});const s=this.getFrozenTensorIds(a),{orderedNodes:i,nodeLiveUntilMap:o}=l;for(const e of i){if(a[e.name])continue;const t=lT(e,a,n,this._resourceManager);if(Ps(t))throw new Error("The execution of the op '".concat(e.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[e.name]=t,this.keepIntermediateTensors&&(this.clonedTensorsMap[e.name]=this.cloneTensorList(t)),this.checkTensorForDisposalWithNodeLiveUntilInfo(e,a,n,s,r,o.get(e.name))}return null==this.parent&&n.dispose(s),t.map(e=>uj(e,a,n))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(t=>e[t]).map(e=>e.map(e=>e.id)));return new Set(t)}checkTensorForDisposal(e,t,n,a,s,r,i){if(!gT(t)&&!r.has(e)){for(const a of n[e])null!=a&&(i[a.id]=(i[a.id]||0)+t.children.length);for(const e of t.inputs){if(gT(e))continue;const t=dj(e.name,n,a);if(null!=t)for(const e of t){if(!e||e.kept||s.has(e.id))continue;const t=i[e.id];1===t?(e.dispose(),delete i[e.id]):null!=t&&i[e.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,a,s,r){function i(e){return gT(e)||s.has(e.name)}if(!gT(e)&&null!=r)for(const o of r){if(i(o))continue;const e=dj(o.name,t,n);for(const t of e)!t||t.kept||a.has(t.id)||t.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=Vs().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(vq){this.keepIntermediateTensors=!1,console.warn(vq.message)}const r=new cT(this.weightMap,a,s,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const i=await this.executeWithControlFlow(e,r,t,n),o=t.map(e=>uj(e,i,r)),l=o.map(e=>e.id),c=Object.keys(e).map(t=>e[t].id),u=new Set([...l,...c,...this.weightIds]);return Object.values(i).forEach(e=>{e.forEach(e=>{!e||e.isDisposed||u.has(e.id)||e.dispose()})}),null==this.parent&&r.dispose(u),o}async executeFunctionAsync(e,t,n){const a=e.reduce((e,t,n)=>(e[this.inputs[n].name]=t,e),{});return this._executeAsync(a,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,a){const s=Object.keys(e),r=s.map(e=>this.graph.nodes[mj(e)[0]]),i=n.map(e=>mj(e)[0]),o=new Set(i);let l=i.map(e=>this.graph.nodes[e]);0===l.length&&(l=this._outputs);const{usedNodes:c,missingInputs:u,dynamicNode:d,syncInputs:h}=uT(e,l,this.weightMap,this._initNodes),p=[...r,...this.graph.weights,...this._initNodes||[]].map(e=>({node:e,contexts:t.currentContext})),m=Object.assign({},this.weightMap);Object.keys(e).forEach(t=>{const[n,a]=mj(t),s=[];s[a]=e[t],m[n]=s});const f={},g=this.getFrozenTensorIds(m),x={};for(;p.length>0;){const e=this.processStack(r,p,t,m,x,g,o,f,c);await Promise.all(e)}null!=d||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const y=l.filter(e=>!gT(e)&&!uj(e.name,m,t)).map(e=>e.name);if(y.length>0){let e="";throw null!=d&&(e="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(h,"]")),new Error("Cannot compute the outputs [".concat(y,"] from the provided ")+"inputs [".concat(s,"]. Consider providing the following inputs: ")+"[".concat(u,"]. ").concat(e))}return m}processStack(e,t,n,a,s,r,i,o,l){const c=[];for(;t.length>0;){const e=t.pop();n.currentContext=e.contexts;let u="";if("Enter"===e.node.op&&cj("isConstant",e.node,a,n)&&([u]=hj(e.node.name,n)),null==a[e.node.name]){const d=lT(e.node,a,n,this._resourceManager);u||([u]=hj(e.node.name,n));const h=n.currentContext;Ps(d)?c.push(d.then(c=>(a[u]=c,this.keepIntermediateTensors&&(this.clonedTensorsMap[u]=this.cloneTensorList(c)),n.currentContext=h,this.checkTensorForDisposal(u,e.node,a,n,r,i,o),this.processChildNodes(e.node,t,n,a,s,l),c))):(a[u]=d,this.keepIntermediateTensors&&(this.clonedTensorsMap[u]=this.cloneTensorList(d)),this.checkTensorForDisposal(u,e.node,a,n,r,i,o),this.processChildNodes(e.node,t,n,a,s,l))}else this.processChildNodes(e.node,t,n,a,s,l)}return c}processChildNodes(e,t,n,a,s,r){e.children.forEach(e=>{const[i]=hj(e.name,n);!s[i]&&r.has(e.name)&&("Merge"===e.op?e.inputNames.some(e=>!!uj(e,a,n))&&(s[i]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every(e=>!!uj(e,a,n))&&(s[i]=!0,t.push({contexts:n.currentContext,node:e})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(e=>e.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const n=e[t],[a]=mj(t),s=this.graph.nodes[a];if(s.attrParams.shape&&s.attrParams.shape.value){const e=s.attrParams.shape.value;$a(e.length===n.shape.length&&n.shape.every((t,n)=>-1===e[n]||e[n]===t),()=>"The shape of dict['".concat(s.name,"'] provided in ")+"model.execute(dict) must be [".concat(e,"], but was ")+"[".concat(n.shape,"]"))}s.attrParams.dtype&&s.attrParams.dtype.value&&$a(n.dtype===s.attrParams.dtype.value,()=>"The dtype of dict['".concat(s.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(s.attrParams.dtype.value,", but was ").concat(n.dtype))})}mapInputs(e){var t,n;const a={};for(const s in e){const r=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[s];null!=r?a[r.name]=e[s]:a[s]=e[s]}return a}checkInputs(e){const t=Object.keys(e).filter(e=>{const[t]=mj(e);return null==this.graph.nodes[t]});if(t.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(t,"] that are not part of graph"))}mapOutputs(e){return e.map(e=>{var t,n;const a=null===(n=null===(t=this._signature)||void 0===t?void 0:t.outputs)||void 0===n?void 0:n[e];return null!=a?a.name:e},{})}checkOutputs(e){e.forEach(e=>{const[t]=mj(e);if(!this.graph.nodes[t])throw new Error("The output '".concat(e,"' is not found in the graph"))})}}class vT{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}const wT="?tfjs-format=file",kT="model.json";class NT{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=n,null==t&&(this.loadOptions={}),this.resourceManager=new vT}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ps(e)?e.then(e=>null==e.getWeightStream?this.loadSync(e):this.loadStreaming(e)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(null==e.getWeightStream)throw new Error("Model artifacts missing streamWeights function");const t=await wu(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const n=this.artifacts.modelTopology;let a=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const e=this.artifacts.userDefinedMetadata;null!=e.signature&&(a=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}if(this.signature=a,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new bT(Oj.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){const t=Oj.Instance.transformGraph(e.modelInitializer);this.initializer=new bT(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if("string"===typeof e){const t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new Error("Found more than one (".concat(t.length,") save handlers for ")+"URL '".concat(e,"'"));e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t={};return(e instanceof ic?[e]:e).forEach((e,n)=>t[this.structuredOutputKeys[n]]=e),t}return e}predict(e,t){const n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){const n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof ic)&&!Array.isArray(e)){const n=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=n)for(const t in n){const a=n[t];null!=a.resourceId&&(e[t]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));let a=0;return this.inputNodes.reduce((t,n)=>{var s,r,i;const o=null===(i=null===(r=null===(s=this.signature)||void 0===s?void 0:s.inputs)||void 0===r?void 0:r[n])||void 0===i?void 0:i.resourceId;return t[n]=null!=o?this.resourceIdToCapturedInput[o]:e[a++],t},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,n=Object.keys(t);for(let a=0;a<n.length;a++){const s=t[n[a]];this.resourceIdToCapturedInput[s.resourceId]=e[a]}}}execute(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&nu(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function _T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&"string"===typeof e&&(e=function(e){e.endsWith("/")||(e+="/");return"".concat(e).concat(kT).concat(wT)}(e));const a=new NT(e,t,n);return await a.load(),a}function ST(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(a.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const s=t(e);if(s.recurse&&null!==s.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(s.recurse){if(IT(e)){const s=Array.isArray(e)?[]:{};a.add(e);for(const r in e){const i=ST(e[r],t,n,a);s[r]=i}return a.delete(e),e.__proto__&&(s.__proto__=e.__proto__),s}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,s.value),s.value}function CT(e){return jT(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:TT)}function jT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const a=e[0];if(n.has(a))throw new Error("Circular references are not supported.");const s=t(e);if(s.recurse&&null!==s.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(s.recurse){if(IT(a)){const s=Array.isArray(a)?[]:{};n.add(a);for(const r in a){const a=jT(e.map(e=>e[r]),t,n);s[r]=a}return n.delete(a),s}throw new Error("Can't recurse into non-iterable type: ".concat(a))}return s.value}function TT(e){return null===e?null:IT(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function IT(e){let t=!1;if(Vs().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:a}=n(551);t=e instanceof a}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof ic)&&!(e instanceof Promise)&&!t)}function ET(e){return function(e,t){return ST(e,t)}(e,AT)}function AT(e){return e instanceof ic?{value:e.clone(),recurse:!1}:IT(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}class RT{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}class MT extends RT{constructor(){super(MT.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=2*this.capacity,t=new Array(e),n=this.length();for(let a=0;a<n;a++)t[a]=this.get(this.wrap(this.begin+a));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function LT(e){return new PT(e)}function DT(e,t){return new XT(e,t)}MT.INITIAL_CAPACITY=32;class OT{async toArray(){const e=[];let t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),t=[];let n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new GT(this,e)}filter(e){return new UT(this,e)}map(e){return new HT(this,e)}mapAsync(e){return new qT(this,e)}serialMapAsync(e){return new qT(this,e).serial()}flatmap(e){return new ZT(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(e=>!0===e)}rowMajorBatch(e){return new VT(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:TT;return this.rowMajorBatch(e,t).map(e=>CT(e,n))}concatenate(e,t){return new XT(new FT([this,e]),t)}take(e){return e<0||null==e?this:new WT(this,e)}skip(e){return e<0||null==e?this:new BT(this,e)}prefetch(e){return new JT(this,e)}shuffle(e,t){return new QT(this,e,t)}serial(){return new zT(this)}}class FT extends OT{constructor(e){super(),this.items=e,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:ET(e),done:!1}}}class PT extends OT{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(vq){throw vq.message="Error thrown while iterating through a dataset: ".concat(vq.message),vq}}}class zT extends OT{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class BT extends OT{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;nu(e.value)}return this.upstream.next()}}class WT extends OT{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class VT extends OT{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}}class UT extends OT{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;nu(e.value)}}}class HT extends OT{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=kc(e.value),n=this.transform(e.value),a=kc(n);for(const s of t)wc(s,a)||s.dispose();return{value:n,done:!1}}}class GT extends OT{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(vq){if(!this.handler(vq))return{value:null,done:!0}}}}class qT extends OT{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=kc(e.value),n=await this.transform(e.value),a=kc(n);for(const s of t)wc(s,a)||s.dispose();return{value:n,done:!1}}}class KT extends OT{constructor(){super(),this.outputQueue=new MT,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class ZT extends KT{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){const e=await this.upstream.next();if(e.done)return!1;const t=kc(e.value),n=this.transform(e.value),a=kc(n);this.outputQueue.pushAll(n);for(const s of t)wc(s,a)||s.dispose();return!0}}class XT extends OT{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){const e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}}var YT;!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(YT||(YT={}));class JT extends OT{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new RT(t)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class QT extends JT{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=hg.alea(n||Vl().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}}class $T{constructor(){this.size=null}batch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let a;return $a(e>0,()=>"batchSize needs to be positive, but it is\n      ".concat(e)),a=this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),eI(async()=>(await n.iterator()).columnMajorBatch(e,t,tI),a)}concatenate(e){const t=this;let n;return n=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,eI(async()=>(await t.iterator()).concatenate(await e.iterator()),n)}filter(e){const t=this;let n;return n=this.size===1/0?1/0:null,eI(async()=>(await t.iterator()).filter(t=>tu(()=>e(t))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const t=this;return eI(async()=>(await t.iterator()).map(t=>tu(()=>e(t))),this.size)}mapAsync(e){const t=this;return eI(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const t=this;return eI(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){const t=this;let n;return n=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,eI(async()=>DT(LT(async()=>({value:await t.iterator(),done:!1})).take(e)),n)}skip(e){const t=this;let n;return n=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,eI(async()=>(await t.iterator()).skip(e),n)}shuffle(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));const a=this,s=hg.alea(t||Vl().toString());return eI(async()=>{let t=s.int32();return n&&(t+=s.int32()),(await a.iterator()).shuffle(e,t.toString())},this.size)}take(e){const t=this;let n;return n=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,eI(async()=>(await t.iterator()).take(e),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function eI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends $T{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function tI(e){if(null===e)return null;if(function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof ic||ql(e);var t}(e[0])){return{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof ic?Yg(e):Hc(e)}(e),recurse:!1}}return{value:null,recurse:!0}}$T.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function nI(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&$a("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors in the CPU backend."))})}const aI=px;class sI extends Ua{nextDataId(){return sI.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Va(this,Qc())}write(e,t,n){this.firstUse&&(this.firstUse=!1,Vs().get("IS_NODE")&&hl("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:n,refCount:1}),a}makeTensorInfo(e,t,n){let a;if("string"===t&&null!=n&&n.length>0&&ks(n[0])){const s=n.map(e=>Hl(e));a=this.write(s,e,t)}else a=this.write(n,e,t);return{dataId:a,shape:e,dtype:t}}refCount(e){if(this.data.has(e)){return this.data.get(e).refCount}return 0}incRef(e){this.data.get(e).refCount++}decRef(e){if(this.data.has(e)){this.data.get(e).refCount--}}move(e,t,n,a,s){this.data.set(e,{values:t,dtype:a,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){return ub(this.readSync(n.real.dataId),this.readSync(n.imag.dataId))}return As(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map(e=>Gl(e));return gd(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return gd(e.shape,e.dtype,t)}makeOutput(e,t,n){return Qc().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=Vl();e();return{kernelMs:Vl()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){nI([e],"where");const t=this.readSync(e.dataId);return aI(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}sI.nextDataId=0;function rI(e){return(t,n,a)=>{const s=gs(n,t.length);for(let r=0;r<t.length;++r)s[r]=e(t[r],a);return s}}function iI(e,t,n){return oI(e,rI(t),n)}function oI(e,t,n){return a=>{let{inputs:s,attrs:r,backend:i}=a;const{x:o}=s;nI(o,e);const l=i,c=l.data.get(o.dataId).values;let u;if("string"===o.dtype){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");u=Hb(c)}else u=c;const d=n||o.dtype,h=t(u,d,r);return l.makeTensorInfo(o.shape,d,h)}}du("cpu",()=>new sI,1);const lI=iI(qr,e=>e>=0?e:Math.exp(e)-1),cI={kernelName:qr,backendName:"cpu",kernelFunc:lI};function uI(e){const{inputs:t,backend:n}=e,{x:a}=t;return n.incRef(a.dataId),{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}const dI={kernelName:ci,backendName:"cpu",kernelFunc:uI};function hI(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{alpha:r}=a;nI([s],"leakyRelu");const i=ns(s.shape),o=n.data.get(s.dataId).values,l=fs("float32",i);for(let c=0;c<o.length;c++)l[c]=o[c]<0?r*o[c]:o[c];return n.makeTensorInfo(s.shape,"float32",l)}const pI={kernelName:fi,backendName:"cpu",kernelFunc:hI};function mI(e){return(t,n,a,s,r)=>{const i=Jd(t,n),o=i.length,l=Ts(i),c=fs(r,ns(i)),u=t.length,d=n.length,h=Ts(t),p=Ts(n),m=Xd(t,i),f=Xd(n,i);if(m.length+f.length===0)for(let g=0;g<c.length;++g)c[g]=e(a[g%a.length],s[g%s.length]);else for(let g=0;g<c.length;++g){const t=Fs(g,o,l),n=t.slice(-u);m.forEach(e=>n[e]=0);const r=Os(n,u,h),i=t.slice(-d);f.forEach(e=>i[e]=0);const x=Os(i,d,p);c[g]=e(a[r],s[x])}return[c,i]}}const fI=mI((e,t)=>e<0?t*e:e);function gI(e){const{inputs:t,backend:n}=e,{x:a,alpha:s}=t;nI([a,s],"prelu");const r=n.data.get(a.dataId).values,i=n.data.get(s.dataId).values,[o,l]=fI(a.shape,s.shape,r,i,"float32");return n.makeTensorInfo(l,"float32",o)}const xI={kernelName:to,backendName:"cpu",kernelFunc:gI},yI=iI(co,e=>Math.max(0,e)),bI={kernelName:co,backendName:"cpu",kernelFunc:yI},vI=iI(go,e=>Math.min(Math.max(0,e),6)),wI={kernelName:go,backendName:"cpu",kernelFunc:vI},kI=rI(e=>1/(1+Math.exp(-e))),NI=iI(Io,e=>1/(1+Math.exp(-e))),_I={kernelName:Io,backendName:"cpu",kernelFunc:NI};function SI(e,t,n,a,s){if("linear"===n)return uI({inputs:{x:t},backend:e});if("relu"===n)return yI({inputs:{x:t},backend:e});if("elu"===n)return lI({inputs:{x:t},backend:e});if("relu6"===n)return vI({inputs:{x:t},backend:e});if("prelu"===n)return gI({inputs:{x:t,alpha:a},backend:e});if("leakyrelu"===n)return hI({inputs:{x:t},backend:e,attrs:{alpha:s}});if("sigmoid"===n)return NI({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function CI(e){const{inputs:t,backend:n}=e,{real:a,imag:s}=t,r=n.data.get(a.dataId).values,i=n.data.get(s.dataId).values,o=n.makeTensorInfo(a.shape,"complex64");return n.data.get(o.dataId).complexTensorInfos={real:n.makeTensorInfo(a.shape,"float32",r),imag:n.makeTensorInfo(s.shape,"float32",i)},o}const jI={kernelName:vr,backendName:"cpu",kernelFunc:CI};function TI(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return CI({inputs:{real:TI(e,t,"float32"),imag:TI(e,t,"float32")},backend:e})}const a=Ms(ns(t),n);return e.makeTensorInfo(t,n,a)}function II(e){const{inputs:t,backend:n}=e,{input:a}=t,s=n.data.get(a.dataId).complexTensorInfos.real,r=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,r)}const EI={kernelName:oo,backendName:"cpu",kernelFunc:II};function AI(e,t,n,a){if("int32"===a){return[t,"int32",Int32Array.from(e)]}if("bool"===a){const a=Wl([0],n),[s,r]=mI((e,t)=>e!==t?1:0)(t,[],e,a,"bool");return[r,"bool",s]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(a))}function RI(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{dtype:r}=a;if("complex64"===r){if("complex64"===s.dtype)return uI({inputs:{x:s},backend:n});const e=TI(n,s.shape,s.dtype),t=RI({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),a=CI({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),a}if("complex64"===s.dtype){const e=II({inputs:{input:s},backend:n}),t=RI({inputs:{x:e},backend:n,attrs:{dtype:r}});return n.disposeIntermediateTensorInfo(e),t}if(!bs(s.dtype,r)){const e=uI({inputs:{x:s},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:r}}const i=n.data.get(s.dataId).values,[o,l,c]=AI(i,s.shape,s.dtype,r);return n.makeTensorInfo(o,l,c)}const MI={kernelName:xr,backendName:"cpu",kernelFunc:RI};function LI(e,t,n,a){return null==n?n=>{let{inputs:s,backend:r}=n;const{a:i,b:o}=s,l=r;nI([i,o],e);const c=l.data.get(i.dataId).values,u=l.data.get(o.dataId).values,d="string"===i.dtype?Hb(c):c,h="string"===i.dtype?Hb(u):u,p=a||i.dtype,[m,f]=t(i.shape,o.shape,d,h,p);return l.makeTensorInfo(f,p,m)}:e=>{let{inputs:s,backend:r}=e;const{a:i,b:o}=s,l=r;if("complex64"===i.dtype||"complex64"===o.dtype){const e=RI({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),t=l.data.get(e.dataId),a=t.complexTensorInfos.real,s=t.complexTensorInfos.imag,r=l.data.get(a.dataId).values,c=l.data.get(s.dataId).values,u=RI({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),d=l.data.get(u.dataId),h=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,m=l.data.get(h.dataId).values,f=l.data.get(p.dataId).values,[g,x,y]=n(i.shape,o.shape,r,c,m,f),b=l.makeTensorInfo(y,"float32",g),v=l.makeTensorInfo(y,"float32",x),w=CI({inputs:{real:b,imag:v},backend:l});return l.disposeIntermediateTensorInfo(e),l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(b),l.disposeIntermediateTensorInfo(v),w}{const e=l.data.get(i.dataId).values,n=l.data.get(o.dataId).values,s=a||i.dtype,[r,c]=t(i.shape,o.shape,e,n,s);return l.makeTensorInfo(c,s,r)}}}function DI(e){return(t,n,a,s,r,i)=>{const o=Jd(t,n),l=ns(o),c=o.length,u=Ts(o),d=fs("float32",l),h=fs("float32",l),p=Xd(t,o),m=Xd(n,o),f=ub(a,s),g=ub(r,i),x=t.length,y=Ts(t),b=n.length,v=Ts(n);if(p.length+m.length===0)for(let w=0;w<d.length;w++){const t=w%f.length,n=w%g.length,a=e(f[2*t],f[2*t+1],g[2*n],g[2*n+1]);d[w]=a.real,h[w]=a.imag}else for(let w=0;w<d.length;w++){const t=Fs(w,c,u),n=t.slice(-x);p.forEach(e=>n[e]=0);const a=Os(n,x,y),s=t.slice(-b);m.forEach(e=>s[e]=0);const r=Os(s,b,v),i=e(f[2*a],f[2*a+1],g[2*r],g[2*r+1]);d[w]=i.real,h[w]=i.imag}return[d,h,o]}}const OI=mI((e,t)=>e+t),FI=DI((e,t,n,a)=>({real:e+n,imag:t+a})),PI=LI(Ys,OI,FI),zI={kernelName:Ys,backendName:"cpu",kernelFunc:PI};function BI(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{shape:r}=a,i=ns(s.shape),o=hs(r,i),l=ns(o);$a(i===l,()=>"The new shape (".concat(o,") has ").concat(l," elements and the old ")+"shape (".concat(s.shape,") has ").concat(i," elements. The new shape and old ")+"shape must have the same number of elements."),n.incRef(s.dataId);const c=n.data.get(s.dataId);if(null!=c.complexTensorInfos){const e=c.complexTensorInfos.real,t=c.complexTensorInfos.imag;e.shape=o,t.shape=o}return{dataId:s.dataId,shape:o,dtype:s.dtype}}const WI={kernelName:uo,backendName:"cpu",kernelFunc:BI};function VI(e){const{inputs:t,backend:n,attrs:a}=e,{a:s,b:r}=t,{transposeA:i,transposeB:o}=a;nI([s,r],"matMul");const l=s.shape.length,c=r.shape.length,u=i?s.shape[l-2]:s.shape[l-1],d=o?r.shape[c-1]:r.shape[c-2],h=i?s.shape[l-1]:s.shape[l-2],p=o?r.shape[c-2]:r.shape[c-1],m=s.shape.slice(0,-2),f=r.shape.slice(0,-2),g=ns(m),x=ns(f),y=Jd(s.shape.slice(0,-2),r.shape.slice(0,-2)).concat([h,p]);$a(u===d,()=>"Error in matMul: inner shapes (".concat(u,") and (")+"".concat(d,") of Tensors with shapes ").concat(s.shape," and ")+"".concat(r.shape," and transposeA=").concat(i)+" and transposeB=".concat(o," must match."));const b=o?[x,p,d]:[x,d,p],v=BI({inputs:{x:s},backend:n,attrs:{shape:i?[g,u,h]:[g,h,u]}}),w=BI({inputs:{x:r},backend:n,attrs:{shape:b}}),k=i?v.shape[1]:v.shape[2],N=i?v.shape[2]:v.shape[1],_=o?w.shape[1]:w.shape[2],S=Math.max(g,x),C=n.data.get(v.dataId).values,j=n.data.get(w.dataId).values,T=Ts(v.shape),I=Ts(w.shape),[E,A,R]=i?[T[0],1,T[1]]:[T[0],T[1],1],[M,L,D]=o?[1,I[1],I[0]]:[I[1],1,I[0]],O=N*_,F=gd([S,N,_],v.dtype),P=F.values,z=n.blockSize;for(let B=0;B<S;B++){const e=B%g,t=B%x;for(let n=0;n<N;n+=z){const a=Math.min(n+z,N);for(let s=0;s<_;s+=z){const r=Math.min(s+z,_);for(let i=0;i<k;i+=z){const o=Math.min(i+z,k);for(let l=n;l<a;l++)for(let n=s;n<r;n++){let a=0;for(let s=i;s<o;s++){a+=C[e*E+l*A+s*R]*j[s*M+n*L+t*D]}P[B*O+(l*_+n)]+=a}}}}}return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(y,F.dtype,F.values)}const UI={kernelName:dr,backendName:"cpu",kernelFunc:VI};const HI={kernelName:cl,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{a:s,b:r,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=a;let h,p,m;const f=[];h=VI({inputs:{a:s,b:r},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(p=PI({inputs:{a:h,b:i},backend:n}),f.push(h),h=p),u&&(m=SI(n,h,u,o,d),f.push(h),h=m);for(const g of f)n.disposeIntermediateTensorInfo(g);return h}};function GI(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const qI={kernelName:Ks,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend;nI(t,"abs");let a=new Float32Array(ns(t.shape));return a=GI(n.data.get(t.dataId).values),n.makeOutput(a,t.shape,t.dtype)}},KI=iI(Zs,e=>Math.acos(e)),ZI={kernelName:Zs,backendName:"cpu",kernelFunc:KI},XI=iI(Xs,e=>Math.acosh(e)),YI={kernelName:Xs,backendName:"cpu",kernelFunc:XI};const JI={kernelName:Js,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,a=t;nI(t,"addN");const s=a.map(e=>n.data.get(e.dataId).values),r=gd(a[0].shape,a[0].dtype),i=r.values;for(let o=0;o<a.length;o++){const e=s[o];for(let t=0;t<i.length;t++)i[t]+=e[t]}return n.makeTensorInfo(r.shape,r.dtype,r.values)}};function QI(e,t,n,a,s){const r=t.length,i=ns(t),o=Ts(t),l=Ts(s),c=fs(n,ns(s));for(let u=0;u<i;++u){const t=Fs(u,r,o),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[a[e]];c[Os(n,r,l)]=e[u]}return c}function $I(e){const{inputs:t,attrs:n,backend:a}=e,{x:s}=t,{perm:r}=n;nI(s,"transpose");const i=s.shape.length,o=new Array(i);for(let c=0;c<o.length;c++)o[c]=s.shape[r[c]];const l=QI(a.data.get(s.dataId).values,s.shape,s.dtype,r,o);return{dataId:a.write(l,o,s.dtype),shape:o,dtype:s.dtype}}const eE={kernelName:el,backendName:"cpu",kernelFunc:$I};const tE={kernelName:Qs,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a;nI(s,"all");const o=ps(r,s.shape);let l=o;const c=Jm(l,s.shape.length);let u=s;null!=c&&(u=$I({inputs:{x:s},backend:n,attrs:{perm:c}}),l=$m(l.length,s.shape.length)),Ym("all",l,u.shape.length);const[d,h]=Zm(u.shape,l),p=ns(h),m=Ms(ns(d),u.dtype),f=n.data.get(u.dataId).values;for(let x=0;x<m.length;++x){const e=x*p;let t=f[e];for(let n=0;n<p;++n){const a=f[e+n];t=t&&a}m[x]=t}null!=c&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,m);if(i){const e=BI({inputs:{x:g},backend:n,attrs:{shape:Xm(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const nE={kernelName:$s,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a;nI(s,"any");const o=ps(r,s.shape);let l=o;const c=Jm(l,s.shape.length);let u=s;null!=c&&(u=$I({inputs:{x:s},backend:n,attrs:{perm:c}}),l=$m(l.length,s.shape.length)),Ym("any",l,u.shape.length);const[d,h]=Zm(u.shape,l),p=ns(h),m=Ms(ns(d),u.dtype),f=n.data.get(u.dataId).values;for(let x=0;x<m.length;++x){const e=x*p;let t=f[e];for(let n=0;n<p;++n){const a=f[e+n];t=t||a}m[x]=t}null!=c&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,m);if(i){const e=BI({inputs:{x:g},backend:n,attrs:{shape:Xm(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const aE={kernelName:er,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r}=a;nI(s,"argMax");let i=ps(r,s.shape);const o=Jm(i,s.shape.length);let l=s;const c=[];null!=o&&(l=$I({inputs:{x:s},backend:n,attrs:{perm:o}}),c.push(l),i=$m(i.length,l.shape.length)),i=[i[0]],Ym("argMax",i,l.shape.length);const[u,d]=Zm(l.shape,i),h=Ms(ns(u),"int32"),p=ns(d),m=n.data.get(l.dataId).values;for(let f=0;f<h.length;++f){const e=f*p;let t=m[e],n=0;for(let a=0;a<p;++a){const s=m[e+a];s>t&&(t=s,n=a)}h[f]=n}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,"int32",h)}};const sE={kernelName:tr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r}=a;nI(s,"argMin");let i=ps(r,s.shape);const o=Jm(i,s.shape.length);let l=s;const c=[];null!=o&&(l=$I({inputs:{x:s},backend:n,attrs:{perm:o}}),c.push(l),i=$m(i.length,l.shape.length)),i=[i[0]],Ym("argMin",i,l.shape.length);const[u,d]=Zm(l.shape,i),h=Ms(ns(u),"int32"),p=ns(d),m=n.data.get(l.dataId).values;for(let f=0;f<h.length;++f){const e=f*p;let t=m[e],n=0;for(let a=0;a<p;++a){const s=m[e+a];s<t&&(t=s,n=a)}h[f]=n}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,"int32",h)}},rE=iI(nr,e=>Math.asin(e)),iE={kernelName:nr,backendName:"cpu",kernelFunc:rE},oE=iI(ar,e=>Math.asinh(e)),lE={kernelName:ar,backendName:"cpu",kernelFunc:oE},cE=iI(sr,e=>Math.atan(e)),uE={kernelName:sr,backendName:"cpu",kernelFunc:cE},dE=mI((e,t)=>Math.atan2(e,t)),hE=LI(ir,dE),pE={kernelName:ir,backendName:"cpu",kernelFunc:hE},mE=iI(rr,e=>Math.atanh(e)),fE={kernelName:rr,backendName:"cpu",kernelFunc:mE};function gE(e,t,n,a,s,r){const i=s.strideHeight,o=s.strideWidth,l=s.dilationHeight,c=s.dilationWidth,u=s.effectiveFilterHeight,d=s.effectiveFilterWidth,h=s.padInfo.top,p=s.padInfo.left,m="max"===r?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,f=gd(s.outShape,n),g=f.values,x=s.outShape[1]*s.outShape[2]*s.outShape[3],y=s.outShape[2]*s.outShape[3],b=s.outShape[3];for(let v=0;v<s.batchSize;++v){const t=v*x,n=v*a[0];for(let f=0;f<s.inChannels;++f)for(let x=0;x<s.outHeight;++x){const v=x*i-h,w=Math.max(0,v),k=Math.min(s.inHeight,u+v),N=t+x*y;for(let t=0;t<s.outWidth;++t){const i=t*o-p,u=Math.max(0,i),h=Math.min(s.inWidth,d+i);let x=m,y=0,v=0;for(let t=w;t<k;t+=l){const s=n+t*a[1];for(let t=u;t<h;t+=c){const n=e[s+t*a[2]+f];"max"===r&&n>x?x=n:"avg"===r&&(y+=n,v++)}if(isNaN(x))break}g[N+t*b+f]="avg"===r?y/v:x}}}return f}function xE(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=gd(a.outShape,"int32"),o=a.strideHeight,l=a.strideWidth,c=a.dilationHeight,u=a.dilationWidth,d=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=a.padInfo.top,m=a.padInfo.left,f=gd(t,n,e);for(let g=0;g<a.batchSize;++g)for(let e=0;e<a.inChannels;++e)for(let t=0;t<a.outHeight;++t){const n=t*o-p;let x=n;for(;x<0;)x+=c;const y=Math.min(a.inHeight,d+n);for(let o=0;o<a.outWidth;++o){const d=o*l-m;let p=d;for(;p<0;)p+=u;const b=Math.min(a.inWidth,h+d);let v=Number.NEGATIVE_INFINITY,w=-1;for(let t=x;t<y;t+=c){const i=t-n;for(let n=p;n<b;n+=u){const o=n-d,l=f.get(g,t,n,e);l>v&&(v=l,w=s?r?((g*a.inHeight+t)*a.inWidth+n)*a.inChannels+e:(t*a.inWidth+n)*a.inChannels+e:i*h+o)}}i.set(w,g,t,o,e)}}return i}function yE(e,t,n,a,s,r){const i=s.strideDepth,o=s.strideHeight,l=s.strideWidth,c=s.dilationDepth,u=s.dilationHeight,d=s.dilationWidth,h=s.effectiveFilterDepth,p=s.effectiveFilterHeight,m=s.effectiveFilterWidth,f=s.padInfo.front,g=s.padInfo.top,x=s.padInfo.left,y="max"===r?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=gd(s.outShape,n),v=b.values,w=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],k=s.outShape[2]*s.outShape[3]*s.outShape[4],N=s.outShape[3]*s.outShape[4],_=s.outShape[4];for(let S=0;S<s.batchSize;++S){const t=S*w,n=S*a[0];for(let b=0;b<s.inChannels;++b)for(let w=0;w<s.outDepth;++w){const S=w*i-f;let C=S;for(;C<0;)C+=c;const j=Math.min(s.inDepth,h+S),T=t+w*k;for(let t=0;t<s.outHeight;++t){const i=t*o-g;let h=i;for(;h<0;)h+=u;const f=Math.min(s.inHeight,p+i),w=T+t*N;for(let t=0;t<s.outWidth;++t){const i=t*l-x;let o=i;for(;o<0;)o+=d;const p=Math.min(s.inWidth,m+i),g=w+t*_;let k=y,N=0,S=0;for(let t=C;t<j;t+=c){const s=n+t*a[1];for(let t=h;t<f;t+=u){const n=s+t*a[2];for(let t=o;t<p;t+=d){const s=e[n+t*a[3]+b];if("max"===r&&s>k?k=s:"avg"===r&&(N+=s,S++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}v[g+b]="avg"===r?N/Math.max(S,1):k}}}}return b}const bE={kernelName:or,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t;nI(s,"avgPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=a;$a(Xp(i,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'"));const c=zp(s.shape,r,i,1,o,l);let u;if(1===c.filterWidth&&1===c.filterHeight&&rs(c.inShape,c.outShape))u=uI({inputs:{x:s},backend:n});else{const e=n.data.get(s.dataId).values,t=Ts(s.shape),a=gE(e,s.shape,s.dtype,t,c,"avg");u=n.makeTensorInfo(c.outShape,s.dtype,a.values)}return u}};const vE={kernelName:cr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=a;nI(s,"avgPool3d");const u=Bp(s.shape,r,i,1,o,l,c),d=yE(n.data.get(s.dataId).values,s.shape,s.dtype,Ts(s.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};const wE={kernelName:ur,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,input:r}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=a;nI([s,r],"avgPool3DGrad");const u=Bp(r.shape,i,o,1,l,c),d=u.strideDepth,h=u.strideHeight,p=u.strideWidth,m=u.filterDepth,f=u.filterHeight,g=u.filterWidth,x=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,N=v-1-u.padInfo.front,_=k-1-u.padInfo.left,S=w-1-u.padInfo.top,C=gd(r.shape,"float32"),j=1/(m*f*g),T=n.bufferSync(s);for(let I=0;I<u.batchSize;++I)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inDepth;++t)for(let n=0;n<u.inHeight;++n)for(let a=0;a<u.inWidth;++a){const s=t-N,r=n-S,i=a-_;let o=0;for(let t=0;t<v;t+=x){const n=(s+t)/d;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=y){const a=(r+t)/h;if(!(a<0||a>=u.outHeight||Math.floor(a)!==a))for(let t=0;t<k;t+=b){const s=(i+t)/p;if(s<0||s>=u.outWidth||Math.floor(s)!==s)continue;o+=T.get(I,n,a,s,e)}}}C.set(o*j,I,t,n,a,e)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};const kE={kernelName:lr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,input:r}=t,i=r;nI([s,r],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=a,u=zp(i.shape,o,l,1,c),d=u.strideHeight,h=u.strideWidth,p=u.filterHeight,m=u.filterWidth,f=u.dilationHeight,g=u.dilationWidth,x=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,v=x-1-u.padInfo.top,w=gd(i.shape,"float32"),k=1/(p*m),N=n.data.get(s.dataId).values,_=gd(s.shape,"float32",N);for(let S=0;S<u.batchSize;++S)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inHeight;++t)for(let n=0;n<u.inWidth;++n){const a=t-v,s=n-b;let r=0;for(let t=0;t<x;t+=f){const n=(a+t)/d;if(!(n<0||n>=u.outHeight||Math.floor(n)!==n))for(let t=0;t<y;t+=g){const a=(s+t)/h;if(a<0||a>=u.outWidth||Math.floor(a)!==a)continue;r+=_.get(S,n,a,e)}}w.set(r*k,S,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const NE={kernelName:si,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,scale:r,offset:i,mean:o,variance:l}=t;$a(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),$a(null==i||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),$a(null==r||o.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),nI([s,o,l,r,i],"batchNorm");let{varianceEpsilon:c}=a;null==c&&(c=.001);const u=n.data.get(s.dataId).values,d=n.data.get(o.dataId).values,h=n.data.get(l.dataId).values,p=r?n.data.get(r.dataId).values:new Float32Array([1]),m=i?n.data.get(i.dataId).values:new Float32Array([0]),f=new Float32Array(u.length),g=m.length,x=p.length,y=h.length,b=d.length;let v=0,w=0,k=0,N=0;for(let _=0;_<u.length;++_)f[_]=m[v++]+(u[_]-d[w++])*p[k++]/Math.sqrt(h[N++]+c),v>=g&&(v=0),w>=b&&(w=0),k>=x&&(k=0),N>=y&&(N=0);return n.makeTensorInfo(s.shape,s.dtype,f)}};function _E(e,t,n,a,s){const r=rp(a,t,n),i=ns(n),o=Ts(a);if(r){const n=ip(t,o);return"string"===s?e.slice(n,n+i):e.subarray(n,n+i)}const l=gd(a,s,"string"===s?Hb(e):e),c=gd(n,s);for(let u=0;u<c.size;++u){const e=c.indexToLoc(u),n=e.map((e,n)=>e+t[n]);c.set(l.get(...n),...e)}return"string"===s?Gb(c.values):c.values}function SE(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{begin:r,size:i}=a;nI(s,"slice");const[o,l]=op(s,r,i);Kh(s,o,l);const c=_E(n.data.get(s.dataId).values,o,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,c)}const CE={kernelName:So,backendName:"cpu",kernelFunc:SE};const jE={kernelName:hr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{blockShape:r,crops:i}=a;nI([s],"batchToSpaceND");const o=r.reduce((e,t)=>e*t),l=Jy(s.shape,r,o),c=Qy(l.length,r.length),u=$y(s.shape,r,o),d=eb(i,r.length),h=tb(u,i,r.length),p=BI({inputs:{x:s},backend:n,attrs:{shape:l}}),m=$I({inputs:{x:p},backend:n,attrs:{perm:c}}),f=BI({inputs:{x:m},backend:n,attrs:{shape:u}}),g=SE({inputs:{x:f},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(f),g}};function TE(e,t,n,a,s){const r=ns(a),i=Ms(s,n);for(let o=0;o<e.length;o++){const n=e[o];if(n<0)throw new Error("Input x must be non-negative!");n>=s||(i[n]+=r>0?t[o]:1)}return i}function IE(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=e.shape[0],r=e.shape[1],i=gd([s,n],t.dtype);for(let o=0;o<s;o++)for(let s=0;s<r;s++){const r=e.get(o,s);if(r<0)throw new Error("Input x must be non-negative!");r>=n||(a?i.set(1,o,r):t.size>0?i.set(i.get(o,r)+t.get(o,s),o,r):i.set(i.get(o,r)+1,o,r))}return i}const EE={kernelName:pr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,weights:r}=t,{size:i}=a,o=TE(n.data.get(s.dataId).values,n.data.get(r.dataId).values,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,o)}},AE=mI((e,t)=>e&t),RE=LI(mr,AE),ME={kernelName:mr,backendName:"cpu",kernelFunc:RE};const LE={kernelName:gr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:a,s1:s}=t,r=n.data.get(a.dataId).values,i=n.data.get(s.dataId).values,o=Jd(Array.from(r),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},DE=rI(e=>Math.ceil(e)),OE=oI(yr,DE),FE={kernelName:yr,backendName:"cpu",kernelFunc:OE},PE=iI(br,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),zE={kernelName:br,backendName:"cpu",kernelFunc:PE},BE={kernelName:wr,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend,a=new Float32Array(ns(t.shape)),s=n.data.get(t.dataId),r=s.complexTensorInfos.real,i=s.complexTensorInfos.imag,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<o.length;c++){const e=o[c],t=l[c];a[c]=Math.hypot(e,t)}return n.makeOutput(a,t.shape,"float32")}};function WE(e,t,n,a){const s=gs(n,ns(t));if(a&&"string"!==n){let t=0;e.forEach(e=>{const n=ns(e.shape);s.set(e.vals,t),t+=n})}else{let a=0;e.forEach(e=>{const r="string"===n?Hb(e.vals):e.vals;let i=0;for(let n=0;n<e.shape[0];++n){const o=n*t[1]+a;for(let t=0;t<e.shape[1];++t)s[o+t]=r[i++]}a+=e.shape[1]})}return s}function VE(e){const{inputs:t,backend:n}=e,{input:a}=t,s=n.data.get(a.dataId).complexTensorInfos.imag,r=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,r)}const UE={kernelName:di,backendName:"cpu",kernelFunc:VE};function HE(e){const{inputs:t,backend:n,attrs:a}=e,{axis:s}=a,r=ps(s,t[0].shape)[0];Wy(t.map(e=>e.shape),r);let i=Vy(t.map(e=>e.shape),r);if(0===ns(i))return n.makeTensorInfo(i,t[0].dtype,[]);const o=t.filter(e=>ns(e.shape)>0);if(1===o.length)return uI({inputs:{x:o[0]},backend:n});if("complex64"===o[0].dtype){const e=o.map(e=>II({inputs:{input:e},backend:n})),t=o.map(e=>VE({inputs:{input:e},backend:n})),a=HE({inputs:e,backend:n,attrs:{axis:r}}),s=HE({inputs:t,backend:n,attrs:{axis:r}}),i=CI({inputs:{real:a,imag:s},backend:n});return e.forEach(e=>n.disposeIntermediateTensorInfo(e)),t.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),i}const l=o.map(e=>{const t=ns(e.shape.slice(r));return BI({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})}),c=l.map(e=>({vals:n.data.get(e.dataId).values,shape:e.shape}));i=Vy(l.map(e=>e.shape),1);const u=1===l[0].shape[0],d=WE(c,i,t[0].dtype,u),h=Vy(o.map(e=>e.shape),r),p=n.makeTensorInfo(h,t[0].dtype,d);return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),p}const GE={kernelName:kr,backendName:"cpu",kernelFunc:HE};function qE(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r}=t,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=a;nI([s,r],"conv2d");const d=Jp(l),h=Wp(s.shape,r.shape,i,c,o,u,!1,d),p=h.filterHeight,m=h.filterWidth,f=h.dilationHeight,g=h.dilationWidth,x=h.padInfo.left,y=h.padInfo.top,b="channelsLast"===h.dataFormat,v=new nc(h.outShape,s.dtype),w=Ts(s.shape),k=Ts(r.shape),N=w[0],_=b?w[1]:w[2],S=b?w[2]:1,C=b?1:w[1],j=v.strides[0],T=b?v.strides[1]:v.strides[2],I=b?v.strides[2]:1,E=b?1:v.strides[1],A=n.data.get(s.dataId).values,R=n.data.get(r.dataId).values,M=v.values;for(let L=0;L<h.batchSize;++L){const e=L*N,t=L*j;for(let n=0;n<h.outHeight;++n){const a=t+n*T,s=n*h.strideHeight-y;for(let t=0;t<p;++t){const n=s+t*f;if(n<0||n>=h.inHeight)continue;const r=t*k[0],i=e+n*_;for(let e=0;e<h.outWidth;++e){const t=a+e*I,n=e*h.strideWidth-x;for(let e=0;e<m;++e){const a=n+e*g;if(a<0||a>=h.inWidth)continue;const s=i+a*S;let o=r+e*k[1];for(let e=0;e<h.inChannels;++e){const n=A[s+e*C];for(let e=0;e<h.outChannels;++e)M[t+e*E]+=n*R[o+e];o+=h.outChannels}}}}}}return n.makeTensorInfo(v.shape,v.dtype,M)}const KE={kernelName:Nr,backendName:"cpu",kernelFunc:qE};const ZE={kernelName:_r,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,dy:r}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=a;nI([s,r],"conv2dBackpropFilter");const d=Jp(l),h=Wp(s.shape,u,i,1,o,c,!1,d),{strideHeight:p,strideWidth:m,filterHeight:f,filterWidth:g}=h,x="channelsLast"===h.dataFormat,y=new nc(h.filterShape,"float32"),b=h.padInfo.left,v=h.padInfo.top,w=n.data.get(s.dataId).values,k=n.data.get(r.dataId).values,N=new nc(s.shape,s.dtype,w),_=new nc(r.shape,r.dtype,k);for(let S=0;S<f;++S){const e=Math.max(0,Math.ceil((v-S)/p)),t=Math.min(h.outHeight,(h.inHeight+v-S)/p);for(let n=0;n<g;++n){const a=Math.max(0,Math.ceil((b-n)/m)),s=Math.min(h.outWidth,(h.inWidth+b-n)/m);for(let r=0;r<h.inChannels;++r)for(let i=0;i<h.outChannels;++i){let o=0;for(let l=0;l<h.batchSize;++l)for(let c=e;c<t;++c){const e=S+c*p-v;for(let t=a;t<s;++t){const a=n+t*m-b;o+=x?N.get(l,e,a,r)*_.get(l,c,t,i):N.get(l,r,e,a)*_.get(l,i,c,t)}}y.set(o,S,n,r,i)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const XE={kernelName:Sr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,filter:r}=t,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=a;nI([s,r],"conv2dBackpropInput");const d=Ts(r.shape),h=Ts(s.shape);let p=Jp(c);const m=Wp(i,r.shape,o,1,l,u,!1,p),f=new nc(m.inShape,"float32"),g=f.values,x=n.data.get(s.dataId).values,y=n.data.get(r.dataId).values,[b,v,w]=d,{batchSize:k,filterHeight:N,filterWidth:_,inChannels:S,inHeight:C,inWidth:j,outChannels:T,outHeight:I,outWidth:E,strideHeight:A,strideWidth:R}=m;p=m.dataFormat;const M=N-1-m.padInfo.top,L=_-1-m.padInfo.left,D="channelsLast"===p,O=f.strides[0],F=D?f.strides[1]:f.strides[2],P=D?f.strides[2]:1,z=D?1:f.strides[1],B=h[0],W=D?h[1]:h[2],V=D?h[2]:1,U=D?1:h[1];for(let H=0;H<k;++H)for(let e=0;e<S;++e)for(let t=0;t<C;++t){const n=t-M,a=Math.max(0,Math.ceil(n/A)),s=Math.min(I,(N+n)/A);for(let r=0;r<j;++r){const i=r-L,o=Math.max(0,Math.ceil(i/R)),l=Math.min(E,(_+i)/R);let c=0;for(let t=a;t<s;++t){const a=t*A-n;for(let n=o;n<l;++n){const s=B*H+W*t+V*n,r=b*(N-1-a)+v*(_-1-(n*R-i))+w*e;for(let e=0;e<T;++e){c+=x[s+U*e]*y[r+e]}}}g[O*H+F*t+P*r+z*e]=c}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};const YE={kernelName:Cr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r}=t,{strides:i,pad:o,dilations:l}=a;nI([s,r],"conv3d");const c=Vp(s.shape,r.shape,i,l,o),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:p,dilationHeight:m,dilationWidth:f,padInfo:g}=c,x=g.front,y=g.left,b=g.top,v=new nc(c.outShape,s.dtype),w=n.data.get(s.dataId).values,k=n.data.get(r.dataId).values,N=v.values,_=Ts(s.shape),S=Ts(r.shape);for(let C=0;C<c.batchSize;++C){const e=C*_[0],t=C*v.strides[0];for(let n=0;n<c.outDepth;++n){const a=t+n*v.strides[1],s=n*c.strideDepth-x;for(let t=0;t<u;++t){const n=s+t*p;if(n<0||n>=c.inDepth)continue;const r=t*S[0],i=e+n*_[1];for(let e=0;e<c.outHeight;++e){const t=a+e*v.strides[2],n=e*c.strideHeight-b;for(let e=0;e<d;++e){const a=n+e*m;if(a<0||a>=c.inHeight)continue;const s=r+e*S[1],o=i+a*_[2];for(let e=0;e<c.outWidth;++e){const n=t+e*c.outChannels,a=e*c.strideWidth-y;for(let e=0;e<h;++e){const t=a+e*f;if(t<0||t>=c.inWidth)continue;const r=s+e*S[2],i=o+t*c.inChannels;let l=r;for(let e=0;e<c.inChannels;++e){const t=w[i+e];for(let e=0;e<c.outChannels;++e)N[n+e]+=t*k[l+e];l+=c.outChannels}}}}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const JE={kernelName:jr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,dy:r}=t,{strides:i,pad:o,filterShape:l}=a;nI([s,r],"conv3dBackpropFilterV2");const c=Ts(s.shape),u=Ts(r.shape),d=Vp(s.shape,l,i,1,o),h=d.strideDepth,p=d.strideHeight,m=d.strideWidth,f=d.filterDepth,g=d.filterHeight,x=d.filterWidth,y=new nc(d.filterShape,"float32"),b=y.values,[v,w,k,N]=y.strides,_=n.data.get(r.dataId).values,[S,C,j,T]=u,I=n.data.get(s.dataId).values,[E,A,R,M]=c,L=d.padInfo.front,D=d.padInfo.left,O=d.padInfo.top;for(let F=0;F<f;++F){const e=Math.max(0,Math.ceil((L-F)/h)),t=Math.min(d.outDepth,(d.inDepth+L-F)/h),n=F*v;for(let a=0;a<g;++a){const s=Math.max(0,Math.ceil((O-a)/p)),r=Math.min(d.outHeight,(d.inHeight+O-a)/p),i=a*w+n;for(let n=0;n<x;++n){const o=Math.max(0,Math.ceil((D-n)/m)),l=Math.min(d.outWidth,(d.inWidth+D-n)/m),c=n*k+i;for(let i=0;i<d.inChannels;++i){const u=i*N+c;for(let c=0;c<d.outChannels;++c){let f=0;for(let u=0;u<d.batchSize;++u){const d=u*E,g=u*S;for(let u=e;u<t;++u){const e=(F+u*h-L)*A+d,t=u*C+g;for(let u=s;u<r;++u){const s=(a+u*p-O)*R+e,r=u*j+t;for(let e=o;e<l;++e){const t=e*T+r;f+=I[(n+e*m-D)*M+s+i]*_[t+c]}}}}b[u+c]=f}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const QE={kernelName:Tr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,filter:r}=t,{pad:i,strides:o,inputShape:l}=a;nI([s],"conv3dBackpropInputV2");const c=Ts(s.shape),u=Ts(r.shape),d=Vp(l,r.shape,o,1,i),h=new nc(d.inShape,"float32"),p=h.values,[m,f,g,x]=h.strides,y=n.data.get(s.dataId).values,[b,v,w,k]=c,N=n.data.get(r.dataId).values,[_,S,C,j]=u,{batchSize:T,filterDepth:I,filterHeight:E,filterWidth:A,inChannels:R,inDepth:M,inHeight:L,inWidth:D,outChannels:O,outDepth:F,outHeight:P,outWidth:z,strideDepth:B,strideHeight:W,strideWidth:V}=d,U=I-1-d.padInfo.front,H=E-1-d.padInfo.top,G=A-1-d.padInfo.left;for(let q=0;q<T;++q)for(let e=0;e<R;++e)for(let t=0;t<M;++t){const n=t-U,a=Math.max(0,Math.ceil(n/B)),s=Math.min(F,(I+n)/B);for(let r=0;r<L;++r){const i=r-H,o=Math.max(0,Math.ceil(i/W)),l=Math.min(P,(E+i)/W);for(let c=0;c<D;++c){const u=c-G,d=Math.max(0,Math.ceil(u/V)),h=Math.min(z,(A+u)/V);let T=0;for(let t=a;t<s;++t){const a=t*B-n;for(let n=o;n<l;++n){const s=n*W-i;for(let r=d;r<h;++r){const i=b*q+v*t+w*n+k*r,o=_*(I-1-a)+S*(E-1-s)+C*(A-1-(r*V-u))+j*e;for(let e=0;e<O;++e){T+=y[i+e]*N[o+e]}}}}p[m*q+f*t+g*r+x*c+e]=T}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},$E=iI(Ir,e=>Math.cos(e)),eA={kernelName:Ir,backendName:"cpu",kernelFunc:$E},tA=iI(Er,e=>Math.cosh(e)),nA={kernelName:Er,backendName:"cpu",kernelFunc:tA};const aA={kernelName:Mr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{image:s,boxes:r,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:c}=a,[u,d,h,p]=s.shape,m=r.shape[0],[f,g]=o,x=gd([m,f,g,p],"float32"),y=n.data.get(r.dataId).values,b=n.data.get(i.dataId).values,v=n.data.get(s.dataId).values,w=Ts(s.shape),k=Ts(x.shape);for(let N=0;N<m;N++){const e=4*N,t=y[e],n=y[e+1],a=y[e+2],s=y[e+3],r=b[N];if(r>=u)continue;const i=f>1?(a-t)*(d-1)/(f-1):0,o=g>1?(s-n)*(h-1)/(g-1):0;for(let u=0;u<f;u++){const e=f>1?t*(d-1)+u*i:.5*(t+a)*(d-1);if(e<0||e>d-1)for(let t=0;t<g;t++)for(let e=0;e<p;e++){const n=e+t*k[2]+u*k[1]+N*k[0];x.values[n]=c}else if("bilinear"===l){const t=Math.floor(e),a=Math.ceil(e),i=e-t;for(let e=0;e<g;e++){const l=g>1?n*(h-1)+e*o:.5*(n+s)*(h-1);if(l<0||l>h-1){for(let t=0;t<p;t++){const n=t+e*k[2]+u*k[1]+N*k[0];x.values[n]=c}continue}const d=Math.floor(l),m=Math.ceil(l),f=l-d;for(let n=0;n<p;n++){let s=n+d*w[2]+t*w[1]+r*w[0];const o=v[s];s=n+m*w[2]+t*w[1]+r*w[0];const l=v[s];s=n+d*w[2]+a*w[1]+r*w[0];const c=v[s];s=n+m*w[2]+a*w[1]+r*w[0];const h=o+(l-o)*f,p=c+(v[s]-c)*f;s=n+e*k[2]+u*k[1]+N*k[0],x.values[s]=h+(p-h)*i}}}else for(let t=0;t<g;++t){const a=g>1?n*(h-1)+t*o:.5*(n+s)*(h-1);if(a<0||a>h-1){for(let e=0;e<p;e++){const n=e+t*k[2]+u*k[1]+N*k[0];x.values[n]=c}continue}const i=Math.round(a),l=Math.round(e);for(let e=0;e<p;e++){const n=e+i*w[2]+l*w[1]+r*w[0],a=e+t*k[2]+u*k[1]+N*k[0];x.values[a]=v[n]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};const sA={kernelName:Ar,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,exclusive:i,reverse:o}=a;nI(s,"cumprod");const l=Jm([r],s.shape.length);let c=s;null!=l&&(c=$I({inputs:{x:s},backend:n,attrs:{perm:l}}));const u=$m(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(u));const d=fc(c.dtype,"int32"),h=Rs(ns(c.shape),d),p=n.data.get(c.dataId).values,m=c.shape[c.shape.length-1],f=o?(e,t)=>e+m-t-1:(e,t)=>e+t;for(let x=0;x<p.length;x+=m)for(let e=0;e<m;e++){const t=f(x,e);if(0===e)h[t]=i?1:p[t];else{const n=f(x,e-1);h[t]=i?p[n]*h[n]:p[t]*h[n]}}const g=n.makeTensorInfo(c.shape,d,h);if(null!=l){const e=$I({inputs:{x:g},backend:n,attrs:{perm:Qm(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),e}return g}};const rA={kernelName:Rr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,exclusive:i,reverse:o}=a;nI(s,"cumsum");const l=Jm([r],s.shape.length);let c=s;null!=l&&(c=$I({inputs:{x:s},backend:n,attrs:{perm:l}}));const u=$m(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(u));const d=fc(c.dtype,"int32"),h=Ms(ns(c.shape),d),p=n.data.get(c.dataId).values,m=c.shape[c.shape.length-1],f=o?(e,t)=>e+m-t-1:(e,t)=>e+t;for(let x=0;x<p.length;x+=m)for(let e=0;e<m;e++){const t=f(x,e);if(0===e)h[t]=i?0:p[t];else{const n=f(x,e-1);h[t]=i?p[n]+h[n]:p[t]+h[n]}}const g=n.makeTensorInfo(c.shape,d,h);if(null!=l){const e=$I({inputs:{x:g},backend:n,attrs:{perm:Qm(l)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),e}return g}};const iA={kernelName:Lr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,weights:r}=t,{size:i,binaryOutput:o}=a;if(1===s.shape.length){const e=TE(n.data.get(s.dataId).values,n.data.get(r.dataId).values,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,e)}if(2===s.shape.length){const e=IE(n.bufferSync(s),n.bufferSync(r),i,o);return n.makeTensorInfo(e.shape,r.dtype,e.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(s.shape.length,"."))}};const oA={kernelName:Dr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{blockSize:r,dataFormat:i}=a;$a("NHWC"===i,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(i));const o=s.shape[0],l=s.shape[1],c=s.shape[2],u=s.shape[3],d=l*r,h=c*r,p=u/(r*r),m=n.data.get(s.dataId).values,f=new Float32Array(o*d*h*p);let g=0;for(let x=0;x<o;++x)for(let e=0;e<d;++e){const t=Math.floor(e/r),n=e%r;for(let e=0;e<h;++e){const a=Math.floor(e/r),s=(n*r+e%r)*p;for(let e=0;e<p;++e){const n=e+s+u*(a+c*(t+l*x));f[g++]=m[n]}}}return n.makeTensorInfo([o,d,h,p],s.dtype,f)}};function lA(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=a;nI([s,r],"depthwiseConv2DNative");const u=Ts(s.shape),d=Ts(r.shape);let h=l;null==h&&(h=[1,1]),$a(Xp(i,h),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(h,"'"));const p=Wp(s.shape,r.shape,i,h,o,c,!0),{filterHeight:m,filterWidth:f,dilationHeight:g,dilationWidth:x,padInfo:y}=p,b=y.left,v=y.top,w=p.outChannels/p.inChannels,k=new nc(p.outShape,s.dtype),N=n.data.get(s.dataId).values,_=n.data.get(r.dataId).values,S=k.values;for(let C=0;C<p.batchSize;++C){const e=C*u[0],t=C*k.strides[0];for(let n=0;n<p.outHeight;++n){const a=t+n*k.strides[1],s=n*p.strideHeight-v;for(let t=0;t<m;++t){const n=s+t*g;if(n<0||n>=p.inHeight)continue;const r=t*d[0],i=e+n*u[1];for(let e=0;e<p.outWidth;++e){const t=a+e*k.strides[2],n=e*p.strideWidth-b;for(let e=0;e<f;++e){const a=n+e*x;if(a<0||a>=p.inWidth)continue;const s=r+e*d[1],o=i+a*p.inChannels;let l=t,c=s;for(let e=0;e<p.inChannels;++e){const t=N[o+e];for(let e=0;e<w;++e)S[l+e]+=t*_[c+e];l+=w,c+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const cA={kernelName:Or,backendName:"cpu",kernelFunc:lA};const uA={kernelName:Fr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,dy:r}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=a;nI([s,r],"depthwiseConv2dNativeBackpropFilter");const d=Wp(s.shape,u,i,o,l,c,!0),{strideHeight:h,strideWidth:p,filterHeight:m,filterWidth:f}=d,g=new nc(d.filterShape,"float32"),x=d.padInfo.left,y=d.padInfo.top,b=d.outChannels/d.inChannels,v=n.data.get(s.dataId).values,w=new nc(s.shape,s.dtype,v),k=n.data.get(r.dataId).values,N=new nc(r.shape,r.dtype,k);for(let _=0;_<m;++_){const e=Math.max(0,Math.ceil((y-_)/h)),t=Math.min(d.outHeight,(d.inHeight+y-_)/h);for(let n=0;n<f;++n){const a=Math.max(0,Math.ceil((x-n)/p)),s=Math.min(d.outWidth,(d.inWidth+x-n)/p);for(let r=0;r<d.outChannels;++r){const i=Math.trunc(r/b),o=r%b;let l=0;for(let c=0;c<d.batchSize;++c)for(let o=e;o<t;++o){const e=_+o*h-y;for(let t=a;t<s;++t){const a=n+t*p-x;l+=w.get(c,e,a,i)*N.get(c,o,t,r)}}g.set(l,_,n,i,o)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const dA={kernelName:Pr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,filter:r}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=a;nI([s,r],"depthwiseConv2DNativeBackpropInput");const d=Ts(s.shape),h=Ts(r.shape),p=Wp(u,r.shape,i,o,l,c,!0),m=new nc(p.inShape,"float32"),f=m.values,[g,x,y]=m.strides,b=n.data.get(s.dataId).values,[v,w,k]=d,N=n.data.get(r.dataId).values,[_,S,C]=h,{batchSize:j,filterHeight:T,filterWidth:I,inChannels:E,inHeight:A,inWidth:R,outChannels:M,outHeight:L,outWidth:D,strideHeight:O,strideWidth:F}=p,P=T-1-p.padInfo.top,z=I-1-p.padInfo.left,B=M/E;for(let W=0;W<j;++W)for(let e=0;e<E;++e)for(let t=0;t<A;++t){const n=t-P,a=Math.max(0,Math.ceil(n/O)),s=Math.min(L,(T+n)/O);for(let r=0;r<R;++r){const i=r-z,o=Math.max(0,Math.ceil(i/F)),l=Math.min(D,(I+i)/F);let c=0;for(let t=a;t<s;++t){const a=t*O-n;for(let n=o;n<l;++n){const s=v*W+w*t+k*n,r=_*(T-1-a)+S*(I-1-(n*F-i))+C*e;for(let t=0;t<B;++t){c+=b[s+(e*B+t)]*N[r+t]}}}f[g*W+x*t+y*r+e]=c}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const hA={kernelName:zr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a}=t,s=ns(a.shape),r=n.data.get(a.dataId).values,i=gd([s,s],a.dtype),o=i.values;for(let c=0;c<r.length;c++)o[c*s+c]=r[c];const l=[...a.shape,...a.shape];return n.makeTensorInfo(l,i.dtype,i.values)}},pA={kernelName:Br,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e;const{x:s,filter:r}=t,{strides:i,pad:o,dilations:l}=a,c=n,u=c.data.get(s.dataId).values,d=s.shape.length,h=c.data.get(r.dataId).values,p=r.shape.length,{batchSize:m,inHeight:f,inWidth:g,inChannels:x,outHeight:y,outWidth:b,padInfo:v,strideHeight:w,strideWidth:k,filterHeight:N,filterWidth:_,dilationHeight:S,dilationWidth:C,outShape:j}=Pp(s.shape,r.shape,i,o,"NHWC",l),T=ns(j),I=j.length,E=gs(s.dtype,T);for(let A=0;A<m;++A)for(let e=0;e<y;++e){const t=e*w-v.top;for(let n=0;n<b;++n){const a=n*k-v.left;for(let i=0;i<x;++i){let o=Number.MIN_SAFE_INTEGER;for(let e=0;e<N;++e){const n=t+e*S;if(n>=0&&n<f)for(let t=0;t<_;++t){const l=a+t*C;if(l>=0&&l<g){const a=Os([A,n,l,i],d,Ts(s.shape)),c=Os([e,t,i],p,Ts(r.shape)),m=u[a]+h[c];m>o&&(o=m)}}}E[Os([A,e,n,i],I,Ts(j))]=o}}}return{dataId:c.write(Wl(E,s.dtype),j,s.dtype),shape:j,dtype:s.dtype}}},mA={kernelName:Vr,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e;const{x:s,filter:r,dy:i}=t,{strides:o,pad:l,dilations:c}=a,u=n,d=Es(s.shape,u.data.get(s.dataId).values),h=Es(r.shape,u.data.get(r.dataId).values),{batchSize:p,inHeight:m,inWidth:f,inChannels:g,outHeight:x,outWidth:y,padInfo:b,strideHeight:v,strideWidth:w,filterHeight:k,filterWidth:N,dilationHeight:_,dilationWidth:S,outShape:C}=Pp(s.shape,r.shape,o,l,"NHWC",c);$a(i.rank===C.length,()=>"Error in ".concat(Vr,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(i.rank));const j=Es(C,u.data.get(i.dataId).values),T=Ls(r.shape,r.dtype);for(let I=0;I<p;++I)for(let e=0;e<x;++e){const t=e*v-b.top;for(let n=0;n<y;++n){const a=n*w-b.left;for(let s=0;s<g;++s){let r=Number.MIN_SAFE_INTEGER,i=0,o=0;for(let e=0;e<k;++e){const n=t+e*_;if(n>=0&&n<m)for(let t=0;t<N;++t){const l=a+t*S;if(l>=0&&l<f){const a=d[I][n][l][s]+h[e][t][s];a>r&&(r=a,i=e,o=t)}}}T[i][o][s]+=j[I][e][n][s]}}}return{dataId:u.write(Wl(T,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},fA={kernelName:Wr,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e;const{x:s,filter:r,dy:i}=t,{strides:o,pad:l,dilations:c}=a,u=n,d=Es(s.shape,u.data.get(s.dataId).values),h=Es(r.shape,u.data.get(r.dataId).values),{batchSize:p,inHeight:m,inWidth:f,inChannels:g,outHeight:x,outWidth:y,padInfo:b,strideHeight:v,strideWidth:w,filterHeight:k,filterWidth:N,dilationHeight:_,dilationWidth:S,outShape:C}=Pp(s.shape,r.shape,o,l,"NHWC",c);$a(i.rank===C.length,()=>"Error in ".concat(Wr,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(i.rank));const j=Es(C,u.data.get(i.dataId).values),T=Ls(s.shape,s.dtype);for(let I=0;I<p;++I)for(let e=0;e<x;++e){const t=e*v-b.top;for(let n=0;n<y;++n){const a=n*w-b.left;for(let s=0;s<g;++s){let r=Number.MIN_SAFE_INTEGER,i=t<0?0:t,o=a<0?0:a;for(let e=0;e<k;++e){const n=t+e*_;if(n>=0&&n<m)for(let t=0;t<N;++t){const l=a+t*S;if(l>=0&&l<f){const a=d[I][n][l][s]+h[e][t][s];a>r&&(r=a,i=n,o=l)}}}T[I][i][o][s]+=j[I][e][n][s]}}}return{dataId:u.write(Wl(T,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};const gA={kernelName:Ur,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{image:s}=t,{canvas:r,options:i}=a,{contextOptions:o,imageOptions:l}=i||{},c=(null===l||void 0===l?void 0:l.alpha)||1,u=(null===o||void 0===o?void 0:o.contextType)||"2d";if("2d"!==u)throw new Error("Context type ".concat(o.contextType," is not supported by the CPU backend."));const d=r.getContext(u,(null===o||void 0===o?void 0:o.contextAttributes)||{});if(null==d)throw new Error("Could not get the context with ".concat(u," type."));const[h,p]=s.shape.slice(0,2),m=2===s.shape.length?1:s.shape[2],f=n.data.get(s.dataId).values,g="float32"===s.dtype?255:1,x=new Uint8ClampedArray(p*h*4);for(let b=0;b<h*p;++b){const e=[0,0,0,255*c];for(let n=0;n<m;n++){const t=f[b*m+n];if("float32"===s.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===s.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(t,"."));1===m?(e[0]=t*g,e[1]=t*g,e[2]=t*g):e[n]=t*g}const t=4*b;x[t+0]=Math.round(e[0]),x[t+1]=Math.round(e[1]),x[t+2]=Math.round(e[2]),x[t+3]=Math.round(e[3])}r.width=p,r.height=h;const y=new ImageData(x,p,h);return d.putImageData(y,0,0),s}},xA=mI((e,t)=>e*t),yA=DI((e,t,n,a)=>({real:e*n-t*a,imag:e*a+t*n})),bA=LI(Ui,xA,yA),vA={kernelName:Ui,backendName:"cpu",kernelFunc:bA};function wA(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a;let o;nI(s,"sum"),o="bool"===s.dtype?RI({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):uI({inputs:{x:s},backend:n});const l=o.shape.length,c=ps(r,o.shape),u=Jm(c,l);let d=c,h=o;null!=u&&(h=$I({inputs:{x:o},backend:n,attrs:{perm:u}}),d=$m(d.length,l)),Ym("sum",d,h.shape.length);const[p,m]=Zm(h.shape,d);let f=TI(n,p,fc(h.dtype,"int32"));const g=ns(m),x=n.data.get(f.dataId).values,y=n.data.get(h.dataId).values;for(let b=0;b<x.length;++b){const e=b*g;let t=0;for(let n=0;n<g;++n)t+=y[e+n];x[b]=t}if(i){const e=f;f=BI({inputs:{x:f},backend:n,attrs:{shape:Xm(f.shape,c)}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(o),null!=u&&n.disposeIntermediateTensorInfo(h),f}const kA={kernelName:Ro,backendName:"cpu",kernelFunc:wA};const NA={kernelName:Gr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{equation:s}=a,r=t,{allDims:i,summedDims:o,idDims:l}=kb(s,r.length);_b(i.length,l,r);const{path:c,steps:u}=Sb(o,l),d=u.length;let h=null,p=i.length;const m=[];for(let f=0;f<d;++f){for(const e of u[f]){const{permutationIndices:t,expandDims:a}=Nb(p,l[e]);let s;Cb(t)?s=r[e]:(s=$I({inputs:{x:r[e]},backend:n,attrs:{perm:t}}),m.push(s));const i=s.shape.slice();for(let e=0;e<a.length;++e)i.splice(a[e],0,1);rs(s.shape,i)||(s=BI({inputs:{x:s},backend:n,attrs:{shape:i}}),m.push(s)),null===h?h=s:(h=bA({inputs:{a:s,b:h},backend:n}),m.push(h))}f<d-1&&(c[f]>=0&&(h=wA({inputs:{x:h},backend:n,attrs:{axis:c[f]-(i.length-p),keepDims:!1}}),m.push(h)),p--)}for(const f of m)f!==h&&n.disposeIntermediateTensorInfo(f);return h}};const _A={kernelName:Kr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{dy:a,y:s}=t;nI([a,s],"eluGrad");const r=new Float32Array(ns(s.shape)),i=n.data.get(s.dataId).values,o=n.data.get(a.dataId).values;for(let l=0;l<i.length;++l){const e=i[l];r[l]=e>=0?o[l]:o[l]*(e+1)}return n.makeTensorInfo(s.shape,"float32",r)}},SA=mI((e,t)=>e===t?1:0),CA=LI(Xr,SA,null,"bool"),jA={kernelName:Xr,backendName:"cpu",kernelFunc:CA},TA=sb,IA=rb,EA=ib,AA=ob,RA=lb,MA=cb,LA=iI(Zr,e=>{const t=Math.sign(e),n=Math.abs(e),a=1/(1+TA*n);return t*(1-((((MA*a+RA)*a+AA)*a+EA)*a+IA)*a*Math.exp(-n*n))}),DA={kernelName:Zr,backendName:"cpu",kernelFunc:LA},OA=rI(e=>Math.exp(e)),FA=oI(Yr,OA,"float32"),PA={kernelName:Yr,backendName:"cpu",kernelFunc:FA};function zA(e){const{inputs:t,backend:n,attrs:a}=e,{input:s}=t,{dim:r}=a,i=s.shape.length,o=s.shape.slice();let l=r;return r<0&&($a(-(i+1)<=r,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),l=i+r+1),o.splice(l,0,1),BI({inputs:{x:s},backend:n,attrs:{shape:o}})}const BA={kernelName:Jr,backendName:"cpu",kernelFunc:zA},WA=rI(e=>Math.expm1(e)),VA=oI(Qr,WA),UA={kernelName:Qr,backendName:"cpu",kernelFunc:VA},HA=mI((e,t)=>e/t),GA=LI(Hr,HA),qA={kernelName:Hr,backendName:"cpu",kernelFunc:GA},KA=mI((e,t)=>e-t),ZA=DI((e,t,n,a)=>({real:e-n,imag:t-a})),XA=LI(Zo,KA,ZA),YA={kernelName:Zo,backendName:"cpu",kernelFunc:XA};function JA(e,t,n){const a=e.shape,s=a[0],r=a[1],i=n.data.get(e.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[s,r],u=ns(c),d=fs("float32",u),h=fs("float32",u);for(let g=0;g<s;g++){const e=SE({inputs:{x:o},backend:n,attrs:{begin:[g,0],size:[1,r]}}),a=SE({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,r]}}),s=CI({inputs:{real:e,imag:a},backend:n}),{real:i,imag:c}=QA(s,t,n),u=ub(i,c);for(let t=0;t<r;t++){const e=mb(u,t);d[g*r+t]=e.real,h[g*r+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s)}const p=n.makeTensorInfo(c,"float32",d),m=n.makeTensorInfo(c,"float32",h),f=CI({inputs:{real:p,imag:m},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),f}function QA(e,t,n){const a=ns(e.shape),s=n.data.get(e.dataId),r=n.data.get(s.complexTensorInfos.real.dataId).values,i=n.data.get(s.complexTensorInfos.imag.dataId).values;if(0===((o=a)&o-1)){const s=$A(r,i,a,t,n),o=[e.shape[0],e.shape[1]];if(t){const e=n.makeTensorInfo(o,"float32",s.real),t=n.makeTensorInfo(o,"float32",s.imag),r=n.makeTensorInfo([],"float32",Bl(a,"float32")),i=uI({inputs:{x:r},backend:n}),l=qA.kernelFunc({inputs:{a:e,b:r},backend:n}),c=qA.kernelFunc({inputs:{a:t,b:i},backend:n}),u=n.data.get(l.dataId).values,d=n.data.get(c.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),{real:u,imag:d}}return s}{const e=function(e,t,n){const a=new Float32Array(2*t);for(let s=0;s<t;s++){let r=0,i=0;for(let a=0;a<t;a++){const o=xb(s*a,t,n),l=mb(e,a);r+=l.real*o.real-l.imag*o.imag,i+=l.real*o.imag+l.imag*o.real}n&&(r/=t,i/=t),fb(a,r,i,s)}return a}(ub(r,i),a,t);return db(e)}var o}function $A(e,t,n,a,s){if(1===n)return{real:e,imag:t};const r=ub(e,t),i=n/2,o=hb(r),l=o.real,c=o.imag,u=[l.length],d=s.makeTensorInfo(u,"float32",l),h=s.makeTensorInfo(u,"float32",c),p=CI({inputs:{real:d,imag:h},backend:s}),m=pb(r),f=m.real,g=m.imag,x=[f.length],y=s.makeTensorInfo(x,"float32",f),b=s.makeTensorInfo(x,"float32",g),v=CI({inputs:{real:y,imag:b},backend:s}),w=$A(l,c,i,a,s),k=w.real,N=w.imag,_=[k.length],S=s.makeTensorInfo(_,"float32",k),C=s.makeTensorInfo(_,"float32",N),j=CI({inputs:{real:S,imag:C},backend:s}),T=$A(f,g,i,a,s),I=T.real,E=T.imag,A=[I.length],R=s.makeTensorInfo(A,"float32",I),M=s.makeTensorInfo(A,"float32",E),L=CI({inputs:{real:R,imag:M},backend:s}),D=gb(n,a),O=[D.real.length],F=s.makeTensorInfo(O,"float32",D.real),P=s.makeTensorInfo(O,"float32",D.imag),z=CI({inputs:{real:F,imag:P},backend:s}),B=bA({inputs:{a:z,b:L},backend:s}),W=PI({inputs:{a:j,b:B},backend:s}),V=XA({inputs:{a:j,b:B},backend:s}),U=II({inputs:{input:W},backend:s}),H=II({inputs:{input:V},backend:s}),G=VE({inputs:{input:W},backend:s}),q=VE({inputs:{input:V},backend:s}),K=HE({inputs:[U,H],backend:s,attrs:{axis:0}}),Z=HE({inputs:[G,q],backend:s,attrs:{axis:0}}),X=s.data.get(K.dataId).values,Y=s.data.get(Z.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(p),s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(S),s.disposeIntermediateTensorInfo(C),s.disposeIntermediateTensorInfo(j),s.disposeIntermediateTensorInfo(R),s.disposeIntermediateTensorInfo(M),s.disposeIntermediateTensorInfo(L),s.disposeIntermediateTensorInfo(F),s.disposeIntermediateTensorInfo(P),s.disposeIntermediateTensorInfo(z),s.disposeIntermediateTensorInfo(B),s.disposeIntermediateTensorInfo(W),s.disposeIntermediateTensorInfo(V),s.disposeIntermediateTensorInfo(U),s.disposeIntermediateTensorInfo(G),s.disposeIntermediateTensorInfo(H),s.disposeIntermediateTensorInfo(q),s.disposeIntermediateTensorInfo(K),s.disposeIntermediateTensorInfo(Z),{real:X,imag:Y}}const eR={kernelName:$r,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:a}=t,s=ns(a.shape),r=a.shape[a.shape.length-1],i=BI({inputs:{x:a},backend:n,attrs:{shape:[s/r,r]}}),o=JA(i,!1,n),l=BI({inputs:{x:o},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}};function tR(e){const{backend:t,attrs:n}=e,{shape:a,value:s,dtype:r}=n,i=r||Ss(s),o=gs(i,ns(a));return function(e,t){e.fill(t)}(o,s),t.makeTensorInfo(a,i,o)}const nR={kernelName:ei,backendName:"cpu",kernelFunc:tR};const aR={kernelName:ti,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e;const{image:s}=t,r=a,i=fs(s.dtype,ns(s.shape)),[o,l,c,u]=s.shape,d=r.data.get(s.dataId).values;for(let h=0;h<o;h++){const e=h*c*l*u;for(let t=0;t<l;t++){const n=t*(c*u);for(let t=0;t<c;t++){const a=t*u;for(let s=0;s<u;s++){const r=Math.round(c-t-1),o=e+n+a+s;let l=d[o];if(r>=0&&r<c){l=d[e+n+r*u+s]}i[o]=l}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},sR=rI(e=>Math.floor(e)),rR=oI(ni,sR),iR={kernelName:ni,backendName:"cpu",kernelFunc:rR},oR=mI((e,t)=>Math.floor(e/t)),lR=LI(ai,oR,null,"int32"),cR={kernelName:ai,backendName:"cpu",kernelFunc:lR};const uR={kernelName:ul,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:m}=a;let f=qE({inputs:{x:s,filter:r},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const e=f;if("NCHW"===u&&1===i.shape.length&&1!==i.shape[0]){const e=BI({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});f=PI({inputs:{a:f,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else f=PI({inputs:{a:f,b:i},backend:n});n.disposeIntermediateTensorInfo(e)}if(p){const e=f;if("NCHW"===u&&"prelu"===p&&1===o.shape.length&&1!==o.shape[0]){const e=BI({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});f=SI(n,f,p,e,m),n.disposeIntermediateTensorInfo(e)}else f=SI(n,f,p,o,m);n.disposeIntermediateTensorInfo(e)}return f}};const dR={kernelName:dl,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:m}=a;let f=lA({inputs:{x:s,filter:r},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const e=f;f=PI({inputs:{a:f,b:i},backend:n}),n.disposeIntermediateTensorInfo(e)}if(p){const e=f;f=SI(n,f,p,o,m),n.disposeIntermediateTensorInfo(e)}return f}};function hR(e,t,n,a,s,r,i,o,l){const c=gd([a,r],n);for(let u=0;u<a;u++){const n=[];let a=0;for(let t=0;t<s;t++){const r=e[u*s+t];a+=r*i[t],n.push(r)}if(a<0||a>=l/r)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(o));for(let e=0;e<r;e++)c.values[u*r+e]=t.get(...t.indexToLoc(a*r+e))}return c}const pR={kernelName:ii,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:a,indices:s}=t,r=ns(a.shape),i=s.shape,o=i[i.length-1],[l,c,u,d]=Wh(a,s);if(0===c)return n.makeTensorInfo(l,a.dtype,[]);const h=hR(n.data.get(s.dataId).values,n.bufferSync(a),a.dtype,c,o,u,d,a.shape,r);return n.makeTensorInfo(l,a.dtype,h.values)}};function mR(e,t,n){const a=gd(n,e.dtype);for(let s=0;s<a.size;++s){const n=a.indexToLoc(s).slice(),r=n[0],i=n[2],o=t.locToIndex([r,i]);n[2]=t.values[o];const l=e.locToIndex(n);0<=l&&l<e.values.length&&(a.values[s]=e.values[l])}return a}const fR={kernelName:ri,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,indices:r}=t,{axis:i,batchDims:o}=a;nI([s,r],"gatherV2");const l=ps(i,s.shape)[0],c=n.data.get(r.dataId).values,u=s.shape[l];for(let b=0;b<c.length;++b){const e=c[b];$a(e<=u-1&&e>=0,()=>"GatherV2: the index value ".concat(e," is not in [0, ").concat(u-1,"]"))}let d=o;null==o&&(d=0);const h=ns(r.shape),p=Ub(s,r,l,d),m=BI({inputs:{x:s},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),f=BI({inputs:{x:r},backend:n,attrs:{shape:[p.batchSize,h/p.batchSize]}}),g=[p.batchSize,p.outerSize,h/p.batchSize,p.sliceSize],x=n.bufferSync(f),y=mR(n.bufferSync(m),x,g);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(f),n.makeTensorInfo(p.outputShape,y.dtype,y.values)}},gR=mI((e,t)=>e>t?1:0),xR=LI(oi,gR,null,"bool"),yR={kernelName:oi,backendName:"cpu",kernelFunc:xR},bR=mI((e,t)=>e>=t?1:0),vR=LI(li,bR,null,"bool"),wR={kernelName:li,backendName:"cpu",kernelFunc:vR};const kR={kernelName:ui,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:a}=t,s=ns(a.shape),r=a.shape[a.shape.length-1],i=BI({inputs:{x:a},backend:n,attrs:{shape:[s/r,r]}}),o=JA(i,!0,n),l=BI({inputs:{x:o},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}},NR=iI(hi,e=>Number.isFinite(e)?1:0,"bool"),_R={kernelName:hi,backendName:"cpu",kernelFunc:NR},SR=iI(pi,e=>Math.abs(e)===1/0?1:0,"bool"),CR={kernelName:pi,backendName:"cpu",kernelFunc:SR},jR=iI(mi,e=>Number.isNaN(e)?1:0,"bool"),TR={kernelName:mi,backendName:"cpu",kernelFunc:jR},IR=mI((e,t)=>e<t?1:0),ER=LI(gi,IR,null,"bool"),AR={kernelName:gi,backendName:"cpu",kernelFunc:ER},RR=mI((e,t)=>e<=t?1:0),MR=LI(xi,RR,null,"bool"),LR={kernelName:xi,backendName:"cpu",kernelFunc:MR};function DR(e,t,n){const a=(t-e)/(n-1),s=Ms(n,"float32");s[0]=e;for(let r=1;r<s.length;r++)s[r]=s[r-1]+a;return s}const OR={kernelName:yi,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:a,stop:s,num:r}=n,i=DR(a,s,r);return t.makeTensorInfo([i.length],"float32",i)}},FR=rI(e=>Math.log(e)),PR=oI(bi,FR),zR={kernelName:bi,backendName:"cpu",kernelFunc:PR},BR=iI(vi,e=>Math.log1p(e)),WR={kernelName:vi,backendName:"cpu",kernelFunc:BR},VR=mI((e,t)=>e&&t),UR=LI(wi,VR,null,"bool"),HR={kernelName:wi,backendName:"cpu",kernelFunc:UR},GR=iI(ki,e=>e?0:1,"bool"),qR={kernelName:ki,backendName:"cpu",kernelFunc:GR},KR=mI((e,t)=>e||t),ZR=LI(Ni,KR,null,"bool"),XR={kernelName:Ni,backendName:"cpu",kernelFunc:ZR};const YR={kernelName:ji,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{depthRadius:r,bias:i,alpha:o,beta:l}=a;nI(s,"LRN");const c=s.shape[3],u=c-1,d=n.data.get(s.dataId).values,h=ns(s.shape),p=new Float32Array(h);function m(e){const t=e%c;let n=e-t+Math.max(0,t-r);const a=e-t+Math.min(t+r,u);let s=0;for(;n<=a;n++){const e=d[n];s+=e*e}return s}for(let f=0;f<h;f++){const e=m(f),t=d[f]*Math.pow(i+o*e,-l);p[f]=t}return n.makeTensorInfo(s.shape,s.dtype,p)}};const JR={kernelName:Ti,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,y:r,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=a;nI(i,"LRNGrad");const d=ns(i.shape),h=i.shape[3],p=n.data.get(i.dataId).values,m=n.data.get(s.dataId).values,f=n.data.get(r.dataId).values,g=new Float32Array(d),x=d;for(let y=0;y<x;y++){const e=y%h,t=y-e+Math.max(0,e-o),n=y-e+Math.min(h,e+o+1);let a=0;for(let s=t;s<n;s++)a+=Math.pow(m[s],2);a=c*a+l;for(let s=t;s<n;s++){let e=-2*c*u*m[s]*f[y]/a;y===s&&(e+=Math.pow(a,-u)),e*=p[y],g[s]+=e}}return n.makeTensorInfo(i.shape,s.dtype,g)}};function QR(e,t,n,a){const s=fs(a,ns(n));for(let r=0;r<s.length;++r){const n=r*t;let a=e[n];for(let s=0;s<t;++s){const t=e[n+s];(Number.isNaN(t)||t>a)&&(a=t)}s[r]=a}return s}function $R(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{reductionIndices:r,keepDims:i}=a,o=n;let l=s.shape;const c=l.length,u=ps(r,l);let d=u;const h=Jm(d,c);let p=o.data.get(s.dataId).values;if(null!=h){const e=new Array(c);for(let t=0;t<e.length;t++)e[t]=l[h[t]];p=QI(p,l,s.dtype,h,e),d=$m(d.length,c),l=e}nI(s,"max"),Ym("max",d,c);const[m,f]=Zm(l,d),g=QR(p,ns(f),m,s.dtype),x=o.write(g,m,s.dtype);let y=m;if(i){y=Xm(m,u)}return{dataId:x,shape:y,dtype:s.dtype}}const eM={kernelName:Ei,backendName:"cpu",kernelFunc:$R},tM=mI((e,t)=>Math.max(e,t)),nM=LI(Ai,tM),aM={kernelName:Ai,backendName:"cpu",kernelFunc:nM};const sM={kernelName:Ri,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t;nI(s,"maxPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=a;$a(Xp(i,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'"));const c=zp(s.shape,r,i,1,o,l);let u;if(1===c.filterWidth&&1===c.filterHeight&&rs(c.inShape,c.outShape))u=uI({inputs:{x:s},backend:n});else{const e=n.data.get(s.dataId).values,t=Ts(s.shape),a=gE(e,s.shape,s.dtype,t,c,"max");u=n.makeTensorInfo(c.outShape,s.dtype,a.values)}return u}};const rM={kernelName:Li,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=a;nI(s,"maxPool3d");const u=Bp(s.shape,r,i,1,o,l,c),d=yE(n.data.get(s.dataId).values,s.shape,s.dtype,Ts(s.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};const iM={kernelName:Di,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,input:r}=t,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=a;nI([s,r],"maxPool3DGrad");const u=Bp(r.shape,i,o,1,l,c),d=function(e,t){const n=gd(t.outShape,"int32"),a=t.strideDepth,s=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,p=t.padInfo.top,m=t.padInfo.left;for(let f=0;f<t.batchSize;++f)for(let g=0;g<t.inChannels;++g)for(let x=0;x<t.outDepth;++x){const y=x*a-h;let b=y;for(;b<0;)b+=i;const v=Math.min(t.inDepth,c+y);for(let a=0;a<t.outHeight;++a){const c=a*s-p;let h=c;for(;h<0;)h+=o;const w=Math.min(t.inHeight,u+c);for(let s=0;s<t.outWidth;++s){const p=s*r-m;let k=p;for(;k<0;)k+=l;const N=Math.min(t.inWidth,d+p);let _=Number.NEGATIVE_INFINITY,S=-1;for(let t=b;t<v;t+=i){const n=t-y;for(let a=h;a<w;a+=o){const s=a-c;for(let r=k;r<N;r+=l){const i=r-p,o=e.get(f,t,a,r,g);o>=_&&(_=o,S=n*u*d+s*u+i)}}}n.set(S,f,x,a,s,g)}}}return n}(n.bufferSync(r),u),h=u.strideDepth,p=u.strideHeight,m=u.strideWidth,f=u.dilationDepth,g=u.dilationHeight,x=u.dilationWidth,y=u.effectiveFilterDepth,b=u.effectiveFilterHeight,v=u.effectiveFilterWidth,w=y-1-u.padInfo.front,k=v-1-u.padInfo.left,N=b-1-u.padInfo.top,_=gd(r.shape,"float32"),S=n.bufferSync(s);for(let C=0;C<u.batchSize;++C)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inDepth;++t)for(let n=0;n<u.inHeight;++n)for(let a=0;a<u.inWidth;++a){const s=t-w,r=n-N,i=a-k;let o=0;for(let t=0;t<y;t+=f){const n=(s+t)/h;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let a=0;a<b;a+=g){const s=(r+a)/p;if(!(s<0||s>=u.outHeight||Math.floor(s)!==s))for(let r=0;r<v;r+=x){const l=(i+r)/m;if(l<0||l>=u.outWidth||Math.floor(l)!==l)continue;const c=y*b*v-1-d.get(C,n,s,l,e)===t*b*v+a*v+r?1:0;if(0===c)continue;o+=S.get(C,n,s,l,e)*c}}}_.set(o,C,t,n,a,e)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}};const oM={kernelName:Mi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,input:r,output:i}=t,o=r;nI([r,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=a,h=zp(o.shape,l,c,1,u,d),p=n.data.get(o.dataId).values,m=gd(h.outShape,o.dtype,xE(p,o.shape,o.dtype,h).values),f=h.strideHeight,g=h.strideWidth,x=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterHeight,v=h.effectiveFilterWidth,w=v-1-h.padInfo.left,k=b-1-h.padInfo.top,N=gd(o.shape,"float32"),_=n.data.get(s.dataId).values,S=gd(s.shape,"float32",_);for(let C=0;C<h.batchSize;++C)for(let e=0;e<h.inChannels;++e)for(let t=0;t<h.inHeight;++t)for(let n=0;n<h.inWidth;++n){const a=t-k,s=n-w;let r=0;for(let t=0;t<b;t+=x){const n=(a+t)/f;if(!(n<0||n>=h.outHeight||Math.floor(n)!==n))for(let a=0;a<v;a+=y){const i=(s+a)/g;if(i<0||i>=h.outWidth||Math.floor(i)!==i)continue;const o=b*v-1-m.get(C,n,i,e)===t*v+a?1:0;if(0===o)continue;r+=S.get(C,n,i,e)*o}}N.set(r,C,t,n,e)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}};const lM={kernelName:Oi,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e;const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:l}=n,c=a;nI(s,"MaxPoolWithArgmax");const u=c.data.get(s.dataId).values,d=zp(s.shape,r,i,[1,1],o),[h,p]=function(e,t,n,a,s){const r=gE(e,0,n,Ts(t),s,"max"),i=xE(e,t,n,s,!0,a);return[r.values,i.values]}(u,s.shape,s.dtype,l,d),m=c.write(h,d.outShape,s.dtype),f=c.write(p,d.outShape,s.dtype);return[{dataId:m,shape:d.outShape,dtype:s.dtype},{dataId:f,shape:d.outShape,dtype:"int32"}]}};const cM={kernelName:Fi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a,o=ps(r,s.shape),l=ns(Zm(s.shape,o)[1]),c=[],u=n.makeTensorInfo([],"float32",new Float32Array([l]));c.push(u);const d=RI({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});c.push(d);const h=GA({inputs:{a:d,b:u},backend:n});c.push(h);const p=wA({inputs:{x:h},backend:n,attrs:{axis:r,keepDims:i}});return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),p}};const uM={kernelName:Pi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a;nI(s,"min");const o=ps(r,s.shape);let l=o;const c=Jm(l,s.shape.length);let u=s;null!=c&&(u=$I({inputs:{x:s},backend:n,attrs:{perm:c}}),l=$m(l.length,s.shape.length)),Ym("min",l,u.shape.length);const[d,h]=Zm(u.shape,l),p=ns(h),m=Ms(ns(d),u.dtype),f=n.data.get(u.dataId).values;for(let x=0;x<m.length;++x){const e=x*p;let t=f[e];for(let n=0;n<p;++n){const a=f[e+n];(Number.isNaN(a)||a<t)&&(t=a)}m[x]=t}null!=c&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,m);if(i){const e=BI({inputs:{x:g},backend:n,attrs:{shape:Xm(d,o)}});return n.disposeIntermediateTensorInfo(g),e}return g}},dM=mI((e,t)=>Math.min(e,t)),hM=LI(zi,dM),pM={kernelName:zi,backendName:"cpu",kernelFunc:hM};const mM={kernelName:Bi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{paddings:r,mode:i}=a;nI(s,"mirrorPad");const o=r.map((e,t)=>e[0]+s.shape[t]+e[1]),l=r.map(e=>e[0]),c=r.map((e,t)=>e[0]+s.shape[t]),u="reflect"===i?0:1,d=n.data.get(s.dataId).values,h=s.shape.length,p=Ts(s.shape),m=ns(o),f=o.length,g=Ts(o),x=fs(s.dtype,m);for(let y=0;y<m;y++){let e=Fs(y,f,g);for(let n=0;n<f;n++)e[n]<l[n]?e[n]=2*l[n]-e[n]-u:e[n]>=c[n]&&(e[n]=2*(c[n]-1)-e[n]+u);e=e.map((e,t)=>e-l[t]);const t=Os(e,h,p);x[y]=d[t]}return{dataId:n.write(x,o,s.dtype),shape:o,dtype:s.dtype}}},fM=mI((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),gM=LI(Wi,fM),xM={kernelName:Wi,backendName:"cpu",kernelFunc:gM};function yM(e){const{inputs:t,backend:n,attrs:a}=e,{logits:s}=t,{dim:r}=a,i=s.shape.length;let o=r;if(-1===o&&(o=i-1),o!==i-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(i," and dim was ").concat(o));const l=ps([o],s.shape),c=$R({inputs:{x:s},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Xm(c.shape,l),d=BI({inputs:{x:c},backend:n,attrs:{shape:u}}),h=XA({inputs:{a:s,b:d},backend:n}),p=FA({inputs:{x:h},backend:n}),m=wA({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),f=BI({inputs:{x:m},backend:n,attrs:{shape:u}}),g=GA({inputs:{a:p,b:f},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(f),g}const bM={kernelName:Do,backendName:"cpu",kernelFunc:yM};const vM={kernelName:Vi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{logits:s}=t,{numSamples:r,seed:i,normalized:o}=a;nI(s,"multinomial");const l=o?s:yM({inputs:{logits:s},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,r],p=Ms(ns(h),"int32");for(let m=0;m<c;++m){const e=m*u,t=new Float32Array(u-1);t[0]=d[e];for(let s=1;s<t.length;++s)t[s]=t[s-1]+d[e+s];const n=hg.alea(i.toString()),a=m*r;for(let s=0;s<r;++s){const e=n();p[a+s]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){p[a+s]=n;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",p)}};function wM(e,t,n){const a=Bl(-1,n);return xA([],t,a,e,n)}const kM={kernelName:Hi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a}=t;nI(a,"neg");const s=n.data.get(a.dataId).values,[r,i]=wM(s,a.shape,a.dtype);return n.makeTensorInfo(i,a.dtype,r)}},NM=Kx;const _M={kernelName:qi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{boxes:s,scores:r}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=a;nI(s,"NonMaxSuppression");const c=n.data.get(s.dataId).values,u=n.data.get(r.dataId).values,{selectedIndices:d}=NM(c,u,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},SM=Zx;const CM={kernelName:Ki,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{boxes:s,scores:r}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=a;nI(s,"NonMaxSuppressionPadded");const u=n.data.get(s.dataId).values,d=n.data.get(r.dataId).values,{selectedIndices:h,validOutputs:p}=SM(u,d,i,o,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},jM=Xx;const TM={kernelName:Zi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{boxes:s,scores:r}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=a;nI(s,"NonMaxSuppressionWithScore");const u=n.data.get(s.dataId).values,d=n.data.get(r.dataId).values,h=i,p=o,m=l,f=c,{selectedIndices:g,selectedScores:x}=jM(u,d,h,p,m,f);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}},IM=mI((e,t)=>e!==t?1:0),EM=LI(Gi,IM,null,"bool"),AM={kernelName:Gi,backendName:"cpu",kernelFunc:EM};const RM={kernelName:Yi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{indices:s}=t,{dtype:r,depth:i,onValue:o,offValue:l}=a;nI(s,"oneHot");const c=ns(s.shape),u=new Float32Array(c*i);u.fill(l);const d=n.data.get(s.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<i&&(u[h*i+d[h]]=o);return n.makeTensorInfo([...s.shape,i],r,u)}};function MM(e){const{inputs:t,backend:n}=e,{x:a}=t;if("string"===a.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===a.dtype){const e=II({inputs:{input:a},backend:n}),t=MM({inputs:{x:e},backend:n}),s=VE({inputs:{input:a},backend:n}),r=MM({inputs:{x:s},backend:n}),i=CI({inputs:{real:t,imag:r},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(r),i}return tR({backend:n,attrs:{shape:a.shape,value:0,dtype:a.dtype}})}const LM={kernelName:rl,backendName:"cpu",kernelFunc:MM};const DM={kernelName:Xi,backendName:"cpu",kernelFunc:function e(t){const{inputs:n,backend:a}=t,{x:s}=n;if("string"===s.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===s.dtype){const t=II({inputs:{input:s},backend:a}),n=e({inputs:{x:t},backend:a}),r=VE({inputs:{input:s},backend:a}),i=MM({inputs:{x:r},backend:a}),o=CI({inputs:{real:n,imag:i},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(n),a.disposeIntermediateTensorInfo(r),a.disposeIntermediateTensorInfo(i),o}return tR({backend:a,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}};function OM(e){const{inputs:t,backend:n,attrs:a}=e,{axis:s}=a;if(1===t.length)return zA({inputs:{input:t[0]},backend:n,attrs:{dim:s}});const r=t[0].shape,i=t[0].dtype;t.forEach(e=>{es(r,e.shape,"All tensors passed to stack must have matching shapes"),$a(i===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=HE({inputs:t.map(e=>{const t=zA({inputs:{input:e},backend:n,attrs:{dim:s}});return o.push(t),t}),backend:n,attrs:{axis:s}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}const FM={kernelName:Ji,backendName:"cpu",kernelFunc:OM};const PM={kernelName:Qi,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{paddings:r,constantValue:i}=a;nI(s,"pad");const o=r.map((e,t)=>e[0]+s.shape[t]+e[1]),l=r.map(e=>e[0]),c=n.data.get(s.dataId).values,u=ns(s.shape),d=s.shape.length,h=Ts(s.shape),p=ns(o),m=o.length,f=Ts(o),g=fs(s.dtype,p);0!==i&&g.fill(i);for(let x=0;x<u;x++){g[Os(Fs(x,d,h).map((e,t)=>e+l[t]),m,f)]=c[x]}return{dataId:n.write(g,o,s.dtype),shape:o,dtype:s.dtype}}},zM=mI((e,t)=>Math.pow(e,t)),BM=LI(eo,zM),WM={kernelName:eo,backendName:"cpu",kernelFunc:BM};function VM(e,t,n,a){const[s,r]=Zm(e,a),i=fc(t,"int32"),o=Ms(ns(s),i),l=ns(r);for(let c=0;c<o.length;++c){const e=c*l;let t=1;for(let a=0;a<l;++a)t*=n[e+a];o[c]=t}return{outVals:o,outShape:s,outDtype:i}}const UM={kernelName:no,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a;nI(s,"prod");const o=s.shape.length,l=ps(r,s.shape),c=Jm(l,o);let u=l,d=s;const h=[];null!=c&&(d=$I({inputs:{x:s},backend:n,attrs:{perm:c}}),h.push(d),u=$m(u.length,o));const p=n.data.get(d.dataId).values,{outVals:m,outShape:f,outDtype:g}=VM(d.shape,d.dtype,p,u);let x=f;return i&&(x=Xm(f,l)),h.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(x,g,m)}};function HM(e,t,n,a){const s=[];let r=0;const i=t.length-1+n.length,o=new Array(i).fill(null).map(()=>[0]);!function(e,t){for(let n=0;n<e.length;++n){const a=e[n],s=n===e.length-1?t:e[n+1].length;if(0===a.length)throw new Error("Ragged splits may not be empty");if(a[0]<0)throw new Error("Ragged splits must be non-negative");if(a[a.length-1]>s)throw new Error("Ragged splits must not point past values");for(let e=1;e<a.length;++e)if(a[e-1]>a[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,a);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];const e=t[c+1];for(let t=1;t<l+1;++t)o[c].push(t*e)}for(let c=0;c<e.length;++c){let a=e[c],i=e[c]+1;for(let e=0;e<n.length;++e){const s=n[e],r=e+t.length-1;if(r>=0){const e=o[r],t=e[e.length-1]-s[a];for(let n=a;n<i;++n)o[r].push(s[n+1]+t)}a=s[a],i=s[i]}i!==a&&(s.push([a,i]),r+=i-a)}return{outSplits:o,valueSlices:s,numValues:r}}function GM(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let a=t;a<e.length;a++)n[t-1]*=e[a];return n}function qM(e,t,n,a,s){const r=t.slice();r[0]=s;const i=gs(n,ns(r)),o=e.length;return function(e,t,n,a,s,r){const i=GM(t,2)[1],o=GM(r,2)[1];let l=0;for(const c of n)for(let t=c[0];t<c[1];++t){for(let n=0;n<a;++n)s[l*o+n]=e[t*i+n];++l}}(e,t,a,0===o?0:o/t[0],i,r),[i,r]}function KM(e,t,n,a,s,r,i,o){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((e,a)=>{if(e<0||e>=n){const s=Fs(a,t.length,Ts(t)).join(",");throw new Error("indices[".concat(s,"] = ").concat(e," is not in [0, ").concat(n,")"))}})}(r,i,t[0][0]-1),0===a.length)throw new Error("params.rank must be nonzero");const l=a[0],{outSplits:c,valueSlices:u,numValues:d}=HM(r,i,e,l),h=function(e){const t=[];for(let n=0;n<e.length;++n){const a=gs("int32",e[n].length);t.push(a),e[n].forEach((e,t)=>a[t]=e)}return t}(c),p=qM(n,a,s,u,d);return[h,p[0],p[1]]}const ZM={kernelName:ao,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{paramsNestedSplits:s,paramsDenseValues:r,indices:i}=t,{outputRaggedRank:o}=a,l=s.map(e=>n.data.get(e.dataId).values),c=s.map(e=>e.shape),u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,[h,p,m]=KM(l,c,u,r.shape,r.dtype,d,i.shape),f=h.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(m,r.dtype,p);return f.concat([g])}},XM=2147483647;function YM(e,t,n,a,s,r,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const o=0===t.length,l=0===s.length,c=0===i.length,u=[];o||u.push(t[0]),l||u.push(s[0]),c||u.push(i[0]);for(let f=1;f<u.length;++f)if(u[f]!==u[f-1])throw new Error("starts, limits, and deltas must have the same shape");const d=0===u.length?1:u[0],h=gs("int32",d+1);h[0]=0;for(let f=0;f<d;++f){const t=o?e[0]:e[f],n=l?a[0]:a[f],s=c?r[0]:r[f];if(0===s)throw new Error("Requires delta != 0");let i;if(s>0&&n<t||s<0&&n>t)i=0;else if(i=Math.ceil(Math.abs((n-t)/s)),i>XM)throw new Error("Requires ((limit - start) / delta) <= ".concat(XM));h[f+1]=h[f]+i}const p=gs(n,h[d]);let m=0;for(let f=0;f<d;++f){const t=h[f+1]-h[f];let n=o?e[0]:e[f];const a=c?r[0]:r[f];for(let e=0;e<t;++e)p[m++]=n,n+=a}return[h,p]}const JM={kernelName:so,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:a,limits:s,deltas:r}=t,i=n.data.get(a.dataId).values,o=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,[c,u]=YM(i,a.shape,a.dtype,o,s.shape,l,r.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],a.dtype,u)]}};var QM=Uy;class $M{constructor(e,t,n,a,s,r,i,o,l,c){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=a,this.valuesDType=s,this.defaultValue=r,this.defaultValueShape=i,this.rowPartitionValues=o,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=Gy(c),this.raggedRank=qy(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===QM.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===QM.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case QM.VALUE_ROWIDS:return $M.getMaxWidthValueRowID(t);case QM.ROW_SPLITS:return $M.getMaxWidthRowSplit(t);default:throw new Error("Cannot handle partition type ".concat(QM[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let n=0;for(let a=0;a<t-1;++a){const t=e[a+1]-e[a];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let n=0,a=e[0],s=0;for(let r=1;r<t;++r){const t=e[r];t!==a&&(a=t,s=Math.max(r-n,s),n=r)}return Math.max(t-n,s)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return tL(e,n)}calculateOutputSize(e){const t=this.valuesShape;Ky(this.defaultValueShape,t);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=Hy(this.raggedRank,n,t);a[0]<0&&(a[0]=e);for(let s=1;s<=this.raggedRank;++s)a[s]<0&&(a[s]=this.getMaxWidth(s));return a}calculateFirstParentOutputIndex(e,t,n){const a=Math.min(e,n),s=[];let r=0;for(let i=0;i<a;++i,r+=t)s.push(r);for(let i=a;i<e;++i)s.push(-1);return $a(s.length===e,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(e,t,n,a){const s=e.length,r=[];for(let i=0;i<s-1;++i){const s=e[i+1]-e[i];let o=Math.min(a,s),l=t[i];-1===l&&(o=0);for(let e=0;e<o;++e)r.push(l),l+=n;for(let e=0;e<s-o;++e)r.push(-1)}if(s>0&&r.length!==e[s-1])throw new Error("Invalid row split size.");return r}calculateOutputIndexValueRowID(e,t,n,a){const s=e.length,r=[];if(0===s)return[];let i=0,o=e[0];if(o>=t.length)throw new Error("Got currentValueRowId=".concat(o,", which is not less than ").concat(t.length));let l=t[o];r.push(l);for(let c=1;c<s;++c){const s=e[c];if(s===o)l>=0&&(++i,i<a?l+=n:l=-1);else{if(i=0,o=s,s>=t.length)throw new Error("Got nextValueRowId=".concat(s," which is not less than ").concat(t.length));l=t[s]}r.push(l)}if(r.length!==e.length)throw new Error("Invalid row ids.");return r}calculateOutputIndex(e,t,n,a){const s=this.getRowPartitionTensor(e),r=this.getRowPartitionTypeByDimension(e);switch(r){case QM.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,t,n,a);case QM.ROW_SPLITS:if(s.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(s.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(s,t,n,a);default:throw new Error("Unsupported partition type: ".concat(QM[r]))}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case QM.FIRST_DIM_SIZE:return e[0];case QM.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case QM.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(QM[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let r=n.length-2;r>=0;--r)n[r]=n[r+1]*t[r+1];const a=tL(t,!1),s=gs(this.valuesDType,ns(a));if(n[0]*t[0]>0){let r=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e){r=this.calculateOutputIndex(e-1,r,n[e],t[e])}this.setOutput(this.raggedRank,r,s,a)}return[a,s]}setOutput(e,t,n,a){if(0===n.length)return;const s=this.values,r=n;let i=a.slice();i=i.slice(e+1);const o=ns(i),l=t.length;let c=this.defaultValue;if(c.length!==o&&1!==c.length){const e=this.defaultValueShape;tu(()=>{const t=$p(c,e),n=fm(t,i);c=n.dataSync()})}let u=0,d=0,h=0;for(let p=0;p<=l;++p){let e=p<l?t[p]:-1;if(e!==h){if(d<h){const e=s.subarray(u*o);eL(r.subarray(d*o),e,(h-d)*o)}if(p>=l){const t=n.length;e=Math.floor(t/o)}if(e>h)if(1===this.defaultValue.length)r.subarray(h*o,e*o).fill(this.defaultValue[0]),h=e;else for(;e>h;){eL(r.slice(h*o),c,o),++h}e<0?(u=p+1,d=h):(u=p,d=h,h=d+1)}else++h}}}function eL(e,t,n){for(let a=0;a<n;a++)e[a]=t[a]}function tL(e,t){const n=[];for(let a of e){if(a<0){if(!t)throw new Error("Dimension ".concat(a," must be >= 0"));if(a<-1)throw new Error("Dimension ".concat(a," must be >= -1"));a=-1}n.push(a)}return n}function nL(e,t,n,a,s,r,i,o,l,c){return new $M(e,t,n,a,s,r,i,o,l,c).compute()}const aL={kernelName:ro,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{shape:s,values:r,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=a,c=n.data.get(s.dataId).values,u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,h=o.map(e=>n.data.get(e.dataId).values),p=o.map(e=>e.shape),[m,f]=nL(c,s.shape,u,r.shape,r.dtype,d,i.shape,h,p,l);return n.makeTensorInfo(m,r.dtype,f)}};function sL(e,t,n,a){if(e===t||e<t&&n<0||t<e&&n>1)return Ms(0,a);const s=Ms(Math.abs(Math.ceil((t-e)/n)),a);t<e&&1===n&&(n=-1),s[0]=e;for(let r=1;r<s.length;r++)s[r]=s[r-1]+n;return s}const rL={kernelName:io,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:a,stop:s,dtype:r,step:i}=n,o=sL(a,s,i,r);return t.makeTensorInfo([o.length],r,o)}},iL=iI(lo,e=>1/e),oL={kernelName:lo,backendName:"cpu",kernelFunc:iL};const lL={kernelName:mo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{images:s}=t,{alignCorners:r,halfPixelCenters:i,size:o}=a;nI(s,"resizeBilinear");const l=Ts(s.shape),[c,u]=o,[d,h,p,m]=s.shape,f=n.data.get(s.dataId).values,g=new Float32Array(ns([d,c,u,m])),x=[r&&c>1?h-1:h,r&&u>1?p-1:p],y=[r&&c>1?c-1:c,r&&u>1?u-1:u];let b=0;const v=x[0]/y[0],w=x[1]/y[1];for(let k=0;k<d;k++)for(let e=0;e<c;e++){let t;t=i?v*(e+.5)-.5:v*e;const n=Math.max(0,Math.floor(t)),a=t-n,s=Math.min(h-1,Math.ceil(t)),r=k*l[0]+n*l[1],o=k*l[0]+s*l[1];for(let e=0;e<u;e++){let t;t=i?w*(e+.5)-.5:w*e;const n=Math.max(0,Math.floor(t)),s=t-n,c=Math.min(p-1,Math.ceil(t)),u=r+n*l[2],d=o+n*l[2],h=r+c*l[2],x=o+c*l[2];for(let e=0;e<m;e++){const t=f[u+e],n=f[d+e],r=t+(f[h+e]-t)*s,i=r+(n+(f[x+e]-n)*s-r)*a;g[b++]=i}}}return n.makeTensorInfo([d,c,u,m],"float32",g)}};const cL={kernelName:fo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{images:s,dy:r}=t,{alignCorners:i}=a;nI([r,s],"resizeBilinearGrad");const o=Ts(s.shape),[l,c,u,d]=s.shape,[,h,p]=r.shape,m=new Float32Array(l*c*u*d),f=[i&&h>1?c-1:c,i&&p>1?u-1:u],g=[i&&h>1?h-1:h,i&&p>1?p-1:p],x=f[0]/g[0],y=f[1]/g[1],b=n.data.get(r.dataId).values;let v=0;for(let w=0;w<l;w++){const e=w*o[0];for(let t=0;t<h;t++){const n=t*x,a=Math.floor(n),s=Math.min(Math.ceil(n),c-1),r=e+a*o[1],i=e+s*o[1],l=n-a,h=1-l;for(let e=0;e<p;e++){const t=e*y,n=Math.floor(t),a=Math.min(Math.ceil(t),u-1),s=t-n,c=1-s,p=r+n*o[2],f=r+a*o[2],g=i+n*o[2],x=i+a*o[2],w=h*c,k=h*s,N=l*c,_=l*s;for(let e=0;e<d;e++){const t=b[v++];m[p+e]+=t*w,m[f+e]+=t*k,m[g+e]+=t*N,m[x+e]+=t*_}}}}return n.makeTensorInfo([l,u,c,d],"float32",m)}};const uL={kernelName:ho,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{images:s}=t,{alignCorners:r,halfPixelCenters:i,size:o}=a;nI(s,"resizeNearestNeighbor");const l=Ts(s.shape),[c,u]=o,[d,h,p,m]=s.shape,f=n.data.get(s.dataId).values,g=new Float32Array(d*c*u*m),x=[r&&c>1?h-1:h,r&&u>1?p-1:p],y=[r&&c>1?c-1:c,r&&u>1?u-1:u],b=x[0]/y[0],v=x[1]/y[1];let w=0;for(let k=0;k<d;k++){const e=k*l[0];for(let t=0;t<c;t++){const n=i?b*(t+.5):b*t;let a=Math.min(h-1,r?Math.round(n):Math.floor(n));i&&(a=Math.max(0,a));const s=e+a*l[1];for(let e=0;e<u;e++){const t=i?v*(e+.5):v*e;let n=Math.min(p-1,r?Math.round(t):Math.floor(t));i&&(n=Math.max(0,n));const a=s+n*l[2];for(let e=0;e<m;e++){const t=f[a+e];g[w++]=t}}}}return n.makeTensorInfo([d,c,u,m],s.dtype,g)}};const dL={kernelName:po,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{images:s,dy:r}=t,{alignCorners:i}=a;nI([r,s],"resizeNearestNeighborGrad");const o=Ts(s.shape),l=Ts(r.shape),[c,u,d,h]=s.shape,[,p,m]=r.shape,f=new Float32Array(c*u*d*h),g=n.data.get(r.dataId).values,x=[i&&p>1?u-1:u,i&&m>1?d-1:d],y=[i&&p>1?p-1:p,i&&m>1?m-1:m],b=x[0]/y[0],v=x[1]/y[1],w=1/b,k=1/v,N=2*Math.ceil(w)+2,_=2*Math.ceil(k)+2;for(let S=0;S<c;S++){const e=S*o[0];for(let t=0;t<u;t++){const n=e+t*o[1],a=Math.floor(t*w),s=Math.floor(a-N/2);for(let r=0;r<d;r++){const a=n+r*o[2],c=Math.floor(r*k),x=Math.floor(c-_/2);for(let n=0;n<h;n++){let o=0;for(let a=0;a<N;a++){const c=a+s;if(c<0||c>=p)continue;const h=e+c*l[1],f=c*b;if(t===Math.min(u-1,i?Math.round(f):Math.floor(f)))for(let e=0;e<_;e++){const t=e+x;if(t<0||t>=m)continue;const a=h+t*l[2],s=t*v;r===Math.min(d-1,i?Math.round(s):Math.floor(s))&&(o+=g[a+n])}}f[a+n]=o}}}}return n.makeTensorInfo(s.shape,s.dtype,f)}};const hL={kernelName:xo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{dims:r}=a;nI(s,"reverse");const i=s.shape.length,o=ps(r,s.shape);if(0===i)return uI({inputs:{x:s},backend:n});const l=new nc(s.shape,s.dtype),c=n.bufferSync(s);for(let u=0;u<l.size;u++){const e=l.indexToLoc(u),t=e.slice();o.forEach(e=>t[e]=s.shape[e]-1-t[e]),l.set(c.get(...t),...e)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},pL={kernelName:ll,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e;const{image:s}=t,{radians:r,fillValue:i,center:o}=n,l=a,c=fs(s.dtype,ns(s.shape)),[u,d,h,p]=s.shape,[m,f]=Yy(o,d,h),g=Math.sin(r),x=Math.cos(r),y=l.data.get(s.dataId).values;for(let b=0;b<u;b++){const e=b*h*d*p;for(let t=0;t<d;t++){const n=t*(h*p);for(let a=0;a<h;a++){const s=a*p;for(let r=0;r<p;r++){const o=[u,t,a,r],l=o[2],b=o[1];let v=(l-m)*x-(b-f)*g,w=(l-m)*g+(b-f)*x;v=Math.round(v+m),w=Math.round(w+f);let k=i;if("number"!==typeof i&&(k=3===r?255:i[r]),v>=0&&v<h&&w>=0&&w<d){k=y[e+w*(h*p)+v*p+r]}c[e+n+s+r]=k}}}}return{dataId:l.write(c,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}},mL=iI(yo,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),fL={kernelName:yo,backendName:"cpu",kernelFunc:mL},gL=rI(e=>1/Math.sqrt(e)),xL=oI(bo,gL),yL={kernelName:bo,backendName:"cpu",kernelFunc:xL};function bL(e,t,n,a,s,r,i,o,l,c){const u=[a/s,s],d=e.values,h=t.values;if(0===a)return gd(n,t.dtype);const p=l instanceof nc?l:gd(u,t.dtype);"string"===typeof l||"number"===typeof l?p.values.fill(l):"boolean"===typeof l&&p.values.fill(+l);for(let m=0;m<r;m++){const e=[];let r=0;for(let t=0;t<i;t++){const n=d[m*i+t];e.push(n),r+=n*o[t]}if(r<0||r>=a/s)throw new Error("Invalid indices: ".concat(e," does not index into ").concat(n));for(let n=0;n<s;n++)c?p.values[r*s+n]+=h[m*s+n]:p.values[r*s+n]=0===t.rank?h[0]:h[m*s+n]}return p}const vL={kernelName:vo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{indices:s,updates:r}=t,{shape:i}=a,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Hh(0,s,i),h=bL(n.bufferSync(s),n.bufferSync(r),i,d,c,l,o,u,0,!0);return n.makeTensorInfo(i,h.dtype,h.values)}};function wL(e,t){let n=0,a=e.length,s=0;for(;n<a;)s=Math.floor((n+a)/2),e[s]<t?n=s+1:a=s;return a}function kL(e,t){let n=0,a=e.length,s=0;for(;n<a;)s=Math.floor((n+a)/2),e[s]<=t?n=s+1:a=s;return a}const NL={kernelName:ko,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{sortedSequence:s,values:r}=t,{side:i}=a,o=function(e,t,n,a,s,r){const i=gs("int32",n*s);for(let o=0;o<n;++o){const n=e.slice(o*a,(o+1)*a),l=o*s;for(let e=0;e<s;++e)i[l+e]="left"===r?wL(n,t[e+l]):kL(n,t[e+l])}return i}(n.data.get(s.dataId).values,n.data.get(r.dataId).values,s.shape[0],s.shape[1],r.shape[1],i);return n.makeTensorInfo(r.shape,"int32",o)}};const _L={kernelName:No,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:a,t:s,e:r}=t;nI([a,s,r],"select");const i=a.shape.length,o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values,c=n.data.get(r.dataId).values,u=fc(s.dtype,r.dtype),d=Ms(ns(s.shape),u);let h=0;const p=0===i||i>1||1===s.shape.length?1:ns(s.shape.slice(1));for(let m=0;m<o.length;m++)for(let e=0;e<p;e++)1===o[m]?d[h++]=l[m]:d[h++]=c[m];return n.makeTensorInfo(s.shape,u,d)}},SL=nb,CL=ab,jL=iI(_o,e=>e>=0?CL*e:SL*(Math.exp(e)-1)),TL={kernelName:_o,backendName:"cpu",kernelFunc:jL},IL=iI(To,e=>e<0?-1:e>0?1:0),EL={kernelName:To,backendName:"cpu",kernelFunc:IL},AL=iI(Co,e=>Math.sin(e)),RL={kernelName:Co,backendName:"cpu",kernelFunc:AL},ML=iI(jo,e=>Math.sinh(e)),LL={kernelName:jo,backendName:"cpu",kernelFunc:ML},DL=Math.log(1.1920928955078125e-7)+2,OL=iI(Eo,e=>{const t=e>-DL,n=e<DL,a=Math.exp(e);let s;return s=n?a:t?e:Math.log(1+a),s}),FL={kernelName:Eo,backendName:"cpu",kernelFunc:OL};const PL={kernelName:Mo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{blockShape:r,paddings:i}=a;nI([s],"spaceToBatchND");const o=ns(r),l=[[0,0]];l.push(...i);for(let g=1+r.length;g<s.shape.length;++g)l.push([0,0]);const c=PM.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),u=Jy(c.shape,r,o,!1),d=Qy(u.length,r.length,!1),h=$y(c.shape,r,o,!1),p=BI({inputs:{x:c},backend:n,attrs:{shape:u}}),m=$I({inputs:{x:p},backend:n,attrs:{perm:d}}),f=BI({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),f}};function zL(e,t,n,a,s,r,i){const o=t[0],l=r[0],c=new Array(l),u=new Array(o),d=t[1];if(0===l){if(0!==o)throw new Error(Ib(o));return[gs(n,0),[0,d],gs(s,0),c,u]}let h=!0,p=0;const m=new Array(l).fill(0);for(let g=0;g<o;++g){const t=e[g*d];if(t<0)throw new Error(Eb(g,t));if(t>=l)throw new Error(Ab(g,t,l));++m[t],h=h&&t>=p,p=t}let f=!0;for(let g=0;g<l;++g){const e=0===m[g];c[g]=e,f=f&&!e,m[g]=Math.max(m[g],1),g>0&&(m[g]+=m[g-1])}if(f&&h){const t=e,n=a;for(let e=0;e<o;++e)u[e]=e;return[t,[o,d],n,c,u]}{const t=m[l-1],r=gs(n,t*d),h=gs(s,t),p=new Array(l).fill(0);for(let n=0;n<o;++n){const t=e[n*d],s=p[t],i=(0===t?0:m[t-1])+s;p[t]++;for(let a=0;a<d;++a)r[i*d+a]=e[n*d+a];h[i]=a[n],u[n]=i}for(let e=0;e<l;++e){if(0===p[e]){const t=0===e?0:m[e-1];r[t*d+0]=e;for(let e=1;e<d;++e)r[t*d+e]=0;h[t]=i}}return[r,[t,d],h,c,u]}}const BL={kernelName:Oo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:a,values:s,denseShape:r,defaultValue:i}=t;if(1!==r.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(r.shape));if(2!==a.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(a.shape));if(1!==s.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(s.shape));if(0!==i.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values[0],[d,h,p,m,f]=zL(o,a.shape,a.dtype,l,s.dtype,c,u);return[n.makeTensorInfo(h,a.dtype,d),n.makeTensorInfo([h[0]],s.dtype,p),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(e=>Number(e)))),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}};function WL(e,t,n,a,s){const r=ns(a),i=t[0],o=s.length,l=[];let c=1,u=-1;for(let f=0;f<o;++f){const e=s[f];if(-1===e){if(-1!==u)throw new Error(Rb(u,f));u=f,l.push(1)}else{if(e<0)throw new Error(Mb(f,e));c*=e,l.push(e)}}if(-1!==u){if(c<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(r/c);if(c*e!==r)throw new Error(Db(a,l));l[u]=e}if(ns(l)!==r)throw new Error(Ob(a,l));const d=a.length,h=[];if(d>0){h[d-1]=1;for(let e=d-2;e>=0;--e)h[e]=h[e+1]*a[e+1]}const p=[];if(o>0){p[o-1]=1;for(let e=o-2;e>=0;--e)p[e]=p[e+1]*l[e+1]}const m=gs(n,i*o);for(let f=0;f<i;++f){let t=0;for(let n=0;n<d;++n)t+=e[f*d+n]*h[n];for(let e=0;e<o;++e)m[f*o+e]=Math.trunc(t/p[e]),t%=p[e]}return[m,[i,o],l]}const VL={kernelName:Fo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:a,inputShape:s,newShape:r}=t;if(2!==a.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(a.shape));if(1!==s.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(s.shape));if(1!==r.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(r.shape));const i=Array.from(n.data.get(s.dataId).values),o=n.data.get(a.dataId).values,l=Array.from(n.data.get(r.dataId).values),[c,u,d]=WL(o,a.shape,a.dtype,i,l);return[n.makeTensorInfo(u,a.dtype,c),n.makeTensorInfo([d.length],r.dtype,new Int32Array(d))]}};function UL(e,t,n,a,s){let r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const o=a.length,l=[t[0],e.length/t[0]],c=l[1],u=o>0?s[o-1]+1:0;if(u<0)throw new Error("segment ids must be >= 0");const d=t.slice();d[0]=u;const h=gs(n,d.reduce((e,t)=>e*t,1));if(0===o)return u>0&&h.fill(i),[h,d];if(u<=0)throw new Error("segment ids must be >= 0");let p=0,m=1,f=0,g=s[p];for(;;){let t=0;if(m<o){if(t=s[m],g===t){++m;continue}if(g>=t)throw new Error(Pb())}if(g<0||g>=u)throw new Error(zb(g,u));g>f&&h.fill(i,f*c,g*c);for(let n=p;n<m;++n){const t=a[n];if(t<0||t>=l[0])throw new Error(Bb(n,a[n],l[0]));for(let n=0;n<c;n++)h[g*c+n]+=e[t*c+n]}if(r)for(let e=0;e<c;e++)h[g*c+e]/=m-p;if(p=m,++m,f=g+1,g=t,m>o)break}return f<u&&h.fill(i,f*c,u*c),[h,d]}const HL={kernelName:Po,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:a,indices:s,segmentIds:r}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(s.shape));if(1!==r.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(r.shape));if(s.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(a.dataId).values,o=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,[c,u]=UL(i,a.shape,a.dtype,o,l,!0);return n.makeTensorInfo(u,a.dtype,c)}};const GL={kernelName:zo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:a,indices:s,segmentIds:r}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(s.shape));if(1!==r.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(r.shape));if(s.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(a.dataId).values,o=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,[c,u]=UL(i,a.shape,a.dtype,o,l);return n.makeTensorInfo(u,a.dtype,c)}};const qL={kernelName:Bo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{sparseIndices:s,sparseValues:r,defaultValue:i}=t,{outputShape:o}=a,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Hh(0,s,o),p=!1,m=n.bufferSync(s);let f;switch(r.dtype){case"bool":f=bL(m,n.bufferSync(r),o,h,u,c,l,d,Boolean(n.data.get(i.dataId).values[0]),p);break;case"float32":f=bL(m,n.bufferSync(r),o,h,u,c,l,d,n.data.get(i.dataId).values[0],p);break;case"int32":f=bL(m,n.bufferSync(r),o,h,u,c,l,d,n.data.get(i.dataId).values[0],p);break;case"string":f=bL(m,n.bufferSync(r),o,h,u,c,l,d,Gl(n.data.get(i.dataId).values[0]),p);break;default:throw new Error("Unsupported type ".concat(r.dtype))}return n.makeTensorInfo(o,f.dtype,f.values)}};const KL={kernelName:Lo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{numOrSizeSplits:r,axis:i}=a,o=ps(i,s.shape)[0],l=Tb(s,r,o),c=new Array(s.shape.length).fill(0),u=s.shape.slice();return l.map(e=>{const t=[...u];t[o]=e;const a=SE({inputs:{x:s},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,a})}},ZL=rI(e=>Math.sqrt(e)),XL=iI(Ao,e=>Math.sqrt(e)),YL={kernelName:Ao,backendName:"cpu",kernelFunc:XL},JL={kernelName:Vo,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{x:a}=t,s=n;nI(a,"square");const r=s.data.get(a.dataId).values,i=new Float32Array(r.length);for(let o=0;o<r.length;++o){const e=r[o];i[o]=e*e}return{dataId:s.write(i,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},QL=mI((e,t)=>{const n=e-t;return n*n}),$L=LI(Wo,QL),eD={kernelName:Wo,backendName:"cpu",kernelFunc:$L},tD=rI((e,t)=>{const{pattern:n,replaceGlobal:a,rewrite:s}=t;return e.replace(new RegExp(n,a?"g":""),s)}),nD=oI(Uo,tD),aD={kernelName:Uo,backendName:"cpu",kernelFunc:nD},sD=iI(il,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),rD={kernelName:il,backendName:"cpu",kernelFunc:sD};function iD(e,t,n,a){const s=gd(e,t.dtype);for(let r=0;r<s.size;r++){const e=s.indexToLoc(r),i=new Array(e.length);for(let t=0;t<i.length;t++)i[t]=e[t]*n[t]+a[t];s.set(t.get(...i),...e)}return s}const oD={kernelName:Ho,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{begin:r,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=a;nI(s,"stridedSlice");const{finalShapeSparse:p,finalShape:m,isIdentity:f,sliceDim0:g,isSimpleSlice:x,begin:y,end:b,strides:v}=lp(s.shape,r,i,o,l,c,u,d,h);let w;if(f)w=BI({inputs:{x:s},backend:n,attrs:{shape:m}});else if(g||x){$a(s.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(s.shape.length));const e=Xh(y,b,v),t=SE({inputs:{x:s},backend:n,attrs:{begin:y,size:e}});w=BI({inputs:{x:t},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(t)}else{const e=iD(p,n.bufferSync(s),v,y);w=n.makeTensorInfo(m,e.dtype,e.values)}return w}};class lD{constructor(e,t,n,a,s,r){this.separator=Hl(e),this.nGramWidths=t,this.leftPad=Hl(n),this.rightPad=Hl(a),this.padWidth=s,this.preserveShort=r}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,a,s,r){for(let i=0;i<s;++i){const o=this.getPadWidth(r),l=Math.max(0,o-i),c=Math.max(0,o-(s-(i+1))),u=r-(l+c),d=t+(l>0?0:i-o);let h=0;h+=l*this.leftPad.length;for(let t=0;t<u;++t)h+=e[d+t].length;h+=c*this.rightPad.length;h+=(l+c+u-1)*this.separator.length,n[a+i]=new Uint8Array(h);const p=n[a+i];let m=0;const f=e=>e.forEach(e=>p[m++]=e);for(let e=0;e<l;++e)f(this.leftPad),f(this.separator);for(let t=0;t<u-1;++t)f(e[d+t]),f(this.separator);if(u>0){f(e[d+u-1]);for(let e=0;e<c;++e)f(this.separator),f(this.rightPad)}else{for(let e=0;e<c-1;++e)f(this.rightPad),f(this.separator);f(this.rightPad)}}}compute(e,t){const n=e.length,a=t.length;if(a>0){let e=t[0];if(0!==e)throw new Error("First split value must be 0, got ".concat(e));for(let s=1;s<a;++s){let a=t[s]>=e;if(a=a&&t[s]<=n,!a)throw new Error("Invalid split value ".concat(t[s],", must be in [").concat(e,", ").concat(n,"]"));e=t[s]}if(e!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(e))}const s=a-1,r=gs("int32",a);if(0===n||0===a){const e=new Array(n);for(let t=0;t<=s;++t)r[t]=0;return[e,r]}r[0]=0;for(let o=1;o<=s;++o){const e=t[o]-t[o-1];let n=0;this.nGramWidths.forEach(t=>{n+=this.getNumNGrams(e,t)}),this.preserveShort&&e>0&&0===n&&(n=1),r[o]=r[o-1]+n}const i=new Array(r[s]);for(let o=0;o<s;++o){const n=t[o];let a=r[o];if(this.nGramWidths.forEach(s=>{const r=t[o+1]-t[o],l=this.getNumNGrams(r,s);this.createNGrams(e,n,i,a,l,s),a+=l}),this.preserveShort&&a===r[o]){const s=t[o+1]-t[o];if(0===s)continue;const r=s+2*this.padWidth,l=1;this.createNGrams(e,n,i,a,l,r)}}return[i,r]}}function cD(e,t,n,a,s,r,i,o){return new lD(n,a,s,r,i,o).compute(e,t)}const uD={kernelName:Go,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{separator:s,nGramWidths:r,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=a,{data:u,dataSplits:d}=t,h=n.data.get(u.dataId).values,p=n.data.get(d.dataId).values,[m,f]=cD(h,p,s,r,i,o,l,c);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",f)]}};function dD(e,t,n,a){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)a.push(e.subarray(t,t+1));return}if(1===t.length){const s=t[0];let r=e.indexOf(s);for(;-1!==r;){const t=e.subarray(0,r);n&&0===t.length||a.push(t),r=(e=e.subarray(r+1)).indexOf(s)}return void(n&&0===e.length||a.push(e))}let s=0;for(let r=0;r<e.length+1;r++)if(r===e.length||-1!==t.indexOf(e[r])){const t=e.subarray(s,r);n&&0===t.length||a.push(t),s=r+1}}function hD(e,t,n){const a=e.length,s=[];let r=0,i=0;const o=new Array(a);for(let h=0;h<a;++h){const a=s.length;dD(e[h],t,n,s);const l=s.length-a;o[h]=l,r+=l,i=Math.max(i,l)}const l=gs("int32",2*r),c=new Array(r),u=[a,i];let d=0;for(let h=0;h<a;++h)for(let e=0;e<o[h];++e)l[2*d]=h,l[2*d+1]=e,c[d]=s[d],++d;return[l,c,u]}const pD={kernelName:qo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{skipEmpty:s}=a,{input:r,delimiter:i}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");if(1!==r.shape.length)throw new Error("Input must be a vector, got shape: ".concat(r.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,d]=hD(o,l,s),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};function mD(e,t){const n=gs("int32",e.length);for(let a=0;a<e.length;++a)n[a]=zl(e[a]).modulo(t).getLowBitsUnsigned();return n}const fD={kernelName:Ko,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{numBuckets:s}=a,{input:r}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=mD(n.data.get(r.dataId).values,s);return n.makeTensorInfo(r.shape,"int32",i)}},gD=iI(Xo,e=>Math.tan(e)),xD={kernelName:Xo,backendName:"cpu",kernelFunc:gD},yD=iI(Yo,e=>Math.tanh(e));const bD={kernelName:wo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{tensor:a,indices:s,updates:r}=t,{sliceRank:i,numUpdates:o,sliceSize:l,strides:c,outputSize:u}=Hh(0,s,a.shape),d=n.bufferSync(s),h=n.bufferSync(r),p=n.bufferSync(a),m=bL(d,h,a.shape,u,l,o,i,c,p,!1);return n.makeTensorInfo(a.shape,m.dtype,m.values)}};function vD(e,t){const n=new Array(e.rank);for(let s=0;s<n.length;s++)n[s]=e.shape[s]*t[s];const a=gd(n,e.dtype);for(let s=0;s<a.values.length;++s){const t=a.indexToLoc(s),n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=t[a]%e.shape[a];const r=e.locToIndex(n);a.values[s]=e.values[r]}return a}const wD={kernelName:Jo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{reps:r}=a;nI(s,"tile");const i=vD(n.bufferSync(s),r);return n.makeTensorInfo(i.shape,i.dtype,i.values)}},kD=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function ND(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;a>n;){if(a-n>600){const s=a-n+1,r=t-n+1,i=Math.log(s),o=.5*Math.exp(2*i/3),l=.5*Math.sqrt(i*o*(s-o)/s)*Math.sign(r-s/2);ND(e,t,Math.max(n,Math.floor(t-r*o/s+l)),Math.min(a,Math.floor(t+(s-r)*o/s+l)))}const s=e[t];let r=n,i=a;for(Xa(e,n,t),kD(e[a],s)>0&&Xa(e,n,a);r<i;){for(Xa(e,r,i),r++,i--;kD(e[r],s)<0;)r+=1;for(;kD(e[i],s)>0;)i-=1}0===kD(e[n],s)?Xa(e,n,i):(i+=1,Xa(e,i,a)),i<=t&&(n=i+1),t<=i&&(a=i-1)}}function _D(e,t,n,a,s){const r=t[t.length-1],[i,o]=[e.length/r,r],l=fs(n,i*a),c=fs("int32",i*a);for(let d=0;d<i;d++){const t=d*o,n=e.subarray(t,t+o);let r=new Array(n.length);n.forEach((e,t)=>r[t]={value:e,index:t}),a<r.length&&(ND(r,a),r=r.slice(0,a)),s&&r.sort(kD);const i=d*a,u=l.subarray(i,i+a),h=c.subarray(i,i+a);for(let e=0;e<a;e++)u[e]=r[e].value,h[e]=r[e].index}const u=t.slice();return u[u.length-1]=a,[gd(u,n,l),gd(u,"int32",c)]}const SD={kernelName:Qo,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{k:r,sorted:i}=a;nI(s,"topk");const o=n.data.get(s.dataId).values,[l,c]=_D(o,s.shape,s.dtype,r,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};const CD={kernelName:$o,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:a}=e,{image:s,transforms:r}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=n,[u,d,h,p]=s.shape,[m,f]=null!=c?c:[d,h],g=[u,m,f,p],x=Ts(s.shape),y=x[0],b=x[1],v=x[2],w=Ts(g),k=w[0],N=w[1],_=w[2],S=fs(s.dtype,ns(g));S.fill(l);const C=a.data.get(s.dataId).values,j=a.data.get(r.dataId).values;for(let T=0;T<u;++T){const e=1===r.shape[0]?j:j.subarray(8*T,8*T+8);for(let t=0;t<m;++t)for(let n=0;n<f;++n)for(let a=0;a<p;++a){let s;const r=e[6]*n+e[7]*t+1;if(0===r)continue;const c=(e[0]*n+e[1]*t+e[2])/r,u=(e[3]*n+e[4]*t+e[5])/r,p=jD(c,h,o),m=jD(u,d,o);switch(i){case"nearest":s=ID(C,d,h,y,b,v,T,m,p,a,l);break;case"bilinear":s=ED(C,d,h,y,b,v,T,m,p,a,l);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(i))}S[T*k+t*N+n*_+a]=s}return a.makeTensorInfo(g,s.dtype,S)}return{dataId:a.write(S,g,s.dtype),shape:s.shape,dtype:s.dtype}}};function jD(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{const e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return Ka(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{const e=t-1;n-=t*Math.trunc(n/e)}return Ka(0,n,t-1)}(e,t);case"nearest":return function(e,t){return Ka(0,e,t-1)}(e,t);default:return function(e){return e}(e)}}function TD(e,t,n,a,s,r,i,o,l,c,u){return 0<=o&&o<t&&0<=l&&l<n?e[i*a+o*s+l*r+c]:u}function ID(e,t,n,a,s,r,i,o,l,c,u){return TD(e,t,n,a,s,r,i,Math.round(o),Math.round(l),c,u)}function ED(e,t,n,a,s,r,i,o,l,c,u){const d=Math.floor(o),h=Math.floor(l),p=d+1,m=h+1;return(p-o)*((m-l)*TD(e,t,n,a,s,r,i,d,h,c,u)+(l-h)*TD(e,t,n,a,s,r,i,d,m,c,u))+(o-d)*((m-l)*TD(e,t,n,a,s,r,i,p,h,c,u)+(l-h)*TD(e,t,n,a,s,r,i,p,m,c,u))}function AD(e,t,n,a){const s=ps(t,n)[0],r=[1,n[0],1];for(let m=0;m<s;m++)r[0]*=n[m];r[1]=n[s];for(let m=s+1;m<n.length;m++)r[2]*=n[m];const i=new Map,o=new Int32Array(n[s]),l=new nc(r,a,e),c=[],u=1===r[0]&&1===r[2];for(let m=0;m<n[s];m++){let t;if(u)t=e[m].toString();else{const e=[];for(let t=0;t<r[0];t++)for(let n=0;n<r[2];n++)e.push(l.get(t,m,n));t=e.join(",")}const n=i.get(t);if(null!=n)o[m]=n;else{const e=i.size;i.set(t,e),o[m]=e,c.push(m)}}const d=r.slice();d[1]=i.size;const h=new nc(d,a);c.forEach((e,t)=>{for(let n=0;n<r[0];n++)for(let a=0;a<r[2];a++)h.set(l.get(n,e,a),n,t,a)});const p=n.slice();return p[s]=d[1],{outputValues:h.values,outputShape:p,indices:o}}const RD={kernelName:tl,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:a}=e,{axis:s}=n,{x:r}=t;nI(r,"unique");const i=a.data.get(r.dataId).values,{outputValues:o,outputShape:l,indices:c}=AD(i,s,r.shape,r.dtype);return[a.makeTensorInfo(l,r.dtype,o),a.makeTensorInfo([c.length],"int32",c)]}};const MD={kernelName:nl,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{value:s}=t;let{axis:r}=a;r<0&&(r+=s.shape.length);const i=s.shape.length,o=s.shape[r],l=new Array(i-1);let c=0;for(let p=0;p<i;p++)p!==r&&(l[c++]=s.shape[p]);const u=new Array(i).fill(0),d=s.shape.slice();d[r]=1;const h=new Array(o);for(let p=0;p<h.length;p++){u[r]=p;const e=SE({inputs:{x:s},backend:n,attrs:{begin:u,size:d}});h[p]=BI({inputs:{x:e},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(e)}return h}};const LD={kernelName:al,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,segmentIds:r}=t,{numSegments:i}=a;nI(s,"unsortedSegmentSum");const o=[],l=[],c=s.shape.length-r.shape.length;let u=r;for(let h=0;h<c;++h){const e=zA({inputs:{input:u},backend:n,attrs:{dim:h+1}});u=e,l.push(e)}for(let h=0;h<i;++h){const e=Bl(h,"int32"),t=n.makeTensorInfo([],"int32",e),a=CA({inputs:{a:t,b:u},backend:n}),r=RI({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),i=bA({inputs:{a:r,b:s},backend:n}),c=wA({inputs:{x:i},backend:n,attrs:{axis:0,keepDims:!1}});o.push(c),l.push(t),l.push(a),l.push(r),l.push(i),l.push(c)}const d=OM({inputs:o,backend:n,attrs:{axis:0}});return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),d}},DD=[HI,qI,ZI,YI,zI,JI,tE,nE,aE,sE,iE,lE,uE,pE,fE,bE,vE,wE,kE,UI,NE,jE,EE,ME,LE,MI,FE,zE,jI,BE,GE,KE,ZE,XE,YE,JE,QE,eA,nA,aA,sA,rA,iA,oA,cA,uA,dA,hA,pA,mA,fA,gA,NA,cI,_A,jA,DA,PA,BA,UA,eR,nR,aR,iR,cR,uR,dR,pR,fR,yR,wR,dI,kR,UE,_R,CR,TR,pI,AR,LR,OR,zR,WR,HR,qR,XR,YR,JR,eM,aM,sM,rM,iM,oM,lM,cM,uM,pM,mM,xM,vM,vA,kM,_M,CM,TM,AM,RM,DM,FM,PM,WM,xI,UM,ZM,JM,aL,rL,EI,qA,oL,bI,wI,WI,lL,cL,uL,dL,hL,pL,fL,yL,vL,NL,_L,TL,_I,EL,RL,LL,CE,bM,FL,PL,BL,VL,HL,GL,qL,KL,YL,JL,eD,aD,rD,oD,uD,pD,fD,YA,kA,xD,{kernelName:Yo,backendName:"cpu",kernelFunc:yD},bD,wD,SD,CD,eE,RD,MD,LD,LM];for(const n of DD)bl(n);const OD={},FD={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function PD(e,t){if(!(e in OD)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if(Vs().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete OD[e]},!1),Vs().getBool("SOFTWARE_WEBGL_ENABLED")&&(FD.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",FD)||n.getContext("experimental-webgl",FD);return n.getContext("webgl2",FD)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;OD[e]=n}const n=OD[e];return null==n||n.isContextLost()?(delete OD[e],PD(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),OD[e])}var zD,BD,WD;function VD(e,t){return[t,e]}function UD(e){const t=ns(e);return ls(Math.ceil(t/4))}function HD(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function GD(e,t){const n=e;let a,s,r,i,o,l,c,u,d,h;return 2===Vs().getNumber("WEBGL_VERSION")?(a=n.R32F,s=n.R16F,r=n.RGBA16F,i=n.RGBA32F,o=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(a=e.RGBA,s=e.RGBA,r=e.RGBA,i=n.RGBA,o=e.RGBA,c=4,u=4,d=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,l=e.RGBA),{internalFormatFloat:a,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}function qD(e,t){const n=t();return Vs().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(zD||(zD={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(BD||(BD={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(WD||(WD={}));function KD(e){return!!(Vs().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function ZD(e,t){return aO(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}const XD=/ERROR: [0-9]+:([0-9]+):/g;function YD(e,t){const n=XD.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);const a=+n[1],s=e.split("\n"),r=s.length.toString().length+2,i=s.map((e,t)=>us((t+1).toString(),r)+e);let o=0;for(let d=0;d<i.length;d++)o=Math.max(i[d].length,o);const l=i.slice(0,a-1),c=i.slice(a-1,a),u=i.slice(a);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(us(c[0],o)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function JD(e,t){if(qD(e,()=>e.validateProgram(t)),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function QD(e,t,n,a,s,r,i){const o=e.getAttribLocation(t,n);return-1!==o&&(qD(e,()=>e.bindBuffer(e.ARRAY_BUFFER,a)),qD(e,()=>e.vertexAttribPointer(o,s,e.FLOAT,!1,r,i)),qD(e,()=>e.enableVertexAttribArray(o)),!0)}function $D(e,t,n,a){qD(e,()=>function(e,t,n){sO(e,n),qD(e,()=>e.activeTexture(e.TEXTURE0+n)),qD(e,()=>e.bindTexture(e.TEXTURE_2D,t))}(e,t,a)),qD(e,()=>e.uniform1i(n,a))}function eO(e,t,n){qD(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),qD(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function tO(e,t){qD(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),qD(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function nO(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function aO(e,t,n){const a=qD(e,()=>t());if(null==a)throw new Error(n);return a}function sO(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,a=t+e.TEXTURE0;if(a<e.TEXTURE0||a>n){const e="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(e,"."))}}function rO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return ns(e.slice(0,e.length-t))}function iO(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function oO(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[rO(e),...iO(e)]),t}function lO(e){return e%2===0}function cO(e,t){if(rs(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e[e.length-1],a=t[t.length-1];if(n===a)return!0;if(lO(n)&&lO(a)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&lO(e[0])&&lO(t[0])}let uO,dO;function hO(e,t){return null!=e.getExtension(t)}function pO(e){try{if(null!=PD(e))return!0}catch(vq){return console.log("Error when getting WebGL context: ",vq),!1}return!1}function mO(e){if(0===e)return!1;const t=PD(e);if(1!==e){if(hO(t,"EXT_color_buffer_float"))return fO(t);const e="EXT_color_buffer_half_float";if(hO(t,e)){const n=t.getExtension(e);return function(e,t){const n=GD(e,t),a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a);const s=1,r=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,s,r,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(a),e.deleteFramebuffer(i),o}(t,n)}return!1}if(!hO(t,"OES_texture_float"))return!1;if(!hO(t,"WEBGL_color_buffer_float"))return!1;return fO(t)}function fO(e){const t=GD(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),s}function gO(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&$a("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors ")+"in the WebGL backend.")})}const xO=Vs();function yO(){let e,t,n,a,s,r,i,o,l,c;return 2===Vs().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",a="in",s="texture",r="outputColor",i="out vec4 outputColor;",o=Vs().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",a="varying",s="texture2D",r="gl_FragColor",i="",o="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:a,texture2D:s,output:r,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}function bO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const a=Ts(t);return a.map((t,s)=>{const r="int ".concat(e[s]," = ").concat(n," / ").concat(t),i=s===a.length-1?"int ".concat(e[s+1]," = ").concat(n," - ").concat(e[s]," * ").concat(t):"index -= ".concat(e[s]," * ").concat(t);return"".concat(r,"; ").concat(i,";")}).join("")}function vO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const a=Ts(t);return a.map((t,s)=>{const r="int ".concat(e[s]," = ").concat(n," / outShapeStrides[").concat(s,"]"),i=s===a.length-1?"int ".concat(e[s+1]," = ").concat(n," - ").concat(e[s]," * outShapeStrides[").concat(s,"]"):"index -= ".concat(e[s]," * outShapeStrides[").concat(s,"]");return"".concat(r,"; ").concat(i,";")}).join("")}function wO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const a=function(e,t){const n=e.length,a=e.map(e=>"".concat(t,"[").concat(e,"]")),s=new Array(n-1);s[n-2]=a[n-1];for(let r=n-3;r>=0;--r)s[r]="(".concat(s[r+1]," * ").concat(a[r+1],")");return s}(e.map((e,t)=>t),t);return a.map((t,s)=>{const r="int ".concat(e[s]," = ").concat(n," / ").concat(a[s]),i=s===a.length-1?"int ".concat(e[s+1]," = ").concat(n," - ").concat(e[s]," * ").concat(a[s]):"index -= ".concat(e[s]," * ").concat(a[s]);return"".concat(r,"; ").concat(i,";")}).join("")}function kO(e){const t=Ts(e).map(e=>e.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}xO.registerFlag("HAS_WEBGL",()=>xO.getNumber("WEBGL_VERSION")>0),xO.registerFlag("WEBGL_VERSION",()=>pO(2)?2:pO(1)?1:0),xO.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),xO.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===xO.get("WEBGL_VERSION")),xO.registerFlag("WEBGL_CPU_FORWARD",()=>!0),xO.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),xO.registerFlag("WEBGL_PACK",()=>xO.getBool("HAS_WEBGL")),xO.registerFlag("WEBGL_PACK_NORMALIZATION",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_PACK_CLIP",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_PACK_REDUCE",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_LAZILY_UNPACK",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_CONV_IM2COL",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>xO.getBool("WEBGL_PACK")),xO.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function(e){if(null==uO){const t=PD(e);uO=t.getParameter(t.MAX_TEXTURE_SIZE)}return uO}(xO.getNumber("WEBGL_VERSION"))),xO.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function(e){if(null==dO){const t=PD(e);dO=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,dO)}(xO.getNumber("WEBGL_VERSION"))),xO.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=xO.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const n=PD(e);return t=hO(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:hO(n,"EXT_disjoint_timer_query")?1:0,t}(e)}),xO.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>xO.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Rc()),xO.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function(e){if(0===e)return!1;const t=PD(e);if(1===e){if(!hO(t,"OES_texture_float"))return!1}else if(!hO(t,"EXT_color_buffer_float"))return!1;return fO(t)}(xO.getNumber("WEBGL_VERSION"))),xO.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!xO.getBool("WEBGL_FORCE_F16_TEXTURES")&&xO.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),xO.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>mO(xO.getNumber("WEBGL_VERSION"))),xO.registerFlag("WEBGL_FENCE_API_ENABLED",()=>{return 2===(e=xO.getNumber("WEBGL_VERSION"))&&null!=PD(e).fenceSync;var e}),xO.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>xO.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),xO.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if("number"!==typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))}),xO.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Rc()?1:-1,e=>{if("number"!==typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))}),xO.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),xO.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),xO.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),xO.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),xO.registerFlag("WEBGL_EXP_CONV",()=>!1),xO.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>xO.getBool("IS_TEST")),xO.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),xO.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),xO.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),xO.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);const NO="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:_O}=f;function SO(e,t,n){const a=[];if(e.forEach(e=>{const t=ns(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){const{uniformShape:t}=DO(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:a.push("uniform int ".concat(e.name,"Shape;"));break;case 2:a.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:a.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:a.push("uniform ivec4 ".concat(e.name,"Shape;"))}a.push("uniform ivec2 ".concat(e.name,"TexShape;"))}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:a.push("uniform int outShape;");break;case 2:a.push("uniform ivec2 outShape;"),a.push("uniform int outShapeStrides;");break;case 3:a.push("uniform ivec3 outShape;"),a.push("uniform ivec2 outShapeStrides;");break;case 4:a.push("uniform ivec4 outShape;"),a.push("uniform ivec3 outShapeStrides;")}a.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(e=>{a.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))});const s=a.join("\n"),r=e.map(e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,s="";s+=n?jO(e,a):CO(e,a);const r=e.shapeInfo.logicalShape,i=t.logicalShape;r.length<=i.length&&(s+=n?function(e,t){const n=e.name,a=n.charAt(0).toUpperCase()+n.slice(1),s="get"+a+"AtOutCoords",r=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,o=_O(e.shapeInfo.logicalShape,t.logicalShape),l=LO(i),c=i-r;let u;const d=["x","y","z","w","u","v"];u=0===r?"":i<2&&o.length>=1?"coords = 0;":o.map(e=>"coords.".concat(d[e+c]," = 0;")).join("\n");let h="";h=i<2&&r>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(d[t+c])).join(", ");let p="return outputValue;";const m=1===ns(e.shapeInfo.logicalShape),f=ns(t.logicalShape),g=1===f;if(1!==r||m||g){if(m&&!g)p=1===i?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(o.length){const e=r-2,t=r-1;o.indexOf(e)>-1&&o.indexOf(t)>-1?p="return vec4(outputValue.x);":o.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(s,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(u,"\n      vec4 outputValue = get").concat(a,"(").concat(h,");\n      ").concat(p,"\n    }\n  ")}(e,t):function(e,t){const n=e.name,a=n.charAt(0).toUpperCase()+n.slice(1),s="get"+a+"AtOutCoords",r=t.texShape,i=e.shapeInfo.texShape,o=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===l&&null==e.shapeInfo.flatOffset&&rs(i,r))return"\n      float ".concat(s,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const c=LO(l),u=_O(e.shapeInfo.logicalShape,t.logicalShape),d=l-o;let h;const p=["x","y","z","w","u","v"];h=0===o?"":l<2&&u.length>=1?"coords = 0;":u.map(e=>"coords.".concat(p[e+d]," = 0;")).join("\n");let m="";m=l<2&&o>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(p[t+d])).join(", ");return"\n    float ".concat(s,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(h,"\n      return get").concat(a,"(").concat(m,");\n    }\n  ")}(e,t));return s}(e,t,n.packedInputs,n.enableShapeUniforms)).join("\n"),i=t.texShape,o=yO(),l=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(o);let c,u,d=function(e){const t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(TO,"\n    ").concat(IO,"\n    ").concat(EO,"\n  ");return t}(o);t.isPacked?(c=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){const a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===a[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(a[1],".0);\n      }\n    ");if(1===a[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(a[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n      return 2 * (resTexRC.x * ").concat(a[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){const a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(rs(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(a[0],", ").concat(a[1],"));\n      }\n    ");const s=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(s,");\n      int c = imod(index, ").concat(s,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],s=Math.ceil(e[2]/2),r=s*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n\n      int b = index / ").concat(r,";\n      index -= b * ").concat(r,";\n\n      int r = 2 * (index / ").concat(s,");\n      int c = imod(index, ").concat(s,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const a=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],s=Math.ceil(e[e.length-1]/2),r=s*Math.ceil(e[e.length-2]/2);let i=r,o="",l="b, r, c";for(let c=2;c<e.length-1;c++)i*=e[e.length-c-1],o="\n      int b".concat(c," = index / ").concat(i,";\n      index -= b").concat(c," * ").concat(i,";\n    ")+o,l="b".concat(c,", ")+l;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(a[0],", ").concat(a[1],"));\n      int index = resTexRC.x * ").concat(a[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(r,";\n      index -= b * ").concat(r,";\n\n      int r = 2 * (index / ").concat(s,");\n      int c = imod(index, ").concat(s,") * 2;\n\n      return ivec").concat(e.length,"(").concat(l,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,i,n.enableShapeUniforms),u=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(o)):(c=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(rs(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){const t=vO(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(t,"\n    return ivec3(r, c, d);\n  }\n")}const a=bO(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){const t=vO(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(t,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const a=bO(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){const n=bO(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){const n=bO(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,i,n.enableShapeUniforms),u=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(o)),n.packedInputs&&(d+=AO);return[d,l,u,s,c,r,n.userCode].join("\n")}function CO(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(a,"() {return ").concat(n,";}");const[s,r]=e.shapeInfo.texShape;if(1===s&&1===r)return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const i=RO(n);if(t)return"\n    float ".concat(a,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(i,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[o,l]=e.shapeInfo.texShape;return"\n    float ".concat(a,"() {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(l,", ").concat(i,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){const n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int index) {\n        ").concat(MO(e),"\n      }\n    ");const s=e.shapeInfo.texShape,r=s[0],i=s[1];if(1===i&&1===r)return"\n      float ".concat(a,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const o=RO(n);if(1===i)return t?"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(r,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===r)return t?"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(a,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(a,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int index) {\n      vec2 uv = uvFromFlat(").concat(r,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,a=e.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),r=e.shapeInfo.texShape;if(null!=r&&rs(n,r)){if(t)return"\n      float ".concat(s,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");const e=r[0],n=r[1];return"\n    float ".concat(s,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(e,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}const{newShape:i,keptDims:o}=ms(n),l=i;if(l.length<n.length){const n=OO(e,l),a=["row","col"];return"\n      ".concat(CO(n,t),"\n      float ").concat(s,"(int row, int col) {\n        return ").concat(s,"(").concat(FO(a,o),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(s,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(MO(e),"\n      }\n    ");const c=r[0],u=r[1],d=RO(a);if(1===u)return t?"\n      float ".concat(s,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(a,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(a,"TexShape[0]));\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(s,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(c,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ");if(1===c)return t?"\n      float ".concat(s,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(a,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(a,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(s,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ");if(t)return"\n      float ".concat(s,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a,"Shape[1] + col + ").concat(d,";\n        vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");return"\n  float ".concat(s,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", index);\n    return sampleTexture(").concat(a,", uv);\n  }\n")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,a=e.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),r=n[1]*n[2],i=n[2],{newShape:o,keptDims:l}=ms(n),c=o;if(c.length<n.length){const n=OO(e,c),a=["row","col","depth"];return"\n        ".concat(CO(n,t),"\n        float ").concat(s,"(int row, int col, int depth) {\n          return ").concat(s,"(").concat(FO(a,l),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(s,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(r,", ").concat(i,", 1)));\n        ").concat(MO(e),"\n      }\n    ");const u=e.shapeInfo.texShape,d=u[0],h=u[1],p=e.shapeInfo.flatOffset;if(h===r&&null==p)return t?"\n      float ".concat(s,"(int row, int col, int depth) {\n        int stride1 = ").concat(a,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n        float ".concat(s,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(h,".0, ").concat(d,".0);\n          return sampleTexture(").concat(a,", uv);\n        }\n      ");if(h===i&&null==p)return t?"\n      float ".concat(s,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(a,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(s,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,".0, ").concat(d,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ");const m=RO(a);if(t)return"\n    float ".concat(s,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(a,"Shape[1] * ").concat(a,"Shape[2];\n      int stride1 = ").concat(a,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index);\n      return sampleTexture(").concat(a,", uv);\n    }\n    ");return"\n      float ".concat(s,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r," + col * ").concat(i," + depth + ").concat(m,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(h,", index);\n        return sampleTexture(").concat(a,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,a=e.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),r=n[3],i=n[2]*r,o=n[1]*i,{newShape:l,keptDims:c}=ms(n);if(l.length<n.length){const n=OO(e,l),a=["row","col","depth","depth2"];return"\n      ".concat(CO(n,t),"\n      float ").concat(s,"(int row, int col, int depth, int depth2) {\n        return ").concat(s,"(").concat(FO(a,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(s,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(o,", ").concat(i,", ").concat(r,", 1)));\n        ").concat(MO(e),"\n      }\n    ");const u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1],m="int stride2 = ".concat(a,"Shape[3];"),f="int stride1 = ".concat(a,"Shape[2] * stride2;"),g="int stride0 = ".concat(a,"Shape[1] * stride1;");if(p===o&&null==u)return t?"\n      float ".concat(s,"(int row, int col, int depth, int depth2) {\n        ").concat(m,"\n        ").concat(f,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n      float ".concat(s,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(r,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");if(p===r&&null==u)return t?"\n      float ".concat(s,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(a,"Shape[1] * ").concat(a,"Shape[2], ").concat(a,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n      float ".concat(s,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    ");const x=RO(a);if(t)return"\n    float ".concat(s,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(m,"\n      ").concat(f,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(a,"TexShape[0], ").concat(a,"TexShape[1], index + ").concat(x,");\n      return sampleTexture(").concat(a,", uv);\n    }\n  ");return"\n    float ".concat(s,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(i," +\n          depth * ").concat(r," + depth2;\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index + ").concat(x,");\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t[4],r=t[3]*s,i=t[2]*r,o=t[1]*i,{newShape:l,keptDims:c}=ms(t);if(l.length<t.length){const t=OO(e,l),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(CO(t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(a,"(").concat(FO(n,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(o,", ").concat(i,", ").concat(r,", ").concat(s,")) +\n          depth3;\n        ").concat(MO(e),"\n      }\n    ");const u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];if(p===o&&null==u)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(i,", ").concat(r,", ").concat(s,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===s&&null==u)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=RO(n);return"\n    float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(i," + depth * ").concat(r," +\n          depth2 * ").concat(s," + depth3 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:r}=ms(t);if(s.length<t.length){const t=OO(e,s),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(CO(t),"\n      float ").concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(a,"(").concat(FO(n,r),");\n      }\n    ")}const i=t[5],o=t[4]*i,l=t[3]*o,c=t[2]*l,u=t[1]*c;if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(c,", ").concat(l,", ").concat(o,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(i,", 1)));\n        ").concat(MO(e),"\n      }\n    ");const d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],m=h[1];if(m===u&&null==d)return"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(c,", ").concat(l,", ").concat(o,", ").concat(i,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===i&&null==d)return"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const f=RO(n);return"\n    float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(c," + depth * ").concat(l," +\n          depth2 * ").concat(o," + depth3 * ").concat(i," + depth4 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function jO(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),a=yO();return"\n    vec4 ".concat(n,"() {\n      return ").concat(a.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){const n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e.shapeInfo.texShape,r=yO();if(t)return"\n    vec4 ".concat(a,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(r.texture2D,"(").concat(n,", uv);\n    }\n  ");const i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return"\n    vec4 ".concat(a,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(r.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,a=e.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),r=e.shapeInfo.texShape,i=r[0],o=r[1],l=yO();if(null!=r&&rs(n,r))return t?"\n      vec4 ".concat(s,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    "):"\n      vec4 ".concat(s,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(s,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(a,"TexShape[0]) / 2.0), ceil(float(").concat(a,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(a,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ");const c=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(s,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,a=e.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),r=e.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(1===n[0]){const a=[1,2],r=OO(e,n.slice(1)),i=["b","row","col"];return"\n        ".concat(jO(r,t),"\n        vec4 ").concat(s,"(int b, int row, int col) {\n          return ").concat(s,"(").concat(FO(i,a),");\n        }\n      ")}const o=yO();if(t)return"\n    vec4 ".concat(s,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(a,"TexShape[0]) / 2.0), ceil(float(").concat(a,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(a,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(a,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(o.texture2D,"(").concat(a,", uv);\n    }\n  ");const l=i[0],c=i[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return"\n    vec4 ".concat(s,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(l,", ").concat(c,", ").concat(d,", ").concat(u,", b, row, col);\n      return ").concat(o.texture2D,"(").concat(a,", uv);\n    }\n  ")}(e,t);default:return function(e,t){const n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),s=yO();if(t)return"\n    vec4 ".concat(a,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(s.texture2D,"(").concat(n,", uv);\n    }\n  ");const r=e.shapeInfo.logicalShape,i=r.length,o=e.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],u=l[1],d=Math.ceil(r[i-1]/2);let h=d*Math.ceil(r[i-2]/2),p="int b, int row, int col",m="b * ".concat(h," + (row / 2) * ").concat(d," + (col / 2)");for(let f=2;f<i-1;f++)p="int b".concat(f,", ")+p,h*=r[i-f-1],m="b".concat(f," * ").concat(h," + ")+m;return"\n    vec4 ".concat(a,"(").concat(p,") {\n      int index = ").concat(m,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(c,");\n      return ").concat(s.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}const TO="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",IO="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",EO="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",AO="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function RO(e){return"offset".concat(e)}function MO(e){const t=e.name,n=ns(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function LO(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function DO(e,t,n){const{newShape:a,keptDims:s}=ms(t),r=t.length,i=e&&3===r&&1===t[0],o=i?t.slice(1):a,l=!e&&r>1&&!rs(t,n)&&a.length<r||i;return{useSqueezeShape:l,uniformShape:l?o:t,keptDims:s}}function OO(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function FO(e,t){return t.map(t=>e[t]).join(", ")}function PO(e,t,n,a){const s=n.map((e,n)=>{const a={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(a.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:a}}),r=s.map(e=>e.shapeInfo),i={logicalShape:a.shape,texShape:a.texData.texShape,isUniform:!1,isPacked:a.texData.isPacked,flatOffset:null},o=SO(s,i,t),l=function(e,t){const n=aO(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(qD(e,()=>e.shaderSource(n,t)),qD(e,()=>e.compileShader(n)),Vs().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw YD(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,o),c=e.createProgram(l);return Vs().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:r,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:r,outShapeInfo:i},zO(e,t,c)))}function zO(e,t,n){const a=[],s=[];let r,i,o,l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),1===Vs().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of t.variableNames){const s={name:d,uniform:e.getUniformLocation(n,d,u),offset:e.getUniformLocation(n,"offset".concat(d),u)};t.enableShapeUniforms&&(s.shape=e.getUniformLocation(n,"".concat(d,"Shape"),u),s.texShape=e.getUniformLocation(n,"".concat(d,"TexShape"),u)),a.push(s)}if(t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",u),o=e.getUniformLocation(n,"outShapeStrides",u),i=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(const d of t.customUniforms)s.push(e.getUniformLocation(n,d.name,u));return{variablesLocations:a,customUniformLocations:s,infLoc:l,nanLoc:c,outShapeLocation:r,outShapeStridesLocation:o,outTexShapeLocation:i}}function BO(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((e,n)=>{const a=e.logicalShape,s=t[n],r=s.shape;if(!rs(a,r))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(a," and ").concat(r," must match"));if(e.isUniform&&s.isUniform)return;const i=e.texShape,o=s.isUniform?null:s.texData.texShape;if(!rs(i,o))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(i," and ").concat(o," must match"))})}function WO(e){return Vs().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class VO{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=zD.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=yO();this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?vO(["r","c","d"],e):bO(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class UO{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=zD.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=yO();this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?vO(["r","c","d"],e):bO(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class HO{constructor(e){this.variableNames=["A"],this.outTexUsage=BD.DOWNLOAD;const t=yO();this.outputShape=e,this.userCode="\n      ".concat(NO,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}class GO{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=BD.DOWNLOAD;const t=yO();this.outputShape=e,this.userCode="\n      ".concat(NO,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}const qO={R:0,G:1,B:2,A:3};class KO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const a=yO();this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length);let s="result";t&&(s="floor(result * 255. + 0.5)");let r="";for(let i=0;i<n.length;i++){const e=n[i];r+="\n          if(offset == ".concat(i,") {\n            result = values[").concat(qO[e],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":kO(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(r,"\n        }\n        ").concat(a.output," = vec4(").concat(s,", 0., 0., 0.);\n      }\n    ")}}class ZO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=yO();this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length);let a="",s="result";t&&(s="floor(result * 255. + 0.5)");for(let r=0;r<=1;r++)for(let t=0;t<=1;t++){const s=2*r+t;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(t," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(t,";\n          if (localCoords[1] + ").concat(r," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(r,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(s,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(s,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(s,"] = values[2];\n            } else {\n              result[").concat(s,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":kO(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(n.output," = ").concat(s,";\n        }\n    ")}}function XO(e){const t=yO();return function(e,t){const n=aO(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(qD(e,()=>e.shaderSource(n,t)),qD(e,()=>e.compileShader(n)),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function YO(e){return function(e,t){const n=aO(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return qD(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),qD(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function JO(e){return function(e,t){const n=aO(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return qD(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),qD(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}(e,new Uint16Array([0,1,2,2,1,3]))}function QO(e,t,n,a,s,r){!function(e,t){const n=Vs().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const n="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(e>n||t>n){const a="[".concat(e,"x").concat(t,"]"),s="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+s+".")}}(t,n);const i=function(e){return aO(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}(e),o=e.TEXTURE_2D;return qD(e,()=>e.bindTexture(o,i)),qD(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),qD(e,()=>e.texParameteri(o,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),qD(e,()=>e.texParameteri(o,e.TEXTURE_MIN_FILTER,e.NEAREST)),qD(e,()=>e.texParameteri(o,e.TEXTURE_MAG_FILTER,e.NEAREST)),1===Vs().getNumber("WEBGL_VERSION")?qD(e,()=>e.texImage2D(o,0,a,t,n,0,s,r,null)):qD(e,()=>e.texStorage2D(o,1,a,t,n)),qD(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:i,texShape:[n,t]}}function $O(e){return e.internalFormatFloat}function eF(e){return e.internalFormatHalfFloat}function tF(e){return e.downloadTextureFormat}function nF(e){return e.internalFormatPackedFloat}function aF(e){return e.internalFormatPackedHalfFloat}function sF(e,t,n,a,s,r,i,o){const l=e,c=new Float32Array(function(e,t){const[n,a]=HD(e,t);return n*a*4}(r,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}class rF{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=Vs().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,function(e,t){OD[e]=t}(t,e)):this.gl=PD(t),e=this.gl,2===Vs().getNumber("WEBGL_VERSION")){const t=e;this.createVertexArray=()=>qD(t,()=>t.createVertexArray()),this.bindVertexArray=e=>qD(t,()=>t.bindVertexArray(e)),this.deleteVertexArray=e=>qD(t,()=>t.deleteVertexArray(e)),this.getVertexArray=()=>qD(t,()=>t.getParameter(t.VERTEX_ARRAY_BINDING))}else if(null!=e){const t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>qD(e,()=>t.createVertexArrayOES()),this.bindVertexArray=n=>qD(e,()=>t.bindVertexArrayOES(n)),this.deleteVertexArray=n=>qD(e,()=>t.deleteVertexArrayOES(n)),this.getVertexArray=()=>qD(e,()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===Vs().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=ZD(this.gl,e),hO(this.gl,t))this.textureHalfFloatExtension=ZD(this.gl,t);else if(Vs().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),hO(this.gl,a))this.colorBufferHalfFloatExtension=ZD(this.gl,a);else if(Vs().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",hO(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!hO(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=YO(this.gl),this.indexBuffer=JO(this.gl),this.framebuffer=function(e){return aO(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=GD(this.gl,this.textureHalfFloatExtension)}get debug(){return Vs().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;qD(e,()=>e.finish()),qD(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),qD(e,()=>e.deleteFramebuffer(this.framebuffer)),qD(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),qD(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),qD(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,a){const[s,r]=VD(t,n);return QO(e,s,r,$O(a),a.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,a){const[s,r]=VD(t,n);return QO(e,s,r,eF(a),a.textureFormatFloat,a.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,a){const[s,r]=VD(t,n);return QO(e,s,r,tF(a),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,n){qD(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?2===Vs().getNumber("WEBGL_VERSION")?qD(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):qD(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):2===Vs().getNumber("WEBGL_VERSION")?qD(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):qD(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),qD(e,()=>e.bindTexture(e.TEXTURE_2D,null))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,a){this.throwIfDisposed(),function(e,t,n,a,s,r){let i,o,l;qD(e,()=>e.bindTexture(e.TEXTURE_2D,t)),s instanceof Uint8Array?(i=new Uint8Array(n*a*4),o=e.UNSIGNED_BYTE,l=e.RGBA):(i=new Float32Array(n*a*4),o=e.FLOAT,l=r.internalFormatPackedFloat),i.set(s),2===Vs().getNumber("WEBGL_VERSION")?qD(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,a,e.RGBA,o,i)):qD(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,a,0,e.RGBA,o,i)),qD(e,()=>e.bindTexture(e.TEXTURE_2D,null))}(this.gl,e,t,n,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,a){const[s,r]=HD(t,n);return QO(e,s,r,aF(a),e.RGBA,a.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,a){const[s,r]=HD(t,n);return QO(e,s,r,nF(a),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(tO(this.gl,this.framebuffer),this.outputTexture=null),qD(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>function(e,t,n,a){const[s,r]=VD(t,n),i=new Uint8Array(t*n*4);return qD(e,()=>e.readPixels(0,0,s,r,a.downloadTextureFormat,e.UNSIGNED_BYTE,i)),new Float32Array(i.buffer)}(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,a,s,r){return sF(this.gl,e,0,0,0,s,r,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){const a=e,s=new Float32Array(n);return a.bindBuffer(a.PIXEL_PACK_BUFFER,t),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,s),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),s}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const a=function(e,t,n){const a=e.createBuffer();qD(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,a));const s=16*t*n;return qD(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,s,e.STREAM_READ)),qD(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),qD(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(Vs().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,s=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=a.clientWaitSync(s,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=s}else Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>function(e,t,n){const a=new Float32Array(t*n*4);return qD(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,a)),a}(this.gl,t,n))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=XO(t));const n=function(e){return aO(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}(t);qD(t,()=>t.attachShader(n,this.vertexShader)),qD(t,()=>t.attachShader(n,e)),function(e,t){if(qD(e,()=>e.linkProgram(t)),!Vs().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,n);const a=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&JD(t,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;qD(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),function(e,t,n){qD(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),QD(e,t,"clipSpacePos",n,3,20,0)&&QD(e,t,"uv",n,2,20,12)}(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(qD(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&JD(this.gl,this.program),qD(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return aO(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),qD(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),$D(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[a,s]=HD(t,n);this.setOutputMatrixTextureDriver(e,a,s)}setOutputMatrixWriteRegion(e,t,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,t)}setOutputPackedMatrixWriteRegion(e,t,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&JD(this.gl,this.program),nO(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}qD(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),qD(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=ZD(this.gl,2===Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await ds(()=>this.disposed||this.isQueryAvailable(e,Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),a=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),a&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=function(e){let t=0;for(;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in Vs().platform&&(n=Vs().platform.setTimeoutCustom.bind(Vs().platform)),ds(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),eO(this.gl,e,this.framebuffer),this.debug&&nO(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(eO(this.gl,this.outputTexture,this.framebuffer),this.debug&&nO(this.gl)):tO(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const a=this.gl;eO(a,e,this.framebuffer),this.debug&&nO(a),this.outputTexture=e,qD(a,()=>a.viewport(0,0,t,n)),qD(a,()=>a.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,a){this.throwIfDisposed(),qD(this.gl,()=>this.gl.scissor(e,t,n,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{mx:iF,XI:oF,Nk:lF,f6:cF,ct:uF,YG:dF,hH:hF,z3:pF,sG:mF,uM:fF,vS:gF,qB:xF,GG:yF,rq:bF,lg:vF,WR:wF,cu:kF,GE:NF,px:_F,jC:SF,He:CF,hE:jF,BF:TF,Dk:IF,cl:EF,_B:AF,ub:RF,_f:MF,Ku:LF,qy:DF,Zy:OF,bu:FF,zv:PF,dH:zF,HS:BF,yH:WF,l3:VF,z9:UF,x6:HF,_m:GF,eW:qF,GK:KF,SP:ZF,yr:XF,dl:YF,Dw:JF,xT:QF,_X:$F,wz:eP}=P;function tP(e,t){return["x","y","z","w","u","v"].slice(0,t).map(t=>"".concat(e,".").concat(t))}function nP(e,t){return 1===t?[e]:tP(e,t)}class aP{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=WO(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=nP("rc",this.rank),t=LO(this.rank),n=this.getOutOfBoundsCondition(e),a=this.getSetup(e),s=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(t," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(a,"\n\n            setOutput(vec4(").concat(s,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let a=0;a<=1;a++){let s="".concat(0===n?"r":"rp1",", ").concat(0===a?"c":"cp1");for(let t=2;t<this.rank;t++)s="".concat(e[e.length-1-t],",")+s;t.push(s)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],a=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(a,";\n    ")}getOutput(e){const t=this.getSourceCoordsArr(e);if(1===this.rank){const e=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(e," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}class sP{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length);let n="";for(let a=0;a<4;a++){let e="thisRC = rc;";a%2===1&&(e+="thisRC.z += 1;"),a>1&&(e+="thisRC.y += 1;"),n+="\n        ".concat(e,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){const n=t?wO(["r","c","d"],"inputShape"):bO(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":kO(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class rP{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const a=oP(t,n),s=lP(e,a,n);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const r=iP(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=r,this.log();const e=this.freeTextures[s].pop();return this.usedTextures[s].push(e),e}let i;return a===WD.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===WD.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===WD.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===WD.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===WD.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(i),this.numUsedTextures++,this._numBytesAllocated+=r,this.log(),i}releaseTexture(e,t,n,a){if(null==this.freeTextures)return;const s=oP(n,a),r=lP(t,s,a);r in this.freeTextures||(this.freeTextures[r]=[]);const i=iP(t,s,this.gpgpu.gl,this.gpgpu.textureConfig,a),o=Vs().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==o&&this._numBytesAllocated>o?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[r].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;const l=this.usedTextures[r],c=l&&l.indexOf(e);if(null==c||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));const t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function iP(e,t,n,a,s){const r=function(e,t){switch(e){case WD.PACKED_2X2_FLOAT32:return nF(t);case WD.PACKED_2X2_FLOAT16:return aF(t);case WD.UNPACKED_FLOAT32:return $O(t);case WD.UNPACKED_FLOAT16:return eF(t);case WD.PACKED_4X1_UNSIGNED_BYTE:return tF(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,a);let i;if(s){const[t,n]=HD(e[0],e[1]);i=t*n}else{const[t,n]=VD(e[0],e[1]);i=t*n}const o=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,r);return i*o}function oP(e,t){if(e===BD.UPLOAD)return WD.PACKED_2X2_FLOAT32;if(e===BD.RENDER||null==e)return function(e){return Vs().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?WD.PACKED_2X2_FLOAT32:WD.UNPACKED_FLOAT32:e?WD.PACKED_2X2_FLOAT16:WD.UNPACKED_FLOAT16}(t);if(e===BD.DOWNLOAD||e===BD.PIXELS)return WD.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function lP(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}class cP{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const uP="if (isnan(x)) return x;",dP="return abs(x);";const hP=uP+"\n  return (x < 0.0) ? 0.0 : x;\n",pP=uP+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",mP="return x;";class fP{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class gP{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length);const t=e.length,n=nP("rc",t),a=LO(t),s=function(e,t){if(1===e)return"rc";let n="";for(let a=0;a<e;a++)n+=t[a],a<e-1&&(n+=",");return n}(t,n),r=n.slice(-2),i=t<=1?"rc":"vec2(".concat(r.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(s,");\n\n        setOutput(getChannel(packedInput, ").concat(i,"));\n      }\n    ")}}const xP=px,yP={};const bP=Vs().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class vP extends Ua{nextDataId(){return vP.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Vs().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof rF)t=e;else{const n=PD(Vs().getNumber("WEBGL_VERSION"),e);t=new rF(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=PD(Vs().getNumber("WEBGL_VERSION"));t=new rF(e),this.binaryCache=((n=Vs().getNumber("WEBGL_VERSION"))in yP||(yP[n]={}),yP[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new rP(this.gpgpu),this.numMBBeforeWarning=null==Vs().global.screen?1024:Vs().global.screen.height*Vs().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new Va(this,Qc())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,a,s,r){const i=this.makeTensorInfo(t,n),o=this.texData.get(i.dataId);o.isPacked=!1,o.texture={texture:e,texShape:[a,s]},o.texShape=[a,s];const l=oO(t),c=new KO(l,!1,r),u=this.runWebGLProgram(c,[i],n,[[a,s]]);return u.shape=t,o.texture=null,this.disposeIntermediateTensorInfo(i),u.dataId}write(e,t,n){if((Vs().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Vs().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:t,dtype:n,values:e,usage:BD.UPLOAD,refCount:1}),a}refCount(e){if(this.texData.has(e)){return this.texData.get(e).refCount}return 0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,a,s){if(Vs().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===a)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:a,values:t,usage:BD.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:a,complexTensorInfos:s,slice:r,shape:i,isPacked:o}=t;if(null!=r){let t;t=o?new fP(i,mP):new cP(i,mP);const n=this.runWebGLProgram(t,[{dataId:e,shape:i,dtype:a}],a),s=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),s}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===a)return n;const l=null!=this.activeTimers;let c,u;if(l&&(c=Vl()),"complex64"===a){u=ub(this.readSync(s.real.dataId),this.readSync(s.imag.dataId))}else u=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=Vl()-c),this.convertAndCacheOnCPU(e,u)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise(e=>t.push(e))}const t=this.texData.get(e),{values:n,shape:a,slice:s,dtype:r,complexTensorInfos:i,isPacked:o}=t;if(null!=s){let t;t=o?new fP(a,mP):new cP(a,mP);const n=this.runWebGLProgram(t,[{dataId:e,shape:a,dtype:r}],r),s=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),s}if(null!=n)return this.convertAndCacheOnCPU(e);if(Vs().getBool("DEBUG")&&!Vs().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Vs().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,c,u=null;if("complex64"!==r&&Vs().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);const t=this.texData.get(l.dataId);u=this.gpgpu.createBufferFromTexture(t.texture.texture,...UD(a))}if(this.pendingRead.set(e,[]),"complex64"!==r&&await this.gpgpu.createAndWaitForFence(),"complex64"===r){const e=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]);c=ub(e[0],e[1])}else if(null==u)c=this.getValuesFromTexture(e);else{const e=ns(a);c=this.gpgpu.downloadFloat32MatrixFromBuffer(u,e)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=u){const e=this.gpgpu.gl;qD(e,()=>e.deleteBuffer(u))}const d=this.convertAndCacheOnCPU(e,c),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(e=>e(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Qc().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(e),{values:a,shape:s,slice:r,dtype:i,isPacked:o,texture:l}=n;if("complex64"===i)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=r){let n;n=o?new fP(s,mP):new cP(s,mP);const a=this.runWebGLProgram(n,[{dataId:e,shape:s,dtype:i}],i),r=this.readToGPU(a,t);return this.disposeIntermediateTensorInfo(a),r}if(null==l)throw null!=a?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,t.customTexShape),u=Qc().makeTensorFromTensorInfo(c),d=this.texData.get(c.dataId);return Object.assign({tensorRef:u},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map(e=>Gl(e));return gd(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return gd(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!KD(n)){if(Vs().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:a}=this.texData.get(e),s=ns(t);if(Vs().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),a=this.texData.get(n.dataId),r=this.gpgpu.downloadMatrixFromPackedTexture(a.texture.texture,...UD(t)).subarray(0,s);return this.disposeIntermediateTensorInfo(n),r}const r=Vs().getBool("WEBGL_PACK")&&!0===a,i=r?oO(t):t,o=r?new GO(i):new HO(i),l=this.runWebGLProgram(o,[{shape:i,dtype:n,dataId:e}],"float32"),c=this.texData.get(l.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(l),u}timerAvailable(){return Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let a=!1;null==this.programTimersStack?(this.programTimersStack=n,a=!0):this.activeTimers.push(n),this.activeTimers=n,e();const s=Kl(this.activeTimers.map(e=>e.query)).filter(e=>null!=e),r=Kl(this.activeTimers.map(e=>e.name)).filter(e=>null!=e);this.activeTimers=t,a&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(s);i.kernelMs=Ya(e),i.getExtraProfileInfo=()=>e.map((e,t)=>({name:r[t],ms:e})).map(e=>"".concat(e.name,": ").concat(e.ms)).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Vl(),endMs:null}}endTimer(e){return Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Vl(),e)}async getQueryTime(e){if(Vs().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:a,usage:s,isPacked:r,slice:i}=this.texData.get(e),o=i&&i.origDataId||e,l=this.dataRefCount.get(o);l>1?this.dataRefCount.set(o,l-1):(this.dataRefCount.delete(o),null!=t&&(this.numBytesInGPU-=this.computeBytes(a,n),this.textureManager.releaseTexture(t,a,s,r)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bP;return Vs().getBool("WEBGL_CPU_FORWARD")&&e.every(e=>null==this.texData.get(e.dataId).texture&&ns(e.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){hl("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return xP(e.shape,t)}packedUnaryOp(e,t,n){const a=new fP(e.shape,t),s=this.compileAndRun(a,[e],n);return Qc().makeTensorFromTensorInfo(s)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=zF(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Vs().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,dP,e.dtype);const t=new cP(e.shape,dP),n=this.compileAndRun(t,[e]);return Qc().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let a;if("string"===t&&null!=n&&n.length>0&&ks(n[0])){const s=n.map(e=>Hl(e));a=this.write(s,e,t)}else a=this.write(n,e,t);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:t}}makeOutput(e,t,n){return Qc().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new gP(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new aP(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[rO(e.shape),...iO(e.shape)],a={dtype:e.dtype,shape:n,dataId:e.dataId},s=[rO(t),...iO(t)],r=new sP(s,n),i=[n],o=this.runWebGLProgram(r,[a],e.dtype,i,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:a,shape:s,dtype:r}=n;if(null!=t){$a(ns(s)<=t[0]*t[1]*4,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const i=oO(s);let o;o=a?new UO(i):new VO(i);const l=[null!=t?t:UD(i)];return{dtype:r,shape:s,dataId:this.runWebGLProgram(o,[{shape:i,dtype:r,dataId:e}],r,l,!0,t).dataId}}runWebGLProgram(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5?arguments[5]:void 0;const i=this.makeTensorInfo(e.outputShape,n),o=this.texData.get(i.dataId);if(e.packedOutput&&(o.isPacked=!0),e.outPackingScheme===zD.DENSE){const t=null!=r?r:UD(e.outputShape);o.texShape=t.map(e=>2*e)}if(null!=e.outTexUsage&&(o.usage=e.outTexUsage),0===ns(i.shape))return o.values=fs(i.dtype,0),i;const l=[],c=t.map(t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&ns(t.shape)<=Vs().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),l.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!cO(n.shape,t.shape)){const e=t,a=t.shape;t.shape=n.shape,t=this.packedReshape(t,a),l.push(t),n=this.texData.get(t.dataId),e.shape=a}return{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(i.dataId);const u={shape:i.shape,texData:o,isUniform:!1},d=function(e,t,n){let a="";t.concat(n).forEach(t=>{const s=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const r=t.texData.texShape,{useSqueezeShape:i,uniformShape:o,keptDims:l}=DO(e.packedInputs,t.shape,r);let c="",u="",d="";if(1===o.length&&e.packedInputs){const e=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];c="".concat(e[0]>1,"_").concat(e[1]>1)}else if(2!==o.length||e.packedInputs){if(o.length>2&&!e.packedInputs){const e=Ts(o);d="".concat(e[0]===r[1],"_").concat(e[e.length-1]===r[1])}}else u="".concat(o[0]>1,"_").concat(o[1]>1);const h=t.shape.length,p=2===o.length&&rs(t.shape,r),m=1===ns(t.shape),f=Xd(t.shape,n.shape),g=!e.packedInputs&&h===n.shape.length&&rs(r,n.texData.texShape),x=e.packedInputs||o.length>2?"":"".concat(r[0]>1,"_").concat(r[1]>1);a+="".concat(h,"_").concat(g,"_").concat(i?l:"","_").concat(o.length,"_").concat(m,"_").concat(f,"_").concat(p,"_").concat(c,"_").concat(u,"_").concat(d,"_").concat(x,"_").concat(s)}else{const e=t.isUniform?"uniform":t.texData.texShape;a+="".concat(t.shape,"_").concat(e,"_").concat(s)}});const s=e.userCode;let r=e.constructor.name;return r+="_"+a+"_"+s+"".concat(Vs().getNumber("WEBGL_VERSION")),r}(e,c,u),h=this.getAndSaveBinary(d,()=>PO(this.gpgpu,e,c,u)),p=null!=this.activeTimers;let m;p&&(m=this.startTimer()),Vs().get("ENGINE_COMPILE_ONLY")||function(e,t,n,a,s){t.program.enableShapeUniforms||(BO(t.inShapeInfos,n),BO([t.outShapeInfo],[a]));const r=a.texData.texture,i=a.texData.texShape;a.texData.isPacked?e.setOutputPackedMatrixTexture(r.texture,i[0],i[1]):e.setOutputMatrixTexture(r.texture,i[0],i[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===Vs().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const a=n[l],{uniform:s,offset:r,shape:i,texShape:o}=t.variablesLocations[l];if(i){const{uniformShape:n}=DO(t.program.packedInputs,a.shape,a.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(i,new Int32Array(n));break;case 2:e.gl.uniform2iv(i,new Int32Array(n));break;case 3:e.gl.uniform3iv(i,new Int32Array(n));break;case 4:e.gl.uniform4iv(i,new Int32Array(n))}}if(o&&e.gl.uniform2i(o,a.texData.texShape[0],a.texData.texShape[1]),null!=s)if(a.isUniform)if(ns(a.shape)<2)e.gl.uniform1f(s,a.uniformValues[0]);else{let t=a.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(s,t)}else null!=a.texData.slice&&null!=r&&e.gl.uniform1i(r,a.texData.slice.flatOffset),e.setInputMatrixTexture(a.texData.texture.texture,s,l)}const o=t.outShapeLocation;if(o)switch(a.shape.length){case 1:e.gl.uniform1iv(o,new Int32Array(a.shape));break;case 2:e.gl.uniform2iv(o,new Int32Array(a.shape));break;case 3:e.gl.uniform3iv(o,new Int32Array(a.shape));break;case 4:e.gl.uniform4iv(o,new Int32Array(a.shape))}if(t.outShapeStridesLocation){const n=Ts(a.shape);switch(a.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,a.texData.texShape[0],a.texData.texShape[1]),t.program.customUniforms&&s)for(let l=0;l<t.program.customUniforms.length;++l){const n=t.program.customUniforms[l],a=t.customUniformLocations[l],r=s[l];if("float"===n.type)e.gl.uniform1fv(a,r);else if("vec2"===n.type)e.gl.uniform2fv(a,r);else if("vec3"===n.type)e.gl.uniform3fv(a,r);else if("vec4"===n.type)e.gl.uniform4fv(a,r);else if("int"===n.type)e.gl.uniform1iv(a,r);else if("ivec2"===n.type)e.gl.uniform2iv(a,r);else if("ivec3"===n.type)e.gl.uniform3iv(a,r);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(a,r)}}e.executeProgram()}(this.gpgpu,h,c,u,a),l.forEach(e=>this.disposeIntermediateTensorInfo(e)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const f=Vs().getNumber("WEBGL_FLUSH_THRESHOLD");if(f>0){const e=Vl();e-this.lastGlFlushTime>f&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!Vs().getBool("WEBGL_LAZILY_UNPACK")&&o.isPacked&&!1===s){const e=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),e}return i}compileAndRun(e,t,n,a){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;return this.runWebGLProgram(e,t,n,a,s)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!Vs().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]})}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=tu(()=>{if(!Vs().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Vs().getBool("DEBUG");Vs().set("DEBUG",!1);const t=this.abs(Ld(1e-8)).dataSync()[0];if(Vs().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:a,values:s,texture:r,usage:i,isPacked:o}=t;if(null!=r)return;const l=null!=this.activeTimers;let c;l&&(c=Vl());let u=t.texShape;if(null==u&&(u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Vs().getNumber("WEBGL_MAX_TEXTURE_SIZE"),a=Vs().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(a===1/0&&Vs().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(a=n/2),t&&(n*=2,a*=2,1===(e=e.map((t,n)=>n>=e.length-2?Za(e[n]):e[n])).length&&(e=[2,e[0]])),2!==e.length){const t=ms(e);e=t.newShape}let s=ns(e),r=null;e.length<=1&&s<=n?r=[1,s]:2===e.length&&e[0]<=n&&e[1]<=n?r=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?r=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?r=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?r=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(r=[e[0],e[1]*e[2]*e[3]]);const i=null!=r&&Math.max(...r)>a&&Math.min(...r)<=(t?2:1)&&Math.min(...r)>0;if(null==r||i)if(t){const t=rO(e);let n=2,a=2;e.length&&([n,a]=iO(e)),s=t*(n/2)*(a/2),r=ls(s).map(e=>2*e)}else r=ls(s);return r}(n,o),t.texShape=u),null!=s){const e=oO(n);let r,i=u[1],d=u[0];const h=s instanceof Uint8Array||s instanceof Uint8ClampedArray;!o&&h||([i,d]=HD(u[0],u[1])),r=o?new ZO(e,h):new KO(e,h);const p=h?[d,i]:u,m=this.makeTensorInfo(p,a),f=this.texData.get(m.dataId);f.usage=h?BD.PIXELS:BD.UPLOAD,f.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(m.dataId),i,d,s);const g=[[d,i]],x=!0,y=this.runWebGLProgram(r,[m],a,g,x),b=this.texData.get(y.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,Vs().get("ENGINE_COMPILE_ONLY")?this.disposeData(y.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(y.dataId)),this.disposeIntermediateTensorInfo(m),l&&(this.uploadWaitMs+=Vl()-c)}else{const e=this.acquireTexture(u,i,a,o);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:a}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error("Unknown dtype ".concat(t))}(t,a)),n.values}acquireTexture(e,t,n,a){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(e," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,a)}computeBytes(e,t){return e[0]*e[1]*vs(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise(e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}});e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await By(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw YD(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:a,nanLoc:s,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:o}=zO(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=a,e.nanLoc=s,e.outShapeLocation=r,e.outShapeStridesLocation=i,e.outTexShapeLocation=o}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:a,height:s,width:r,channels:i}=e,o=Qc().backend;if(!o.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=o.writeTexture(a,t,n,s,r,i);return Qc().makeTensorFromDataId(l,t,n,o)}}vP.nextDataId=0;Mc()&&du("webgl",()=>new vP,2);const wP="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class kP{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=Jd(t,n),this.enableShapeUniforms=WO(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const NP="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class _P{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Jd(t,n);const s=this.outputShape.length;this.enableShapeUniforms=WO(s);let r="";if(a)if(0===s||1===ns(this.outputShape))r="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const e=LO(s);if(r="\n          ".concat(e," coords = getOutputCoords();\n        "),1===s)this.enableShapeUniforms?r+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":r+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const e=nP("coords",s);this.enableShapeUniforms?r+="\n            bool nextRowOutOfBounds =\n              (".concat(e[s-2]," + 1) >= outShape[").concat(s," - 2];\n            bool nextColOutOfBounds =\n              (").concat(e[s-1]," + 1) >= outShape[").concat(s," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):r+="\n            bool nextRowOutOfBounds =\n              (".concat(e[s-2]," + 1) >= ").concat(this.outputShape[s-2],";\n            bool nextColOutOfBounds =\n              (").concat(e[s-1]," + 1) >= ").concat(this.outputShape[s-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}}function SP(e){const{inputs:t,backend:n}=e,{x:a}=t;return n.incRef(a.dataId),{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}const CP={kernelName:ci,backendName:"webgl",kernelFunc:SP};function jP(e){const{inputs:t,backend:n}=e,{real:a,imag:s}=t,r=n.makeTensorInfo(a.shape,"complex64"),i=n.texData.get(r.dataId),o=SP({inputs:{x:a},backend:n}),l=SP({inputs:{x:s},backend:n});return i.complexTensorInfos={real:o,imag:l},r}const TP={kernelName:vr,backendName:"webgl",kernelFunc:jP},IP="return (a < 0.) ? b * a : a;",EP="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const AP={kernelName:fi,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{alpha:r}=a,i=n.makeTensorInfo([],"float32",Bl(r,"float32")),o=Vs().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _P(EP,s.shape,i.shape):new kP(IP,s.shape,i.shape),l=n.runWebGLProgram(o,[s,i],"float32");return n.disposeIntermediateTensorInfo(i),l}},RP="return (a < 0.) ? b * a : a;",MP="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const LP={kernelName:to,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a,alpha:s}=t,r=Vs().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _P(MP,a.shape,s.shape):new kP(RP,a.shape,s.shape);return n.runWebGLProgram(r,[a,s],"float32")}},DP="if (isnan(x)) return x;";function OP(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:a,dtype:s}=e;return e=>{let{inputs:r,backend:i}=e;const{x:o}=r,l=i,c=s||o.dtype;if(l.shouldExecuteOnCPU([o])&&null!=a){const e=l.texData.get(o.dataId),t=a(e.values,c);return l.makeTensorInfo(o.shape,c,t)}let u;return u=Vs().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new fP(o.shape,n):new cP(o.shape,t),l.runWebGLProgram(u,[o],c)}}function FP(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:a=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}=e;return e=>{let{inputs:o,backend:l}=e;const{a:c,b:u}=o,d=l;if(s&&"complex64"===c.dtype){const e=d.texData.get(c.dataId),n=d.texData.get(u.dataId),[a,s]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{const[n,a]=e,s={dataId:n.dataId,dtype:n.dtype,shape:c.shape},r={dataId:a.dataId,dtype:a.dtype,shape:u.shape},i=new kP(t,c.shape,u.shape);return d.runWebGLProgram(i,[s,r],fc(n.dtype,a.dtype))}),r=jP({inputs:{real:a,imag:s},backend:d});return d.disposeIntermediateTensorInfo(a),d.disposeIntermediateTensorInfo(s),r}const h=i||fc(c.dtype,u.dtype);if(("string"===c.dtype||"string"===u.dtype||d.shouldExecuteOnCPU([c,u]))&&null!=r){const e=d.texData.get(c.dataId).values,t=d.texData.get(u.dataId).values,n="string"===c.dtype?Hb(e):e,a="string"===c.dtype?Hb(t):t,[s,i]=r(c.shape,u.shape,n,a,h),o=d.makeTensorInfo(i,h);return d.texData.get(o.dataId).values=s,o}let p;return p=Vs().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new _P(n,c.shape,u.shape,a):new kP(t,c.shape,u.shape),d.runWebGLProgram(p,[c,u],h)}}function PP(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":hP;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":pP;if("prelu"===e)return t?MP:RP;if("leakyrelu"===e)return t?EP:IP;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}class zP{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=WO(this.outputShape.length);const c=a?e[1]:e[2],u=Math.ceil(c/2),d=a?"i * 2, rc.y":"rc.y, i * 2",h=s?"rc.z, i * 2":"i * 2, rc.z",p=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let f="",g="";i&&(f=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(i,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(i,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(i,"\n        }"),g="result = activation(result);");const x=r?"result += getBiasAtOutCoords();":"";r&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let y="rc.x",b="rc.x";e[0]<t[0]?y="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(b="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(f,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(y,";\n        int batchB = ").concat(b,";\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(m[0],");\n          result += (").concat(p[1]," * ").concat(m[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(x,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}}const BP="return areal * breal - aimag * bimag;",WP="return areal * bimag + aimag * breal;";class VP{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Jd(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const UP="return a * b;";function HP(e){const{inputs:t,backend:n}=e,{a:a,b:s}=t,r=fc(a.dtype,s.dtype);if("complex64"===a.dtype){const e=n.texData.get(a.dataId),t=n.texData.get(s.dataId),r=new VP(BP,a.shape,s.shape),i=new VP(WP,a.shape,s.shape),o=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:a.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:s.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:s.shape}],l=n.runWebGLProgram(r,o,"float32"),c=n.runWebGLProgram(i,o,"float32"),u=jP({inputs:{real:l,imag:c},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),u}if(n.shouldExecuteOnCPU([a,s])){const e=n.texData.get(a.dataId),t=n.texData.get(s.dataId),[i,o]=TF(a.shape,s.shape,e.values,t.values,r),l=n.makeTensorInfo(o,r);return n.texData.get(l.dataId).values=i,l}let i;return i=Vs().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _P(UP,a.shape,s.shape):new kP(UP,a.shape,s.shape),n.runWebGLProgram(i,[a,s],r)}const GP={kernelName:Ui,backendName:"webgl",kernelFunc:HP};function qP(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{shape:r}=a,i=n,o=ns(s.shape),l=hs(r,o),c=ns(l);$a(o===c,()=>"The new shape (".concat(l,") has ").concat(c," elements and the old ")+"shape (".concat(s.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements.");const u=i.texData.get(s.dataId);return!u.isPacked||cO(s.shape,l)||null!==u.texture&&cO(u.shape,l)?(i.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype}):function(e,t,n){const a=[rO(e.shape),...iO(e.shape)],s={dtype:e.dtype,shape:a,dataId:e.dataId},r=[rO(t),...iO(t)],i=new sP(r,a),o=[a],l=n.runWebGLProgram(i,[s],e.dtype,o,!0);return{dataId:l.dataId,shape:t,dtype:l.dtype}}(s,l,i)}const KP={kernelName:uo,backendName:"webgl",kernelFunc:qP};class ZP{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:a,inSize:s,outSize:r}=e;this.outputShape=[a,r];const i=4*Math.floor(n/4),o=n%4;let l="sumValue += dot(values, ones);";if(null!=t){const e=1/t;l="sumValue += dot(values * ".concat(is(e)?e.toPrecision(2):e,", ones);")}let c="";s%n>0&&(c="\n        if (inIdx < 0 || inIdx >= ".concat(s,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(c,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(i,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(i,";\n        if (").concat(1===o,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===o,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===o,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class XP{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:a,inSize:s,outSize:r}=e;this.outputShape=[a,r];let i="0.0",o="";"prod"===t?i="1.0":"min"===t?(i="1.0 / 1e-20",o="min"):"max"===t&&(i="-1.0 / 1e-20",o="max");let l="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");const c=4*Math.floor(n/4),u=n%4;let d="\n      if (".concat("sum"===t,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===t,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(o,"(values, minMaxValue);\n        if (").concat("min"===t," || ").concat("max"===t,") {\n          minMaxValue = ").concat(o,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),h="vec4";"all"===t?(i="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(i="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let p="";s%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(s,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(i,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(i,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}}function YP(e,t,n,a){const s=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],a=Xy(n);t.push({inSize:n,windowSize:a,outSize:Math.ceil(n/a)})}return t}(e.shape);let r=e;for(let i=0;i<s.length;i++){const{inSize:o,windowSize:l,outSize:c}=s[i];let u,d;u="mean"===n?0===i?new ZP({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},o):new ZP({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c}):new XP({windowSize:l,inSize:o,batchSize:e.shape[0],outSize:c},n),d=r,r=a.runWebGLProgram(u,[r],t),d.dataId!==e.dataId&&a.disposeIntermediateTensorInfo(d)}return r}class JP{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;const a=LO(this.rank),s=function(e){const t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],a=new Array(t);for(let s=0;s<e.length;s++)a[e[s]]=n[s];return a.join()}(t);this.userCode="\n    void main() {\n      ".concat(a," resRC = getOutputCoords();\n      setOutput(getA(").concat(s,"));\n    }\n    ")}}class QP{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let c=0;c<n.length;c++)n[c]=e[t[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const a=LO(this.rank),s=tP("rc",this.rank),r=new Array(this.rank);for(let c=0;c<t.length;c++)r[t[c]]=s[c];const i="vec2(".concat(r.slice(-2).join(),")"),o="++".concat(s[this.rank-1]," < ").concat(n[this.rank-1]),l="getChannel(getA(".concat(r.join(),"), ").concat(i,")");this.userCode="\n    void main() {\n      ".concat(a," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(l,";\n      if(").concat(o,") {\n        result[1] = ").concat(l,";\n      }\n      --").concat(s[this.rank-1],";\n      if(++").concat(s[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(l,";\n        if(").concat(o,") {\n          result[3] = ").concat(l,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function $P(e,t,n){const a=Vs().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new QP(e.shape,t):new JP(e.shape,t);return n.runWebGLProgram(a,[e],e.dtype)}function ez(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a;return function(e,t,n,a){const s=t,r=e.shape.length,i=ps(s,e.shape);let o=i;const l=Jm(o,r),c=null!=l;let u=e;c&&(u=$P(e,l,a),o=$m(o.length,r)),Ym("sum",o,r);const[d,h]=Zm(u.shape,o);let p=d;n&&(p=Xm(d,i));const m=ns(h),f=qP({inputs:{x:u},attrs:{shape:[ns(e.shape)/m,m]},backend:a}),g=YP(f,gc(e.dtype),"sum",a),x=qP({inputs:{x:g},attrs:{shape:p},backend:a});return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(g),c&&a.disposeIntermediateTensorInfo(u),x}(s,r,i,n)}const tz={kernelName:Ro,backendName:"webgl",kernelFunc:ez};function nz(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{perm:r}=a,i=n,o=s.shape.length,l=new Array(o);for(let u=0;u<l.length;u++)l[u]=s.shape[r[u]];let c;if(i.shouldExecuteOnCPU([s])){const e=i.texData.get(s.dataId).values,t=$F(e,s.shape,s.dtype,r,l);c=i.makeTensorInfo(l,s.dtype);i.texData.get(c.dataId).values=t}else c=$P(s,r,i);return c}const az={kernelName:el,backendName:"webgl",kernelFunc:nz};function sz(e){let{a:t,b:n,transposeA:a,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:c=null}=e;const u=t.shape.length,d=n.shape.length,h=a?t.shape[u-2]:t.shape[u-1],p=s?n.shape[d-1]:n.shape[d-2],m=a?t.shape[u-1]:t.shape[u-2],f=s?n.shape[d-2]:n.shape[d-1],g=t.shape.slice(0,-2),x=n.shape.slice(0,-2),y=ns(g),b=ns(x),v=Jd(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([m,f]);$a(h===p,()=>"Error in matMul: inner shapes (".concat(h,") and (")+"".concat(p,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(a)+" and transposeB=".concat(s," must match."));const w=a?[y,h,m]:[y,m,h],k=s?[b,f,p]:[b,p,f],N=qP({inputs:{x:t},backend:r,attrs:{shape:w}}),_=qP({inputs:{x:n},backend:r,attrs:{shape:k}}),S=[N,_],C=Math.max(y,b),j=a?N.shape[1]:N.shape[2],T=null!=i,I=null!=o,E="leakyrelu"===c,A=null!=c?PP(c,!0):null;let R;if((1===m||1===f)&&j>1e3&&!1===(T||I||E||null!=A)){let e=N,t=_;a&&(e=nz({inputs:{x:N},backend:r,attrs:{perm:[0,2,1]}}),S.push(e)),s&&(t=nz({inputs:{x:_},backend:r,attrs:{perm:[0,2,1]}}),S.push(t));const n=1===f;let i=e;1!==f&&(i=qP({inputs:{x:e},backend:r,attrs:{shape:[C,j,1]}}),S.push(i));const o=1===f?2:1;let l=t;n&&(l=qP({inputs:{x:t},backend:r,attrs:{shape:[C,1,j]}}),S.push(l));const c=HP({inputs:{a:i,b:l},backend:r});R=ez({inputs:{x:c},backend:r,attrs:{axis:o,keepDims:!0}}),S.push(c)}else{const e=fc(t.dtype,n.dtype),c=new zP(w,k,[C,m,f],a,s,T,A,I,E),u=[N,_];if(null!=i&&u.push(i),I&&u.push(o),E){const e=r.makeTensorInfo([],"float32",Bl(l,"float32"));u.push(e),S.push(e)}R=r.runWebGLProgram(c,u,e)}const M=qP({inputs:{x:R},backend:r,attrs:{shape:v}});S.push(R);for(const L of S)r.disposeIntermediateTensorInfo(L);return M}const rz={kernelName:cl,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{a:s,b:r,bias:i,preluActivationWeights:o}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=a;return sz({a:s,b:r,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:o,leakyreluAlpha:d,activation:u})}},iz="return abs(x);";const oz={kernelName:Ks,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a}=t;if(n.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){const e=n.texData.get(a.dataId),t=zF(e.values);return n.makeTensorInfo(a.shape,a.dtype,t)}let s;return s=Vs().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new fP(a.shape,iz):new cP(a.shape,iz),n.runWebGLProgram(s,[a],a.dtype)}},lz=OP({opSnippet:uP+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),cz={kernelName:Zs,backendName:"webgl",kernelFunc:lz},uz=OP({opSnippet:uP+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),dz={kernelName:Xs,backendName:"webgl",kernelFunc:uz},hz="return a + b;",pz=FP({opSnippet:hz,packedOpSnippet:hz,supportsComplex:!0,cpuKernelImpl:iF}),mz={kernelName:Ys,backendName:"webgl",kernelFunc:pz};class fz{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));const n=[];this.variableNames.forEach(e=>{n.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))});const a=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}}class gz{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));const n=[];this.variableNames.forEach(e=>{n.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))});const a=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}}const xz={kernelName:Js,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:a}=t,s=n;if(1===s.length)return SP({inputs:{x:s[0]},backend:a});if(s.length>Vs().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(s.length/2),n=e({inputs:s.slice(0,t),backend:a}),r=e({inputs:s.slice(t),backend:a});return e({inputs:[n,r],backend:a})}const r=s.map(e=>e.dtype).reduce((e,t)=>fc(e,t)),i=s.map(e=>e.shape),o=Vs().getBool("WEBGL_PACK")?new gz(s[0].shape,i):new fz(s[0].shape,i);return a.runWebGLProgram(o,s,r)}};const yz={kernelName:Qs,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a,o=s.shape.length,l=ps(r,s.shape);let c=l;const u=Jm(c,o);let d=s;null!=u&&(d=nz({inputs:{x:s},backend:n,attrs:{perm:u}}),c=$m(c.length,o)),Ym("all",c,o);const[h,p]=Zm(d.shape,c),m=qP({inputs:{x:d},backend:n,attrs:{shape:[-1,ns(p)]}}),f=YP(m,m.dtype,"all",n);let g;if(i){g=qP({inputs:{x:f},backend:n,attrs:{shape:Xm(h,l)}})}else g=qP({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(f),null!=u&&n.disposeIntermediateTensorInfo(d),g}};const bz={kernelName:$s,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a,o=s.shape.length,l=ps(r,s.shape);let c=l;const u=Jm(c,o);let d=s;null!=u&&(d=nz({inputs:{x:s},backend:n,attrs:{perm:u}}),c=$m(c.length,o)),Ym("any",c,o);const[h,p]=Zm(d.shape,c),m=qP({inputs:{x:d},backend:n,attrs:{shape:[-1,ns(p)]}}),f=YP(m,m.dtype,"any",n);let g;if(i){g=qP({inputs:{x:f},backend:n,attrs:{shape:Xm(h,l)}})}else g=qP({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(f),null!=u&&n.disposeIntermediateTensorInfo(d),g}};class vz{constructor(e,t,n){this.variableNames=["A"];const{windowSize:a,batchSize:s,outSize:r}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[s,r];const i="max"===t?">":"<",o=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(o,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(i," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class wz{constructor(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,$a(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));const s=e[e.length-1],r=Math.ceil(s/t);this.outputShape=e.slice(0,-1),r>1&&this.outputShape.push(r),a||this.variableNames.push("bestIndicesA");const i=this.outputShape,o=i.length,l=LO(o),c=nP("coords",o);let u,d;if(1===r){d=o+1;const e=LO(d);u="\n        ".concat(e," sourceLocR = ").concat(e,"(").concat(c.join(),", 0);\n        ++").concat(c[o-1],";\n        ").concat(e," sourceLocG = ").concat(e,"(").concat(c.join(),", 0);\n        ++").concat(c[o-2],";\n        ").concat(e," sourceLocA = ").concat(e,"(").concat(c.join(),", 0);\n        --").concat(c[o-1],";\n        ").concat(e," sourceLocB = ").concat(e,"(").concat(c.join(),", 0);\n        --").concat(c[o-2],";")}else d=o,u="\n        ".concat(l," sourceLocR = coords;\n        ++").concat(c[o-1],";\n        ").concat(l," sourceLocG = coords;\n        ++").concat(c[o-2],";\n        ").concat(l," sourceLocA = coords;\n        --").concat(c[o-1],";\n        ").concat(l," sourceLocB = coords;\n        --").concat(c[o-2],";");const h=["x","y","z","w","u","v"].slice(0,d),p="."+h[d-1],m=h.map(e=>"int "+e),f=nP("sourceLocR",d-1).concat("inIdx.r"),g=nP("sourceLocG",d-1).concat("inIdx.g"),x=nP("sourceLocB",d-1).concat("inIdx.b"),y=nP("sourceLocA",d-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",v=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(f.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),")));"),w="vec4(\n            getAChannel(".concat(f.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(x.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(y.join(),") : 0.)"),k=a?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(h.join(),"),\n                                          vec2(").concat(h.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(h.join(),"),\n                               vec2(").concat(h.slice(-2).join(),"));\n      }\n      ").concat(k,"\n      void main() {\n        ").concat(l," coords = getOutputCoords();\n        bool hasNextCol = ").concat(c[o-1]," < ").concat(i[o-1]-1,";\n        bool hasNextRow = ").concat(c[o-2]," < ").concat(i[o-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(p,", sourceLocG").concat(p,",\n          sourceLocB").concat(p,", sourceLocA").concat(p,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(v,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(b,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function kz(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=t.shape[0],r=t.shape[1];null!=a&&(s=a.shape[0],r=a.shape[1]);const i=Xy(r),o={windowSize:i,inSize:r,batchSize:s,outSize:Math.ceil(r/i)},l=new vz(o,n,null==a),c=[t];null!=a&&c.push(a);const u=e.runWebGLProgram(l,c,"int32");if(1===u.shape[1])return u;const d=kz(e,t,n,u);return e.disposeIntermediateTensorInfo(u),d}function Nz(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const s=null!=a?a.shape:t.shape,r=Xy(s[s.length-1]),i=new wz(s,r,n,null==a),o=null==a?[t]:[t,a],l=e.runWebGLProgram(i,o,"int32");if(l.shape.length===t.shape.length){const a=Nz(e,t,n,l);return e.disposeIntermediateTensorInfo(l),a}return l}function _z(e,t,n,a){const s=[n];if(Ym("arg"+a.charAt(0).toUpperCase()+a.slice(1),s,t.shape.length),!Vs().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],r=e.texData.get(t.dataId);let i=t;null!==r&&r.isPacked&&(i=e.unpackTensor(t),n.push(i));const[o,l]=Zm(i.shape,s),c=ns(l),u=qP({inputs:{x:i},backend:e,attrs:{shape:[-1,c]}});n.push(u);const d=kz(e,u,a);n.push(d);const h=qP({inputs:{x:d},backend:e,attrs:{shape:o}});return n.forEach(t=>e.disposeIntermediateTensorInfo(t)),h}return Nz(e,t,a)}const Sz={kernelName:er,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r}=a;let i=ps(r,s.shape);const o=Jm(i,s.shape.length);let l=s;const c=[];null!=o&&(l=nz({inputs:{x:s},backend:n,attrs:{perm:o}}),c.push(l),i=$m(i.length,l.shape.length)),Ym("argMax",[i[0]],l.shape.length);const u=_z(n,l,i[0],"max");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}};const Cz={kernelName:tr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r}=a;let i=ps(r,s.shape);const o=Jm(i,s.shape.length);let l=s;const c=[];null!=o&&(l=nz({inputs:{x:s},backend:n,attrs:{perm:o}}),c.push(l),i=$m(i.length,l.shape.length)),Ym("argMin",[i[0]],l.shape.length);const u=_z(n,l,i[0],"min");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}},jz=OP({opSnippet:uP+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Tz={kernelName:nr,backendName:"webgl",kernelFunc:jz},Iz=OP({opSnippet:uP+"return log(x + sqrt(x * x + 1.0));"}),Ez={kernelName:ar,backendName:"webgl",kernelFunc:Iz},Az=OP({opSnippet:uP+"\n  return atan(x);\n"}),Rz={kernelName:sr,backendName:"webgl",kernelFunc:Az},Mz=FP({opSnippet:wP+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+NP+"\n  return result;\n"}),Lz={kernelName:ir,backendName:"webgl",kernelFunc:Mz},Dz=OP({opSnippet:uP+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Oz={kernelName:rr,backendName:"webgl",kernelFunc:Dz};class Fz{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const r=e.filterWidth,i=e.strideHeight,o=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m="avg"===t,f="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d");let x="0.0";if(m||(x="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(t," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?s?f:g:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let y="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / max(count, 1.0)");const b=4*Math.floor(r/4),v=r%4,w="\n      if (".concat(m,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===v,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===v,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===v,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(y,");\n      }\n    ")}}class Pz{constructor(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,f=e.padInfo.front,g=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const y="avg"===t;let b="0.0";if(y||(b="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(i,", ").concat(o,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(f,", ").concat(g,", ").concat(x,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(m,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(t," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?s?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(p," * ").concat(m," +\n                      wR * ").concat(m," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let v="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(v="avgValue / max(count, 1.0)");const w=4*Math.floor(r/4),k=r%4,N="\n      if (".concat(y,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(i,", ").concat(o,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(f,", ").concat(g,", ").concat(x,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(N,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(N,"\n            }\n          }\n        }\n        setOutput(").concat(v,");\n      }\n    ")}}const zz={kernelName:or,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t;gO(s,"avgPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=a;$a(Xp(i,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'"));const c=zp(s.shape,r,i,1,o,l);if(1===c.filterWidth&&1===c.filterHeight&&rs(c.inShape,c.outShape))return SP({inputs:{x:s},backend:n});const u=new Fz(c,"avg",!1);return n.runWebGLProgram(u,[s],"float32")}};const Bz={kernelName:cr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=a,u=Bp(s.shape,r,i,[1,1,1],o,l,c),d=new Pz(u,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}};class Wz{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=o-1-e.padInfo.top,u=l-1-e.padInfo.left,d=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n            wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(i,") {\n            float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Vz{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=u-1-e.padInfo.front,m=d-1-e.padInfo.top,f=h-1-e.padInfo.left,g=1/(t*n*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(m,", ").concat(f,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(s,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const Uz={kernelName:ur,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,input:r}=t,i=r,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=a,d=Bp(i.shape,o,l,[1,1,1],c,u),h=new Vz(d);return n.runWebGLProgram(h,[s],i.dtype)}};const Hz={kernelName:lr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,input:r}=t,i=r;gO([s,r],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=a,u=zp(i.shape,o,l,1,c),d=new Wz(u);return n.runWebGLProgram(d,[s],i.dtype)}};const Gz={kernelName:dr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{a:s,b:r}=t,{transposeA:i,transposeB:o}=a;return sz({a:s,b:r,transposeA:i,transposeB:o,backend:n})}};class qz{constructor(e,t,n,a,s,r){this.outputShape=[],this.variableNames=["x","mean","variance"],Jd(e,t),Jd(e,n);let i="0.0";null!=a&&(Jd(e,a),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="1.0";null!=s&&(Jd(e,s),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(i,";\n        float scale = ").concat(o,";\n        float inv = scale * inversesqrt(variance + float(").concat(r,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class Kz{constructor(e,t,n,a,s,r){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Jd(e,t),Jd(e,n);let i="vec4(0.0)";null!=a&&(Jd(e,a),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let o="vec4(1.0)";null!=s&&(Jd(e,s),this.variableNames.push("scale"),o="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(i,";\n        vec4 scale = ").concat(o,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(r,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const Zz={kernelName:si,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e;const{x:s,mean:r,variance:i,offset:o,scale:l}=t;$a(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),$a(null==o||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),$a(null==l||r.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=a;null==c&&(c=.001);const u=[s,r,i];let d=null;null!=o&&(d=o.shape,u.push(o));let h=null;null!=l&&(h=l.shape,u.push(l));const p=Vs().getBool("WEBGL_PACK_NORMALIZATION")?new Kz(s.shape,r.shape,i.shape,d,h,c):new qz(s.shape,r.shape,i.shape,d,h,c);return n.runWebGLProgram(p,u,u[0].dtype)}};class Xz{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=LO(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return Yz.slice(0,e).map(e=>"sourceLoc."+e).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);let a;const s=e.map((e,t)=>"sourceLoc.".concat(Yz[t]," = start[").concat(t,"] + coords.").concat(Yz[t],";"));a="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(s.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(a,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const Yz=["x","y","z","w","u","v"];class Jz{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=LO(this.rank),n=nP("coords",this.rank),a=nP("sourceLoc",this.rank),s=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),r="getChannel(getSource(".concat(a.join(),"), ").concat(s,")"),i="\n      result.x = ".concat(r,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(r,";\n        --").concat(a[this.rank-1],";\n      }\n    "),o=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(r,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(r,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((e,t)=>"start[".concat(t,"]")).join(),");"):e.map((e,t)=>"".concat(a[t]," = ").concat(n[t]," + start[").concat(t,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(i,"\n        ").concat(o,"\n        setOutput(result);\n      }\n    ")}}function Qz(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{begin:r,size:i}=a,[o,l]=op(s,r,i);if(Kh(s,o,l),0===ns(l))return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||"string"===s.dtype){const e=n.texData.get(s.dataId),t=BF(e.values,o,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,t)}const{isPacked:c}=n.texData.get(s.dataId),u=rp(s.shape,o,l);if(c||!u){const e=Vs().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Jz(l):new Xz(l),t=[o];return n.runWebGLProgram(e,[s],s.dtype,t)}return n.uploadToGPU(s.dataId),function(e,t,n,a){const s=a.texData.get(e.dataId),r=a.makeTensorInfo(n,e.dtype),i=a.texData.get(r.dataId);Object.assign(i,s),i.refCount=1,i.shape=n,i.dtype=e.dtype;let o=ip(t,Ts(e.shape));s.slice&&(o+=s.slice.flatOffset),i.slice={flatOffset:o,origDataId:s.slice&&s.slice.origDataId||e.dataId};const l=a.dataRefCount.get(i.slice.origDataId)||1;return a.dataRefCount.set(i.slice.origDataId,l+1),r}(s,o,l,n)}const $z={kernelName:So,backendName:"webgl",kernelFunc:Qz},eB={kernelName:hr,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{blockShape:r,crops:i}=a;$a(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=r.reduce((e,t)=>e*t),l=Jy(s.shape,r,o),c=Qy(l.length,r.length),u=$y(s.shape,r,o),d=eb(i,r.length),h=tb(u,i,r.length),p=[],m=qP({inputs:{x:s},backend:n,attrs:{shape:l}}),f=nz({inputs:{x:m},backend:n,attrs:{perm:c}}),g=qP({inputs:{x:f},backend:n,attrs:{shape:u}}),x=Qz({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return p.push(m),p.push(f),p.push(g),p.forEach(e=>n.disposeIntermediateTensorInfo(e)),x}};const tB={kernelName:pr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,weights:r}=t,{size:i}=a,o=n.readSync(s.dataId),l=n.readSync(r.dataId),c=oF(o,l,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,c)}};const nB={kernelName:mr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{a:a,b:s}=t,r=Vs().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=Vs().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([a,s])||1===i){const e=n.texData.get(a.dataId).values,t=n.texData.get(s.dataId).values,[r,i]=cF(a.shape,s.shape,e,t,a.dtype),o=n.makeTensorInfo(i,a.dtype);return n.texData.get(o.dataId).values=r,o}let o;return o=r?new _P("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",a.shape,s.shape,!1):new kP("\n  return float(int(a.r) & int(b.r));\n",a.shape,s.shape),n.runWebGLProgram(o,[a,s],a.dtype)}};const aB={kernelName:gr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:a,s1:s}=t,r=n.readSync(a.dataId),i=n.readSync(s.dataId),o=Jd(Array.from(r),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}},sB=FP({opSnippet:"return float(a != b);",cpuKernelImpl:EF,dtype:"bool"}),rB={kernelName:Gi,backendName:"webgl",kernelFunc:sB};function iB(e){const{inputs:t,backend:n}=e,{input:a}=t;return SP({inputs:{x:n.texData.get(a.dataId).complexTensorInfos.real},backend:n})}const oB={kernelName:oo,backendName:"webgl",kernelFunc:iB};const lB={kernelName:xr,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:a,attrs:s}=t,{x:r}=n,{dtype:i}=s;if("complex64"===i){if("complex64"===r.dtype)return SP({inputs:{x:r},backend:a});const t=Wf(r.shape),n=e({inputs:{x:r},backend:a,attrs:{dtype:"float32"}}),s=jP({inputs:{real:n,imag:t},backend:a});return t.dispose(),a.disposeIntermediateTensorInfo(n),s}if("complex64"===r.dtype){const t=iB({inputs:{input:r},backend:a}),n=e({inputs:{x:t},backend:a,attrs:{dtype:i}});return a.disposeIntermediateTensorInfo(t),n}if(!bs(r.dtype,i)){const e=SP({inputs:{x:r},backend:a});return{dataId:e.dataId,shape:e.shape,dtype:i}}if(a.shouldExecuteOnCPU([r])){const e=a.texData.get(r.dataId).values,[t,n,s]=uF(e,r.shape,r.dtype,i);return a.makeTensorInfo(t,n,s)}if("int32"===i)return function(e,t){const n=new cP(e.shape,"return float(int(x));"),a=t.runWebGLProgram(n,[e],"int32");return{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}(r,a);if("bool"===i){const e=a.makeTensorInfo([],"bool",fs("bool",1)),t=sB({inputs:{a:r,b:e},backend:a});return a.disposeIntermediateTensorInfo(e),t}throw new Error("Error in Cast: failed to cast ".concat(r.dtype," to ").concat(i))}},cB="return ceil(x);",uB=OP({opSnippet:cB,packedOpSnippet:cB,cpuKernelImpl:dF}),dB={kernelName:yr,backendName:"webgl",kernelFunc:uB};class hB{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class pB{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const mB={kernelName:br,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{clipValueMin:r,clipValueMax:i}=a;let o;o=Vs().getBool("WEBGL_PACK_CLIP")?new pB(s.shape):new hB(s.shape);const l=[[r],[i]];return n.runWebGLProgram(o,[s],s.dtype,l)}};class fB{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function gB(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const xB={kernelName:wr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a}=t,s=n.texData.get(a.dataId),r=new fB(a.shape),i=[gB(a,s.complexTensorInfos.real),gB(a,s.complexTensorInfos.imag)];return n.runWebGLProgram(r,i,i[0].dtype)}};class yB{constructor(e){this.outputShape=[],this.outputShape=Vy(e,1),this.variableNames=e.map((e,t)=>"T".concat(t));const t=new Array(e.length-1);t[0]=e[0][1];for(let r=1;r<t.length;r++)t[r]=t[r-1]+e[r][1];const n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let r=1;r<t.length;r++){const e=t[r-1];n.push("else if (yC < ".concat(t[r],") ")+"setOutput(getT".concat(r,"(yR, yC-").concat(e,"));"))}const a=t.length,s=t[t.length-1];n.push("else setOutput(getT".concat(a,"(yR, yC-").concat(s,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class bB{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Vy(e,t);const n=this.outputShape,a=n.length,s=LO(a),r=nP("coords",a),i=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((e,t)=>"T".concat(t));const o=new Array(e.length-1);o[0]=e[0][t];for(let m=1;m<o.length;m++)o[m]=o[m-1]+e[m][t];const l=i[t],c=i.slice(-2),u=i.join();let d="if (".concat(l," < ").concat(o[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(c.join(),"));\n        }");for(let m=1;m<o.length;m++){const e=o[m-1];d+="\n        if (".concat(l," < ").concat(o[m],"  && ").concat(l," >= ").concat(o[m-1],") {\n          return getChannel(\n            getT").concat(m,"(").concat(vB(i,l,e),"),\n            vec2(").concat(vB(c,l,e),"));\n        }")}const h=o.length,p=o[o.length-1];d+="\n        return getChannel(\n          getT".concat(h,"(").concat(vB(i,l,p),"),\n          vec2(").concat(vB(c,l,p),"));"),this.userCode="\n      float getValue(".concat(i.map(e=>"int "+e),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(s," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(r,"), 0., 0., 0.);\n\n        ").concat(r[a-1]," = ").concat(r[a-1]," + 1;\n        if (").concat(r[a-1]," < ").concat(n[a-1],") {\n          result.g = getValue(").concat(r,");\n        }\n\n        ").concat(r[a-2]," = ").concat(r[a-2]," + 1;\n        if (").concat(r[a-2]," < ").concat(n[a-2],") {\n          result.a = getValue(").concat(r,");\n        }\n\n        ").concat(r[a-1]," = ").concat(r[a-1]," - 1;\n        if (").concat(r[a-2]," < ").concat(n[a-2]," &&\n            ").concat(r[a-1]," < ").concat(n[a-1],") {\n          result.b = getValue(").concat(r,");\n        }\n        setOutput(result);\n      }\n    ")}}function vB(e,t,n){const a=e.indexOf(t);return e.map((e,t)=>t===a?"".concat(e," - ").concat(n):e).join()}function wB(e){const{inputs:t,backend:n}=e,{input:a}=t;return SP({inputs:{x:n.texData.get(a.dataId).complexTensorInfos.imag},backend:n})}const kB={kernelName:di,backendName:"webgl",kernelFunc:wB};function NB(e,t,n){const a=e[0].dtype;if("complex64"===a){const a=e.map(e=>iB({inputs:{input:e},backend:n})),s=e.map(e=>wB({inputs:{input:e},backend:n})),r=NB(a,t,n),i=NB(s,t,n),o=jP({inputs:{real:r,imag:i},backend:n});return a.forEach(e=>n.disposeIntermediateTensorInfo(e)),s.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),o}let s=n.shouldExecuteOnCPU(e);if("string"===a&&(s=!0),s){const s=e.map(e=>{const a=ns(e.shape.slice(t));return qP({inputs:{x:e},backend:n,attrs:{shape:[-1,a]}})}),r=s.map(e=>({vals:n.readSync(e.dataId),shape:e.shape})),i=Vy(s.map(e=>e.shape),1),o=1===s[0].shape[0],l=hF(r,i,a,o),c=Vy(e.map(e=>e.shape),t),u=n.makeTensorInfo(c,a,l);return s.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}const r=e.filter(e=>ns(e.shape)>0),i=Vs().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1;if(1===r.length){const t=i?new cP(e[0].shape,mP):new fP(e[0].shape,mP);return n.runWebGLProgram(t,e,a)}const o=Vs().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(r.length>o){const e=[];for(let s=0;s<r.length;s+=o){const a=r.slice(s,s+o);e.push(NB(a,t,n))}const a=NB(e,t,n);for(const t of e)n.disposeIntermediateTensorInfo(t);return a}if(i){const e=new bB(r.map(e=>e.shape),t);return n.runWebGLProgram(e,r,a)}const{tensors2D:l,outShape:c}=function(e,t,n){const a=Vy(e.map(e=>e.shape),t),s=e.map(e=>qP({inputs:{x:e},attrs:{shape:[-1,ns(e.shape.slice(t))]},backend:n}));return{tensors2D:s,outShape:a}}(r,t,n),u=new yB(l.map(e=>e.shape)),d=n.runWebGLProgram(u,l,a);l.forEach(e=>n.disposeIntermediateTensorInfo(e));const h=qP({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function _B(e){const{inputs:t,backend:n,attrs:a}=e,{axis:s}=a,r=ps(s,t[0].shape)[0];Wy(t.map(e=>e.shape),r);const i=Vy(t.map(e=>e.shape),r);if(0===ns(i))return n.makeTensorInfo(i,t[0].dtype,[]);const o=t.filter(e=>ns(e.shape)>0);return 1===o.length?SP({inputs:{x:o[0]},backend:n}):NB(o,r,n)}const SB={kernelName:kr,backendName:"webgl",kernelFunc:_B};class CB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;const r=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),m=e.inChannels%4,f="channelsLast"===e.dataFormat,g=f?1:2,x=f?2:3,y=f?3:1;let b="",v="";n&&(b=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):s?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),v="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(o,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(r,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(x,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(f,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===m,") {\n\n              if (").concat(f,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===m,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===m,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(v,"\n        setOutput(result);\n      }\n    ")}}class jB{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),m=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(s,", ").concat(r,", ").concat(i,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(o,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===m,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class TB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=WO(this.outputShape.length);const r=e.padInfo.left,i=e.strideWidth,o=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,u=c;let d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let f=0;f<c;f++)d+="\n           vec4 xTexelC".concat(2*f,";\n           int xTexelC").concat(2*f,"Ready;\n           vec4 xTexelC").concat(2*f+1,";\n           int xTexelC").concat(2*f+1,"Ready;\n           vec4 xC").concat(f,";");d+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let f=0;f<c;f++)d+="\n           xTexelC".concat(2*f," = vec4(0.0);\n           xTexelC").concat(2*f,"Ready = 0;\n           xTexelC").concat(2*f+1," = vec4(0.0);\n           xTexelC").concat(2*f+1,"Ready = 0;\n           xC").concat(f," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let f=0;f<(u+1)/2;f++){const t=2*f;if(d+="\n           xC = xCCorner + ".concat(t*o,";\n           "),1===i){if(t<c&&(r%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n               "),d+=1===o&&t>0?"\n                 xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                   } else {\n                     xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xC").concat(t," = xTexelC").concat(t,";\n                 "),t+1<c)){const e=r%2===0?Za(o):o;o%2===0&&r%2===1||o%2!==0&&r%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                     xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(t+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(t+1,"Ready = 1;\n                   }\n                   "),d+=o>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                     } else {\n                      xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                     }\n                     "):"\n                     xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                     ")):d+=1===e?"\n                     xC".concat(t+1," = xTexelC").concat(t,";\n                     "):"\n                     xCOffset = xC + ".concat(e,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                       xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(t+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(t+1,"Ready = 1;\n                     }\n\n                     xC").concat(t+1," = xTexelC").concat(t+1,";\n                     ")}}else t<c&&(r%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n               "),t+1<c&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(\n                   xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n               "),t+1<c&&(d+="\n                   xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                 "))));t<c&&(d+="\n             wTexel = getW(r, ".concat(t,", d1, d2);\n             dotProd += xC").concat(t,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(t,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),t+1<c&&(d+="\n               wTexel = getW(r, ".concat(t+1,", d1, d2);\n               dotProd += xC").concat(t+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(t+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let h="",p="";n&&(h=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):s?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),p="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(h,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(m,"\n         ").concat(p,"\n         setOutput(result);\n       }\n     ")}}class IB{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=WO(this.outputShape.length);const{dataFormat:n}=t,a=yO(),s="channelsLast"===n,r=s?1:2,i=s?2:3,o=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {");let l="";for(let c=0;c<=1;c++)for(let e=0;e<=1;e++)l+="\n          blockIndex = rc.z + ".concat(e,";\n          pos = rc.y + ").concat(c,";\n\n          ").concat(o,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(r,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(i,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(s,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*c+e,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*c+e,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(a.output," = result;\n      }\n    ")}}function EB(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function AB(e){let{x:t,filter:n,convInfo:a,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}=e;const c=t.shape,u=s.texData.get(t.dataId),d=a.inChannels,h=c[0]*c[1]*c[2],p=a.outChannels,m="channelsLast"===a.dataFormat,f=!1;let g;const x=[];if(null!=i){const e=EB(i.shape,m);null!=e&&(i=qP({inputs:{x:i},backend:s,attrs:{shape:e}}),x.push(i))}if(null!=r){const e=EB(r.shape,m);null!=e&&(r=qP({inputs:{x:r},backend:s,attrs:{shape:e}}),x.push(r))}if(!((1===h||1===p)&&d>1e3)&&u.isPacked&&m&&null!=u.texture&&c[2]%2!==0&&rs(u.shape.slice(-3),c.slice(-3))){const e=c[0]*c[1]*(c[2]+1),d={dataId:t.dataId,shape:[1,e,a.inChannels],dtype:t.dtype},h=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,$a(cO(u.shape,d.shape),()=>"packed reshape ".concat(u.shape," to ").concat(d.shape," isn't free"));const p=qP({inputs:{x:n},backend:s,attrs:{shape:[1,a.inChannels,a.outChannels]}});x.push(p);const m=sz({a:d,b:p,backend:s,transposeA:false,transposeB:f,bias:r,activation:l,preluActivationWeights:i,leakyreluAlpha:o}),y=s.texData.get(m.dataId);$a(y.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=h,y.shape=a.outShape,g=SP({inputs:{x:m},backend:s}),g.shape=a.outShape,x.push(m)}else{const e=a.outHeight*a.outWidth,c=qP({inputs:{x:t},backend:s,attrs:{shape:m?[a.batchSize,e,a.inChannels]:[a.batchSize,a.inChannels,e]}}),u=qP({inputs:{x:n},backend:s,attrs:{shape:[1,a.inChannels,a.outChannels]}}),d=sz({a:m?c:u,b:m?u:c,transposeA:!m,transposeB:f,backend:s,bias:r,activation:l,preluActivationWeights:i,leakyreluAlpha:o});g=qP({inputs:{x:d},backend:s,attrs:{shape:a.outShape}}),x.push(c),x.push(u),x.push(d)}for(const y of x)s.disposeIntermediateTensorInfo(y);return g}function RB(e){let{x:t,filter:n,convInfo:a,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}=e;const{filterWidth:c,filterHeight:u,inChannels:d,outWidth:h,outHeight:p,dataFormat:m}=a,f="channelsLast"===m,g=c*u*d,x=p*h,y=[a.batchSize,g,x],b=[];if(null!=i){const e=EB(i.shape,f);null!=e&&(i=qP({inputs:{x:i},backend:s,attrs:{shape:e}}),b.push(i))}if(null!=r){const e=EB(r.shape,f);null!=e&&(r=qP({inputs:{x:r},backend:s,attrs:{shape:e}}),b.push(r))}const v=qP({inputs:{x:n},backend:s,attrs:{shape:[1,g,ns(n.shape)/g]}});b.push(v);const w=new IB(y,a),k=[t.shape,[a.padInfo.top,a.padInfo.left],[a.strideHeight,a.strideWidth],[a.dilationHeight,a.dilationWidth],[a.inChannels],[a.filterWidth*a.inChannels],[a.outWidth]],N=s.runWebGLProgram(w,[t],"float32",k),_=qP({inputs:{x:N},backend:s,attrs:{shape:y}});b.push(N),b.push(_);const S=null!=r,C=null!=i,j="leakyrelu"===l,T=l?PP(l,!0):null,I=new zP(f?_.shape:v.shape,f?v.shape:_.shape,f?[a.batchSize,x,a.outChannels]:[a.batchSize,a.outChannels,x],!0,!1,S,T,C,j),E=f?[_,v]:[v,_];if(r&&E.push(r),C&&E.push(i),j){const e=s.makeTensorInfo([],"float32",Bl(o,"float32"));E.push(e),b.push(e)}const A=s.runWebGLProgram(I,E,"float32"),R=qP({inputs:{x:A},backend:s,attrs:{shape:a.outShape}});b.push(A);for(const M of b)s.disposeIntermediateTensorInfo(M);return R}const MB={kernelName:Nr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r}=t,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=a,d=Jp(l),h=Wp(s.shape,r.shape,i,c,o,u,!1,d);let p;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===d&&Vs().getBool("WEBGL_EXP_CONV")){const e=new TB(h),t=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=n.runWebGLProgram(e,[s,r],"float32",t)}else if(Vs().getBool("WEBGL_CONV_IM2COL"))p=RB({x:s,filter:r,convInfo:h,backend:n});else{const e=new CB(h);p=n.runWebGLProgram(e,[s,r],"float32")}else p=AB({x:s,filter:r,convInfo:h,backend:n});const m=qP({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),m}};class LB{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,s=e.padInfo.left,r="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(s,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(r?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class DB{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,s=e.strideWidth,r="channelsLast"===e.dataFormat,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,l=r?1:2,c=r?2:3,u=r?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(c,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(r,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class OB{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,s=e.padInfo.front,r=e.padInfo.top,i=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(s,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(r,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(i,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class FB{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,a=e.filterWidth,s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(o,", ").concat(l,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(s,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const PB={kernelName:_r,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,dy:r}=t,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=a,d=Jp(l),h=Wp(s.shape,u,i,1,o,c,!1,d),p=new LB(h);return n.runWebGLProgram(p,[s,r],"float32")}};class zB{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=WO(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,a=t-1-e.padInfo.top,s=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}const BB={kernelName:Sr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,filter:r}=t,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=a,d=Jp(c),h=Wp(i,r.shape,o,1,l,u,!1,d);if(Vs().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===d){const e=[[h.strideHeight,h.strideWidth]],t=new zB(h);return n.runWebGLProgram(t,[s,r],"float32",e)}{const e=new DB(h);return n.runWebGLProgram(e,[s,r],"float32")}}};const WB={kernelName:Cr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r}=t,{strides:i,pad:o,dilations:l}=a,c=Vp(s.shape,r.shape,i,l,o),u=new jB(c);return n.runWebGLProgram(u,[s,r],"float32")}};const VB={kernelName:jr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,dy:r}=t,{strides:i,pad:o,filterShape:l}=a,c=Vp(s.shape,l,i,1,o),u=new OB(c);return n.runWebGLProgram(u,[s,r],"float32")}};const UB={kernelName:Tr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,filter:r}=t,{pad:i,strides:o,inputShape:l}=a,c=Vp(l,r.shape,o,1,i),u=new FB(c);return n.runWebGLProgram(u,[s,r],"float32")}},HB=OP({opSnippet:DP+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(NP,"\n  return result;\n")}),GB={kernelName:Ir,backendName:"webgl",kernelFunc:HB},qB=OP({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),KB={kernelName:Er,backendName:"webgl",kernelFunc:qB};class ZB{constructor(e,t,n,a,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[r,i,o,l]=e,[c]=t,[u,d]=n;this.outputShape=[c,u,d,l];const h="bilinear"===a?1:0,[p,m]=["".concat(i-1,".0"),"".concat(o-1,".0")],[f,g,x]=u>1?["".concat((i-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(p," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(p)],[y,b,v]=d>1?["".concat((o-1)/(d-1)),"(x2-x1) * width_ratio","x1*".concat(m," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(m)];this.userCode="\n      const float height_ratio = float(".concat(f,");\n      const float width_ratio = float(").concat(y,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(r,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(b,";\n\n        float in_y = ").concat(x,";\n        if( in_y < 0.0 || in_y > ").concat(p," ) {\n          setOutput(float(").concat(s,"));\n          return;\n        }\n        float in_x = ").concat(v,";\n        if( in_x < 0.0 || in_x > ").concat(m," ) {\n          setOutput(float(").concat(s,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(h," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const XB={kernelName:Mr,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:a}=e,{image:s,boxes:r,boxInd:i}=t,{cropSize:o,method:l,extrapolationValue:c}=a,u=new ZB(s.shape,r.shape,o,l,c);return n.runWebGLProgram(u,[s,r,i],"float32")}};var YB;!function(e){e.Prod="*",e.Sum="+"}(YB||(YB={}));class JB{constructor(e,t,n,a){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,r=this.op===YB.Prod?"1.0":"0.0",i=n?r:"getX(".concat(QB(s,"coords",this.op),")"),o=this.outputShape[this.outputShape.length-1];let l="",c="";n?(l=a?"end != ".concat(o-1):"end != 0",c=a?"end + 1":"end - 1"):(l=a?"end + pow2 < ".concat(o):"end >= pow2",c=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(LO(s)," coords = getOutputCoords();\n        int end = ").concat($B(s,"coords",this.op),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(l,") {\n          int idx = ").concat(c,";\n          ").concat($B(s,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(QB(s,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function QB(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function $B(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function eW(e,t,n,a,s,r){const i=t.shape.length,o=Jm([a],i);let l=t;null!=o&&(l=nz({inputs:{x:t},backend:n,attrs:{perm:o}}));const c=$m(1,i)[0];if(c!==i-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(a));const u=l.shape[c];let d=SP({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const t=new JB(e,l.shape,!1,r),a=[[h]],s=d;d=n.runWebGLProgram(t,[d],d.dtype,a),n.disposeIntermediateTensorInfo(s)}if(s){const t=new JB(e,l.shape,s,r),a=d;d=n.runWebGLProgram(t,[d],d.dtype),n.disposeIntermediateTensorInfo(a)}if(null!=o){const e=nz({inputs:{x:d},backend:n,attrs:{perm:Qm(o)}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),e}return d}const tW={kernelName:Ar,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,exclusive:i,reverse:o}=a;return eW(YB.Prod,s,n,r,i,o)}};const nW={kernelName:Rr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,exclusive:i,reverse:o}=a;return eW(YB.Sum,s,n,r,i,o)}};const aW={kernelName:Lr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,weights:r}=t,{size:i,binaryOutput:o}=a;if(1===s.shape.length){const e=n.readSync(s.dataId),t=n.readSync(r.dataId),a=oF(e,t,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,a)}if(2===s.shape.length){const e=n.bufferSync(s),t=n.bufferSync(r),a=lF(e,t,i,o);return n.makeTensorInfo(a.shape,r.dtype,a.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(s.shape.length,"."))}};class sW{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const rW={kernelName:Dr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{blockSize:r,dataFormat:i}=a,o=s.shape[0],l=("NHWC"===i?s.shape[1]:s.shape[2])*r,c=("NHWC"===i?s.shape[2]:s.shape[3])*r,u=("NHWC"===i?s.shape[3]:s.shape[1])/(r*r),d=new sW("NHWC"===i?[o,l,c,u]:[o,u,l,c],r,i);return n.runWebGLProgram(d,[s],s.dtype)}};class iW{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=WO(this.outputShape.length);const r=e.filterHeight,i=e.filterWidth,o=e.outChannels/e.inChannels;let l="",c="";n&&(l=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):s?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),c="result = activation(result);");const u=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(l,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(r,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(u,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}}class oW{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=WO(this.outputShape.length);const r=e.outChannels/e.inChannels,i=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<u;g++)h+="\n          vec4 xTexelC".concat(2*g,";\n          int xTexelC").concat(2*g,"Ready;\n          vec4 xTexelC").concat(2*g+1,";\n          int xTexelC").concat(2*g+1,"Ready;\n          vec4 xC").concat(g,";");h+="\n    for (int r = 0; r < ".concat(c,"; r++) {\n      ");for(let g=0;g<u;g++)h+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(d+1)/2;g++){const e=2*g;if(h+="\n          xC = xCCorner + ".concat(e*l,";\n          "),1===o){if(e<u&&(i%2===1?(h+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n              "),h+=1===l&&e>0?"\n                xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                  } else {\n                    xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                  }\n                  ")):h+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xC").concat(e," = xTexelC").concat(e,";\n                "),e+1<u)){const t=i%2===0?Za(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                    xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(e+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(e+1,"Ready = 1;\n                  }\n                  "),h+=l>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                    } else {\n                     xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                    }\n                    "):"\n                    xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                    ")):h+=1===t?"\n                    xC".concat(e+1," = xTexelC").concat(e,";\n                    "):"\n                    xCOffset = xC + ".concat(t,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                      xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(e+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(e+1,"Ready = 1;\n                    }\n\n                    xC").concat(e+1," = xTexelC").concat(e+1,";\n                    ")}}else e<u&&(i%2===1?(h+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n              "),e+1<u&&(h+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                "))):(h+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(\n                  xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n              "),e+1<u&&(h+="\n                  xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                "))));e<u&&(h+="\n            wTexel = getW(r, ".concat(e,", d1, q);\n            dotProd += xC").concat(e," * vec4(wTexel.xz, wTexel.xz);\n          "),e+1<u&&(h+="\n              wTexel = getW(r, ".concat(e+1,", d1, q);\n              dotProd += xC").concat(e+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}h+="\n    }\n  ",h+="\n      }\n    ";let p="",m="";n&&(p=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):s?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),m="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(p,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(r,";\n        int q = d2 - d1 * ").concat(r,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(h,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(f,"\n        ").concat(m,"\n        setOutput(result);\n      }\n    ")}}const lW={kernelName:Or,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r}=t,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=a;let u=l;null==u&&(u=[1,1]),$a(Xp(i,u),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(u,"'"));const d=Wp(s.shape,r.shape,i,u,o,c,!0);let h;h=Vs().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new oW(d):new iW(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[s,r],"float32",p)}};class cW{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,a=e.padInfo.top,s=e.padInfo.left,r=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(r," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(s,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class uW{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,a=e.strideHeight,s=e.strideWidth,r=t-1-e.padInfo.top,i=n-1-e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(o,"; dm++) {\n              int d2 = d1 * ").concat(o," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const dW={kernelName:Fr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,dy:r}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=a,d=Wp(s.shape,u,i,o,l,c,!0),h=new cW(d);return n.runWebGLProgram(h,[s,r],"float32")}};const hW={kernelName:Pr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,filter:r}=t,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=a,d=Wp(u,r.shape,i,o,l,c,!0),h=new uW(d);return n.runWebGLProgram(h,[s,r],"float32")}};class pW{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const mW={kernelName:zr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a}=t,s=[...a.shape,...a.shape],r=ns(a.shape),i=qP({inputs:{x:a},backend:n,attrs:{shape:[r]}}),o=new pW(r),l=n.runWebGLProgram(o,[i],i.dtype),c=qP({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}};class fW{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:a,strideHeight:s,strideWidth:r,filterHeight:i,filterWidth:o,dilationHeight:l,dilationWidth:c}=e,{top:u,left:d}=a;this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(r,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(i,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(o,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const gW={kernelName:Br,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r}=t,{strides:i,pad:o,dilations:l}=a,c=Pp(s.shape,r.shape,i,o,"NHWC",l);let u;const d=new fW(c);u=n.runWebGLProgram(d,[s,r],"float32");const h=qP({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}};const xW={kernelName:Gr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{equation:s}=a,r=t,{allDims:i,summedDims:o,idDims:l}=kb(s,r.length);_b(i.length,l,r);const{path:c,steps:u}=Sb(o,l),d=u.length;let h=null,p=i.length;const m=[];for(let f=0;f<d;++f){for(const e of u[f]){const{permutationIndices:t,expandDims:a}=Nb(p,l[e]);let s;Cb(t)?s=r[e]:(s=nz({inputs:{x:r[e]},backend:n,attrs:{perm:t}}),m.push(s));const i=s.shape.slice();for(let e=0;e<a.length;++e)i.splice(a[e],0,1);rs(s.shape,i)||(s=qP({inputs:{x:s},backend:n,attrs:{shape:i}}),m.push(s)),null===h?h=s:(h=HP({inputs:{a:s,b:h},backend:n}),m.push(h))}f<d-1&&(c[f]>=0&&(h=ez({inputs:{x:h},backend:n,attrs:{axis:c[f]-(i.length-p),keepDims:!1}}),m.push(h)),p--)}for(const f of m)f!==h&&n.disposeIntermediateTensorInfo(f);return h}},yW=OP({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),bW={kernelName:qr,backendName:"webgl",kernelFunc:yW},vW={kernelName:Kr,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:a,y:s}=t,r=Vs().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _P("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",a.shape,s.shape):new kP("return (b >= 0.0) ? a : a * (b + 1.0);",a.shape,s.shape);return n.runWebGLProgram(r,[a,s],a.dtype)}},wW=FP({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:pF}),kW={kernelName:Xr,backendName:"webgl",kernelFunc:wW},NW=OP({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(sb,";\n  float a1 = ").concat(rb,";\n  float a2 = ").concat(ib,";\n  float a3 = ").concat(ob,";\n  float a4 = ").concat(lb,";\n  float a5 = ").concat(cb,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),_W={kernelName:Zr,backendName:"webgl",kernelFunc:NW},SW=OP({opSnippet:DP+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:mF,dtype:"float32"}),CW={kernelName:Yr,backendName:"webgl",kernelFunc:SW};function jW(e){const{inputs:t,attrs:n,backend:a}=e,{dim:s}=n,{input:r}=t,i=r.shape.length,o=r.shape.slice();let l=s;return s<0&&($a(-(i+1)<=s,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),l=i+s+1),o.splice(l,0,1),qP({inputs:{x:r},backend:a,attrs:{shape:o}})}const TW={kernelName:Jr,backendName:"webgl",kernelFunc:jW},IW="return exp(x) - 1.0;",EW=OP({opSnippet:IW,packedOpSnippet:IW,cpuKernelImpl:fF}),AW={kernelName:Qr,backendName:"webgl",kernelFunc:EW};class RW{constructor(e,t,n){this.variableNames=["real","imag"];const a=t[1];this.outputShape=t;const s=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),r=n?"".concat(a,".0"):"1.0";let i;if("real"===e)i="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(s,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(r,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function MW(e,t,n){const a=n.texData.get(e.dataId),s=ns(e.shape),r=e.shape[e.shape.length-1],i=qP({inputs:{x:e},backend:n,attrs:{shape:[s/r,r]}}),o=i.shape,l=new RW("real",o,t),c=new RW("imag",o,t),u=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:o},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:o}],d=n.runWebGLProgram(l,u,"float32"),h=n.runWebGLProgram(c,u,"float32"),p=jP({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);const m=qP({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(p),m}const LW={kernelName:$r,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:a}=t;return MW(a,!1,n)}};class DW{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function OW(e){const{backend:t,attrs:n}=e,{shape:a,value:s}=n;let{dtype:r}=n;if(r=r||Ss(s),"string"===r){const e=gs(r,ns(a));return e.fill(s),t.makeTensorInfo(a,r,e)}{const e=new DW(a,s),n=[[s]];return t.runWebGLProgram(e,[],r,n)}}const FW={kernelName:ei,backendName:"webgl",kernelFunc:OW};class PW{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const zW={kernelName:ti,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{image:a}=t,s=n,r=new PW(a.shape);return s.runWebGLProgram(r,[a],a.dtype)}},BW="return floor(x);",WW=OP({opSnippet:BW,packedOpSnippet:BW,cpuKernelImpl:gF}),VW={kernelName:ni,backendName:"webgl",kernelFunc:WW},UW=FP({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),HW={kernelName:ai,backendName:"webgl",kernelFunc:UW};class GW{constructor(e){this.variableNames=["A"];const t=yO(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(a,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class qW{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=yO(),[n,a]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(a,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}const KW={kernelName:ol,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e;let{pixels:s}=t;const{numChannels:r}=a,i="undefined"!==typeof HTMLVideoElement&&s instanceof HTMLVideoElement,o="undefined"!==typeof HTMLImageElement&&s instanceof HTMLImageElement,[l,c]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],u=[c,l],d=[c,l,r];if(o||i){const e=Vs().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=ZW&&e===XW||(XW=e,ZW=document.createElement("canvas").getContext("2d",{willReadFrequently:XW})),ZW.canvas.width=l,ZW.canvas.height=c,ZW.drawImage(s,0,0,l,c),s=ZW.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=BD.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),s);const p=Vs().getBool("WEBGL_PACK")?new qW(d):new GW(d),m=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),m}};let ZW,XW=Vs().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const YW={kernelName:ul,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:m}=a,f=Jp(u),g=Wp(s.shape,r.shape,l,d,c,h,!1,f);let x;const y=[],b=null!=i,v=null!=o,w="leakyrelu"===p,k=()=>{const e=[s,r],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=qP({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return y.push(t),t}return e};if(b&&e.push(t(i,u)),v&&e.push(t(o,u)),w){const t=n.makeTensorInfo([],"float32",Bl(m,"float32"));e.push(t),y.push(t)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===f&&Vs().getBool("WEBGL_EXP_CONV")){const e=p?PP(p,!0):null,t=new TB(g,b,e,v,w),a=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],s=k();x=n.runWebGLProgram(t,s,"float32",a)}else if(Vs().getBool("WEBGL_CONV_IM2COL"))x=RB({x:s,filter:r,convInfo:g,backend:n,bias:i,activation:p,preluActivationWeights:o,leakyreluAlpha:m});else{const e=p?PP(p,!1):null,t=new CB(g,b,e,v,w),a=k();x=n.runWebGLProgram(t,a,"float32")}else x=AB({x:s,filter:r,convInfo:g,backend:n,bias:i,activation:p,preluActivationWeights:o,leakyreluAlpha:m});const N=qP({inputs:{x:x},backend:n,attrs:{shape:g.outShape}});return y.push(x),y.forEach(e=>n.disposeIntermediateTensorInfo(e)),N}};const JW={kernelName:dl,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,filter:r,bias:i,preluActivationWeights:o}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=a,m=[];let f=u;null==f&&(f=[1,1]),$a(Xp(l,f),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(l," and dilations '").concat(f,"'"));const g=Wp(s.shape,r.shape,l,f,c,d,!0),x=Vs().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,y=h?PP(h,x):null,b=[s,r],v=null!=i,w=null!=o,k="leakyrelu"===h;if(v&&b.push(i),w&&b.push(o),k){const e=n.makeTensorInfo([],"float32",Bl(p,"float32"));b.push(e),m.push(e)}let N;N=x?new oW(g,v,y,w,k):new iW(g,v,y,w,k);const _=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],S=n.runWebGLProgram(N,b,"float32",_);return m.forEach(e=>n.disposeIntermediateTensorInfo(e)),S}};class QW{constructor(e,t,n,a){this.sliceDim=e,this.strides=t,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=n;const s=LO(n.length);let r="\n    int index;";for(let i=0;i<this.sliceDim;i++)r+="\n          index = round(getIndices(coords[0], ".concat(i,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[i],";\n          flattenIndex += index * ").concat(this.strides[i],";");this.userCode="\n         void main() {\n          ".concat(s," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(r,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}const $W={kernelName:ii,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:a,indices:s}=t,r=s.shape,i=r[r.length-1],o=ns(a.shape),[l,c,u,d]=Wh(a,s),h=qP({inputs:{x:s},backend:n,attrs:{shape:[c,i]}}),p=qP({inputs:{x:a},backend:n,attrs:{shape:[ns(a.shape)/u,u]}});if(n.shouldExecuteOnCPU([a,s])||"string"===a.dtype){const e=n.readSync(s.dataId),t=n.bufferSync(a),r=xF(e,t,a.dtype,c,i,u,d,a.shape,o);return n.makeTensorInfo(l,a.dtype,r.values)}const m=new QW(i,d,[c,u],a.shape),f=n.runWebGLProgram(m,[p,h],p.dtype),g=qP({inputs:{x:f},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),g}};class eV{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=LO(this.rank),a=function(e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let a=0;a<e.length;a++)2===a?n.push("index"):n.push("".concat(t[a]));return n.join()}(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}}function tV(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,indices:r}=t,{axis:i,batchDims:o}=a,l=ps(i,s.shape)[0];if(Vs().get("DEBUG")){const e=n.readSync(r.dataId),t=s.shape[l];for(let n=0;n<e.length;++n){const a=e[n];$a(a<=t-1&&a>=0,()=>"GatherV2: the index value ".concat(a," is not in [0, ").concat(t-1,"]"))}}const c=Ub(s,r,l,o),u=ns(r.shape),d=[],h=qP({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),p=qP({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(p);const m=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([s,r])||"string"===s.dtype){const e=n.bufferSync(p),t=n.bufferSync(h),a=yF(t,e,m);return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(c.outputShape,a.dtype,a.values)}const f=new eV(h.shape,m),g=n.runWebGLProgram(f,[h,p],h.dtype);d.push(g);const x=qP({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),x}const nV={kernelName:ri,backendName:"webgl",kernelFunc:tV},aV=FP({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:bF,dtype:"bool"}),sV={kernelName:oi,backendName:"webgl",kernelFunc:aV},rV=FP({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:vF}),iV={kernelName:li,backendName:"webgl",kernelFunc:rV};const oV={kernelName:ui,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:a}=t;return MW(a,!0,n)}},lV=OP({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),cV={kernelName:hi,backendName:"webgl",kernelFunc:lV},uV=OP({opSnippet:"return float(isinf(x));",dtype:"bool"}),dV={kernelName:pi,backendName:"webgl",kernelFunc:uV},hV=OP({opSnippet:"return float(isnan(x));",dtype:"bool"}),pV={kernelName:mi,backendName:"webgl",kernelFunc:hV},mV=FP({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:wF,dtype:"bool"}),fV={kernelName:gi,backendName:"webgl",kernelFunc:mV},gV=FP({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:kF,dtype:"bool"}),xV={kernelName:xi,backendName:"webgl",kernelFunc:gV};const yV={kernelName:yi,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:a,stop:s,num:r}=n,i=NF(a,s,r);return t.makeTensorInfo([i.length],"float32",i)}},bV=OP({opSnippet:DP+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:_F}),vV={kernelName:bi,backendName:"webgl",kernelFunc:bV},wV=OP({opSnippet:DP+"\n  return log(1.0 + x);\n"}),kV={kernelName:vi,backendName:"webgl",kernelFunc:wV},NV=FP({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),_V={kernelName:wi,backendName:"webgl",kernelFunc:NV},SV=OP({opSnippet:"return float(!(x >= 1.0));"}),CV={kernelName:ki,backendName:"webgl",kernelFunc:SV},jV=FP({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),TV={kernelName:Ni,backendName:"webgl",kernelFunc:jV};class IV{constructor(e,t,n,a,s){this.variableNames=["x"],this.outputShape=[];const r=t,i=e[3]-1;let o;this.outputShape=e;const l="float(".concat(n,") + float(").concat(a,") * sum");o=.5===s?"inversesqrt(".concat(l,")"):1===s?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(s,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(r,"; j <= ").concat(r,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(i,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")}}class EV{constructor(e,t,n,a,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const r=t,i=e[3]-1;let o;this.outputShape=e;const l="float(".concat(n,") + float(").concat(a,") * sum");o=.5===s?"inversesqrt(".concat(l,")"):1===s?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(s,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(r,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(r,"; j <= ").concat(r,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(i,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")}}const AV={kernelName:ji,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{depthRadius:r,bias:i,alpha:o,beta:l}=a,c=Vs().getBool("WEBGL_PACK_NORMALIZATION")?new EV(s.shape,r,i,o,l):new IV(s.shape,r,i,o,l);return n.runWebGLProgram(c,[s],s.dtype)}};class RV{constructor(e,t,n,a,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=s,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(s,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(s,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const MV={kernelName:Ti,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:a}=e,{x:s,y:r,dy:i}=t,{depthRadius:o,bias:l,alpha:c,beta:u}=a,d=new RV(s.shape,o,l,c,u);return n.runWebGLProgram(d,[s,r,i],s.dtype)}};function LV(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{reductionIndices:r,keepDims:i}=a,o=s.shape.length,l=ps(r,s.shape);let c=l;const u=Jm(c,o),d=null!=u,h=n.shouldExecuteOnCPU([s]);let p=s;if(d){if(h){const e=n.texData.get(p.dataId).values,t=new Array(o);for(let n=0;n<t.length;n++)t[n]=s.shape[u[n]];const a=$F(e,s.shape,s.dtype,u,t);p=n.makeTensorInfo(t,s.dtype);n.texData.get(p.dataId).values=a}else p=$P(s,u,n);c=$m(c.length,o)}Ym("max",c,o);const[m,f]=Zm(p.shape,c);let g,x=m;if(i&&(x=Xm(m,l)),h){const e=n.texData.get(p.dataId).values,t=SF(e,ns(f),x,s.dtype);g=n.makeTensorInfo(x,s.dtype);n.texData.get(g.dataId).values=t}else g=function(e,t,n,a){const s=ns(t),r=qP({inputs:{x:e},attrs:{shape:[ns(e.shape)/s,s]},backend:a}),i=YP(r,e.dtype,"max",a),o=qP({inputs:{x:i},attrs:{shape:n},backend:a});return a.disposeIntermediateTensorInfo(r),a.disposeIntermediateTensorInfo(i),o}(p,f,x,n);return d&&n.disposeIntermediateTensorInfo(p),g}const DV={kernelName:Ei,backendName:"webgl",kernelFunc:LV},OV=FP({opSnippet:wP+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+NP+"\n  return result;\n",cpuKernelImpl:CF}),FV={kernelName:Ai,backendName:"webgl",kernelFunc:OV};const PV={kernelName:Ri,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t;gO(s,"maxPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=a;$a(Xp(i,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'"));const c=zp(s.shape,r,i,1,o,l);if(1===c.filterWidth&&1===c.filterHeight&&rs(c.inShape,c.outShape))return SP({inputs:{x:s},backend:n});const u=new Fz(c,"max",!1);return n.runWebGLProgram(u,[s],s.dtype)}};const zV={kernelName:Li,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{filterSize:r,strides:i,pad:o,dataFormat:l,dimRoundingMode:c}=a,u=Bp(s.shape,r,i,[1,1,1],o,c,l),d=new Pz(u,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}};class BV{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,a=e.dilationHeight,s=e.effectiveFilterHeight,r=e.effectiveFilterWidth,i=s-1-e.padInfo.top,o=r-1-e.padInfo.left,l=s*r-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(r," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class WV{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,r=e.dilationHeight,i=e.dilationWidth,o=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=o-1-e.padInfo.front,d=l-1-e.padInfo.top,h=c-1-e.padInfo.left,p=o*l*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(d,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(o,";\n           wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(r,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(i,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const VV={kernelName:Di,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,input:r}=t,i=r,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=a,d=Bp(i.shape,o,l,[1,1,1],c,u),h=new Pz(d,"max",!0),p=n.runWebGLProgram(h,[i],i.dtype),m=new WV(d),f=n.runWebGLProgram(m,[s,p],i.dtype);return n.disposeIntermediateTensorInfo(p),f}};const UV={kernelName:Mi,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{dy:s,input:r,output:i}=t,o=r;gO([r,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=a,h=zp(o.shape,l,c,1,u,d),p=new Fz(h,"max",!0),m=n.runWebGLProgram(p,[o],o.dtype),f=new BV(h),g=n.runWebGLProgram(f,[s,m],o.dtype);return n.disposeIntermediateTensorInfo(m),g}};const HV={kernelName:Oi,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e;const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:l}=n,c=a;$a(4===s.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(s.shape.length,"."));const u=[1,1];$a(Xp(i,u),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(u,"'"));const d=zp(s.shape,r,i,u,o),[h,p]=function(e,t,n,a){let s=new Fz(n,"max",!1);const r=a.runWebGLProgram(s,[e],"float32");return s=new Fz(n,"max",!0,!0,t),[r,a.runWebGLProgram(s,[e],"float32")]}(s,l,d,c);return[h,p]}};const GV={kernelName:Fi,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e;const{x:s}=t,{keepDims:r,axis:i}=n,o=a,l=s.shape.length,c=ps(i,s.shape);let u=c;const d=Jm(u,l),h=null!=d,p=o.shouldExecuteOnCPU([s]),m=[];let f=s;if(h){if(p){const e=o.texData.get(f.dataId).values,t=new Array(l);for(let a=0;a<t.length;a++)t[a]=s.shape[d[a]];const n=$F(e,s.shape,s.dtype,d,t);f=o.makeTensorInfo(t,s.dtype);o.texData.get(f.dataId).values=n}else f=$P(s,d,o);m.push(f),u=$m(u.length,l)}Ym("sum",u,l);const[g,x]=Zm(f.shape,u);let y=g;r&&(y=Xm(g,c));const b=function(e,t,n,a){const s=ns(t),r=qP({inputs:{x:e},attrs:{shape:[ns(e.shape)/s,s]},backend:a}),i=YP(r,"float32","mean",a),o=qP({inputs:{x:i},attrs:{shape:n},backend:a});return a.disposeIntermediateTensorInfo(r),a.disposeIntermediateTensorInfo(i),o}(f,x,y,o);for(const v of m)o.disposeIntermediateTensorInfo(v);return b}};const qV={kernelName:Pi,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a,o=s.shape.length,l=ps(r,s.shape);let c=l;const u=Jm(c,o);let d=s;null!=u&&(d=nz({inputs:{x:s},backend:n,attrs:{perm:u}}),c=$m(c.length,s.shape.length)),Ym("min",c,o);const[h,p]=Zm(d.shape,c),m=qP({inputs:{x:d},backend:n,attrs:{shape:[-1,ns(p)]}}),f=YP(m,m.dtype,"min",n);let g;if(i){g=qP({inputs:{x:f},backend:n,attrs:{shape:Xm(h,l)}})}else g=qP({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(f),null!=u&&n.disposeIntermediateTensorInfo(d),g}},KV=FP({opSnippet:wP+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+NP+"\n  return result;\n",cpuKernelImpl:jF}),ZV={kernelName:zi,backendName:"webgl",kernelFunc:KV};class XV{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const a=e.length,s=LO(a),r=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),l="reflect"===n?0:1;this.userCode=1!==a?"\n      ".concat(s," start = ").concat(s,"(").concat(r,");\n      ").concat(s," end = ").concat(s,"(").concat(i,");\n\n      void main() {\n        ").concat(s," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(s," coords = outC - start;\n        setOutput(getX(").concat(o,"));\n      }\n    "):"\n        int start = ".concat(r,";\n        int end = ").concat(i,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class YV{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const a=e.length,s=LO(a),r=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),o=nP("rc",a),l=nP("source",a),c="".concat(o[a-1]," < ").concat(this.outputShape[a-1]),u=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),d="reflect"===n?0:1;let h="";if(1===a){const e="\n        ".concat(s," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");h="\n        ".concat(s," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(o[a-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ")}else{const e="\n        ".concat(s," source = rc;\n        ").concat(s," lt = ").concat(s,"(lessThan(source, start));\n        ").concat(s," gte = ").concat(s,"(greaterThanEqual(source, end));\n        ").concat(s," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");h="\n        ".concat(s," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(o[a-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(o[a-2]," += 1;\n        if(").concat(o[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(e,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          ").concat(o[a-1]," += 1;\n          if(").concat(c,") {\n            ").concat(e,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(s," start = ").concat(s,"(").concat(r,");\n      const ").concat(s," end = ").concat(s,"(").concat(i,");\n\n      void main() {\n        ").concat(s," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")}}const JV={kernelName:Bi,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:a}=e;const{x:s}=t,{paddings:r,mode:i}=a,o=Vs().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new YV(s.shape,r,i):new XV(s.shape,r,i);return n.runWebGLProgram(o,[s],s.dtype)}},QV=FP({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+NP+"\n  return result;\n"}),$V={kernelName:Wi,backendName:"webgl",kernelFunc:QV};class eU{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}}const tU=FP({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),nU={kernelName:Hr,backendName:"webgl",kernelFunc:tU},aU="return a - b;",sU=FP({opSnippet:aU,packedOpSnippet:aU,supportsComplex:!0,cpuKernelImpl:YF}),rU={kernelName:Zo,backendName:"webgl",kernelFunc:sU};function iU(e){const{inputs:t,backend:n,attrs:a}=e,{logits:s}=t,{dim:r}=a,i=ps([r],s.shape),o=LV({inputs:{x:s},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=Xm(o.shape,i),c=qP({inputs:{x:o},backend:n,attrs:{shape:l}}),u=sU({inputs:{a:s,b:c},backend:n}),d=SW({inputs:{x:u},backend:n}),h=ez({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),p=qP({inputs:{x:h},backend:n,attrs:{shape:l}}),m=tU({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),m}const oU={kernelName:Do,backendName:"webgl",kernelFunc:iU};const lU={kernelName:Vi,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{logits:s}=t,{numSamples:r,seed:i,normalized:o}=a,l=o?s:iU({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new eU(c,u,r),h=[[i]],p=n.runWebGLProgram(d,[l],"int32",h);return o||n.disposeIntermediateTensorInfo(l),p}},cU=uP+"\n  return -x;\n";const uU={kernelName:Hi,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:a}=t;if(n.shouldExecuteOnCPU([a])){const e=n.texData.get(a.dataId),[t,s]=IF(e.values,a.shape,a.dtype);return n.makeTensorInfo(s,a.dtype,t)}let s;return s=Vs().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new fP(a.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new cP(a.shape,cU),n.runWebGLProgram(s,[a],a.dtype)}},dU=Kx;const hU={kernelName:qi,backendName:"webgl",kernelFunc:function(e){hl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:a}=e,{boxes:s,scores:r}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=a,c=n.readSync(s.dataId),u=n.readSync(r.dataId),{selectedIndices:d}=dU(c,u,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},pU=Zx;const mU={kernelName:Ki,backendName:"webgl",kernelFunc:function(e){hl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:a}=e,{boxes:s,scores:r}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=a,u=n.readSync(s.dataId),d=n.readSync(r.dataId),{selectedIndices:h,validOutputs:p}=pU(u,d,i,o,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},fU=Xx;const gU={kernelName:Zi,backendName:"webgl",kernelFunc:function(e){hl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:a}=e,{boxes:s,scores:r}=t,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=a,u=n.readSync(s.dataId),d=n.readSync(r.dataId),h=i,p=o,m=l,f=c,{selectedIndices:g,selectedScores:x}=fU(u,d,h,p,m,f);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}};class xU{constructor(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const yU={kernelName:Yi,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:a}=e,{indices:s}=t,{dtype:r,depth:i,onValue:o,offValue:l}=a,c=ns(s.shape),u=new xU(c,i,o,l),d=qP({inputs:{x:s},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],r);n.disposeIntermediateTensorInfo(d);const p=qP({inputs:{x:h},backend:n,attrs:{shape:[...s.shape,i]}});return n.disposeIntermediateTensorInfo(h),p}};function bU(e){const{inputs:t,backend:n}=e,{x:a}=t;if("complex64"===a.dtype){const e=iB({inputs:{input:a},backend:n}),t=bU({inputs:{x:e},backend:n}),s=wB({inputs:{input:a},backend:n}),r=bU({inputs:{x:s},backend:n}),i=jP({inputs:{real:t,imag:r},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(r),i}return OW({attrs:{shape:a.shape,dtype:a.dtype,value:"string"===a.dtype?"":0},backend:n})}const vU={kernelName:rl,backendName:"webgl",kernelFunc:bU};const wU={kernelName:Xi,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:a}=t,{x:s}=n;if("string"===s.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===s.dtype){const t=iB({inputs:{input:s},backend:a}),n=e({inputs:{x:t},backend:a}),r=wB({inputs:{input:s},backend:a}),i=bU({inputs:{x:r},backend:a}),o=jP({inputs:{real:n,imag:i},backend:a});return a.disposeIntermediateTensorInfo(t),a.disposeIntermediateTensorInfo(n),a.disposeIntermediateTensorInfo(r),a.disposeIntermediateTensorInfo(i),o}return OW({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:a})}};const kU={kernelName:Ji,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{axis:s}=a;if(1===t.length)return jW({inputs:{input:t[0]},backend:n,attrs:{dim:s}});const r=t[0].shape,i=t[0].dtype;t.forEach(e=>{es(r,e.shape,"All tensors passed to stack must have matching shapes"),$a(i===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=_B({inputs:t.map(e=>{const t=jW({inputs:{input:e},backend:n,attrs:{dim:s}});return o.push(t),t}),backend:n,attrs:{axis:s}});return o.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}};class NU{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const a=e.length,s=LO(a),r=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(s," start = ").concat(s,"(").concat(r,");\n      ").concat(s," end = ").concat(s,"(").concat(i,");\n\n      void main() {\n        ").concat(s," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(s," coords = outC - start;\n          setOutput(getX(").concat(o,"));\n        }\n      }\n    "):"\n        int start = ".concat(r,";\n        int end = ").concat(i,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class _U{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const a=e.length,s=LO(a),r=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),o=nP("rc",a),l=nP("source",a),c="".concat(o[a-1]," < ").concat(this.outputShape[a-1]),u=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),d=["".concat(s," rc = outputLoc;"),"".concat(o[a-1]," += 1;\n       if(").concat(c,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(o[a-2]," += 1;\n       if(").concat(o[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(o[a-1]," += 1;\n         if(").concat(c,") {")],h=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,f=1===a?2:4;m<f;m++)p+="\n        ".concat(d[m],"\n        if (").concat(h,") {\n          result[").concat(m,"] = float(value);\n        } else {\n          ").concat(s," source = rc - start;\n          result[").concat(m,"] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(s," start = ").concat(s,"(").concat(r,");\n      const ").concat(s," end = ").concat(s,"(").concat(i,");\n\n      void main() {\n        ").concat(s," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}const SU=e=>{const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{paddings:r,constantValue:i}=a;if(0===ns(s.shape)){const e=r.map((e,t)=>e[0]+s.shape[t]+e[1]);return OW({backend:n,attrs:{shape:e,value:i,dtype:s.dtype}})}const o=Vs().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _U(s.shape,r,i):new NU(s.shape,r,i),l=[[i]];return n.runWebGLProgram(o,[s],s.dtype,l)},CU={kernelName:Qi,backendName:"webgl",kernelFunc:SU},jU=FP({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+NP+"\n  return result;\n"}),TU={kernelName:eo,backendName:"webgl",kernelFunc:jU};const IU={kernelName:no,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{axis:r,keepDims:i}=a,o=s.shape.length,l=[],c=ps(r,s.shape);let u=c;const d=Jm(u,o);let h,p=s;if(null!=d&&(p=nz({inputs:{x:s},backend:n,attrs:{perm:d}}),u=$m(u.length,o),l.push(p)),Ym("prod",u,o),n.shouldExecuteOnCPU([p])){const e=n.texData.get(p.dataId).values,{outVals:t,outShape:a,outDtype:s}=AF(p.shape,p.dtype,e,u);h=n.makeTensorInfo(a,s,t)}else{const[e,t]=Zm(p.shape,u),a=ns(t),r=qP({inputs:{x:p},backend:n,attrs:{shape:[-1,a]}}),i=YP(r,gc(s.dtype),"prod",n);h=qP({inputs:{x:i},backend:n,attrs:{shape:e}}),l.push(r),l.push(i)}if(i){l.push(h);const e=Xm(h.shape,c);h=qP({inputs:{x:h},backend:n,attrs:{shape:e}})}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),h}};const EU={kernelName:ao,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{paramsNestedSplits:s,paramsDenseValues:r,indices:i}=t,{outputRaggedRank:o}=a,l=s.map(e=>n.readSync(e.dataId)),c=s.map(e=>e.shape),u=n.readSync(r.dataId),d=n.readSync(i.dataId),[h,p,m]=RF(l,c,u,r.shape,r.dtype,d,i.shape,o),f=h.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(m,r.dtype,p);return f.concat([g])}};const AU={kernelName:so,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:a,limits:s,deltas:r}=t,i=n.readSync(a.dataId),o=n.readSync(s.dataId),l=n.readSync(r.dataId),[c,u]=MF(i,a.shape,a.dtype,o,s.shape,l,r.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],a.dtype,u)]}};const RU={kernelName:ro,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{shape:s,values:r,defaultValue:i,rowPartitionTensors:o}=t,{rowPartitionTypes:l}=a,c=n.readSync(s.dataId),u=n.readSync(r.dataId),d=n.readSync(i.dataId),h=o.map(e=>n.readSync(e.dataId)),p=o.map(e=>e.shape),[m,f]=LF(c,s.shape,u,r.shape,r.dtype,d,i.shape,h,p,l);return n.makeTensorInfo(m,r.dtype,f)}},MU=e=>{const{backend:t,attrs:n}=e,{start:a,stop:s,step:r,dtype:i}=n,o=DF(a,s,r,i);return t.makeTensorInfo([o.length],i,o)},LU={kernelName:io,backendName:"webgl",kernelFunc:MU},DU=OP({opSnippet:"return 1.0 / x;"}),OU={kernelName:lo,backendName:"webgl",kernelFunc:DU},FU=OP({opSnippet:uP+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),PU={kernelName:co,backendName:"webgl",kernelFunc:FU},zU=OP({opSnippet:uP+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),BU={kernelName:go,backendName:"webgl",kernelFunc:zU};class WU{constructor(e,t,n,a,s){this.variableNames=["A"],this.outputShape=[];const[r,i,o,l]=e;this.outputShape=[r,t,n,l];const c=[a&&t>1?i-1:i,a&&n>1?o-1:o],u=[a&&t>1?t-1:t,a&&n>1?n-1:n];let d;d=s?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(i,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class VU{constructor(e,t,n,a,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[r,i,o,l]=e;this.outputShape=[r,t,n,l];const c=[a&&t>1?i-1:i,a&&n>1?o-1:o],u=[a&&t>1?t-1:t,a&&n>1?n-1:n];let d;d=s?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(i,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const UU={kernelName:mo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{images:s}=t,{alignCorners:r,halfPixelCenters:i,size:o}=a,[l,c]=o,u=Vs().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new VU(s.shape,l,c,r,i):new WU(s.shape,l,c,r,i);return n.runWebGLProgram(u,[s],"float32")}};class HU{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,a,s]=t,[,r,i]=e,o=[n&&r>1?a-1:a,n&&i>1?s-1:s],l=[n&&r>1?r-1:r,n&&i>1?i-1:i],c=o[0]/l[0],u=o[1]/l[1],d=1/c,h=1/u,p=2*Math.ceil(d)+2,m=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(m,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(r,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(i,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(a-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(s-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const GU={kernelName:fo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{images:s,dy:r}=t,{alignCorners:i}=a,o=new HU(r.shape,s.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}};class qU{constructor(e,t,n,a,s){this.variableNames=["A"],this.outputShape=[];const[r,i,o,l]=e;this.outputShape=[r,t,n,l];const c=[a&&t>1?i-1:i,a&&n>1?o-1:o],u=[a&&t>1?t-1:t,a&&n>1?n-1:n],d=a?"0.5":"0.0";let h;h=s?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(i,".0, ").concat(o,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class KU{constructor(e,t,n,a,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[r,i,o,l]=e;this.outputShape=[r,t,n,l];const c=[a&&t>1?i-1:i,a&&n>1?o-1:o],u=[a&&t>1?t-1:t,a&&n>1?n-1:n],d=a?"0.5":"0.0";let h;h=s?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(i,".0, ").concat(o,".0,\n                                     ").concat(o,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}const ZU={kernelName:ho,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{images:s}=t,{alignCorners:r,halfPixelCenters:i,size:o}=a,[l,c]=o,u=Vs().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new KU(s.shape,l,c,r,i):new qU(s.shape,l,c,r,i);return n.runWebGLProgram(u,[s],s.dtype)}};class XU{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,a,s]=t,[,r,i]=e,o=[n&&r>1?a-1:a,n&&i>1?s-1:s],l=[n&&r>1?r-1:r,n&&i>1?i-1:i],c=o[0]/l[0],u=o[1]/l[1],d=1/c,h=1/u,p=2*Math.ceil(d)+2,m=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(m,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(r,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(i,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(o[0],") *\n                (float(dyR) / float(").concat(l[0],"));\n\n            float sourceFracCol =\n                float(").concat(o[1],") *\n                  (float(dyC) / float(").concat(l[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(s,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const YU={kernelName:po,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{images:s,dy:r}=t,{alignCorners:i}=a,o=new XU(r.shape,s.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}};class JU{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      "));const a=e.map((n,a)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(a)).join(","),s=LO(n);this.userCode="\n      void main() {\n        ".concat(s," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}}class QU{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;const a=nP("rc",n),s="".concat(a[n-1]," + 1 < ").concat(this.outputShape[n-1]),r="".concat(a[n-2]," + 1 < ").concat(this.outputShape[n-2]),i=LO(n);function o(n){const a=e.map((a,s)=>function(n,a){return-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - ").concat(a[n]," - 1"):"".concat(a[n])}(s,n)),s=a.join(","),r=a.slice(-2).join(",");return"getChannel(getX(".concat(s,"), vec2(").concat(r,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(s,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(i," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return o(e)}(a.slice()),";\n          if(").concat(s,"){\n            result.g = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",o(e)}(a.slice()),";\n          }\n          if(").concat(r,") {\n            result.b = ").concat(function(e){return e[n-2]="("+e[n-2]+" + 1)",o(e)}(a.slice()),";\n            if(").concat(s,") {\n              result.a = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",o(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const $U={kernelName:xo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{dims:r}=a,i=s.shape.length,o=ps(r,s.shape);if(0===i)return SP({inputs:{x:s},backend:n});const l=Vs().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new QU(s.shape,o):new JU(s.shape,o);return n.runWebGLProgram(l,[s],s.dtype)}};class eH{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],a=e[2];this.outputShape=e;let s="";s="number"===typeof t?"float outputValue = ".concat(t.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(s,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const tH={kernelName:ll,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:a}=e;const{image:s}=t,{radians:r,fillValue:i,center:o}=n,l=a,c=new eH(s.shape,i),[u,d]=Yy(o,s.shape[1],s.shape[2]),h=[[u,d,Math.sin(r),Math.cos(r)]];return l.runWebGLProgram(c,[s],s.dtype,h)}},nH=OP({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),aH={kernelName:yo,backendName:"webgl",kernelFunc:nH},sH=OP({opSnippet:"return inversesqrt(x);",cpuKernelImpl:OF}),rH={kernelName:bo,backendName:"webgl",kernelFunc:sH};class iH{constructor(e,t,n,a,s,r){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=r;const o=LO(s.length),l=LO(r.length);let c="";1===n?c="i":2===n&&(c="i, j");const u="getIndices(".concat(c,")");let d="";1===a?d="i":2===a&&(d="i, coords[1]");const h="getUpdates(".concat(d,")");let p="";i&&(p="coords[0], coords[1]");const m="getDefaultValue(".concat(p,")"),f=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(s,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(u,");\n              flattenedIndex += index * ").concat(f,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(m,", sum, float(found)));\n        }\n      ")}}class oH{constructor(e,t,n,a,s,r){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;const o=LO(s.length),l=LO(r.length);let c="";1===n?c="i":2===n&&(c="i, j");const u="getIndices(".concat(c,")");let d="";1===a?d="i":2===a&&(d="i, coords[1]");const h="getUpdates(".concat(d,")");let p="";i&&(p="coords[0], coords[1]");const m="getDefaultValue(".concat(p,")"),f=t>1?"strides[j]":"strides",g=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(s,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(u,");\n              flattenedIndex += index.xz * ").concat(f,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(h,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(m,", sum, found));\n        }\n      ")}}const lH={kernelName:vo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{indices:s,updates:r}=t,{shape:i}=a,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Hh(0,s,i),h=[d/c,c];if(0===d)return n.makeTensorInfo(i,s.dtype);const p=qP({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),m=qP({inputs:{x:r},backend:n,attrs:{shape:[l,c]}}),f=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;g=Vs().getBool("WEBGL_PACK")?new oH(l,o,p.shape.length,m.shape.length,u,h):new iH(l,o,p.shape.length,m.shape.length,u,h);const x=n.runWebGLProgram(g,[m,p,f],m.dtype),y=qP({inputs:{x:x},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(f),y}};class cH{constructor(e,t,n,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const s="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),r=2===Vs().getNumber("WEBGL_VERSION")?"while (left < right) {":s,i="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(r,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(i," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}const uH={kernelName:ko,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{sortedSequence:s,values:r}=t,{side:i}=a,o=new cH(s.shape[0],s.shape[1],r.shape[1],i),l=[[s.shape[1]]];return n.runWebGLProgram(o,[s,r],"int32",l)}};class dH{constructor(e,t,n){let a,s;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)s="resRC",a="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],i=[];for(let a=0;a<t.length;a++)i.push("".concat(n[a])),a<e&&r.push("".concat(n[a]));a=r.join(),s=i.join()}const r=LO(n);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(s,"));\n        } else {\n          setOutput(getB(").concat(s,"));\n        }\n      }\n    ")}}const hH={kernelName:No,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:a,t:s,e:r}=t,i=new dH(a.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(i,[a,s,r],fc(s.dtype,r.dtype))}},pH=OP({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(nb,";\n  float scale = ").concat(ab,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),mH={kernelName:_o,backendName:"webgl",kernelFunc:pH},fH=OP({opSnippet:DP+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:PF}),gH={kernelName:Io,backendName:"webgl",kernelFunc:fH},xH=OP({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),yH={kernelName:To,backendName:"webgl",kernelFunc:xH},bH=OP({opSnippet:DP+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(NP,"\n  return result;\n")}),vH={kernelName:Co,backendName:"webgl",kernelFunc:bH},wH=OP({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),kH={kernelName:jo,backendName:"webgl",kernelFunc:wH},NH=OP({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),_H={kernelName:Eo,backendName:"webgl",kernelFunc:NH},SH={kernelName:Mo,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{blockShape:r,paddings:i}=a;$a(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=r.reduce((e,t)=>e*t),l=[[0,0]];l.push(...i);for(let x=1+r.length;x<s.shape.length;++x)l.push([0,0]);const c=[],u=SU({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=Jy(u.shape,r,o,!1),h=Qy(d.length,r.length,!1),p=$y(u.shape,r,o,!1),m=qP({inputs:{x:u},backend:n,attrs:{shape:d}}),f=nz({inputs:{x:m},backend:n,attrs:{perm:h}}),g=qP({inputs:{x:f},backend:n,attrs:{shape:p}});return c.push(u),c.push(m),c.push(f),c.forEach(e=>n.disposeIntermediateTensorInfo(e)),g}};const CH={kernelName:Oo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:a,values:s,denseShape:r,defaultValue:i}=t;if(1!==r.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(r.shape));if(2!==a.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(a.shape));if(1!==s.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(s.shape));if(0!==i.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const o=n.readSync(a.dataId),l=n.readSync(s.dataId),c=n.readSync(r.dataId),u=n.readSync(i.dataId)[0],[d,h,p,m,f]=WF(o,a.shape,a.dtype,l,s.dtype,c,u);return[n.makeTensorInfo(h,a.dtype,d),n.makeTensorInfo([h[0]],s.dtype,p),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(e=>Number(e)))),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}};const jH={kernelName:Fo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:a,inputShape:s,newShape:r}=t;if(2!==a.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(a.shape));if(1!==s.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(s.shape));if(1!==r.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(r.shape));const i=Array.from(n.readSync(s.dataId)),o=n.readSync(a.dataId),l=Array.from(n.readSync(r.dataId)),[c,u,d]=VF(o,a.shape,a.dtype,i,l);return[n.makeTensorInfo(u,a.dtype,c),n.makeTensorInfo([d.length],r.dtype,new Int32Array(d))]}};const TH={kernelName:Po,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:a,indices:s,segmentIds:r}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(s.shape));if(1!==r.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(r.shape));const i=n.readSync(a.dataId),o=n.readSync(s.dataId),l=n.readSync(r.dataId),[c,u]=UF(i,a.shape,a.dtype,o,l,!0);return n.makeTensorInfo(u,a.dtype,c)}};const IH={kernelName:zo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:a,indices:s,segmentIds:r}=t;if(a.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==s.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(s.shape));if(1!==r.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(r.shape));const i=n.readSync(a.dataId),o=n.readSync(s.dataId),l=n.readSync(r.dataId),[c,u]=UF(i,a.shape,a.dtype,o,l);return n.makeTensorInfo(u,a.dtype,c)}};const EH={kernelName:Bo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{sparseIndices:s,sparseValues:r,defaultValue:i}=t,{outputShape:o}=a,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Hh(0,s,o),p=!1;if("string"===r.dtype){const e=n.bufferSync(s),t=n.bufferSync(r),a=Gl(n.readSync(i.dataId)[0]),m=FF(e,t,o,h,u,c,l,d,a,p);return n.makeTensorInfo(o,m.dtype,m.values)}const m=new iH(c,l,s.shape.length,r.shape.length,d,[h,1],p),f=n.runWebGLProgram(m,[r,s,i],r.dtype),g=qP({inputs:{x:f},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),g}};const AH={kernelName:Lo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{numOrSizeSplits:r,axis:i}=a,o=ps(i,s.shape)[0],l=Tb(s,r,o),c=s.shape.length,u=new Array(c).fill(0),d=s.shape.slice();return l.map(e=>{const t=[...d];t[o]=e;const a=Qz({inputs:{x:s},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,a})}},RH="return sqrt(x);",MH=OP({opSnippet:RH,packedOpSnippet:RH,cpuKernelImpl:HF}),LH={kernelName:Ao,backendName:"webgl",kernelFunc:MH},DH=OP({opSnippet:"return x * x;"}),OH={kernelName:Vo,backendName:"webgl",kernelFunc:DH},FH="return (a - b) * (a - b);",PH=FP({opSnippet:FH,packedOpSnippet:FH}),zH={kernelName:Wo,backendName:"webgl",kernelFunc:PH};const BH={kernelName:Uo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");const r=Hb(n.readSync(s.dataId)),i=GF(r,"string",a);return n.makeTensorInfo(s.shape,"string",i)}};const WH={kernelName:il,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:a}=e;const{x:s}=t,r=uP+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),i=new cP(s.shape,r);return a.runWebGLProgram(i,[s],s.dtype)}};class VH{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const a=n.length,s=LO(n.length),r=LO(n.length);let i="";if(1===a)i="coords * strides + begin";else{let e=0;i=n.map((t,a)=>(e++,1===n.length?"coords * strides[".concat(a,"] + begin[").concat(a,"]"):"coords[".concat(e-1,"] * strides[").concat(a,"] + begin[").concat(a,"]"))).join(",")}this.userCode="\n      ".concat(s," begin = ").concat(s,"(").concat(e,");\n      ").concat(s," strides = ").concat(s,"(").concat(t,");\n\n      void main() {\n        ").concat(r," coords = getOutputCoords();\n        setOutput(getX(").concat(i,"));\n      }\n    ")}}const UH={kernelName:Ho,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{begin:r,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=a,{finalShapeSparse:p,finalShape:m,isIdentity:f,sliceDim0:g,isSimpleSlice:x,begin:y,end:b,strides:v}=lp(s.shape,r,i,o,l,c,u,d,h);let w;if(f)w=qP({inputs:{x:s},backend:n,attrs:{shape:m}});else if(g||x){$a(s.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(s.shape.length));const e=Xh(y,b,v),t=Qz({inputs:{x:s},backend:n,attrs:{begin:y,size:e}});w=qP({inputs:{x:t},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(t)}else{if(n.shouldExecuteOnCPU([s])){const e=n.readSync(s.dataId),t=gd(s.shape,s.dtype,e),a=qF(p,t,v,y);w=n.makeTensorInfo(m,s.dtype,a.values)}else{const e=new VH(y,v,p);w=n.runWebGLProgram(e,[s],s.dtype)}}const k=qP({inputs:{x:w},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(w),k}};const HH={kernelName:Go,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{separator:s,nGramWidths:r,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=a,{data:u,dataSplits:d}=t,h=n.readSync(u.dataId),p=n.readSync(d.dataId),[m,f]=KF(h,p,s,r,i,o,l,c);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",f)]}};const GH={kernelName:qo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{skipEmpty:s}=a,{input:r,delimiter:i}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");if(1!==r.shape.length)throw new Error("Input must be a vector, got shape: ".concat(r.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const o=n.readSync(r.dataId),l=n.readSync(i.dataId)[0],[c,u,d]=ZF(o,l,s),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};const qH={kernelName:Ko,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{numBuckets:s}=a,{input:r}=t;if("string"!==r.dtype)throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(r.dataId),o=XF(i,s);return n.makeTensorInfo(r.shape,"int32",o)}},KH=OP({opSnippet:"return tan(x);"}),ZH={kernelName:Xo,backendName:"webgl",kernelFunc:KH},XH=OP({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),YH={kernelName:Yo,backendName:"webgl",kernelFunc:XH};const JH={kernelName:wo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{tensor:s,indices:r,updates:i}=t,{}=a,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Hh(0,r,s.shape),h=[d/c,c];if(0===d)return n.makeTensorInfo(s.shape,r.dtype);const p=qP({inputs:{x:r},backend:n,attrs:{shape:[l,o]}}),m=qP({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),f=qP({inputs:{x:s},backend:n,attrs:{shape:h}}),g=new iH(l,o,p.shape.length,m.shape.length,u,h,!1,!0),x=n.runWebGLProgram(g,[m,p,f],f.dtype),y=qP({inputs:{x:x},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(x),y}};class QH{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;const a=LO(this.rank),s=function(e){const t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],a=[];for(let s=0;s<e.length;s++)a.push("imod(".concat(n[s],", ").concat(e[s],")"));return a.join()}(e);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        setOutput(getA(").concat(s,"));\n      }\n    ")}}function $H(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{reps:r}=a;if("string"===s.dtype||s.shape.length>5){const e=n.readSync(s.dataId),t="string"===s.dtype?e.map(e=>Gl(e)):e,a=gd(s.shape,s.dtype,t),i=JF(a,r);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const i=new QH(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const eG={kernelName:Jo,backendName:"webgl",kernelFunc:$H};class tG{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class nG{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function aG(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function sG(e){let t=1;for(;t<e;)t*=2;return t}const rG={kernelName:Qo,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s}=t,{k:r,sorted:i}=a,o=Vs().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Vs().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=s.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([s])||u<o||r>l){const e=n.readSync(s.dataId),[t,a]=QF(e,c,s.dtype,r,i);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(a.shape,a.dtype,a.values)]}if(0===r)return c[c.length-1]=0,[n.makeTensorInfo(c,s.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===u)return[s,OW({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),h=null!==d&&d.isPacked,p=h?n.unpackTensor(s):s,m=ns(c)/u,f=qP({inputs:{x:p},attrs:{shape:[m,u]},backend:n});h&&aG(n,p);const g=sG(r),x=sG(u);let y=null;const b=()=>null===y?[f,f]:[f,y],v=(e,t,a)=>{const s=b(),r=new tG(a),i=[[u],[null===y?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],o=y;y=n.runWebGLProgram(r,s,"int32",i),aG(n,o)};for(let S=1;S<g;S*=2){const e=2*S;for(let t=S;t>=1;t/=2)v(e,t,[m,x])}for(let S=x;S>g;S/=2){const e=b(),t=new nG([m,S/2]),a=[[u],[null===y?1:0],[g]],s=y;y=n.runWebGLProgram(t,e,"int32",a),aG(n,s);const r=g/2,i=2*r;for(let n=r;n>=1;n/=2)v(i,n,y.shape)}let w=y;y=Qz({inputs:{x:y},backend:n,attrs:{begin:0,size:[m,r]}}),aG(n,w);let k=tV({inputs:{x:f,indices:y},backend:n,attrs:{axis:1,batchDims:1}});aG(n,f);const N=c.slice(0,-1);N.push(r),w=y,y=qP({inputs:{x:y},attrs:{shape:N},backend:n}),aG(n,w);const _=k;return k=qP({inputs:{x:k},attrs:{shape:N},backend:n}),aG(n,_),[k,y]}};class iG{constructor(e,t,n,a,s,r){this.variableNames=["Image","Transforms"],this.outputShape=r;const i="nearest"===n?1:2;let o;switch(a){case"constant":default:o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(o," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(o," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(o," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(s,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(s,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(i," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}const oG={kernelName:$o,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{image:s,transforms:r}=t,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=a,[u,d,h,p]=s.shape,[m,f]=null!=c?c:[d,h],g=new iG(d,h,i,o,l,[u,m,f,p]);return n.runWebGLProgram(g,[s,r],"float32")}};const lG={kernelName:tl,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:n,backend:a}=e,{axis:s}=n,{x:r}=t;gO(r,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=a.readSync(r.dataId),{outputValues:o,outputShape:l,indices:c}=eP(i,s,r.shape,r.dtype);return[a.makeTensorInfo(l,r.dtype,o),a.makeTensorInfo([c.length],"int32",c)]}};const cG={kernelName:nl,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{value:s}=t;let{axis:r}=a;r<0&&(r+=s.shape.length);const i=s,o=i.shape.length,l=s.shape[r],c=new Array(o-1);let u=0;for(let f=0;f<o;f++)f!==r&&(c[u++]=i.shape[f]);const d=[],h=new Array(o).fill(0),p=i.shape.slice();p[r]=1;const m=new Array(l);for(let f=0;f<m.length;f++){h[r]=f;const e=Qz({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),t=qP({inputs:{x:e},backend:n,attrs:{shape:c}});m[f]=t,d.push(e)}return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),m}};class uG{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,a=e.batchSize,s=e.inSize,r=e.numSegments,i=r*Math.ceil(s/n);this.outputShape=[a,i];const o=4*Math.floor(n/4),l=n%4,c="\n        sumValue += dot(values, segFilter);\n    ";let u="";s%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(s,") {\n          return initializationValue;\n        }\n      "));let d="";s%n>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(s,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(r,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(r,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(o,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(o,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const dG={kernelName:al,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:a}=e,{x:s,segmentIds:r}=t,{numSegments:i}=a,o=s.shape.length,l=[];let c=0;const u=Jm([c],o);let d=s;null!=u&&(d=nz({inputs:{x:s},backend:n,attrs:{perm:u}}),l.push(d),c=$m(1,o)[0]);const h=Vb(d.shape,c,i),p=ns([d.shape[c]]),m=qP({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(m);const f=gc(s.dtype),g=(e,t,a,s,r)=>{const i=e.shape[0],o=e.shape[1],c=Wb(o,r),u=new uG({windowSize:c,inSize:o,batchSize:i,numSegments:r},t),d=n.compileAndRun(u,[e,a],s);if(l.push(d),d.shape[1]===r)return d;const h=MU({backend:n,attrs:{start:0,stop:r,step:1,dtype:"float32"}}),p=$H({inputs:{x:h},backend:n,attrs:{reps:[o/c]}});l.push(h),l.push(p);return g(d,t,p,s,r)},x=qP({inputs:{x:g(m,"unsortedSegmentSum",r,f,i)},backend:n,attrs:{shape:h}});let y=x;if(null!=u){l.push(x);const e=Qm(u);y=nz({inputs:{x:y},backend:n,attrs:{perm:e}})}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}},hG=[rz,oz,cz,dz,mz,xz,yz,bz,Sz,Cz,Tz,Ez,Rz,Lz,Oz,zz,Bz,Uz,Hz,Gz,Zz,eB,tB,nB,aB,lB,dB,mB,TP,xB,SB,MB,PB,BB,WB,VB,UB,GB,KB,XB,tW,nW,aW,rW,lW,dW,hW,mW,gW,xW,bW,vW,kW,_W,CW,TW,AW,LW,FW,zW,VW,HW,KW,YW,JW,$W,nV,sV,iV,CP,oV,kB,cV,dV,pV,AP,fV,xV,yV,vV,kV,_V,CV,TV,AV,MV,DV,FV,PV,zV,VV,UV,HV,GV,qV,ZV,JV,$V,lU,GP,uU,hU,mU,gU,rB,yU,wU,kU,CU,TU,LP,IU,EU,AU,RU,LU,oB,nU,OU,PU,BU,KP,UU,GU,ZU,YU,$U,tH,aH,rH,lH,uH,hH,mH,gH,yH,vH,kH,$z,oU,_H,SH,CH,jH,TH,IH,EH,AH,LH,OH,zH,BH,WH,UH,HH,GH,qH,rU,tz,ZH,YH,JH,eG,rG,oG,az,lG,cG,dG,vU];for(const n of hG)bl(n);function pG(e,t,n,a){return new(n||(n=Promise))(function(s,r){function i(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,o)}l((a=a.apply(e,t||[])).next())})}function mG(e,t){var n,a,s,r,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(s=2&r[0]?a.return:r[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,r[1])).done)return s;switch(a=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(s=(s=i.trys).length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){i.label=r[1];break}if(6===r[0]&&i.label<s[1]){i.label=s[1],s=r;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(r);break}s[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}}var fG={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},gG=224,xG={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},yG={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}};var bG=function(){function e(e,t,n,a,s){void 0===a&&(a=-1),void 0===s&&(s=1),this.version=e,this.alpha=t,this.modelUrl=n,this.inputMin=a,this.inputMax=s,this.normalizationConstant=(s-a)/255}return e.prototype.load=function(){return pG(this,void 0,void 0,function(){var e,t,n,a,s=this;return mG(this,function(r){switch(r.label){case 0:return this.modelUrl?(e=this,[4,_T(this.modelUrl)]):[3,2];case 1:return e.model=r.sent(),[3,4];case 2:return t=yG[this.version][this.alpha].url,n=this,[4,_T(t,{fromTFHub:!0})];case 3:n.model=r.sent(),r.label=4;case 4:return[4,(a=tu(function(){return s.model.predict(Wf([1,gG,gG,3]))})).data()];case 5:return r.sent(),a.dispose(),[2]}})})},e.prototype.infer=function(e,t){var n=this;return void 0===t&&(t=!1),tu(function(){e instanceof ic||(e=Bh(e));var a=vd(Nd(xd(e,"float32"),n.normalizationConstant),n.inputMin),s=a;e.shape[0]===gG&&e.shape[1]===gG||(s=My.resizeBilinear(a,[gG,gG],!0));var r,i=$p(s,[-1,gG,gG,3]);if(t){var o=xG[n.version],l=n.model.execute(i,o);r=Xg(l,[1,2])}else{var c=n.model.predict(i);r=sm(c,[0,1],[-1,1e3])}return r})},e.prototype.classify=function(e,t){return void 0===t&&(t=3),pG(this,void 0,void 0,function(){var n,a;return mG(this,function(s){switch(s.label){case 0:return[4,vG(n=this.infer(e),t)];case 1:return a=s.sent(),n.dispose(),[2,a]}})})},e}();function vG(e,t){return pG(this,void 0,void 0,function(){var n,a,s,r,i,o,l;return mG(this,function(c){switch(c.label){case 0:return[4,(n=Vg(e)).data()];case 1:for(a=c.sent(),n.dispose(),s=[],l=0;l<a.length;l++)s.push({value:a[l],index:l});for(s.sort(function(e,t){return t.value-e.value}),r=new Float32Array(t),i=new Int32Array(t),l=0;l<t;l++)r[l]=s[l].value,i[l]=s[l].index;for(o=[],l=0;l<i.length;l++)o.push({className:fG[i[l]],probability:r[l]});return[2,o]}})})}"undefined"!==typeof window&&ru("webgl").catch(()=>(console.warn("WebGL backend not available, falling back to CPU"),ru("cpu")));const wG={"taj mahal":{name:"Taj Mahal",location:"Agra, Uttar Pradesh",yearBuilt:"1632-1653",architecturalStyle:"Mughal Architecture",historicalInfo:"Built by Mughal Emperor Shah Jahan in memory of his beloved wife Mumtaz Mahal. It is considered one of the most beautiful buildings in the world and is a symbol of eternal love.",significance:"UNESCO World Heritage Site and one of the Seven Wonders of the World. It represents the pinnacle of Mughal architecture and is considered the finest example of Mughal art in India.",keyFeatures:["White marble dome with intricate calligraphy","Four minarets at each corner","Symmetrical garden layout","Reflecting pool that mirrors the monument"],keywords:["taj mahal","agra","mughal","marble","mausoleum","wonder"],confidence:0},"red fort":{name:"Red Fort",location:"Delhi",yearBuilt:"1638-1648",architecturalStyle:"Mughal Architecture",historicalInfo:"Constructed by Mughal Emperor Shah Jahan as his palace fort. It served as the main residence of the Mughal emperors for nearly 200 years.",significance:"UNESCO World Heritage Site and a powerful symbol of India's struggle for independence. The Prime Minister addresses the nation from here on Independence Day.",keyFeatures:["Red sandstone walls","Lahori Gate and Delhi Gate","Diwan-i-Aam (Hall of Public Audience)","Diwan-i-Khas (Hall of Private Audience)"],keywords:["red fort","delhi","lal qila","mughal","sandstone","fort"],confidence:0},"qutub minar":{name:"Qutub Minar",location:"Delhi",yearBuilt:"1192-1368",architecturalStyle:"Indo-Islamic Architecture",historicalInfo:"Built by Qutb-ud-din Aibak, the founder of the Delhi Sultanate. It is the tallest brick minaret in the world and was constructed to celebrate Muslim dominance in Delhi.",significance:"UNESCO World Heritage Site and the tallest brick minaret in the world. It represents the beginning of Muslim rule in India and showcases the fusion of Indian and Islamic architectural styles.",keyFeatures:["Five distinct storeys","Intricate carvings and verses from Quran","Iron Pillar that never rusts","Quwwat-ul-Islam Mosque"],keywords:["qutub minar","delhi","minaret","islamic","brick","tallest"],confidence:0},"india gate":{name:"India Gate",location:"New Delhi",yearBuilt:"1921-1931",architecturalStyle:"Triumphal Arch Architecture",historicalInfo:"Built as a memorial to the 70,000 Indian soldiers who died in World War I and the Third Anglo-Afghan War. It was designed by Sir Edwin Lutyens.",significance:"National monument of India and a tribute to the brave soldiers who sacrificed their lives. It is one of the largest war memorials in India.",keyFeatures:["42-meter high arch","Names of 13,516 war dead inscribed","Eternal flame (Amar Jawan Jyoti)","Surrounding gardens and fountains"],keywords:["india gate","delhi","war memorial","lutyens","arch","soldiers"],confidence:0},"lotus temple":{name:"Lotus Temple",location:"New Delhi",yearBuilt:"1980-1986",architecturalStyle:"Expressionist Modern Architecture",historicalInfo:"Built as a Bah\xe1'\xed House of Worship, it is open to people of all religions. The temple is shaped like a lotus flower and has won numerous architectural awards.",significance:"One of the most visited buildings in the world and a symbol of unity and peace. It represents the Bah\xe1'\xed principle of oneness of religion.",keyFeatures:["27 marble-clad petals","Nine surrounding pools","Central prayer hall","No idols or religious symbols inside"],keywords:["lotus temple","delhi","bahai","lotus","marble","temple"],confidence:0},"golden temple":{name:"Golden Temple",location:"Amritsar, Punjab",yearBuilt:"1588-1601",architecturalStyle:"Sikh Architecture",historicalInfo:"The holiest shrine of Sikhism, built by Guru Arjan Dev. The temple is covered with gold and is surrounded by a sacred pool called Amrit Sarovar.",significance:"The most important pilgrimage site in Sikhism and a symbol of human brotherhood and equality. It represents the spiritual and cultural heritage of Punjab.",keyFeatures:["Gold-plated exterior","Four entrances symbolizing openness","Amrit Sarovar (holy pool)","World's largest free kitchen"],keywords:["golden temple","amritsar","harmandir sahib","sikh","gold","gurudwara"],confidence:0},"hawa mahal":{name:"Hawa Mahal",location:"Jaipur, Rajasthan",yearBuilt:"1799",architecturalStyle:"Rajput Architecture",historicalInfo:"Built by Maharaja Sawai Pratap Singh, this palace was designed for royal ladies to observe street life without being seen. It has 953 small windows.",significance:"An architectural marvel that showcases the ingenuity of Rajput architecture and the cultural practices of royal women in medieval India.",keyFeatures:["953 small windows (jharokhas)","Five-story pyramidal structure","Pink and red sandstone","Natural air conditioning system"],keywords:["hawa mahal","jaipur","palace of winds","rajput","windows","pink"],confidence:0},"gateway of india":{name:"Gateway of India",location:"Mumbai, Maharashtra",yearBuilt:"1911-1924",architecturalStyle:"Indo-Saracenic Architecture",historicalInfo:"Built to commemorate the visit of King George V and Queen Mary to Mumbai. It was the ceremonial entrance to India for British viceroys and governors.",significance:"An iconic symbol of Mumbai and a reminder of India's colonial past. It serves as a major tourist attraction and gathering point.",keyFeatures:["26-meter high arch","Yellow basalt and reinforced concrete","Central dome with intricate carvings","Four turrets at corners"],keywords:["gateway of india","mumbai","gateway","colonial","arch","taj hotel"],confidence:0}};let kG=null;async function NG(){try{return console.log("Initializing TensorFlow.js backend..."),await iu(),console.log("TensorFlow.js backend ready:",ou()),console.log("Loading MobileNet model..."),kG||(kG=await function(e){return void 0===e&&(e={version:1,alpha:1}),pG(this,void 0,void 0,function(){var t,n,a,s,r,i,o;return mG(this,function(l){switch(l.label){case 0:if(null==x)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(t=e.version.toFixed(2),n=e.alpha?e.alpha.toFixed(2):"",a=-1,s=1,null==e.modelUrl){if(!(t in yG))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(yG));if(!(n in yG[t]))throw new Error("MobileNet constructed with invalid alpha "+e.alpha+". Valid multipliers for this version are: "+Object.keys(yG[t])+".");i=yG[t][n].inputRange,a=i[0],s=i[1]}return null!=e.inputRange&&(o=e.inputRange,a=o[0],s=o[1]),[4,(r=new bG(t,n,e.modelUrl,a,s)).load()];case 1:return l.sent(),[2,r]}})})}(),console.log("MobileNet model loaded successfully")),kG}catch(e){return console.error("Error loading MobileNet model:",e),console.warn("AI model failed to load, falling back to pattern matching"),null}}function _G(e){let t=null,n=0;return Object.values(wG).forEach(a=>{let s=0,r=0;e.forEach(e=>{const t=e.className.toLowerCase();a.keywords.forEach(n=>{(t.includes(n)||n.includes(t))&&(s+=e.probability,r++)})});const i=r>0?s/r:0;i>n&&i>.1&&(n=i,t=Lt(Lt({},a),{},{confidence:i}))}),t}function SG(){const e=Object.values(wG),t=e[Math.floor(Math.random()*e.length)],n=.7+.25*Math.random();return{success:!0,monument:Lt(Lt({},t),{},{confidence:n}),confidence:n,predictions:[{className:t.name.toLowerCase(),probability:n}],fallback:!0}}const CG=e=>{let{isOpen:t,onClose:n}=e;const a=(0,B.useRef)(null),s=(0,B.useRef)(null),[r,i]=(0,B.useState)(!1),[o,l]=(0,B.useState)(null),[c,u]=(0,B.useState)(!1),[d,h]=(0,B.useState)(0),[p,m]=(0,B.useState)(null),[f,g]=(0,B.useState)(!1),[x,y]=(0,B.useState)(!1),[b,v]=(0,B.useState)([]),[w,k]=(0,B.useState)(!1);(0,B.useEffect)(()=>{(async()=>{try{await NG(),g(!0),console.log("AI Model loaded successfully")}catch(p){console.error("Failed to load AI model:",p),m("Failed to initialize AI recognition system")}})(),l(null),y(!1),v([])},[]),(0,B.useEffect)(()=>()=>{_(),N()},[]),(0,B.useEffect)(()=>{t||(_(),N())},[t]);const N=()=>{l(null),y(!1),v([]),m(null)},_=()=>{if(a.current&&a.current.srcObject){a.current.srcObject.getTracks().forEach(e=>e.stop()),a.current.srcObject=null,i(!1),setTimeout(()=>N(),500)}};return f?t?(0,Dt.jsx)(B.Fragment,{children:(0,Dt.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",children:(0,Dt.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 to-purple-900 relative overflow-hidden w-full max-w-4xl max-h-screen overflow-y-auto",children:[(0,Dt.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-20",children:(0,Dt.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-10 animate-pulse"})}),(0,Dt.jsx)("div",{className:"relative z-10 p-6",children:(0,Dt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Dt.jsxs)("h1",{className:"text-3xl font-bold text-white flex items-center",children:[(0,Dt.jsx)(Da,{className:"w-8 h-8 mr-3"}),"AR Monument Guide"]}),(0,Dt.jsx)("button",{onClick:()=>{_(),n()},className:"text-white hover:text-gray-300 transition-colors duration-200 p-2 rounded-lg hover:bg-white hover:bg-opacity-10",children:(0,Dt.jsx)(Oa,{className:"w-6 h-6"})})]})}),(0,Dt.jsxs)("div",{className:"relative z-10 flex flex-col items-center justify-center px-6 pb-6",children:[!r&&!x&&(0,Dt.jsxs)("div",{className:"text-center text-white max-w-md",children:[(0,Dt.jsxs)("div",{className:"bg-white bg-opacity-10 backdrop-blur-lg rounded-3xl p-8 mb-8",children:[(0,Dt.jsx)(Da,{className:"w-16 h-16 mx-auto mb-4 text-yellow-300"}),(0,Dt.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Discover Historical Monuments"}),(0,Dt.jsx)("p",{className:"text-lg mb-6 opacity-90",children:"Point your camera at any monument and let AI identify it instantly. Learn about its rich history and cultural significance."}),(0,Dt.jsx)("button",{onClick:async()=>{try{if(m(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return void m("Camera not supported in this browser. Please try a modern browser.");if(a.current&&a.current.srcObject){a.current.srcObject.getTracks().forEach(e=>e.stop())}N();const e={video:{facingMode:"environment",width:{ideal:1280,max:1920},height:{ideal:720,max:1080},frameRate:{ideal:30}}},t=await navigator.mediaDevices.getUserMedia(e);a.current&&(a.current.srcObject=t,a.current.play().catch(e=>{console.error("Error playing video:",e),m("Error starting camera playback. Please try again.")}),a.current.onloadedmetadata=()=>{i(!0),console.log("Camera started successfully"),console.log("Video dimensions:",a.current.videoWidth,"x",a.current.videoHeight),console.log("Video ready state:",a.current.readyState)},a.current.onerror=e=>{console.error("Video element error:",e),m("Camera stream error. Please try again.")})}catch(p){console.error("Error accessing camera:",p);let t="Unable to access camera. ";"NotAllowedError"===p.name?t+="Please grant camera permissions.":"NotFoundError"===p.name?t+="No camera device found.":"NotReadableError"===p.name?t+="Camera is already in use by another application.":t+="Please ensure camera permissions are granted and try again.",m(t)}},className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-black px-8 py-4 rounded-full font-bold text-lg hover:from-yellow-500 hover:to-orange-600 transition-all duration-200 transform hover:scale-105 shadow-lg",children:"Start AR Camera"})]}),b.length>0&&(0,Dt.jsxs)("div",{className:"bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl p-6",children:[(0,Dt.jsxs)("h3",{className:"text-xl font-bold mb-4 flex items-center",children:[(0,Dt.jsx)(Fa,{className:"w-5 h-5 mr-2"}),"Recent Scans"]}),(0,Dt.jsx)("div",{className:"space-y-3",children:b.map((e,t)=>(0,Dt.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-3 cursor-pointer hover:bg-opacity-30 transition-all duration-200",onClick:()=>{l(e),y(!0)},children:[(0,Dt.jsx)("p",{className:"font-semibold",children:e.name}),(0,Dt.jsx)("p",{className:"text-sm opacity-80",children:e.location})]},t))})]})]}),r&&!x&&(0,Dt.jsx)("div",{className:"relative w-full max-w-2xl mx-auto",children:(0,Dt.jsxs)("div",{className:"relative bg-black rounded-2xl overflow-hidden shadow-2xl",style:{minHeight:"400px"},children:[(0,Dt.jsx)("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover min-h-96",style:{display:"block",backgroundColor:"#000"}}),(0,Dt.jsx)("canvas",{ref:s,className:"hidden"}),c&&(0,Dt.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"text-center text-white",children:[(0,Dt.jsx)(La,{className:"w-12 h-12 animate-spin mx-auto mb-4"}),(0,Dt.jsx)("p",{className:"text-lg mb-2",children:"Analyzing Monument..."}),(0,Dt.jsx)("div",{className:"w-48 bg-gray-700 rounded-full h-2 mx-auto",children:(0,Dt.jsx)("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(d,"%")}})}),(0,Dt.jsxs)("p",{className:"text-sm mt-2 opacity-75",children:[d,"% complete"]})]})}),(0,Dt.jsxs)("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 flex space-x-4",children:[(0,Dt.jsx)("button",{onClick:async()=>{if(a.current&&f&&s.current)if(4===a.current.readyState){u(!0),h(0),m(null),k(!0);try{const e=await(async()=>{if(!a.current||!s.current)return;const e=s.current,t=a.current,n=e.getContext("2d");return e.width=t.videoWidth,e.height=t.videoHeight,n.drawImage(t,0,0,e.width,e.height),new Promise(t=>{e.toBlob(e=>{t(e)},"image/jpeg",.9)})})();if(!e)throw new Error("Failed to capture photo");const t=new Image,n=URL.createObjectURL(e);await new Promise((e,a)=>{t.onload=e,t.onerror=a,t.src=n});const r=setInterval(()=>{h(e=>e>=75?(clearInterval(r),75):e+12*Math.random()+3)},400),i=await async function(e){try{if(kG||await NG(),!kG)return console.log("Using enhanced fallback monument recognition method"),SG();const t=3;let n=null,a=0;for(let s=0;s<t;s++){const r=await kG.classify(e,5);console.log("Attempt ".concat(s+1," predictions:"),r);const i=_G(r);if(i&&i.confidence>a&&(n=i,a=i.confidence),a>.8)break;s<t-1&&await new Promise(e=>setTimeout(e,100))}return n?{success:!0,monument:n,confidence:Math.round(100*n.confidence),attempts:t}:{success:!1,error:"No recognized monument found in the image after multiple attempts",attempts:t}}catch(p){return console.error("Error in enhanced monument analysis:",p),SG()}}(t);URL.revokeObjectURL(n),clearInterval(r),h(100),i.success&&i.monument?(l(i.monument),v(e=>[i.monument,...e.slice(0,4)]),setTimeout(()=>{u(!1),h(0),k(!1),y(!0)},1500)):(u(!1),h(0),k(!1),m(i.error||"No monument recognized. Please try again with a clearer photo."))}catch(p){console.error("Error during monument scan:",p),u(!1),h(0),k(!1),m("Failed to analyze monument. Please try again.")}}else m("Camera not ready. Please wait a moment and try again.");else m("Camera or AI model not ready. Please wait...")},disabled:c,className:"bg-white bg-opacity-90 hover:bg-opacity-100 text-black p-4 rounded-full transition-all duration-200 transform hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,Dt.jsx)(Da,{className:"w-8 h-8"})}),(0,Dt.jsx)("button",{onClick:_,className:"bg-red-600 hover:bg-red-700 text-white p-4 rounded-full transition-colors duration-200",children:(0,Dt.jsx)(Oa,{className:"w-8 h-8"})})]}),(0,Dt.jsxs)("div",{className:"absolute inset-4 pointer-events-none",children:[(0,Dt.jsx)("div",{className:"absolute top-0 left-0 w-16 h-16 border-t-4 border-l-4 border-yellow-400 rounded-tl-lg"}),(0,Dt.jsx)("div",{className:"absolute top-0 right-0 w-16 h-16 border-t-4 border-r-4 border-yellow-400 rounded-tr-lg"}),(0,Dt.jsx)("div",{className:"absolute bottom-0 left-0 w-16 h-16 border-b-4 border-l-4 border-yellow-400 rounded-bl-lg"}),(0,Dt.jsx)("div",{className:"absolute bottom-0 right-0 w-16 h-16 border-b-4 border-r-4 border-yellow-400 rounded-br-lg"})]}),(0,Dt.jsx)("div",{className:"absolute top-4 left-4 right-4",children:(0,Dt.jsxs)("div",{className:"bg-black bg-opacity-50 text-white p-3 rounded-lg",children:[(0,Dt.jsx)("p",{className:"text-sm text-center",children:w?"Capturing photo...":"Point camera at a monument and tap the camera button"}),a.current&&4===a.current.readyState&&(0,Dt.jsx)("p",{className:"text-xs text-center text-green-400 mt-1",children:"\u2713 Camera active"})]})})]})}),x&&o&&(0,Dt.jsx)("div",{className:"w-full max-w-2xl",children:(0,Dt.jsxs)("div",{className:"bg-white bg-opacity-95 backdrop-blur-lg rounded-2xl p-6 shadow-2xl",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:o.name}),(0,Dt.jsxs)("p",{className:"text-gray-600 flex items-center",children:[(0,Dt.jsx)(Pa,{className:"w-4 h-4 mr-1"}),o.location]})]}),(0,Dt.jsxs)("div",{className:"text-right",children:[(0,Dt.jsxs)("div",{className:"flex items-center mb-1",children:[(0,Dt.jsx)(za,{className:"w-5 h-5 text-yellow-400 fill-current"}),(0,Dt.jsxs)("span",{className:"ml-1 font-semibold",children:[o.confidence,"%"]})]}),(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:"Recognition Confidence"})]})]}),(0,Dt.jsx)("div",{className:"mb-6",children:(0,Dt.jsx)("img",{src:o.image||"/api/placeholder/400/250",alt:o.name,className:"w-full h-48 object-cover rounded-lg shadow-md"})}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[(0,Dt.jsx)(Fa,{className:"w-5 h-5 mr-2 text-blue-600"}),"Historical Information"]}),(0,Dt.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,Dt.jsx)("p",{className:"text-gray-700 leading-relaxed",children:o.historicalInfo||o.description||"This magnificent monument stands as a testament to the rich cultural heritage and architectural brilliance of its era. Built with exquisite craftsmanship, it has witnessed centuries of history and continues to inspire visitors from around the world."})})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,Dt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,Dt.jsx)("h4",{className:"font-semibold text-blue-900 mb-2",children:"Year Built"}),(0,Dt.jsx)("p",{className:"text-blue-800",children:o.yearBuilt||"Unknown"})]}),(0,Dt.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,Dt.jsx)("h4",{className:"font-semibold text-green-900 mb-2",children:"Architectural Style"}),(0,Dt.jsx)("p",{className:"text-green-800",children:o.architecturalStyle||"Various"})]}),(0,Dt.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4",children:[(0,Dt.jsx)("h4",{className:"font-semibold text-purple-900 mb-2",children:"Cultural Significance"}),(0,Dt.jsx)("p",{className:"text-purple-800",children:o.culturalSignificance||"High"})]}),(0,Dt.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4",children:[(0,Dt.jsx)("h4",{className:"font-semibold text-orange-900 mb-2",children:"Visitor Rating"}),(0,Dt.jsx)("p",{className:"text-orange-800",children:o.rating||"4.5/5"})]})]}),(0,Dt.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,Dt.jsxs)(ut,{to:"/trip-packages?monument=".concat(encodeURIComponent(o.name),"&location=").concat(encodeURIComponent(o.location)),className:"bg-gradient-to-r from-green-500 to-teal-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-green-600 hover:to-teal-700 transition-all duration-200 flex items-center justify-center",children:[(0,Dt.jsx)(Ba,{className:"w-5 h-5 mr-2"}),"Book Visit Package"]}),(0,Dt.jsxs)("button",{onClick:()=>{l(null),y(!1),m(null)},className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors duration-200 flex items-center justify-center",children:[(0,Dt.jsx)(Wa,{className:"w-5 h-5 mr-2"}),"Scan Another Monument"]})]})]})}),p&&(0,Dt.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50",children:(0,Dt.jsxs)("div",{className:"bg-red-600 text-white px-6 py-3 rounded-lg shadow-lg flex items-center",children:[(0,Dt.jsx)(Oa,{className:"w-5 h-5 mr-2"}),p,(0,Dt.jsx)("button",{onClick:()=>m(null),className:"ml-4 text-white hover:text-gray-200",children:(0,Dt.jsx)(Oa,{className:"w-4 h-4"})})]})})]})]})})}):null:(0,Dt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 to-purple-900 flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"text-center text-white",children:[(0,Dt.jsx)(La,{className:"w-12 h-12 animate-spin mx-auto mb-4"}),(0,Dt.jsx)("p",{className:"text-xl",children:"Loading AI Model..."})]})})};const jG=function(){const e=Oe(),[t,n]=(0,B.useState)(!1),[a,s]=(0,B.useState)([{sender:"bot",text:"Hi there! I'm your travel assistant. How can I help you today?"}]),[r,i]=(0,B.useState)(""),[o,l]=(0,B.useState)(!1),[c,u]=(0,B.useState)(!1),[d,h]=(0,B.useState)(null),[p,m]=(0,B.useState)(""),[f,g]=(0,B.useState)("en"),x=(0,B.useRef)(null),y=(0,B.useRef)(null);(0,B.useEffect)(()=>{y.current&&y.current.scrollIntoView({behavior:"smooth"})},[a]);const b=t=>{const n=t.toLowerCase();if(n.includes("go to")||n.includes("navigate to")||n.includes("open")){const t={dashboard:"/dashboard","live location":"/live-location","live map":"/live-location",safety:"/safety",community:"/community",recommendations:"/recommendations",hotels:"/hotels-restaurants",restaurants:"/hotels-restaurants",booking:"/booking",signup:"/signup",login:"/login",flight:"/commute/flight",auto:"/commute/auto"};for(const[a,r]of Object.entries(t))if(n.includes(a)&&!n.includes("admin"))return void setTimeout(()=>{s(e=>[...e,{sender:"bot",text:"I'll take you to the ".concat(a," page right away!")}]),setTimeout(()=>e(r),1e3)},600)}let a="";a=n.includes("hello")||n.includes("hi")?"Hello! How can I assist you with your travel plans today?":n.includes("recommendation")||n.includes("suggest")?"I recommend checking out our Recommendations page for personalized travel suggestions based on your preferences!":n.includes("hotel")||n.includes("restaurant")||n.includes("stay")||n.includes("eat")?"You can find great hotels and restaurants in our Hotels & Restaurants section. Would you like me to take you there?":n.includes("safety")||n.includes("safe")||n.includes("emergency")?"Your safety is our priority! Check out our Safety features for emergency contacts, danger zone alerts, and more.":n.includes("flight")||n.includes("air")||n.includes("plane")?"We offer 8 different flight options with various airlines, aircraft types, and amenities. Would you like to check our flight booking page?":n.includes("auto")||n.includes("car")||n.includes("taxi")||n.includes("cab")?"We have 4 types of auto options: Regular, Premium, Shared, and Electric. Each has different pricing and features. Would you like to see our auto booking page?":n.includes("book")||n.includes("reservation")?"You can make bookings through our Booking page. We offer various options including flights and auto services. What type of booking are you interested in?":n.includes("booking status")||n.includes("my booking")||n.includes("check status")?"You can check your booking status on the Dashboard page. Your bookings may be pending, confirmed, or completed. Would you like to go to your dashboard?":n.includes("translate")||n.includes("translation")?"You can use our translation feature by clicking the Translate button at the bottom of the screen.":"I'm here to help with travel recommendations, navigation, and information. Feel free to ask about our features or where you'd like to go!",setTimeout(()=>{s(e=>[...e,{sender:"bot",text:a}])},600)},v=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0});x.current&&(x.current.srcObject=e)}catch(wq){console.error("Error accessing camera:",wq),alert("Could not access camera. Please check permissions.")}},w=()=>{if(x.current&&x.current.srcObject){x.current.srcObject.getTracks().forEach(e=>e.stop()),x.current.srcObject=null}},k=()=>{o?(l(!1),w(),h(null),m("")):(l(!0),v())};return(0,Dt.jsxs)("div",{className:"bg-white relative animate-fadeIn",children:[t?(0,Dt.jsxs)("div",{className:"fixed bottom-6 right-6 z-50 bg-white rounded-lg shadow-xl w-80 sm:w-96 max-h-96 flex flex-col",children:[(0,Dt.jsxs)("div",{className:"bg-primary-600 text-white p-4 rounded-t-lg flex justify-between items-center",children:[(0,Dt.jsx)("h3",{className:"font-medium",children:"Travel Assistant"}),(0,Dt.jsx)("button",{onClick:()=>n(!1),className:"text-white hover:text-gray-200",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,Dt.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[a.map((e,t)=>(0,Dt.jsx)("div",{className:"".concat("bot"===e.sender?"bg-gray-100 text-gray-800":"bg-primary-600 text-white ml-auto"," \n                  p-3 rounded-lg max-w-[80%] break-words"),children:e.text},t)),(0,Dt.jsx)("div",{ref:y})]}),(0,Dt.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!r.trim())return;const t={sender:"user",text:r};s([...a,t]),b(r),i("")},className:"border-t p-2 flex",children:[(0,Dt.jsx)("input",{type:"text",value:r,onChange:e=>i(e.target.value),placeholder:"Ask me anything...",className:"flex-1 border rounded-l-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500"}),(0,Dt.jsx)("button",{type:"submit",className:"bg-primary-600 text-white px-4 py-2 rounded-r-lg hover:bg-primary-700",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}):(0,Dt.jsx)("button",{onClick:()=>n(!0),className:"fixed bottom-6 right-6 z-50 bg-primary-600 text-white rounded-full p-4 shadow-lg hover:bg-primary-700 transition-all hover-lift","aria-label":"Open AI Assistant",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),(0,Dt.jsx)("button",{onClick:()=>u(!0),className:"fixed bottom-20 left-6 z-50 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-full p-4 shadow-lg hover:from-purple-700 hover:to-blue-700 transition-all transform hover:scale-105","aria-label":"Open AR Monument Guide",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),o?(0,Dt.jsx)("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[(0,Dt.jsxs)("div",{className:"bg-secondary-600 text-white p-4 rounded-t-lg flex justify-between items-center",children:[(0,Dt.jsx)("h3",{className:"font-medium",children:"Translation Tool"}),(0,Dt.jsx)("button",{onClick:k,className:"text-white hover:text-gray-200",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,Dt.jsx)("div",{className:"p-4",children:d?(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("div",{className:"mb-4",children:(0,Dt.jsx)("img",{src:d,alt:"Captured",className:"w-full rounded-lg"})}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Translate to:"}),(0,Dt.jsxs)("select",{value:f,onChange:e=>g(e.target.value),className:"w-full border rounded-md py-2 px-3",children:[(0,Dt.jsx)("option",{value:"en",children:"English"}),(0,Dt.jsx)("option",{value:"es",children:"Spanish"}),(0,Dt.jsx)("option",{value:"fr",children:"French"}),(0,Dt.jsx)("option",{value:"de",children:"German"}),(0,Dt.jsx)("option",{value:"hi",children:"Hindi"}),(0,Dt.jsx)("option",{value:"ja",children:"Japanese"}),(0,Dt.jsx)("option",{value:"zh",children:"Chinese"})]})]}),p?(0,Dt.jsxs)("div",{className:"mb-4 p-3 bg-gray-100 rounded-lg",children:[(0,Dt.jsx)("h4",{className:"font-medium mb-1",children:"Translation:"}),(0,Dt.jsx)("p",{children:p})]}):(0,Dt.jsxs)("div",{className:"flex justify-center items-center py-4",children:[(0,Dt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-secondary-600"}),(0,Dt.jsx)("span",{className:"ml-2",children:"Translating..."})]}),(0,Dt.jsxs)("div",{className:"flex space-x-2",children:[(0,Dt.jsx)("button",{onClick:()=>{h(null),m(""),v()},className:"flex-1 bg-gray-200 py-2 rounded-lg hover:bg-gray-300",children:"Try Again"}),(0,Dt.jsx)("button",{onClick:k,className:"flex-1 bg-secondary-600 text-white py-2 rounded-lg hover:bg-secondary-700",children:"Done"})]})]}):(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("div",{className:"bg-black rounded-lg overflow-hidden mb-4 aspect-video",children:(0,Dt.jsx)("video",{ref:x,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"})}),(0,Dt.jsx)("button",{onClick:()=>{if(x.current){const e=document.createElement("canvas");e.width=x.current.videoWidth,e.height=x.current.videoHeight;e.getContext("2d").drawImage(x.current,0,0,e.width,e.height);const t=e.toDataURL("image/png");h(t),w(),setTimeout(()=>{m("This is a simulated translation of text detected in the image. In a production environment, this would use OCR and translation APIs to provide real translations.")},1500)}},className:"w-full bg-secondary-600 text-white py-2 rounded-lg hover:bg-secondary-700",children:"Capture Image"})]})})]})}):(0,Dt.jsx)("button",{onClick:k,className:"fixed bottom-6 left-6 z-50 bg-secondary-600 text-white rounded-full p-4 shadow-lg hover:bg-secondary-700 transition-all","aria-label":"Open Translation Tool",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})})}),(0,Dt.jsxs)("div",{className:"relative bg-primary-600",children:[(0,Dt.jsxs)("div",{className:"absolute inset-0",children:[(0,Dt.jsx)("img",{className:"w-full h-full object-cover",src:"https://png.pngtree.com/thumb_back/fw800/back_our/20190619/ourmid/pngtree-travel-around-the-world-travel-poster-template-image_140335.jpg",alt:"Travel background"}),(0,Dt.jsx)("div",{className:"absolute inset-0 bg-transparent mix-blend-multiply opacity-60"})]}),(0,Dt.jsxs)("div",{className:"relative max-w-7xl mx-auto py-24 px-4 sm:py-32 sm:px-6 lg:px-8",children:[(0,Dt.jsx)("h1",{className:"text-4xl font-extrabold tracking-tight text-black sm:text-5xl lg:text-6xl",children:"Capture Your Travel Journey"}),(0,Dt.jsx)("p",{className:"mt-6 max-w-3xl text-xl text-black-primary-100",children:"Record your trips, discover new places, and travel safely with our comprehensive travel companion."}),(0,Dt.jsxs)("div",{className:"mt-10 flex flex-col sm:flex-row gap-4",children:[(0,Dt.jsx)(ut,{to:"/signup",className:"inline-flex items-center justify-center px-5 py-3 border border-transparent text-base font-medium rounded-md text-white bg-secondary-600 hover:bg-secondary-700",children:"Get Started"}),(0,Dt.jsx)(ut,{to:"/dashboard",className:"inline-flex items-center justify-center px-5 py-3 border border-transparent text-base font-medium rounded-md text-primary-700 bg-white hover:bg-primary-50",children:"Explore Features"})]})]})]}),(0,Dt.jsx)("div",{className:"py-16 bg-gray-50 overflow-hidden",children:(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsx)("h2",{className:"text-base font-semibold text-primary-600 tracking-wide uppercase",children:"Features"}),(0,Dt.jsx)("p",{className:"mt-1 text-4xl font-extrabold text-gray-900 sm:text-5xl sm:tracking-tight",children:"Everything you need for your travels"}),(0,Dt.jsx)("p",{className:"max-w-xl mt-5 mx-auto text-xl text-gray-500",children:"Our app helps you capture trip data, stay safe, and make your travel experiences more enjoyable."})]}),(0,Dt.jsx)("div",{className:"mt-16",children:(0,Dt.jsxs)("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-4",children:[(0,Dt.jsx)("div",{className:"pt-6",children:(0,Dt.jsx)("div",{className:"flow-root bg-white rounded-lg px-6 pb-8 shadow-md",children:(0,Dt.jsxs)("div",{className:"-mt-6",children:[(0,Dt.jsx)("div",{children:(0,Dt.jsx)("span",{className:"inline-flex items-center justify-center p-3 bg-primary-500 rounded-md shadow-lg",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})})}),(0,Dt.jsx)("h3",{className:"mt-8 text-lg font-medium text-gray-900 tracking-tight",children:"Trip Management"}),(0,Dt.jsx)("p",{className:"mt-5 text-base text-gray-500",children:"Record your trips with detailed information including origin, destination, mode of transport, and more."}),(0,Dt.jsx)("div",{className:"mt-5",children:(0,Dt.jsx)(ut,{to:"/dashboard",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Learn more \u2192"})})]})})}),(0,Dt.jsx)("div",{className:"pt-6",children:(0,Dt.jsx)("div",{className:"bg-white rounded-lg px-6 pb-8 shadow-md flex flex-col h-full",children:(0,Dt.jsxs)("div",{className:"-mt-6 flex-1 flex flex-col",children:[(0,Dt.jsx)("div",{children:(0,Dt.jsx)("span",{className:"inline-flex items-center justify-center p-3 bg-primary-500 rounded-md shadow-lg",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"})})})}),(0,Dt.jsx)("h3",{className:"mt-8 text-lg font-medium text-gray-900 tracking-tight",children:"Live Map"}),(0,Dt.jsx)("p",{className:"mt-5 text-base text-gray-500",children:"Track your real-time location on an interactive map and share your journey with friends and family."}),(0,Dt.jsx)("div",{className:"mt-5",children:(0,Dt.jsx)(ut,{to:"/live-location",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Try Live Map \u2192"})})]})})}),(0,Dt.jsx)("div",{className:"pt-6",children:(0,Dt.jsx)("div",{className:"flow-root bg-white rounded-lg px-6 pb-8 shadow-md",children:(0,Dt.jsxs)("div",{className:"-mt-6",children:[(0,Dt.jsx)("div",{children:(0,Dt.jsx)("span",{className:"inline-flex items-center justify-center p-3 bg-primary-500 rounded-md shadow-lg",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})}),(0,Dt.jsx)("h3",{className:"mt-8 text-lg font-medium text-gray-900 tracking-tight",children:"Safety Features"}),(0,Dt.jsx)("p",{className:"mt-5 text-base text-gray-500",children:"Stay safe with danger zone alerts, SOS button, and trusted contact sharing for emergencies."}),(0,Dt.jsx)("div",{className:"mt-5",children:(0,Dt.jsx)(ut,{to:"/safety",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Learn more \u2192"})})]})})}),(0,Dt.jsx)("div",{className:"pt-6",children:(0,Dt.jsx)("div",{className:"flow-root bg-white rounded-lg px-6 pb-8 shadow-md",children:(0,Dt.jsxs)("div",{className:"-mt-6",children:[(0,Dt.jsx)("div",{children:(0,Dt.jsx)("span",{className:"inline-flex items-center justify-center p-3 bg-primary-500 rounded-md shadow-lg",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})}),(0,Dt.jsx)("h3",{className:"mt-8 text-lg font-medium text-gray-900 tracking-tight",children:"Community"}),(0,Dt.jsx)("p",{className:"mt-5 text-base text-gray-500",children:"Connect with other travelers, read reviews, join forums, and find travel buddies for your next adventure."}),(0,Dt.jsx)("div",{className:"mt-5",children:(0,Dt.jsx)(ut,{to:"/community",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Learn more \u2192"})})]})})})]})})]})}),(0,Dt.jsx)("div",{className:"py-16 bg-white overflow-hidden",children:(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsx)("h2",{className:"text-base font-semibold text-primary-600 tracking-wide uppercase",children:"How It Works"}),(0,Dt.jsx)("p",{className:"mt-1 text-4xl font-extrabold text-gray-900 sm:text-5xl sm:tracking-tight",children:"Simple steps to get started"})]}),(0,Dt.jsx)("div",{className:"mt-16",children:(0,Dt.jsxs)("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-md bg-primary-500 text-white mx-auto",children:(0,Dt.jsx)("span",{className:"text-lg font-bold",children:"1"})}),(0,Dt.jsx)("h3",{className:"mt-5 text-lg leading-6 font-medium text-gray-900",children:"Create an account"}),(0,Dt.jsx)("p",{className:"mt-2 text-base text-gray-500",children:"Sign up with your email or phone number and set up your profile to get started."})]}),(0,Dt.jsxs)("div",{className:"mt-10 lg:mt-0 text-center",children:[(0,Dt.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-md bg-primary-500 text-white mx-auto",children:(0,Dt.jsx)("span",{className:"text-lg font-bold",children:"2"})}),(0,Dt.jsx)("h3",{className:"mt-5 text-lg leading-6 font-medium text-gray-900",children:"Record your trips"}),(0,Dt.jsx)("p",{className:"mt-2 text-base text-gray-500",children:"Enter your trip details including origin, destination, mode of transport, and more."})]}),(0,Dt.jsxs)("div",{className:"mt-10 lg:mt-0 text-center",children:[(0,Dt.jsx)("div",{className:"flex items-center justify-center h-12 w-12 rounded-md bg-primary-500 text-white mx-auto",children:(0,Dt.jsx)("span",{className:"text-lg font-bold",children:"3"})}),(0,Dt.jsx)("h3",{className:"mt-5 text-lg leading-6 font-medium text-gray-900",children:"Enjoy the benefits"}),(0,Dt.jsx)("p",{className:"mt-2 text-base text-gray-500",children:"Get personalized recommendations and travel safely with our features."})]})]})})]})}),(0,Dt.jsx)("div",{className:"bg-primary-700",children:(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:py-16 lg:px-8 lg:flex lg:items-center lg:justify-between",children:[(0,Dt.jsxs)("h2",{className:"text-3xl font-extrabold tracking-tight text-white sm:text-4xl",children:[(0,Dt.jsx)("span",{className:"block",children:"Ready to get started?"}),(0,Dt.jsx)("span",{className:"block text-primary-300",children:"Join thousands of travelers today."})]}),(0,Dt.jsxs)("div",{className:"mt-8 flex lg:mt-0 lg:flex-shrink-0",children:[(0,Dt.jsx)("div",{className:"inline-flex rounded-md shadow",children:(0,Dt.jsx)(ut,{to:"/signup",className:"inline-flex items-center justify-center px-5 py-3 border border-transparent text-base font-medium rounded-md text-primary-600 bg-white hover:bg-primary-50",children:"Sign up for free"})}),(0,Dt.jsx)("div",{className:"ml-3 inline-flex rounded-md shadow",children:(0,Dt.jsx)(ut,{to:"/login",className:"inline-flex items-center justify-center px-5 py-3 border border-transparent text-base font-medium rounded-md text-white bg-primary-600 hover:bg-primary-500",children:"Login"})})]})]})}),(0,Dt.jsx)(CG,{isOpen:c,onClose:()=>u(!1)})]})},TG=Zn("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),IG=Zn("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),EG=Zn("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),AG=Zn("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);const RG=function(){const[e,t]=(0,B.useState)([]);(0,B.useEffect)(()=>{n()},[]);const n=()=>{const e=On();t(e)},a=e=>{if(window.confirm("Are you sure you want to delete this booking? This action cannot be undone.")){!function(e){const t=On().filter(t=>t.id!==e);localStorage.setItem("bookings",JSON.stringify(t))}(e),n();const t=document.createElement("div");t.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fadeIn",t.innerHTML='\n        <div class="bg-white rounded-lg p-6 max-w-sm mx-4 animate-scaleIn">\n          <div class="text-center">\n            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">\n              <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>\n              </svg>\n            </div>\n            <h3 class="text-lg font-bold text-gray-900 mb-1">Booking Deleted</h3>\n            <p class="text-sm text-gray-600">Your booking has been successfully deleted.</p>\n          </div>\n        </div>\n      ',document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},2e3)}},s=e.reduce((e,t)=>{const n=t.type||"Other";return e[n]||(e[n]=[]),e[n].push(t),e},{});return(0,Dt.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[(0,Dt.jsxs)("div",{className:"px-4 py-5 sm:px-6",children:[(0,Dt.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Your Bookings"}),(0,Dt.jsx)("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Recent travel bookings and reservations"})]}),Object.keys(s).length>0?(0,Dt.jsx)("div",{className:"border-t border-gray-200",children:Object.entries(s).map(e=>{let[t,s]=e;return(0,Dt.jsxs)("div",{className:"px-4 py-5 sm:p-6 border-b border-gray-200",children:[(0,Dt.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-4",children:[t," Bookings"]}),(0,Dt.jsx)("div",{className:"space-y-4",children:s.map((e,t)=>(0,Dt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h5",{className:"font-medium",children:e.name||"Booking"}),e.from&&e.to&&(0,Dt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.from," \u2192 ",e.to]}),e.date&&(0,Dt.jsxs)("p",{className:"text-sm text-gray-600",children:[new Date(e.date).toLocaleDateString(),e.time&&" at ".concat(e.time)]})]}),(0,Dt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("Active"===e.status?"bg-green-100 text-green-800":"Completed"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:["Active"===e.status&&(0,Dt.jsx)(IG,{className:"w-3 h-3 mr-1"}),"Completed"===e.status&&(0,Dt.jsx)(EG,{className:"w-3 h-3 mr-1"}),e.status||"Confirmed"]})]}),e.details&&(0,Dt.jsx)("div",{className:"mt-2 text-sm text-gray-500",children:Object.entries(e.details).map(e=>{let[t,n]=e;return(0,Dt.jsxs)("div",{className:"flex mt-1",children:[(0,Dt.jsxs)("span",{className:"font-medium w-24",children:[t,":"]}),(0,Dt.jsx)("span",{children:n})]},t)})}),(0,Dt.jsx)("div",{className:"mt-3 flex gap-2",children:"Active"===e.status&&(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsxs)("button",{onClick:()=>(e=>{if(window.confirm("Are you sure you want to mark this booking as completed?")){zn(e,"Completed"),n();const t=document.createElement("div");t.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fadeIn",t.innerHTML='\n        <div class="bg-white rounded-lg p-6 max-w-sm mx-4 animate-scaleIn">\n          <div class="text-center">\n            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">\n              <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n              </svg>\n            </div>\n            <h3 class="text-lg font-bold text-gray-900 mb-1">Booking Completed</h3>\n            <p class="text-sm text-gray-600">Your booking has been marked as completed.</p>\n          </div>\n        </div>\n      ',document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},2e3)}})(e.id),className:"flex items-center px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors duration-200",children:[(0,Dt.jsx)(EG,{className:"w-3 h-3 mr-1"}),"Complete"]}),(0,Dt.jsxs)("button",{onClick:()=>a(e.id),className:"flex items-center px-3 py-1 text-xs bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors duration-200",children:[(0,Dt.jsx)(AG,{className:"w-3 h-3 mr-1"}),"Delete"]})]})})]},t))})]},t)})}):(0,Dt.jsxs)("div",{className:"border-t border-gray-200 px-4 py-12 text-center",children:[(0,Dt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),(0,Dt.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No bookings yet"}),(0,Dt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Your travel bookings will appear here once you make reservations."})]})]})},MG=["center","children"],LG=ka(function(e,t){let{center:n,children:a}=e,s=pt(e,MG);const r=new ia.Circle(n,s);return pa(r,na(t,{overlayContainer:r}))},Ca),DG=["positions"],OG=ka(function(e,t){let{positions:n}=e,a=pt(e,DG);const s=new ia.Polyline(n,a);return pa(s,na(t,{overlayContainer:s}))},function(e,t,n){t.positions!==n.positions&&e.setLatLngs(t.positions)});delete oa().Icon.Default.prototype._getIconUrl,oa().Icon.Default.mergeOptions({iconRetinaUrl:n(249),iconUrl:n(24),shadowUrl:n(71)});const FG=function(e){let{trips:t}=e;const[n,a]=(0,B.useState)(t),[s,r]=(0,B.useState)([]),[i,o]=(0,B.useState)(!1),[l,c]=(0,B.useState)(null),[u,d]=(0,B.useState)(null),[h,p]=(0,B.useState)([]),[m,f]=(0,B.useState)(null),{isAuthenticated:g}=Pt(),x=(0,B.useRef)(null);(0,B.useEffect)(()=>{const e=On();r(e)},[]),(0,B.useEffect)(()=>{let e;return i&&l&&(navigator.geolocation.getCurrentPosition(e=>{const{latitude:t,longitude:n}=e.coords;d([t,n]),y([t,n],l)},e=>{console.error("Error getting location:",e),alert("Could not get your current location. Please check your browser permissions."),o(!1)}),e=navigator.geolocation.watchPosition(e=>{const{latitude:t,longitude:n}=e.coords;d([t,n])},e=>{console.error("Error watching location:",e)})),()=>{e&&navigator.geolocation.clearWatch(e)}},[i,l]);const y=(e,t)=>{const n=e[0]+.01,a=e[1]+.01,s=[e,[e[0]+.002,e[1]+.003],[e[0]+.005,e[1]+.005],[e[0]+.008,e[1]+.008],[n,a]];p(s)},b=e=>{if(!g())return void alert("Please sign in to delete trips");const t=n.filter(t=>t.id!==e);a(t);const s=On().filter(t=>t.id!==e);localStorage.setItem("bookings",JSON.stringify(s)),r(s);const i=JSON.parse(localStorage.getItem("tripPackages")||"[]").filter(t=>t.id!==e);localStorage.setItem("tripPackages",JSON.stringify(i)),alert("Trip deleted successfully")},v=e=>{const t=[...n||[],...s||[]].find(t=>t.id===e);if(t){c(t),o(!0);const e=document.getElementById("trip-route-map");e&&e.scrollIntoView({behavior:"smooth"})}};if((!n||0===n.length)&&(!s||0===s.length))return(0,Dt.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:(0,Dt.jsxs)("div",{className:"text-center py-10",children:[(0,Dt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),(0,Dt.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No trips"}),(0,Dt.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new trip."})]})});if(i&&u){const e=[{id:1,name:"Construction Site",level:"high",lat:u[0]+.003,lng:u[1]+.002,description:"Heavy machinery and construction work in progress."},{id:2,name:"Flood Risk Area",level:"moderate",lat:u[0]-.002,lng:u[1]+.004,description:"Area prone to flooding during heavy rainfall."},{id:3,name:"Traffic Congestion",level:"moderate",lat:u[0]+.005,lng:u[1]-.003,description:"Heavy traffic congestion reported in this area."}],t=e=>{const t="high"===e.level?.4:.3;return[50,100,150].map((n,a)=>{const s=t-.1*a;return(0,Dt.jsx)(LG,{center:[e.lat,e.lng],radius:n,pathOptions:{color:"high"===e.level?"#ef4444":"#f59e0b",fillColor:"high"===e.level?"#ef4444":"#f59e0b",fillOpacity:s},eventHandlers:{click:()=>f(e)}},"".concat(e.id,"-").concat(n))})};return(0,Dt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Dt.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Live Trip Tracking: ",(null===l||void 0===l?void 0:l.name)||(null!==l&&void 0!==l&&l.from&&null!==l&&void 0!==l&&l.to?"".concat(l.from," \u2192 ").concat(l.to):"Trip")]}),(0,Dt.jsx)("button",{onClick:()=>o(!1),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-md text-sm hover:bg-gray-200",children:"Back to Trips"})]}),(0,Dt.jsxs)("div",{id:"trip-route-map",className:"h-96 w-full rounded-lg overflow-hidden border border-gray-200",children:[(0,Dt.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,Dt.jsxs)("button",{onClick:()=>o(!i),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 shadow-md flex items-center",children:[(0,Dt.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),i?"Stop Tracking":"Track Route"]})}),(0,Dt.jsxs)(da,{center:u,zoom:14,style:{height:"100%",width:"100%"},ref:x,children:[(0,Dt.jsx)(_a,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,Dt.jsx)(Ea,{position:u,children:(0,Dt.jsx)(Aa,{children:"Your current location"})}),h.length>0&&(0,Dt.jsx)(Ea,{position:h[h.length-1],children:(0,Dt.jsxs)(Aa,{children:["Destination: ",(null===l||void 0===l?void 0:l.to)||"Destination"]})}),h.length>0&&(0,Dt.jsx)(OG,{positions:h,color:"blue",weight:5,opacity:.7}),e.map(e=>(0,Dt.jsxs)(B.Fragment,{children:[t(e),(0,Dt.jsx)(Ea,{position:[e.lat,e.lng],children:(0,Dt.jsx)(Aa,{children:(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"font-medium",children:e.name}),(0,Dt.jsx)("p",{className:"text-sm",children:e.description}),(0,Dt.jsx)("p",{className:"text-xs mt-1",children:(0,Dt.jsxs)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium ".concat("high"===e.level?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"," capitalize"),children:[e.level," risk"]})})]})})})]},e.id))]})]}),(0,Dt.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,Dt.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Trip Information"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-sm text-gray-600",children:"From:"}),(0,Dt.jsx)("p",{className:"font-medium",children:(null===l||void 0===l?void 0:l.from)||"Starting Point"})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-sm text-gray-600",children:"To:"}),(0,Dt.jsx)("p",{className:"font-medium",children:(null===l||void 0===l?void 0:l.to)||"Destination"})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-sm text-gray-600",children:"Estimated Arrival:"}),(0,Dt.jsxs)("p",{className:"font-medium",children:[new Date(Date.now()+12e5).toLocaleTimeString(),(0,Dt.jsx)("span",{className:"text-sm text-gray-500 ml-1",children:"(~20 min)"})]})]})]})]}),m&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Dt.jsx)("h3",{className:"text-xl font-medium text-gray-900",children:m.name}),(0,Dt.jsx)("button",{onClick:()=>f(null),className:"text-gray-400 hover:text-gray-500",children:(0,Dt.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Dt.jsx)("div",{className:"p-3 mb-4 rounded-md ".concat("high"===m.level?"bg-red-50":"bg-yellow-50"),children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full flex items-center justify-center ".concat("high"===m.level?"bg-red-100 text-red-600":"bg-yellow-100 text-yellow-600"),children:(0,Dt.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,Dt.jsx)("div",{className:"ml-3",children:(0,Dt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("high"===m.level?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"," capitalize"),children:[m.level," risk level"]})})]})}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:m.description})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Safety Tips"}),(0,Dt.jsx)("ul",{className:"list-disc pl-5 text-sm text-gray-600 space-y-1",children:"high"===m.level?(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("li",{children:"Avoid this area if possible"}),(0,Dt.jsx)("li",{children:"Stay alert and follow safety instructions"}),(0,Dt.jsx)("li",{children:"Consider alternative routes"})]}):(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("li",{children:"Proceed with caution"}),(0,Dt.jsx)("li",{children:"Be aware of your surroundings"}),(0,Dt.jsx)("li",{children:"Follow local guidance"})]})})]}),(0,Dt.jsx)("div",{className:"flex justify-end",children:(0,Dt.jsx)("button",{onClick:()=>f(null),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Close"})})]})})]})}return n&&0!==n.length?(0,Dt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md overflow-x-auto",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Trip Flow Visualization"}),(0,Dt.jsx)("div",{className:"min-w-max",children:(0,Dt.jsx)("div",{className:"flex flex-col space-y-8",children:n.map((e,t)=>(0,Dt.jsxs)("div",{className:"relative",children:[t<n.length-1&&(0,Dt.jsx)("div",{className:"absolute left-6 top-full h-8 w-0.5 bg-gray-300 z-0"}),(0,Dt.jsxs)("div",{className:"flex items-start relative z-10",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 h-12 w-12 rounded-full bg-primary-100 flex items-center justify-center border-2 border-primary-500",children:(0,Dt.jsx)("span",{className:"text-primary-700 font-medium",children:t+1})}),(0,Dt.jsx)("div",{className:"ml-4 flex-grow bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 overflow-hidden",children:(0,Dt.jsxs)("div",{className:"p-4",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("h4",{className:"text-base font-medium text-gray-900",children:[e.origin," \u2192 ",e.destination]}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[new Date(e.originTime).toLocaleString()," - ",new Date(e.destinationTime).toLocaleString()]})]}),(0,Dt.jsxs)("div",{className:"flex-shrink-0 flex space-x-2",children:[(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize",children:e.mode}),(0,Dt.jsx)("button",{onClick:()=>v(e.id),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-md text-xs hover:bg-blue-200",children:"Track"}),(0,Dt.jsx)("button",{onClick:()=>b(e.id),className:"px-3 py-1 bg-red-100 text-red-700 rounded-md text-xs hover:bg-red-200",children:"Delete"})]})]}),e.purpose&&(0,Dt.jsxs)("div",{className:"mt-2",children:[(0,Dt.jsx)("span",{className:"text-sm text-gray-700",children:"Purpose: "}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.purpose})]}),e.accompaniedBy&&e.accompaniedBy.length>0&&(0,Dt.jsxs)("div",{className:"mt-2",children:[(0,Dt.jsx)("span",{className:"text-sm text-gray-700",children:"Accompanied by: "}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.accompaniedBy.map(e=>e.name).join(", ")})]}),(0,Dt.jsxs)("div",{className:"mt-3 flex justify-end space-x-2",children:[(0,Dt.jsx)("button",{className:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Edit"}),(0,Dt.jsx)("button",{className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-primary-700 bg-primary-100 hover:bg-primary-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Details"}),(0,Dt.jsx)("button",{onClick:()=>b(e.id),className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete"})]})]})})]})]},e.id||t))})})]}):(0,Dt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Your Bookings"}),(0,Dt.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,Dt.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,Dt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h4",{className:"text-base font-medium text-gray-900",children:e.name||(e.from&&e.to?"".concat(e.from," \u2192 ").concat(e.to):"Booking")}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.date," ",e.time&&"at ".concat(e.time)]}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Type: ",e.type||"Trip"]})]}),(0,Dt.jsxs)("div",{className:"flex-shrink-0 flex space-x-2",children:[(0,Dt.jsx)("button",{onClick:()=>v(e.id),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-md text-sm hover:bg-blue-200",children:"Track"}),g()&&(0,Dt.jsx)("button",{onClick:()=>b(e.id),className:"px-3 py-1 bg-red-100 text-red-700 rounded-md text-sm hover:bg-red-200",children:"Delete"})]})]})},e.id))})]})},PG=Zn("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),zG=Zn("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]),BG=Zn("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),WG=Zn("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]),VG=Zn("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);const UG=function(e){let{origin:t,destination:n,waypoints:a=[]}=e;const[s,r]=(0,B.useState)(!1),[i,o]=(0,B.useState)({distance:"12.5 km",duration:"25 mins",traffic:"Light",tolls:2});(0,B.useEffect)(()=>{setTimeout(()=>r(!0),500)},[]),(0,B.useEffect)(()=>{t&&n&&o((()=>{const e=20*Math.random()+5,t=40*Math.random()+15;return{distance:"".concat(e.toFixed(1)," km"),duration:"".concat(Math.round(t)," mins"),traffic:["Light","Moderate","Heavy"][Math.floor(3*Math.random())],tolls:Math.floor(4*Math.random())}})())},[t,n]);const l=()=>{const e=[],t=a.length+2;e.push({x:50,y:30}),a.forEach((n,a)=>{e.push({x:50+(a+1)*(100/t),y:30+20*Math.sin(.5*a)+20*Math.random()})}),e.push({x:150,y:70});let n="M ".concat(e[0].x," ").concat(e[0].y);for(let a=1;a<e.length;a++){const t=e[a-1],s=e[a],r=(t.x+s.x)/2,i=(t.y+s.y)/2+10*Math.random();n+=" Q ".concat(r," ").concat(i," ").concat(s.x," ").concat(s.y)}return n};return(0,Dt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200",children:[(0,Dt.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-4",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("h3",{className:"text-lg font-semibold text-white flex items-center",children:[(0,Dt.jsx)(PG,{className:"w-5 h-5 mr-2"}),"Trip Route Visualization"]}),(0,Dt.jsxs)("p",{className:"text-blue-100 text-sm mt-1",children:[t," \u2192 ",n]})]}),(0,Dt.jsx)("div",{className:"bg-white bg-opacity-20 rounded-lg px-3 py-1",children:(0,Dt.jsxs)("span",{className:"text-white text-sm font-medium",children:[a.length+1," stops"]})})]})}),(0,Dt.jsxs)("div",{className:"relative bg-gradient-to-br from-blue-50 to-indigo-100 h-80 w-full overflow-hidden",children:[(0,Dt.jsx)("div",{className:"absolute inset-0 opacity-20",children:(0,Dt.jsxs)("svg",{width:"100%",height:"100%",children:[(0,Dt.jsx)("defs",{children:(0,Dt.jsx)("pattern",{id:"grid",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:(0,Dt.jsx)("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"#3B82F6",strokeWidth:"0.5"})})}),(0,Dt.jsx)("rect",{width:"100%",height:"100%",fill:"url(#grid)"})]})}),!s&&(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,Dt.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading interactive map..."})]})}),s&&(0,Dt.jsxs)("div",{className:"relative w-full h-full",children:[(0,Dt.jsxs)("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 200 100",children:[(0,Dt.jsx)("path",{d:l(),stroke:"#E5E7EB",strokeWidth:"4",fill:"none",strokeDasharray:"2,2"}),(0,Dt.jsx)("path",{d:l(),stroke:"url(#routeGradient)",strokeWidth:"3",fill:"none",strokeDasharray:"10,5",className:"animate-pulse"}),(0,Dt.jsx)("defs",{children:(0,Dt.jsxs)("linearGradient",{id:"routeGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,Dt.jsx)("stop",{offset:"0%",stopColor:"#3B82F6"}),(0,Dt.jsx)("stop",{offset:"50%",stopColor:"#8B5CF6"}),(0,Dt.jsx)("stop",{offset:"100%",stopColor:"#EC4899"})]})})]}),(0,Dt.jsxs)("div",{className:"absolute top-1/4 left-1/4 transform -translate-x-1/2 -translate-y-1/2 group",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("div",{className:"h-6 w-6 rounded-full bg-green-500 border-4 border-white shadow-lg animate-pulse"}),(0,Dt.jsx)("div",{className:"absolute -top-1 -left-1 h-8 w-8 rounded-full bg-green-500 opacity-30 animate-ping"})]}),(0,Dt.jsxs)("div",{className:"absolute top-8 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-3 py-1 rounded-lg text-xs font-medium shadow-lg whitespace-nowrap group-hover:scale-105 transition-transform",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Pa,{className:"w-3 h-3 mr-1"}),t]}),(0,Dt.jsx)("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-green-600 rotate-45"})]})]}),(0,Dt.jsxs)("div",{className:"absolute bottom-1/4 right-1/4 transform -translate-x-1/2 -translate-y-1/2 group",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("div",{className:"h-6 w-6 rounded-full bg-red-500 border-4 border-white shadow-lg animate-pulse"}),(0,Dt.jsx)("div",{className:"absolute -top-1 -left-1 h-8 w-8 rounded-full bg-red-500 opacity-30 animate-ping"})]}),(0,Dt.jsxs)("div",{className:"absolute top-8 left-1/2 transform -translate-x-1/2 bg-red-600 text-white px-3 py-1 rounded-lg text-xs font-medium shadow-lg whitespace-nowrap group-hover:scale-105 transition-transform",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Pa,{className:"w-3 h-3 mr-1"}),n]}),(0,Dt.jsx)("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-red-600 rotate-45"})]})]}),a.map((e,t)=>(0,Dt.jsxs)("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 group",style:{top:"".concat(25+15*t,"%"),left:"".concat(30+20*t,"%")},children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("div",{className:"h-5 w-5 rounded-full bg-blue-500 border-3 border-white shadow-md animate-bounce",style:{animationDelay:"".concat(.2*t,"s")}}),(0,Dt.jsx)("div",{className:"absolute -inset-1 rounded-full bg-blue-500 opacity-20 animate-ping",style:{animationDelay:"".concat(.2*t,"s")}})]}),(0,Dt.jsxs)("div",{className:"absolute top-7 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium shadow-md whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity",children:[e.name,(0,Dt.jsx)("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-blue-600 rotate-45"})]})]},t)),(0,Dt.jsxs)("div",{className:"absolute top-4 right-4 flex space-x-2",children:[(0,Dt.jsx)("button",{className:"bg-white bg-opacity-90 hover:bg-opacity-100 rounded-lg p-2 shadow-md transition-all duration-200 hover:scale-105",children:(0,Dt.jsx)(zG,{className:"w-4 h-4 text-gray-600"})}),(0,Dt.jsx)("button",{className:"bg-white bg-opacity-90 hover:bg-opacity-100 rounded-lg p-2 shadow-md transition-all duration-200 hover:scale-105",children:(0,Dt.jsx)(BG,{className:"w-4 h-4 text-gray-600"})})]})]})]}),(0,Dt.jsxs)("div",{className:"p-4 bg-gradient-to-r from-gray-50 to-blue-50",children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,Dt.jsx)("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-gray-100",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"Distance"}),(0,Dt.jsx)("p",{className:"text-lg font-bold text-gray-900",children:i.distance})]}),(0,Dt.jsx)(zG,{className:"w-5 h-5 text-blue-500"})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-gray-100",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"Duration"}),(0,Dt.jsx)("p",{className:"text-lg font-bold text-gray-900",children:i.duration})]}),(0,Dt.jsx)(IG,{className:"w-5 h-5 text-green-500"})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-gray-100",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"Traffic"}),(0,Dt.jsx)("p",{className:"text-lg font-bold text-gray-900",children:i.traffic})]}),(0,Dt.jsx)(WG,{className:"w-5 h-5 text-orange-500"})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-gray-100",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-xs text-gray-500 font-medium",children:"Tolls"}),(0,Dt.jsx)("p",{className:"text-lg font-bold text-gray-900",children:i.tolls})]}),(0,Dt.jsx)(VG,{className:"w-5 h-5 text-purple-500"})]})})]}),(0,Dt.jsxs)("div",{className:"mt-4 bg-white rounded-lg p-4 shadow-sm border border-gray-100",children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Dt.jsx)("h4",{className:"text-sm font-semibold text-gray-900",children:"Route Summary"}),(0,Dt.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,Dt.jsx)(za,{className:"w-3 h-3 mr-1 text-yellow-500"}),"Recommended Route"]})]}),(0,Dt.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,Dt.jsxs)("p",{children:["Fastest route with minimal traffic, ",a.length," stops along the way"]}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Updated just now \u2022 Live traffic data"})]})]})]})]})};const HG=function(){const e=Le(),[t,n]=(0,B.useState)([]),[a,s]=(0,B.useState)(!1),[r,i]=(0,B.useState)(!1);return(0,B.useEffect)(()=>{var t;const a=On().map(e=>{var t;return{id:e.id||Date.now().toString(),tripNumber:e.id||"TRIP-".concat(Date.now().toString().slice(-4)),origin:e.from||"Origin",originTime:e.departureTime||(new Date).toISOString(),destination:e.to||"Destination",destinationTime:e.arrivalTime||(new Date).toISOString(),mode:(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())||"car",purpose:e.purpose||"travel",accompaniedBy:e.passengers||[],notes:e.notes||""}});n(a),s(Pn()),null!==(t=e.state)&&void 0!==t&&t.shoppingConfirmed&&(i(!0),setTimeout(()=>i(!1),5e3))},[e.state]),(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Trip Management Dashboard"}),a?(0,Dt.jsxs)("div",{className:"flex items-center space-x-2 bg-yellow-100 border border-yellow-400 text-yellow-800 px-4 py-2 rounded-lg",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5"}),(0,Dt.jsx)("span",{className:"text-sm font-medium",children:"Complete or delete your current booking to make a new one"})]}):(0,Dt.jsxs)(ut,{to:"/trip-packages",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center space-x-2 transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl",children:[(0,Dt.jsx)(TG,{className:"w-5 h-5"}),(0,Dt.jsx)("span",{children:"Make a Book"})]})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Dt.jsx)("div",{className:"lg:col-span-1",children:(0,Dt.jsx)(RG,{})}),(0,Dt.jsx)("div",{className:"lg:col-span-2",children:(0,Dt.jsx)(FG,{trips:t})})]}),(0,Dt.jsxs)("div",{className:"mt-8",children:[(0,Dt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Trip Route Visualization"}),(0,Dt.jsx)(UG,{origin:"Home",destination:"Office",waypoints:[{name:"Coffee Shop",lat:12.9716,lng:77.5946},{name:"Gas Station",lat:12.9815,lng:77.6074}]})]}),(0,Dt.jsxs)("div",{className:"mt-12",children:[(0,Dt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Trip Statistics"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 cursor-pointer",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 rounded-md bg-blue-100 p-3 transition-colors duration-200",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4"})})}),(0,Dt.jsxs)("div",{className:"ml-5",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Trips"}),(0,Dt.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900 transition-colors duration-200 group-hover:text-blue-600",children:t.length})]})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 rounded-md bg-blue-100 p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,Dt.jsxs)("div",{className:"ml-5",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Most Used Transport"}),(0,Dt.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900 capitalize",children:"Car"})]})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 rounded-md bg-green-100 p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),(0,Dt.jsxs)("div",{className:"ml-5",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Distance"}),(0,Dt.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:"25 km"})]})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 rounded-md bg-yellow-100 p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Dt.jsxs)("div",{className:"ml-5",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Trip Time"}),(0,Dt.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:"35 min"})]})]})})]})]})]})};const GG=function(){const[e,t]=(0,B.useState)("routes"),{addToCart:a}=Bt(),s=Oe(),r=Le(),[i,o]=(0,B.useState)(null),[l,c]=(0,B.useState)(!1),[u,d]=(0,B.useState)("");(0,B.useEffect)(()=>{const e=new URLSearchParams(r.search).get("search");e&&d(e)},[r.search]);const h=[{id:1,title:"Scenic Route ",origin:"Home",destination:"Grassland",distance:"75 km",duration:"3 hour",attractions:["City Park","Lakeside View","Historic Building"],description:"A beautiful route with scenic views and less traffic. Perfect for a relaxed morning commute.",rating:4.5,mapImage:n(23),waypoints:[{name:"Home",time:"0 min",description:"Starting point"},{name:"City Park",time:"1 hour",description:"Beautiful park with walking paths and a small lake"},{name:"Lakeside View",time:"20 min",description:"Scenic viewpoint overlooking the city lake"},{name:"Historic Building",time:"2 hour",description:"Well-preserved colonial era building with architecture tours"},{name:"Grassland",time:"3 hour",description:"Destination"}],transportOptions:[{mode:"Car",duration:"3 hour",cost:"\u20b91200"},{mode:"Bike",duration:"4 hour",cost:"\u20b9600"},{mode:"Public Transit",duration:"2 hour",cost:"\u20b91300"}]},{id:2,title:"Quick Route to Shopping Mall",origin:"Home",destination:"Central Mall",distance:"8 km",duration:"35 mins",attractions:["Coffee Shop","Bookstore"],description:"The fastest route to reach the mall, avoiding major traffic signals.",rating:4.2,mapImage:n(96),waypoints:[{name:"Home",time:"0 min",description:"Starting point"},{name:"Coffee Shop",time:"10 min",description:"Popular local coffee shop with specialty brews"},{name:"Bookstore",time:"20 min",description:"Large bookstore with reading areas and cafe"},{name:"Central Mall",time:"30 min",description:"Destination"}],transportOptions:[{mode:"Car",duration:"20 mins",cost:"\u20b980"},{mode:"Bike",duration:"30 mins",cost:"\u20b960"},{mode:"Public Transit",duration:"35 mins",cost:"\u20b925"}]},{id:3,title:"Weekend Getaway Route",origin:"Home",destination:"Beach Resort",distance:"45 km",duration:"1 hr 15 mins",attractions:["Viewpoint","Waterfall","Countryside","Local Market"],description:"A leisure drive through scenic countryside with multiple attractions along the way.",rating:4.8,mapImage:n(709),waypoints:[{name:"Home",time:"0 min",description:"Starting point"},{name:"Viewpoint",time:"20 min",description:"Panoramic views of the valley and mountains"},{name:"Waterfall",time:"40 min",description:"Beautiful 30-foot waterfall with swimming area"},{name:"Countryside",time:"55 min",description:"Scenic rural landscapes with farms and fields"},{name:"Local Market",time:"1 hr 5 min",description:"Traditional market with local crafts and food"},{name:"Beach Resort",time:"1 hr 15 min",description:"Destination"}],transportOptions:[{mode:"Car",duration:"1 hr 15 mins",cost:"\u20b9350"},{mode:"Bike",duration:"2 hrs 30 mins",cost:"\u20b9200"},{mode:"Public Transit",duration:"2 hrs",cost:"\u20b9420"}]},{id:4,title:"Historical City Tour",origin:"Hotel",destination:"Old City Center",distance:"22 km",duration:"2 hour",attractions:["Ancient Temple","Heritage Museum","Royal Palace","Artisan Market"],description:"Explore the rich cultural heritage of the old city with stops at key historical landmarks.",rating:4.7,mapImage:n(374),waypoints:[{name:"Hotel",time:"0 min",description:"Starting point"},{name:"Ancient Temple",time:"30 min",description:"800-year-old temple with intricate carvings"},{name:"Heritage Museum",time:"20 min",description:"Museum showcasing local history and artifacts"},{name:"Royal Palace",time:"20 min",description:"Former royal residence with guided tours"},{name:"Artisan Market",time:"25 min",description:"Traditional market with local crafts and souvenirs"},{name:"Old City Center",time:"2 hour",description:"Destination"}],transportOptions:[{mode:"Car",duration:"30 mins",cost:"\u20b9400"},{mode:"Bike",duration:"45 mins",cost:"\u20b9200"},{mode:"Public Transit",duration:"40 mins",cost:"\u20b9350"}]},{id:5,title:"Nature Trail Adventure",origin:"City Center",destination:"National Park",distance:"25 km",duration:"2 hour",attractions:["Botanical Garden","Bird Sanctuary","Hiking Trail","Mountain View"],description:"A nature lover's route with diverse flora and fauna, perfect for photography and hiking.",rating:4.9,mapImage:n(683),waypoints:[{name:"City Center",time:"0 min",description:"Starting point"},{name:"Botanical Garden",time:"15 min",description:"Garden with rare plant species and flower displays"},{name:"Bird Sanctuary",time:"10 min",description:"Protected area with over 100 bird species"},{name:"Hiking Trail",time:"40 min",description:"Moderate difficulty trail with scenic views"},{name:"Mountain View",time:"45 min",description:"Panoramic viewpoint overlooking the valley"},{name:"National Park",time:"2 hour",description:"Destination"}],transportOptions:[{mode:"Car",duration:"50 mins",cost:"\u20b9350"},{mode:"Bike",duration:"1 hr 30 mins",cost:"\u20b9200"},{mode:"Public Transit",duration:"1 hr 15 mins",cost:"\u20b9260"}]},{id:6,title:"Fun Trail Adventure",origin:"City Center",destination:"Ammusement Park",distance:"25 km",duration:"50 mins",attractions:["Ammusement Park","Waterpark","Roller Coaster","Kiddie Rides"],description:"A fun-filled route with amusement park rides, water parks, and thrilling roller coasters.",rating:4.9,mapImage:n(708),waypoints:[{name:"City Center",time:"0 min",description:"Starting point"},{name:"Ammusement Park",time:"15 min",description:"Fun-filled amusement park with rides, water parks, and roller coasters"},{name:"Waterpark",time:"30 min",description:"Waterpark with fun-filled water rides and games"},{name:"Roller Coaster",time:"40 min",description:"Thrilling roller coaster with a fast-paced ride"},{name:"Kiddie Rides",time:"45 min",description:"Family-friendly rides for children"},{name:"Ammusement Park",time:"50 min",description:"Destination"}],transportOptions:[{mode:"Car",duration:"50 mins",cost:"\u20b9350"},{mode:"Bike",duration:"1 hr 30 mins",cost:"\u20b9200"},{mode:"Public Transit",duration:"1 hr 15 mins",cost:"\u20b9260"}]}];return(0,Dt.jsxs)("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-6 text-primary-700",children:"Recommendations"}),u&&(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsxs)("h2",{className:"text-xl font-semibold mb-3",children:['Search Results for "',u,'"']}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[(0,Dt.jsx)("p",{className:"text-gray-600",children:"Showing recommendations related to your search."}),(0,Dt.jsx)("button",{onClick:()=>{d(""),s("/recommendations")},className:"mt-2 text-primary-600 hover:text-primary-800 text-sm font-medium",children:"Clear search"})]})]}),(0,Dt.jsxs)("div",{className:"flex border-b mb-6",children:[(0,Dt.jsx)("button",{className:"px-4 py-2 font-medium ".concat("routes"===e?"text-primary-600 border-b-2 border-primary-600":"text-gray-500"),onClick:()=>t("routes"),children:"Suggested Routes"}),(0,Dt.jsx)("button",{className:"px-4 py-2 font-medium ".concat("nearby"===e?"text-primary-600 border-b-2 border-primary-600":"text-gray-500"),onClick:()=>t("nearby"),children:"Nearby Attractions"}),(0,Dt.jsx)("button",{className:"px-4 py-2 font-medium ".concat("packages"===e?"text-primary-600 border-b-2 border-primary-600":"text-gray-500"),onClick:()=>t("packages"),children:"Trip Packages"})]}),(0,Dt.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,Dt.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,Dt.jsx)("button",{onClick:()=>t("routes"),className:"".concat("routes"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Suggested Routes"}),(0,Dt.jsx)("button",{onClick:()=>t("nearby"),className:"".concat("nearby"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Nearby Attractions"}),(0,Dt.jsx)("button",{onClick:()=>t("packages"),className:"".concat("packages"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Trip Packages"})]})}),(0,Dt.jsxs)("div",{className:"mt-6",children:["routes"===e&&!l&&(0,Dt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(e=>(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300",children:[(0,Dt.jsxs)("div",{className:"h-48 bg-gray-200 relative overflow-hidden",children:[(0,Dt.jsx)("img",{src:e.mapImage,alt:"Map of ".concat(e.title),className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}),(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",style:{display:"none"},children:(0,Dt.jsx)("svg",{className:"h-12 w-12 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),(0,Dt.jsxs)("div",{className:"absolute top-2 right-2 bg-white bg-opacity-90 rounded-full px-2 py-1 text-xs font-medium text-gray-700 shadow",children:[e.distance," \u2022 ",e.duration]})]}),(0,Dt.jsxs)("div",{className:"p-4",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),(0,Dt.jsx)("div",{className:"flex items-center mt-1",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),(0,Dt.jsx)("span",{className:"ml-1 text-sm text-gray-600",children:e.rating})]})}),(0,Dt.jsxs)("div",{className:"mt-3",children:[(0,Dt.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,Dt.jsx)("span",{className:"font-medium text-gray-700",children:"From:"}),(0,Dt.jsx)("span",{className:"ml-1",children:e.origin})]}),(0,Dt.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mt-1",children:[(0,Dt.jsx)("span",{className:"font-medium text-gray-700",children:"To:"}),(0,Dt.jsx)("span",{className:"ml-1",children:e.destination})]})]}),(0,Dt.jsx)("p",{className:"mt-3 text-sm text-gray-600",children:e.description}),(0,Dt.jsxs)("div",{className:"mt-4",children:[(0,Dt.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Points of Interest:"}),(0,Dt.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:e.attractions.map((e,t)=>(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e},t))})]}),(0,Dt.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,Dt.jsx)("button",{onClick:()=>{o(e),c(!0)},className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"View Details"}),(0,Dt.jsx)("button",{onClick:()=>{o(e),_n.success('Route "'.concat(e.title,'" selected!'))},className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Select Route"})]})]})]},e.id))}),"routes"===e&&l&&i&&(0,Dt.jsxs)("div",{className:"bg-white rounded-lg border p-5",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h2",{className:"text-2xl font-bold text-primary-700",children:i.title}),(0,Dt.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mt-1",children:[(0,Dt.jsx)("span",{children:i.origin}),(0,Dt.jsx)("span",{className:"mx-2",children:"\u2192"}),(0,Dt.jsx)("span",{children:i.destination}),(0,Dt.jsx)("span",{className:"mx-2",children:"\u2022"}),(0,Dt.jsx)("span",{children:i.distance}),(0,Dt.jsx)("span",{className:"mx-2",children:"\u2022"}),(0,Dt.jsx)("span",{children:i.duration})]})]}),(0,Dt.jsx)("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Dt.jsx)("div",{className:"mb-6",children:(0,Dt.jsx)("img",{src:i.mapImage,alt:"Map for ".concat(i.title),className:"w-full h-64 object-cover rounded-lg border"})}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Route Description"}),(0,Dt.jsx)("p",{className:"text-gray-700",children:i.description}),(0,Dt.jsx)("h3",{className:"text-lg font-semibold mt-4 mb-3",children:"Attractions"}),(0,Dt.jsx)("div",{className:"flex flex-wrap gap-2",children:i.attractions.map((e,t)=>(0,Dt.jsx)("span",{className:"bg-primary-50 text-primary-700 px-3 py-1 rounded-full text-sm",children:e},t))})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Transport Options"}),(0,Dt.jsx)("div",{className:"space-y-3",children:i.transportOptions.map((e,t)=>(0,Dt.jsxs)("div",{className:"flex justify-between p-3 border rounded-lg",children:[(0,Dt.jsx)("div",{className:"font-medium",children:e.mode}),(0,Dt.jsx)("div",{className:"text-gray-600",children:e.duration}),(0,Dt.jsx)("div",{className:"font-semibold",children:e.cost})]},t))})]})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Waypoints"}),(0,Dt.jsx)("div",{className:"relative",children:i.waypoints.map((e,t)=>(0,Dt.jsxs)("div",{className:"flex mb-4 relative",children:[(0,Dt.jsxs)("div",{className:"mr-4 relative",children:[(0,Dt.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-600 text-white flex items-center justify-center z-10 relative",children:t+1}),t<i.waypoints.length-1&&(0,Dt.jsx)("div",{className:"absolute top-8 bottom-0 left-4 w-0.5 bg-primary-200 -z-10"})]}),(0,Dt.jsxs)("div",{className:"flex-1",children:[(0,Dt.jsx)("div",{className:"font-medium",children:e.name}),(0,Dt.jsx)("div",{className:"text-sm text-gray-500",children:e.time}),(0,Dt.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]},t))})]}),(0,Dt.jsxs)("div",{className:"flex justify-between",children:[(0,Dt.jsx)("button",{onClick:()=>c(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Back to Routes"}),(0,Dt.jsx)("button",{onClick:()=>{_n.success('Route "'.concat(i.title,'" selected!'))},className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Select This Route"})]})]}),"nearby"===e&&(0,Dt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{id:1,name:"Mountain Cafe",type:"restaurant",distance:"1.2 km",rating:4.7,reviews:128,image:"https://images.unsplash.com/photo-1554118811-1e0d58224f24?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8M3x8Y2FmZXxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",description:"Cozy cafe with panoramic mountain views and excellent coffee."},{id:2,name:"Heritage Museum",type:"attraction",distance:"3.5 km",rating:4.5,reviews:312,image:"https://tse2.mm.bing.net/th/id/OIP.IHbldF_mZiMFn9m3LN0fwwHaE7?rs=1&pid=ImgDetMain&o=7&rm=3",description:"Explore local history and culture at this well-preserved museum."},{id:3,name:"Riverside Park",type:"park",distance:"2.1 km",rating:4.6,reviews:245,image:"https://images.unsplash.com/photo-1519331379826-f10be5486c6f?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8cGFya3xlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",description:"Peaceful park with walking trails, picnic areas, and river views."},{id:4,name:"Seafood Grill",type:"restaurant",distance:"4.3 km",rating:4.4,reviews:189,image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8c2VhZm9vZHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",description:"Fresh seafood prepared with local ingredients and unique flavors."}].map(e=>(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300",children:[(0,Dt.jsxs)("div",{className:"h-48 bg-gray-200 relative overflow-hidden",children:[(0,Dt.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}),(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",style:{display:"none"},children:(0,Dt.jsx)("svg",{className:"h-12 w-12 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,Dt.jsx)("div",{className:"absolute top-2 right-2 bg-white rounded-full px-2 py-1 text-xs font-medium text-gray-700 shadow",children:e.distance}),(0,Dt.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3",children:(0,Dt.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs font-medium text-white bg-black/50 capitalize",children:e.type})})]}),(0,Dt.jsxs)("div",{className:"p-4",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,Dt.jsx)("div",{className:"flex items-center mt-1",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),(0,Dt.jsx)("span",{className:"ml-1 text-sm text-gray-600",children:e.rating}),(0,Dt.jsx)("span",{className:"mx-1 text-gray-500",children:"\u2022"}),(0,Dt.jsxs)("span",{className:"text-sm text-gray-500",children:[e.reviews," reviews"]})]})}),(0,Dt.jsx)("p",{className:"mt-3 text-sm text-gray-600",children:e.description}),(0,Dt.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,Dt.jsx)(ut,{to:"/attraction/".concat(e.id),className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"View Details"}),(0,Dt.jsxs)("button",{onClick:()=>{a({id:e.id,type:"attraction",name:e.name,description:e.description,image:e.image,price:Math.floor(500*Math.random())+100})?_n.success("".concat(e.name," added to your trip!")):_n.info("".concat(e.name," is already in your trip"))},className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Add to Trip"]})]})]})]},e.id))}),"packages"===e&&(0,Dt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{id:1,title:"Weekend City Explorer",duration:"7 days",budget:"$200-$300",activities:["City Tour","Museum Visit","Local Cuisine Tasting","Shopping"],description:"Perfect for a quick weekend getaway to explore the city highlights.",rating:4.3,image:"https://www.touropia.com/gfx/d/best-places-to-visit-in-usa/orlando.jpg?v=ebe1017033950f50bd70537740fc33fb"},{id:2,title:"Nature Retreat",duration:"3 days",budget:"$250-$400",activities:["Hiking","Camping","Wildlife Spotting","Bonfire Night"],description:"Escape to nature with this refreshing retreat package in the mountains.",rating:4.7,image:"https://images.unsplash.com/photo-1504280390367-361c6d9f38f4?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8bmF0dXJlJTIwcmV0cmVhdHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60"},{id:3,title:"Cultural Immersion",duration:"4 days",budget:"$300-$500",activities:["Heritage Sites","Local Workshops","Traditional Performances","Culinary Classes"],description:"Dive deep into local culture and traditions with guided experiences.",rating:4.5,image:"https://images.unsplash.com/photo-1533104816931-20fa691ff6ca?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8Y3VsdHVyYWwlMjBpbW1lcnNpb258ZW58MHx8MHx8&auto=format&fit=crop&w=500&q=60"}].map(e=>(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 border border-gray-200",children:[(0,Dt.jsxs)("div",{className:"h-48 bg-gray-200 relative overflow-hidden",children:[(0,Dt.jsx)("img",{src:e.image,alt:"".concat(e.title," package"),className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}),(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",style:{display:"none"},children:(0,Dt.jsx)("svg",{className:"h-12 w-12 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,Dt.jsx)("div",{className:"absolute top-2 right-2 bg-white bg-opacity-90 rounded-full px-2 py-1 text-xs font-medium text-gray-700 shadow",children:e.duration})]}),(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Dt.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e.title}),(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e.budget})]}),(0,Dt.jsxs)("div",{className:"flex items-center mt-2",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),(0,Dt.jsx)("span",{className:"ml-1 text-sm text-gray-600",children:e.rating}),(0,Dt.jsx)("span",{className:"mx-2 text-gray-500",children:"\u2022"}),(0,Dt.jsx)("span",{className:"text-sm text-gray-600",children:e.duration})]}),(0,Dt.jsx)("p",{className:"mt-4 text-sm text-gray-600",children:e.description}),(0,Dt.jsxs)("div",{className:"mt-4",children:[(0,Dt.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Activities:"}),(0,Dt.jsx)("ul",{className:"mt-2 space-y-1",children:e.activities.map((e,t)=>(0,Dt.jsxs)("li",{className:"flex items-center text-sm text-gray-600",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 text-green-500 mr-2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e]},t))})]}),(0,Dt.jsx)("div",{className:"mt-6",children:(0,Dt.jsxs)("button",{onClick:()=>{a({id:e.id,type:"package",name:e.title,description:e.description,price:parseInt(e.budget.split("-")[0].replace("$","")),duration:e.duration})?_n.success("".concat(e.title," added to your trip!")):_n.info("".concat(e.title," is already in your trip"))},className:"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Add to Trip"]})})]})]},e.id))})]})]})};function qG(e){let{position:t}=e;const n=Sa();return(0,B.useEffect)(()=>{t&&n.flyTo(t,14)},[n,t]),null}delete oa().Icon.Default.prototype._getIconUrl,oa().Icon.Default.mergeOptions({iconRetinaUrl:n(249),iconUrl:n(24),shadowUrl:n(71)});const KG=function(e){let{dangerZones:t}=e;const[n,a]=(0,B.useState)(null),[s,r]=(0,B.useState)(!0),[i,o]=(0,B.useState)(null);(0,B.useEffect)(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{a({lat:e.coords.latitude,lng:e.coords.longitude}),r(!1)},e=>{console.error("Error getting location:",e);let t="Unable to access your location. ";switch(e.code){case e.PERMISSION_DENIED:t+="Please allow location access to view danger zones near you.";break;case e.POSITION_UNAVAILABLE:t+="Location information is currently unavailable.";break;case e.TIMEOUT:t+="Location request timed out.";break;default:t+="Using default location."}o(t),r(!1),a(null)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}):(o("Geolocation is not supported by this browser. Using default location."),r(!1))},[]);const l=[20.5937,78.9629],c=e=>{const t="high"===e.level?.3:.2;return[200,400,600].map((n,a)=>{const s=t-.1*a;return(0,Dt.jsx)(LG,{center:[e.lat,e.lng],radius:n,pathOptions:{color:"high"===e.level?"#ef4444":"#f59e0b",fillColor:"high"===e.level?"#ef4444":"#f59e0b",fillOpacity:s}},"".concat(e.id,"-").concat(n))})};if(s)return(0,Dt.jsx)("div",{className:"h-96 flex items-center justify-center bg-gray-100 rounded-lg",children:(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsxs)("svg",{className:"animate-spin h-8 w-8 text-primary-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Dt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,Dt.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Loading map..."})]})});if(i)return(0,Dt.jsx)("div",{className:"h-96 flex items-center justify-center bg-gray-100 rounded-lg",children:(0,Dt.jsxs)("div",{className:"text-center p-4",children:[(0,Dt.jsx)("svg",{className:"h-12 w-12 text-yellow-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,Dt.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:i}),(0,Dt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Please enable location services to view danger zones near you."})]})});const u=t.map(e=>{const t=n?n.lat+(.02*Math.random()-.01):l[0],a=n?n.lng+(.02*Math.random()-.01):l[1];return Lt(Lt({},e),{},{lat:t,lng:a})});return(0,Dt.jsx)("div",{className:"h-64 rounded-lg overflow-hidden",children:(0,Dt.jsxs)(da,{center:n?[n.lat,n.lng]:l,zoom:13,style:{height:"100%",width:"100%"},scrollWheelZoom:!1,children:[(0,Dt.jsx)(_a,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),n&&(0,Dt.jsx)(qG,{position:[n.lat,n.lng]}),n&&(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)(Ta,{center:[n.lat,n.lng],radius:8,pathOptions:{color:"#3b82f6",fillColor:"#3b82f6",fillOpacity:.8,weight:2},children:(0,Dt.jsx)(Aa,{children:"Your current location"})}),(0,Dt.jsx)(Ta,{center:[n.lat,n.lng],radius:15,pathOptions:{color:"#3b82f6",fillColor:"#3b82f6",fillOpacity:.2,weight:1}})]}),u.map(e=>(0,Dt.jsxs)(B.Fragment,{children:[c(e),(0,Dt.jsx)(Ea,{position:[e.lat,e.lng],children:(0,Dt.jsx)(Aa,{children:(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"font-medium",children:e.name}),(0,Dt.jsx)("p",{className:"text-sm",children:e.description}),(0,Dt.jsx)("p",{className:"text-xs mt-1",children:(0,Dt.jsxs)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium ".concat("high"===e.level?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"," capitalize"),children:[e.level," risk"]})})]})})})]},e.id))]})})};const ZG=function(){const[e,t]=(0,B.useState)(!1),[n,a]=(0,B.useState)(!1),[s,r]=(0,B.useState)(null),[i,o]=(0,B.useState)([{id:1,name:"John Doe",relation:"Family",phone:"+91 98765 43210"},{id:2,name:"Jane Smith",relation:"Friend",phone:"+91 87654 32109"}]),[l,c]=(0,B.useState)({name:"",relation:"",phone:""}),u=[{id:1,name:"Downtown Construction Site",level:"moderate",distance:"1.2 km",description:"Heavy machinery and construction work in progress.",detailedInfo:"This area has ongoing construction of a new commercial complex. Heavy machinery is in operation throughout the day. The site has inadequate barriers and signage, creating potential hazards for pedestrians and vehicles passing by.",safetyTips:["Avoid walking near the construction barriers","Be cautious of construction vehicles entering and exiting the site","Use alternative routes especially during peak construction hours (9 AM - 5 PM)"],reportedIncidents:2,lastUpdated:"2 hours ago"},{id:2,name:"Riverside Area",level:"high",distance:"3.5 km",description:"Flooding reported due to heavy rainfall.",detailedInfo:"Recent heavy rainfall has caused the river to overflow in certain sections. Water levels have risen significantly, and some low-lying paths are submerged. Local authorities have issued warnings to avoid the area until water levels recede.",safetyTips:["Avoid all riverside paths and roads","Do not attempt to cross flooded areas by foot or vehicle","Follow evacuation instructions if you are in the affected neighborhoods","Monitor local news for updates on water levels"],reportedIncidents:5,lastUpdated:"30 minutes ago"},{id:3,name:"Highway Junction",level:"moderate",distance:"5.8 km",description:"Accident prone area with heavy traffic.",detailedInfo:"This junction connects three major highways and experiences heavy traffic throughout the day. Poor visibility during certain hours and complex lane merging has led to multiple accidents in the past month. Traffic police have been deployed but caution is advised.",safetyTips:["Reduce speed when approaching the junction","Use navigation apps to find alternative routes during peak hours","Be particularly cautious during early morning and evening when visibility is reduced","Follow all traffic signals and police instructions"],reportedIncidents:3,lastUpdated:"1 day ago"}],d=e=>{const{name:t,value:n}=e.target;c(Lt(Lt({},l),{},{[t]:n}))},h=()=>{r(null)};return(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Safety & Emergency"}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Emergency SOS"}),(0,Dt.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Dt.jsx)("button",{onClick:()=>{t(!e),e||alert("SOS activated! Emergency contacts would be notified in a real application.")},className:"w-32 h-32 rounded-full flex items-center justify-center text-white font-bold text-xl focus:outline-none transition-colors duration-300 ".concat(e?"bg-red-600 animate-pulse":"bg-red-500 hover:bg-red-600"),children:e?"ACTIVE":"SOS"}),(0,Dt.jsx)("p",{className:"mt-4 text-gray-600 text-center max-w-md",children:e?"SOS is active. Your emergency contacts have been notified with your current location.":"Press the SOS button in case of emergency. This will alert your emergency contacts with your current location."})]}),(0,Dt.jsxs)("div",{className:"mt-8",children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Live Location Sharing"}),(0,Dt.jsxs)("div",{className:"relative inline-block w-12 mr-2 align-middle select-none",children:[(0,Dt.jsx)("input",{type:"checkbox",name:"toggle",id:"locationToggle",checked:n,onChange:()=>{a(!n)},className:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-transform duration-200 ease-in-out"}),(0,Dt.jsx)("label",{htmlFor:"locationToggle",className:"toggle-label block overflow-hidden h-6 rounded-full cursor-pointer ".concat(n?"bg-green-500":"bg-gray-300")})]})]}),(0,Dt.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:n?"Your trusted contacts can see your live location.":"Enable to share your live location with trusted contacts."})]})]})}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:[(0,Dt.jsxs)("div",{className:"px-6 py-4 bg-yellow-50 border-b border-yellow-100",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Danger Zone Alerts"}),(0,Dt.jsx)("p",{className:"text-sm text-gray-600",children:"Based on your current location and route"})]}),(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)(KG,{dangerZones:u}),(0,Dt.jsx)("p",{className:"mt-2 text-sm text-gray-500 text-center",children:"Circles show danger zones with decreasing intensity as they expand outward"})]}),(0,Dt.jsxs)("div",{className:"mt-8 divide-y divide-gray-200",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Nearby Danger Zones"}),u.map(e=>(0,Dt.jsx)("div",{className:"py-4",children:(0,Dt.jsxs)("div",{className:"flex items-start",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full flex items-center justify-center ".concat("high"===e.level?"bg-red-100 text-red-600":"bg-yellow-100 text-yellow-600"),children:(0,Dt.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:e.name}),(0,Dt.jsxs)("div",{className:"flex items-center mt-1",children:[(0,Dt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("high"===e.level?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"," capitalize"),children:[e.level," risk"]}),(0,Dt.jsxs)("span",{className:"ml-2 text-sm text-gray-500",children:[e.distance," away"]})]}),(0,Dt.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:e.description}),(0,Dt.jsxs)("div",{className:"mt-3 flex",children:[(0,Dt.jsx)("button",{onClick:()=>(e=>{r(e)})(e),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"View Details"}),(0,Dt.jsx)("button",{className:"ml-3 inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Avoid Area"})]})]})]})},e.id))]})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Dt.jsxs)("div",{className:"px-6 py-4 bg-blue-50 border-b border-blue-100",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Emergency Contacts"}),(0,Dt.jsx)("p",{className:"text-sm text-gray-600",children:"Manage your trusted emergency contacts"})]}),(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Contact"}),(0,Dt.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l.name&&l.phone&&(o([...i,Lt(Lt({},l),{},{id:Date.now()})]),c({name:"",relation:"",phone:""}))},className:"grid grid-cols-1 gap-y-6 sm:grid-cols-6 gap-x-4",children:[(0,Dt.jsxs)("div",{className:"sm:col-span-2",children:[(0,Dt.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{type:"text",name:"name",id:"name",value:l.name,onChange:d,className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0})})]}),(0,Dt.jsxs)("div",{className:"sm:col-span-2",children:[(0,Dt.jsx)("label",{htmlFor:"relation",className:"block text-sm font-medium text-gray-700",children:"Relation"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsxs)("select",{id:"relation",name:"relation",value:l.relation,onChange:d,className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",children:[(0,Dt.jsx)("option",{value:"",children:"Select relation"}),(0,Dt.jsx)("option",{value:"Family",children:"Family"}),(0,Dt.jsx)("option",{value:"Friend",children:"Friend"}),(0,Dt.jsx)("option",{value:"Colleague",children:"Colleague"}),(0,Dt.jsx)("option",{value:"Other",children:"Other"})]})})]}),(0,Dt.jsxs)("div",{className:"sm:col-span-2",children:[(0,Dt.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{type:"tel",name:"phone",id:"phone",value:l.phone,onChange:d,className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0})})]}),(0,Dt.jsx)("div",{className:"sm:col-span-6 flex justify-end",children:(0,Dt.jsx)("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Add Contact"})})]})]}),(0,Dt.jsxs)("div",{className:"mt-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Your Emergency Contacts"}),i.length>0?(0,Dt.jsx)("ul",{className:"divide-y divide-gray-200",children:i.map(e=>(0,Dt.jsxs)("li",{className:"py-4 flex justify-between items-center",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h4",{className:"text-base font-medium text-gray-900",children:e.name}),(0,Dt.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,Dt.jsx)("span",{className:"text-sm text-gray-500",children:e.relation}),(0,Dt.jsx)("span",{className:"mx-2 text-gray-300",children:"\u2022"}),(0,Dt.jsx)("span",{className:"text-sm text-gray-500",children:e.phone})]})]}),(0,Dt.jsxs)("div",{className:"flex space-x-2",children:[(0,Dt.jsx)("button",{onClick:()=>alert("Calling ".concat(e.name,"...")),className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:(0,Dt.jsx)("svg",{className:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),(0,Dt.jsx)("button",{onClick:()=>{return t=e.id,void o(i.filter(e=>e.id!==t));var t},className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:(0,Dt.jsx)("svg",{className:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},e.id))}):(0,Dt.jsx)("div",{className:"text-center py-4",children:(0,Dt.jsx)("p",{className:"text-gray-500",children:"No emergency contacts added yet."})})]})]})]}),s&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:h,children:(0,Dt.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white",onClick:e=>e.stopPropagation(),children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-between pb-3",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Danger Zone Details"}),(0,Dt.jsx)("button",{onClick:h,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:(0,Dt.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Dt.jsxs)("div",{className:"space-y-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:s.name}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,Dt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("high"===s.level?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"," capitalize"),children:[s.level," risk"]}),(0,Dt.jsxs)("span",{className:"text-sm text-gray-500",children:[s.distance," away"]})]}),(0,Dt.jsx)("p",{className:"text-gray-700",children:s.detailedInfo})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h5",{className:"text-md font-semibold text-gray-900 mb-2",children:"Safety Tips:"}),(0,Dt.jsx)("ul",{className:"list-disc list-inside space-y-1",children:s.safetyTips.map((e,t)=>(0,Dt.jsx)("li",{className:"text-sm text-gray-700",children:e},t))})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("span",{className:"font-medium text-gray-900",children:"Reported Incidents:"}),(0,Dt.jsx)("span",{className:"ml-2 text-gray-700",children:s.reportedIncidents})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("span",{className:"font-medium text-gray-900",children:"Last Updated:"}),(0,Dt.jsx)("span",{className:"ml-2 text-gray-700",children:s.lastUpdated})]})]})]}),(0,Dt.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 mt-4 border-t",children:[(0,Dt.jsx)("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Close"}),(0,Dt.jsx)("button",{className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Avoid This Area"})]})]})}),(0,Dt.jsx)("style",{children:"\n        .toggle-checkbox:checked {\n          transform: translateX(100%);\n          border-color: #fff;\n        }\n        .toggle-label {\n          transition: background-color 0.2s ease-in-out;\n        }\n      "})]})};const XG=function(){return(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Live Location Tracking"}),(0,Dt.jsx)("div",{className:"mb-6",children:(0,Dt.jsx)("p",{className:"text-gray-600",children:"This page shows your current location in real-time. Your location data is only used for display purposes and is not stored unless you explicitly save a trip."})}),(0,Dt.jsx)("div",{className:"grid grid-cols-1 gap-8",children:(0,Dt.jsx)(Ma,{})}),(0,Dt.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"About Location Tracking"}),(0,Dt.jsxs)("div",{className:"space-y-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Privacy Information"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:'Your location data is only processed on your device and is not sent to our servers unless you explicitly save a trip. You can stop location tracking at any time by clicking the "Stop Tracking" button.'})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Location Accuracy"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:"Location accuracy depends on your device's GPS capabilities and environmental factors. The accuracy radius shown on the map indicates the approximate precision of your location."})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Battery Usage"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:"Continuous location tracking may increase battery consumption. We recommend disabling tracking when not in use."})]})]})]})]})};const YG=function(){const[e,t]=(0,B.useState)((()=>{const e=new URLSearchParams(window.location.search).get("tab");return["reviews","forums","buddies","guides"].includes(e)?e:"reviews"})()),[n,a]=(0,B.useState)(""),[s,r]=(0,B.useState)(!1),[i,o]=(0,B.useState)({place:"",rating:5,content:"",images:[]}),[l,c]=(0,B.useState)(!1),[u,d]=(0,B.useState)({title:"",category:"general",content:""}),[h,p]=(0,B.useState)(null),[m,f]=(0,B.useState)(!1),[g,x]=(0,B.useState)(null),[y,b]=(0,B.useState)(!1),{addToCart:v}=Bt(),{isAuthenticated:w}=Pt(),[k,N]=(0,B.useState)([{id:1,place:"Golden Temple, Amritsar",author:"Rahul S.",date:"2023-10-15",rating:5,content:"One of the most peaceful and spiritual places I have ever visited. The atmosphere is serene and the golden structure reflecting in the water is breathtaking.",images:["https://th.bing.com/th/id/R.bb0657c2cd312373b9db5d705f0e11c0?rik=424p5vnzfed1KQ&riu=http%3a%2f%2fupload.wikimedia.org%2fwikipedia%2fcommons%2f9%2f9f%2fAmritsar_Golden_Temple_3.JPG&ehk=Kkzw3alSjguRImw%2bsslFGCuJsWZd1YKI52sQqnrqHYw%3d&risl=&pid=ImgRaw&r=0"]},{id:2,place:"Taj Mahal, Agra",author:"Priya M.",date:"2023-09-22",rating:5,content:"A true wonder of the world. The intricate marble work and the symmetry of the structure is amazing. Best visited during sunrise.",images:["https://h2.gifposter.com/bingImages/TajMahalReflection_1920x1080.jpg"]},{id:3,place:"Jaipur City Palace",author:"Amit K.",date:"2023-11-05",rating:4,content:"Beautiful palace with stunning architecture. The museum inside has a great collection of royal artifacts. Highly recommended for history lovers.",images:["https://i.pinimg.com/originals/d9/ca/53/d9ca53ea0b409b5a5abb7cd421bc53d1.jpg"]}]),[_,S]=(0,B.useState)([{id:1,title:"Best hiking trails around the city",author:"HikingEnthusiast",date:"2023-06-18",content:"I'm looking for recommendations on hiking trails within 30km of the city center. Preferably with moderate difficulty and good scenic views. Any suggestions?",replies:12,views:145,tags:["hiking","outdoors","nature"]},{id:2,title:"Public transport tips for tourists",author:"TravelGuru",date:"2023-06-16",content:"Let's share tips and tricks for using the local public transport system efficiently. What are the best passes for tourists? How to avoid peak hours?",replies:8,views:98,tags:["transport","local-tips","budget-travel"]},{id:3,title:"Hidden gems for food lovers",author:"FoodieExplorer",date:"2023-06-14",content:"Looking to discover some underrated local restaurants and street food spots. Share your favorite hidden gems that tourists usually miss!",replies:15,views:203,tags:["food","local-cuisine","restaurants"]},{id:4,title:"Weekend getaway ideas",author:"WeekendTraveler",date:"2023-06-12",content:"Planning a 2-day trip this weekend. What are some interesting places within 200km radius that are worth visiting? Looking for both nature and cultural experiences.",replies:10,views:178,tags:["weekend","short-trips","getaway"]}]);return(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Travel Community"}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:(0,Dt.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[(0,Dt.jsxs)("div",{className:"mb-4 md:mb-0",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Connect with Fellow Travelers"}),(0,Dt.jsx)("p",{className:"text-gray-600 text-sm",children:"Share experiences, find travel buddies, and get local insights"})]}),(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("input",{type:"text",placeholder:"Search community...",value:n,onChange:e=>a(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full"}),(0,Dt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Dt.jsx)("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})})]})]})}),(0,Dt.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,Dt.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,Dt.jsx)("button",{onClick:()=>t("reviews"),className:"".concat("reviews"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Reviews & Ratings"}),(0,Dt.jsx)("button",{onClick:()=>t("forums"),className:"".concat("forums"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Travel Forums"}),(0,Dt.jsx)("button",{onClick:()=>t("buddies"),className:"".concat("buddies"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Travel Buddies"}),(0,Dt.jsx)("button",{onClick:()=>t("guides"),className:"".concat("guides"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Local Guides"})]})}),(0,Dt.jsxs)("div",{children:["reviews"===e&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Reviews"}),(0,Dt.jsx)("button",{onClick:()=>r(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Write a Review"})]}),(0,Dt.jsx)("div",{className:"space-y-6",children:(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200",children:(0,Dt.jsx)("div",{className:"p-6",children:(0,Dt.jsx)("div",{className:"flex justify-between items-start",children:(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"No reviews available"}),(0,Dt.jsx)("p",{className:"text-gray-600 mt-1",children:"Be the first to write a review!"})]})})})})}),k.length>0&&(0,Dt.jsx)("div",{className:"mt-6 space-y-6",children:k.map(e=>(0,Dt.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[(0,Dt.jsxs)("div",{className:"px-4 py-5 sm:px-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between",children:[(0,Dt.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:e.place}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex",children:[...Array(5)].map((t,n)=>(0,Dt.jsx)("svg",{className:"h-5 w-5 ".concat(n<e.rating?"text-yellow-400":"text-gray-300"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},n))}),(0,Dt.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:[e.rating,"/5"]})]})]}),(0,Dt.jsxs)("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:["By ",e.author," \u2022 ",e.date]})]}),(0,Dt.jsx)("div",{className:"border-t border-gray-200",children:(0,Dt.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,Dt.jsx)("p",{className:"text-gray-700",children:e.content}),e.images&&e.images.length>0&&(0,Dt.jsx)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:e.images.map((e,t)=>(0,Dt.jsx)("img",{src:e,alt:"Review image ".concat(t+1),className:"h-40 w-full object-cover rounded-md"},t))}),(0,Dt.jsx)("div",{className:"mt-4 flex justify-end",children:"You"===e.author&&(0,Dt.jsxs)("button",{onClick:()=>{N(k.filter(t=>t.id!==e.id)),_n.success("Review deleted successfully!")},className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 mr-1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Delete"]})})]})})]},e.id))}),(0,Dt.jsx)("div",{className:"mt-8 text-center",children:(0,Dt.jsx)("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Load More Reviews"})})]}),s&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold",children:"Write a Review"}),(0,Dt.jsx)("button",{onClick:()=>r(!1),className:"text-gray-500 hover:text-gray-700",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Dt.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t=k.length+1,n=(new Date).toISOString().split("T")[0],a=Lt(Lt({},i),{},{id:t,author:"You",date:n});N([a,...k]),_n.success("Review submitted successfully!"),r(!1),o({place:"",rating:5,content:"",images:[]})},children:[(0,Dt.jsxs)("div",{className:"space-y-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"place",className:"block text-sm font-medium text-gray-700 mb-1",children:"Place or Attraction"}),(0,Dt.jsx)("input",{type:"text",id:"place",value:i.place,onChange:e=>o(Lt(Lt({},i),{},{place:e.target.value})),className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"Name of the place you're reviewing",required:!0})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rating"}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[[1,2,3,4,5].map(e=>(0,Dt.jsx)("button",{type:"button",onClick:()=>o(Lt(Lt({},i),{},{rating:e})),className:"focus:outline-none",children:(0,Dt.jsx)("svg",{className:"h-8 w-8 ".concat(e<=i.rating?"text-yellow-400":"text-gray-300"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},e)),(0,Dt.jsxs)("span",{className:"ml-2 text-gray-600",children:[i.rating," out of 5"]})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Review"}),(0,Dt.jsx)("textarea",{id:"content",rows:5,value:i.content,onChange:e=>o(Lt(Lt({},i),{},{content:e.target.value})),className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"Share your experience...",required:!0})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Add Photos (Optional)"}),(0,Dt.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:(0,Dt.jsxs)("div",{className:"space-y-1 text-center",children:[(0,Dt.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:(0,Dt.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,Dt.jsxs)("div",{className:"flex text-sm text-gray-600",children:[(0,Dt.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-500",children:[(0,Dt.jsx)("span",{children:"Upload a file"}),(0,Dt.jsx)("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only"})]}),(0,Dt.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})})]})]}),(0,Dt.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,Dt.jsx)("button",{type:"button",onClick:()=>r(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,Dt.jsx)("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700",children:"Submit Review"})]})]})]})})}),"forums"===e&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Discussion Forums"}),(0,Dt.jsx)("button",{onClick:()=>c(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Start New Discussion"})]}),(0,Dt.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:(0,Dt.jsx)("ul",{className:"divide-y divide-gray-200",children:_.map(e=>(0,Dt.jsx)("li",{children:(0,Dt.jsx)("div",{className:"px-4 py-5 sm:px-6 hover:bg-gray-50",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-primary-600 truncate",children:e.title}),(0,Dt.jsxs)("div",{className:"mt-1 flex items-center text-sm text-gray-500",children:[(0,Dt.jsxs)("span",{children:["Started by ",e.author]}),(0,Dt.jsx)("span",{className:"mx-1",children:"\u2022"}),(0,Dt.jsx)("span",{children:new Date(e.date).toLocaleDateString()})]}),(0,Dt.jsx)("p",{className:"mt-2 text-sm text-gray-600 line-clamp-2",children:e.content}),(0,Dt.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.tags.map((e,t)=>(0,Dt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["#",e]},t))})]}),(0,Dt.jsxs)("div",{className:"ml-6 flex-shrink-0 flex flex-col items-end",children:[(0,Dt.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,Dt.jsx)("svg",{className:"h-5 w-5 mr-1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z",clipRule:"evenodd"})}),(0,Dt.jsxs)("span",{children:[e.replies," replies"]})]}),(0,Dt.jsxs)("div",{className:"mt-1 flex items-center text-sm text-gray-500",children:[(0,Dt.jsxs)("svg",{className:"h-5 w-5 mr-1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,Dt.jsx)("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}),(0,Dt.jsxs)("span",{children:[e.views," views"]})]})]})]})})},e.id))})}),(0,Dt.jsx)("div",{className:"mt-8 text-center",children:(0,Dt.jsx)("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"View All Discussions"})}),l&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,Dt.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Start a New Discussion"})}),(0,Dt.jsxs)("form",{onSubmit:e=>{e.preventDefault();const t={id:_.length+1,title:u.title,author:"You",date:(new Date).toISOString().split("T")[0],content:u.content,replies:0,views:0,tags:u.category.split(",").map(e=>e.trim())};S([t,..._]),d({title:"",category:"general",content:""}),c(!1),_n.success("Discussion posted successfully!")},children:[(0,Dt.jsxs)("div",{className:"px-6 py-4",children:[(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discussion Title"}),(0,Dt.jsx)("input",{type:"text",id:"title",value:u.title,onChange:e=>d(Lt(Lt({},u),{},{title:e.target.value})),className:"w-full border border-gray-300 rounded-md shadow-sm px-4 py-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Categories (comma separated)"}),(0,Dt.jsx)("input",{type:"text",id:"category",value:u.category,onChange:e=>d(Lt(Lt({},u),{},{category:e.target.value})),className:"w-full border border-gray-300 rounded-md shadow-sm px-4 py-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"general, question, advice",required:!0})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discussion Content"}),(0,Dt.jsx)("textarea",{id:"content",value:u.content,onChange:e=>d(Lt(Lt({},u),{},{content:e.target.value})),rows:5,className:"w-full border border-gray-300 rounded-md shadow-sm px-4 py-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]})]}),(0,Dt.jsxs)("div",{className:"px-6 py-4 bg-gray-50 flex justify-end space-x-3",children:[(0,Dt.jsx)("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,Dt.jsx)("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700",children:"Post Discussion"})]})]})]})})]}),"buddies"===e&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Find Travel Buddies"}),(0,Dt.jsxs)("div",{className:"flex space-x-2",children:[(0,Dt.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500",children:[(0,Dt.jsx)("option",{children:"All Locations"}),(0,Dt.jsx)("option",{children:"New York"}),(0,Dt.jsx)("option",{children:"Chicago"}),(0,Dt.jsx)("option",{children:"San Francisco"}),(0,Dt.jsx)("option",{children:"Miami"})]}),(0,Dt.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500",children:[(0,Dt.jsx)("option",{children:"All Interests"}),(0,Dt.jsx)("option",{children:"Hiking"}),(0,Dt.jsx)("option",{children:"Food Tours"}),(0,Dt.jsx)("option",{children:"Beach Trips"}),(0,Dt.jsx)("option",{children:"Adventure Sports"})]})]})]}),(0,Dt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{id:1,name:"Sarah Wilson",age:28,location:"New York",interests:["Hiking","Photography","Cultural Experiences"],bio:"Adventure enthusiast looking for travel companions for weekend trips. Love exploring nature trails and capturing moments through my lens.",tripPreferences:"Weekend getaways, National parks, Historical sites",image:"https://img.freepik.com/premium-photo/photo-traveler_889227-44735.jpg",compatibility:85},{id:2,name:"Vernit",age:32,location:"Chicago",interests:["Food Tours","Museums","City Exploration"],bio:"Foodie and history buff looking to explore new cities. Always on the hunt for authentic local cuisines and hidden historical gems.",tripPreferences:"City breaks, Food tours, Cultural events",image:"https://thumbs.dreamstime.com/z/happy-guy-vacation-bag-hat-holding-map-portrait-57224721.jpg",compatibility:72},{id:3,name:"Emma Chen",age:26,location:"San Francisco",interests:["Beach Trips","Surfing","Road Trips"],bio:"Surf enthusiast and road trip lover. Looking for like-minded travelers for coastal adventures and exploring scenic routes.",tripPreferences:"Coastal trips, Road journeys, Beach camping",image:"https://img.freepik.com/free-photo/portrait-woman-travelling-world-using-map-tablet-standing-small-european-city-looking-camera_197531-22267.jpg",compatibility:90},{id:4,name:"Carlos Rodriguez",age:35,location:"Miami",interests:["Wildlife Safaris","Adventure Sports","Mountain Climbing"],bio:"Adrenaline junkie seeking travel partners for adventure trips. Experienced in mountain climbing and wildlife expeditions.",tripPreferences:"Adventure trips, Wildlife safaris, Mountain expeditions",image:"https://i1.rgstatic.net/ii/profile.image/11431281128750249-1679422056721_Q512/Daniel-Ghiurca-2.jpg",compatibility:65}].map(e=>(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow duration-300",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-48 object-cover"}),(0,Dt.jsxs)("div",{className:"absolute top-2 right-2 bg-primary-600 text-white rounded-full px-2 py-1 text-xs font-medium",children:[e.compatibility,"% Match"]})]}),(0,Dt.jsxs)("div",{className:"p-4",children:[(0,Dt.jsx)("div",{className:"flex justify-between items-start",children:(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500",children:[e.age," \u2022 ",e.location]})]})}),(0,Dt.jsx)("p",{className:"mt-3 text-sm text-gray-600 line-clamp-3",children:e.bio}),(0,Dt.jsxs)("div",{className:"mt-3",children:[(0,Dt.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Interests"}),(0,Dt.jsx)("div",{className:"mt-1 flex flex-wrap gap-1",children:e.interests.map((e,t)=>(0,Dt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:e},t))})]}),(0,Dt.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,Dt.jsx)("button",{onClick:()=>{p(e),f(!0)},className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"View Profile"}),(0,Dt.jsx)("button",{className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Connect"})]})]})]},e.id))}),(0,Dt.jsx)("div",{className:"mt-8 text-center",children:(0,Dt.jsx)("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"View More Travel Buddies"})})]}),"guides"===e&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Local Guides"}),(0,Dt.jsxs)("div",{className:"flex space-x-2",children:[(0,Dt.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500",children:[(0,Dt.jsx)("option",{children:"All Locations"}),(0,Dt.jsx)("option",{children:"New York"}),(0,Dt.jsx)("option",{children:"Chicago"}),(0,Dt.jsx)("option",{children:"San Francisco"}),(0,Dt.jsx)("option",{children:"Miami"})]}),(0,Dt.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500",children:[(0,Dt.jsx)("option",{children:"All Expertise"}),(0,Dt.jsx)("option",{children:"History"}),(0,Dt.jsx)("option",{children:"Food"}),(0,Dt.jsx)("option",{children:"Art"}),(0,Dt.jsx)("option",{children:"Outdoors"})]})]})]}),(0,Dt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{id:1,name:"David Thompson",location:"New York",expertise:["History","Architecture","Local Cuisine"],languages:["English","Spanish"],experience:"5 years",rating:4.8,reviews:56,image:"https://img.freepik.com/premium-photo/portrait-smiling-traveling-man-with-map_33839-603.jpg?w=2000",price:"$40/hour",bio:"Born and raised in New York City, I have a deep passion for sharing the rich history and architectural wonders of this amazing city. With a background in urban planning and culinary arts, I offer unique perspectives on both the historical significance of landmarks and the best local food spots that tourists typically miss.",achievements:["Certified NYC Tour Guide","Featured in Travel Magazine 2022","History Channel Documentary Consultant"],popularTours:["Historical Manhattan Walking Tour","Brooklyn Food Experience","Architectural Marvels of NYC"]},{id:2,name:"Aisha",location:"Chicago",expertise:["Art Galleries","Urban Culture","Photography Spots"],languages:["English","Urdu","Hindi"],experience:"3 years",rating:4.9,reviews:42,image:"https://thumbs.dreamstime.com/z/happy-travel-woman-smile-to-you-sky-background-caucasian-beauty-69884089.jpg",price:"$35/hour",bio:"As a professional photographer and art enthusiast, I love showcasing Chicago's vibrant art scene and urban culture. My tours focus on both well-known galleries and hidden artistic gems, along with perfect photography spots to capture the essence of the Windy City.",achievements:["Chicago Arts Council Member","Published Photographer","Local Culture Blog Creator"],popularTours:["Chicago Art Gallery Hopping","Urban Photography Expedition","Cultural Neighborhoods Tour"]},{id:3,name:"Adam",location:"San Francisco",expertise:["Wine Tours","Coastal Trails","Hidden Viewpoints"],languages:["English","Italian","French"],experience:"7 years",rating:4.7,reviews:89,image:"https://thumbs.dreamstime.com/b/man-happy-face-smile-travel-holiday-summer-beach-hawaii-freedom-enjoy-nature-young-make-smiling-vacation-traveling-263412600.jpg",price:"$45/hour",bio:"With Italian roots and a sommelier certification, I specialize in wine tours throughout the Bay Area and Napa Valley. I also love hiking and have discovered many hidden coastal trails and viewpoints that offer breathtaking views of San Francisco and the surrounding areas.",achievements:["Certified Sommelier","Bay Area Hiking Club Founder",'Author of "Hidden San Francisco" guidebook'],popularTours:["Napa Valley Wine Experience","Secret Coastal Trails Adventure","San Francisco Hidden Viewpoints"]},{id:4,name:"Leila Nguyen",location:"Miami",expertise:["Beach Life","Nightlife","Water Sports"],languages:["English","Vietnamese","Spanish"],experience:"4 years",rating:4.6,reviews:37,image:"https://thumbs.dreamstime.com/b/pretty-female-tourist-traveling-nature-carefree-young-woman-making-touristic-travel-forest-holding-binoculars-74739503.jpg",price:"$38/hour",bio:"Miami native with a passion for beach life and water sports. I know all the best spots for sunbathing, swimming, and water activities. By night, I can guide you through Miami's exciting nightlife scene, from upscale lounges to local hotspots with the best Latin music.",achievements:["Professional Surfing Instructor","Miami Nightlife Award 2023","Water Safety Certified"],popularTours:["Miami Beach Hopping","Nightlife VIP Experience","Water Sports Adventure Day"]}].map(e=>(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow duration-300",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-48 object-cover"}),(0,Dt.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex",children:[...Array(5)].map((t,n)=>(0,Dt.jsx)("svg",{className:"h-4 w-4 ".concat(n<Math.floor(e.rating)?"text-yellow-400":"text-gray-300"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},n))}),(0,Dt.jsxs)("span",{className:"ml-1 text-xs text-white",children:[e.rating," (",e.reviews,")"]})]})})]}),(0,Dt.jsxs)("div",{className:"p-4",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500",children:[e.location," \u2022 ",e.experience]})]}),(0,Dt.jsx)("div",{className:"text-sm font-medium text-primary-600",children:e.price})]}),(0,Dt.jsxs)("div",{className:"mt-3",children:[(0,Dt.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expertise"}),(0,Dt.jsx)("div",{className:"mt-1 flex flex-wrap gap-1",children:e.expertise.map((e,t)=>(0,Dt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:e},t))})]}),(0,Dt.jsxs)("div",{className:"mt-3",children:[(0,Dt.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Languages"}),(0,Dt.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:e.languages.join(", ")})]}),(0,Dt.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,Dt.jsx)("button",{onClick:()=>{x(e),b(!1),f(!0)},className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"View Profile"}),(0,Dt.jsx)("button",{onClick:()=>{x(e),b(!0)},className:"inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Book Guide"})]})]})]},e.id))}),(0,Dt.jsx)("div",{className:"mt-8 text-center",children:(0,Dt.jsx)("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"View More Local Guides"})})]}),y&&g&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Dt.jsxs)("h2",{className:"text-xl font-semibold",children:["Book ",g.name]}),(0,Dt.jsx)("button",{onClick:()=>b(!1),className:"text-gray-500 hover:text-gray-700",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,Dt.jsx)("div",{className:"md:col-span-1",children:(0,Dt.jsx)("img",{src:g.image,alt:g.name,className:"w-full h-auto rounded-lg object-cover"})}),(0,Dt.jsxs)("div",{className:"md:col-span-2",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:g.name}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500",children:[g.location," \u2022 ",g.experience]}),(0,Dt.jsxs)("div",{className:"flex items-center mt-2",children:[(0,Dt.jsx)("div",{className:"flex",children:[...Array(5)].map((e,t)=>(0,Dt.jsx)("svg",{className:"h-4 w-4 ".concat(t<Math.floor(g.rating)?"text-yellow-400":"text-gray-300"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},t))}),(0,Dt.jsxs)("span",{className:"ml-1 text-sm text-gray-600",children:[g.rating," (",g.reviews," reviews)"]})]}),(0,Dt.jsxs)("div",{className:"mt-3",children:[(0,Dt.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Expertise"}),(0,Dt.jsx)("div",{className:"mt-1 flex flex-wrap gap-1",children:g.expertise.map((e,t)=>(0,Dt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:e},t))})]}),(0,Dt.jsxs)("div",{className:"mt-3",children:[(0,Dt.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Languages"}),(0,Dt.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:g.languages.join(", ")})]}),(0,Dt.jsxs)("div",{className:"mt-3",children:[(0,Dt.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Price"}),(0,Dt.jsx)("p",{className:"mt-1 text-lg font-semibold text-primary-600",children:g.price})]})]})]}),(0,Dt.jsxs)("form",{onSubmit:e=>{e.preventDefault(),v({id:"guide-".concat(g.id),name:"".concat(g.name," - Local Guide Service"),price:parseInt(g.price.replace(/[^0-9]/g,"")),image:g.image,type:"guide"}),_n.success("".concat(g.name," has been added to your cart!")),b(!1)},children:[(0,Dt.jsxs)("div",{className:"space-y-4 border-t border-gray-200 pt-4",children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,Dt.jsx)("input",{type:"date",id:"date",min:(new Date).toISOString().split("T")[0],className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"time",className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),(0,Dt.jsxs)("select",{id:"time",className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,children:[(0,Dt.jsx)("option",{value:"",children:"Select a time"}),(0,Dt.jsx)("option",{value:"09:00",children:"9:00 AM"}),(0,Dt.jsx)("option",{value:"10:00",children:"10:00 AM"}),(0,Dt.jsx)("option",{value:"11:00",children:"11:00 AM"}),(0,Dt.jsx)("option",{value:"12:00",children:"12:00 PM"}),(0,Dt.jsx)("option",{value:"13:00",children:"1:00 PM"}),(0,Dt.jsx)("option",{value:"14:00",children:"2:00 PM"}),(0,Dt.jsx)("option",{value:"15:00",children:"3:00 PM"}),(0,Dt.jsx)("option",{value:"16:00",children:"4:00 PM"})]})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),(0,Dt.jsxs)("select",{id:"duration",className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,children:[(0,Dt.jsx)("option",{value:"",children:"Select duration"}),(0,Dt.jsx)("option",{value:"2",children:"2 hours"}),(0,Dt.jsx)("option",{value:"3",children:"3 hours"}),(0,Dt.jsx)("option",{value:"4",children:"4 hours"}),(0,Dt.jsx)("option",{value:"6",children:"6 hours (Half day)"}),(0,Dt.jsx)("option",{value:"8",children:"8 hours (Full day)"})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"people",className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of People"}),(0,Dt.jsxs)("select",{id:"people",className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",required:!0,children:[(0,Dt.jsx)("option",{value:"",children:"Select group size"}),(0,Dt.jsx)("option",{value:"1",children:"1 person"}),(0,Dt.jsx)("option",{value:"2",children:"2 people"}),(0,Dt.jsx)("option",{value:"3",children:"3 people"}),(0,Dt.jsx)("option",{value:"4",children:"4 people"}),(0,Dt.jsx)("option",{value:"5",children:"5 people"}),(0,Dt.jsx)("option",{value:"6+",children:"6+ people (custom quote)"})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Special Requests or Notes"}),(0,Dt.jsx)("textarea",{id:"notes",rows:"3",className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"Any specific interests, accessibility requirements, or other requests..."})]})]}),(0,Dt.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,Dt.jsx)("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),(0,Dt.jsx)("button",{type:"submit",onClick:()=>{if(!("true"===localStorage.getItem("userAuth")))return _n.error("Please log in to book a guide"),b(!1),void(window.location.href="/login?redirect=/community?tab=guides");const e={id:"GUIDE-".concat(Date.now().toString().slice(-6)),type:"Local Guide",name:g.name,location:g.location,expertise:g.expertise.join(", "),date:(new Date).toLocaleDateString(),price:g.price,image:g.image};v(e),_n.success("".concat(g.name," has been added to your cart!")),b(!1)},className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Add to Cart"})]})]})]})})}),g&&!y&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Dt.jsxs)("h2",{className:"text-xl font-semibold",children:[g.name,"'s Profile"]}),(0,Dt.jsx)("button",{onClick:()=>x(null),className:"text-gray-500 hover:text-gray-700",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Dt.jsxs)("div",{className:"md:col-span-1",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("img",{src:g.image,alt:g.name,className:"w-full h-auto rounded-lg object-cover"}),(0,Dt.jsxs)("div",{className:"absolute top-2 right-2 bg-yellow-400 text-gray-900 rounded-full px-2 py-1 text-xs font-medium",children:[g.rating," \u2605"]})]}),(0,Dt.jsxs)("div",{className:"mt-4 bg-gray-50 rounded-lg p-4",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:g.name}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500",children:[g.location," \u2022 ",g.experience]}),(0,Dt.jsxs)("div",{className:"mt-4",children:[(0,Dt.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expertise"}),(0,Dt.jsx)("div",{className:"mt-1 flex flex-wrap gap-1",children:g.expertise.map((e,t)=>(0,Dt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:e},t))})]}),(0,Dt.jsxs)("div",{className:"mt-4",children:[(0,Dt.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Languages"}),(0,Dt.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:g.languages.join(", ")})]}),(0,Dt.jsxs)("div",{className:"mt-4",children:[(0,Dt.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,Dt.jsx)("p",{className:"mt-1 text-lg font-semibold text-primary-600",children:g.price})]})]})]}),(0,Dt.jsx)("div",{className:"md:col-span-2",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg",children:[(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"About Me"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:g.bio})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Achievements"}),(0,Dt.jsx)("ul",{className:"mt-2 text-sm text-gray-600 space-y-1",children:g.achievements.map((e,t)=>(0,Dt.jsxs)("li",{children:["\u2022 ",e]},t))})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Popular Tours"}),(0,Dt.jsx)("div",{className:"grid grid-cols-1 gap-3",children:g.popularTours.map((e,t)=>(0,Dt.jsx)("div",{className:"bg-gray-50 rounded-lg p-3",children:(0,Dt.jsx)("span",{className:"block text-sm font-medium text-gray-900",children:e})},t))})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Reviews"}),(0,Dt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Dt.jsx)("div",{className:"flex",children:[...Array(5)].map((e,t)=>(0,Dt.jsx)("svg",{className:"h-5 w-5 ".concat(t<Math.floor(g.rating)?"text-yellow-400":"text-gray-300"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},t))}),(0,Dt.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:[g.rating," out of 5 (",g.reviews," reviews)"]})]}),(0,Dt.jsxs)("div",{className:"space-y-3",children:[(0,Dt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,Dt.jsxs)("div",{className:"flex justify-between",children:[(0,Dt.jsx)("span",{className:"font-medium text-gray-900",children:"Sarah M."}),(0,Dt.jsx)("div",{className:"flex",children:[...Array(5)].map((e,t)=>(0,Dt.jsx)("svg",{className:"h-4 w-4 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},t))})]}),(0,Dt.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Amazing experience! Our guide was knowledgeable and showed us places we would never have found on our own."})]}),(0,Dt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,Dt.jsxs)("div",{className:"flex justify-between",children:[(0,Dt.jsx)("span",{className:"font-medium text-gray-900",children:"John D."}),(0,Dt.jsxs)("div",{className:"flex",children:[[...Array(4)].map((e,t)=>(0,Dt.jsx)("svg",{className:"h-4 w-4 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},t)),(0,Dt.jsx)("svg",{className:"h-4 w-4 text-gray-300",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})]})]}),(0,Dt.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Great tour with lots of interesting information. Would have liked a bit more time at some locations."})]})]})]}),(0,Dt.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Dt.jsx)("button",{onClick:()=>x(null),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Close"}),(0,Dt.jsx)("button",{onClick:()=>b(!0),className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Book Now"})]})]})})]})]})})}),m&&h&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Dt.jsxs)("h2",{className:"text-xl font-semibold",children:[h.name,"'s Profile"]}),(0,Dt.jsx)("button",{onClick:()=>f(!1),className:"text-gray-500 hover:text-gray-700",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Dt.jsxs)("div",{className:"md:col-span-1",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("img",{src:h.image,alt:h.name,className:"w-full h-auto rounded-lg object-cover"}),(0,Dt.jsxs)("div",{className:"absolute top-2 right-2 bg-primary-600 text-white rounded-full px-2 py-1 text-xs font-medium",children:[h.compatibility,"% Match"]})]}),(0,Dt.jsxs)("div",{className:"mt-4 bg-gray-50 rounded-lg p-4",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:h.name}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500",children:[h.age," \u2022 ",h.location]}),(0,Dt.jsxs)("div",{className:"mt-4",children:[(0,Dt.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Interests"}),(0,Dt.jsx)("div",{className:"mt-1 flex flex-wrap gap-1",children:h.interests.map((e,t)=>(0,Dt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:e},t))})]}),(0,Dt.jsxs)("div",{className:"mt-4",children:[(0,Dt.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip Preferences"}),(0,Dt.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:h.tripPreferences})]})]})]}),(0,Dt.jsx)("div",{className:"md:col-span-2",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg",children:[(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"About Me"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:h.bio})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Travel History"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Dt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,Dt.jsx)("h4",{className:"font-medium text-gray-900",children:"Recent Trips"}),(0,Dt.jsxs)("ul",{className:"mt-2 text-sm text-gray-600 space-y-1",children:[(0,Dt.jsx)("li",{children:"\u2022 Bali, Indonesia (2 months ago)"}),(0,Dt.jsx)("li",{children:"\u2022 Tokyo, Japan (6 months ago)"}),(0,Dt.jsx)("li",{children:"\u2022 Barcelona, Spain (1 year ago)"})]})]}),(0,Dt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,Dt.jsx)("h4",{className:"font-medium text-gray-900",children:"Upcoming Plans"}),(0,Dt.jsxs)("ul",{className:"mt-2 text-sm text-gray-600 space-y-1",children:[(0,Dt.jsx)("li",{children:"\u2022 Costa Rica (Next month)"}),(0,Dt.jsx)("li",{children:"\u2022 Weekend hiking trip (In 2 weeks)"})]})]})]})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Travel Style"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:[(0,Dt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[(0,Dt.jsx)("span",{className:"block text-sm font-medium text-gray-900",children:"Budget"}),(0,Dt.jsx)("span",{className:"block mt-1 text-xs text-gray-500",children:"Mid-range"})]}),(0,Dt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[(0,Dt.jsx)("span",{className:"block text-sm font-medium text-gray-900",children:"Pace"}),(0,Dt.jsx)("span",{className:"block mt-1 text-xs text-gray-500",children:"Moderate"})]}),(0,Dt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[(0,Dt.jsx)("span",{className:"block text-sm font-medium text-gray-900",children:"Planning"}),(0,Dt.jsx)("span",{className:"block mt-1 text-xs text-gray-500",children:"Flexible"})]}),(0,Dt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[(0,Dt.jsx)("span",{className:"block text-sm font-medium text-gray-900",children:"Accommodation"}),(0,Dt.jsx)("span",{className:"block mt-1 text-xs text-gray-500",children:"Hotels/Hostels"})]}),(0,Dt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[(0,Dt.jsx)("span",{className:"block text-sm font-medium text-gray-900",children:"Activities"}),(0,Dt.jsx)("span",{className:"block mt-1 text-xs text-gray-500",children:"Adventure/Culture"})]})]})]}),(0,Dt.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Dt.jsx)("button",{className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Message"}),(0,Dt.jsx)("button",{className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Connect"})]})]})})]})]})})}),l&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold",children:"Start a New Discussion"}),(0,Dt.jsx)("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Dt.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!u.title||!u.content)return void _n.error("Please fill in all required fields");const t={id:Date.now(),title:u.title,category:u.category,content:u.content,author:"You",date:(new Date).toISOString().split("T")[0],replies:0,views:1,tags:[u.category]};S([t,..._]),_n.success("Discussion posted successfully!"),c(!1),d({title:"",category:"general",content:""})},children:[(0,Dt.jsxs)("div",{className:"space-y-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discussion Title"}),(0,Dt.jsx)("input",{type:"text",id:"title",value:u.title,onChange:e=>d(Lt(Lt({},u),{},{title:e.target.value})),className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"Enter a title for your discussion",required:!0})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,Dt.jsxs)("select",{id:"category",value:u.category,onChange:e=>d(Lt(Lt({},u),{},{category:e.target.value})),className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",children:[(0,Dt.jsx)("option",{value:"general",children:"General"}),(0,Dt.jsx)("option",{value:"tips",children:"Travel Tips"}),(0,Dt.jsx)("option",{value:"safety",children:"Safety"}),(0,Dt.jsx)("option",{value:"accommodation",children:"Accommodation"}),(0,Dt.jsx)("option",{value:"transportation",children:"Transportation"}),(0,Dt.jsx)("option",{value:"food",children:"Food & Dining"}),(0,Dt.jsx)("option",{value:"attractions",children:"Attractions"})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discussion Content"}),(0,Dt.jsx)("textarea",{id:"content",rows:8,value:u.content,onChange:e=>d(Lt(Lt({},u),{},{content:e.target.value})),className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"Share your thoughts, questions, or experiences...",required:!0})]})]}),(0,Dt.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,Dt.jsx)("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,Dt.jsx)("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700",children:"Post Discussion"})]})]})]})})})]})]})},JG=wa(function(e,t){return pa(new ia.Tooltip(e,t.overlayContainer),t)},function(e,t,n,a){let{position:s}=n;(0,B.useEffect)(function(){const n=t.overlayContainer;if(null==n)return;const{instance:r}=e,i=e=>{e.tooltip===r&&(null!=s&&r.setLatLng(s),r.update(),a(!0))},o=e=>{e.tooltip===r&&a(!1)};return n.on({tooltipopen:i,tooltipclose:o}),n.bindTooltip(r),function(){n.off({tooltipopen:i,tooltipclose:o}),null!=n._map&&n.unbindTooltip()}},[e,t,a,s])}),QG={"United States":{lat:39.8283,lng:-98.5795,type:"country"},Canada:{lat:56.1304,lng:-106.3468,type:"country"},"United Kingdom":{lat:55.3781,lng:-3.436,type:"country"},Germany:{lat:51.1657,lng:10.4515,type:"country"},France:{lat:46.2276,lng:2.2137,type:"country"},Italy:{lat:41.8719,lng:12.5674,type:"country"},Spain:{lat:40.4637,lng:-3.7492,type:"country"},Australia:{lat:-25.2744,lng:133.7751,type:"country"},Japan:{lat:36.2048,lng:138.2529,type:"country"},China:{lat:35.8617,lng:104.1954,type:"country"},Brazil:{lat:-14.235,lng:-51.9253,type:"country"},Russia:{lat:61.524,lng:105.3188,type:"country"},India:{lat:20.5937,lng:78.9629,type:"country"},Mexico:{lat:23.6345,lng:-102.5528,type:"country"},"South Korea":{lat:35.9078,lng:127.7669,type:"country"},Thailand:{lat:15.87,lng:100.9925,type:"country"},Singapore:{lat:1.3521,lng:103.8198,type:"country"},Malaysia:{lat:4.2105,lng:101.9758,type:"country"},Indonesia:{lat:-.7893,lng:113.9213,type:"country"},Philippines:{lat:12.8797,lng:121.774,type:"country"},Vietnam:{lat:14.0583,lng:108.2772,type:"country"},Turkey:{lat:38.9637,lng:35.2433,type:"country"},Egypt:{lat:26.0975,lng:30.0444,type:"country"},"South Africa":{lat:-30.5595,lng:22.9375,type:"country"},Nigeria:{lat:9.082,lng:8.6753,type:"country"},Kenya:{lat:-.0236,lng:37.9062,type:"country"},Argentina:{lat:-38.4161,lng:-63.6167,type:"country"},Chile:{lat:-35.6751,lng:-71.543,type:"country"},Colombia:{lat:4.5709,lng:-74.2973,type:"country"},Peru:{lat:-9.19,lng:-75.0152,type:"country"},Venezuela:{lat:6.4238,lng:-66.5897,type:"country"},California:{lat:36.7783,lng:-119.4179,type:"state"},Texas:{lat:31.9686,lng:-99.9018,type:"state"},Florida:{lat:27.7663,lng:-82.6404,type:"state"},"New York":{lat:43.2994,lng:-74.2179,type:"state"},Illinois:{lat:40.6331,lng:-89.3985,type:"state"},Pennsylvania:{lat:41.2033,lng:-77.1945,type:"state"},Ohio:{lat:40.3888,lng:-82.7649,type:"state"},Georgia:{lat:32.1656,lng:-82.9001,type:"state"},"North Carolina":{lat:35.5397,lng:-79.8431,type:"state"},Michigan:{lat:44.3148,lng:-85.6024,type:"state"},Delhi:{lat:28.6139,lng:77.209,type:"city"},Mumbai:{lat:19.076,lng:72.8777,type:"city"},Bangalore:{lat:12.9716,lng:77.5946,type:"city"},Chennai:{lat:13.0827,lng:80.2707,type:"city"},Kolkata:{lat:22.5726,lng:88.3639,type:"city"},Hyderabad:{lat:17.385,lng:78.4867,type:"city"},Pune:{lat:18.5204,lng:73.8567,type:"city"},Ahmedabad:{lat:23.0225,lng:72.5714,type:"city"},Jaipur:{lat:26.9124,lng:75.7873,type:"city"},Gurugram:{lat:28.4595,lng:77.0266,type:"city"},Andheri:{lat:19.1197,lng:72.8468,type:"city"},Bandra:{lat:19.0606,lng:72.8365,type:"city"},Whitefield:{lat:12.9698,lng:77.7499,type:"city"},Indiranagar:{lat:12.9784,lng:77.6408,type:"city"},"Connaught Place":{lat:28.6315,lng:77.2167,type:"city"},"Cyber City":{lat:28.4946,lng:77.0882,type:"city"},"New York City":{lat:40.7128,lng:-74.006,type:"city"},"Los Angeles":{lat:34.0522,lng:-118.2437,type:"city"},Chicago:{lat:41.8781,lng:-87.6298,type:"city"},Houston:{lat:29.7604,lng:-95.3698,type:"city"},Phoenix:{lat:33.4484,lng:-112.074,type:"city"},Philadelphia:{lat:39.9526,lng:-75.1652,type:"city"},"San Antonio":{lat:29.4241,lng:-98.4936,type:"city"},"San Diego":{lat:32.7157,lng:-117.1611,type:"city"},Dallas:{lat:32.7767,lng:-96.797,type:"city"},"San Jose":{lat:37.3382,lng:-121.8863,type:"city"},London:{lat:51.5074,lng:-.1278,type:"city"},Paris:{lat:48.8566,lng:2.3522,type:"city"},Berlin:{lat:52.52,lng:13.405,type:"city"},Madrid:{lat:40.4168,lng:-3.7038,type:"city"},Rome:{lat:41.9028,lng:12.4964,type:"city"},Amsterdam:{lat:52.3676,lng:4.9041,type:"city"},Vienna:{lat:48.2082,lng:16.3738,type:"city"},Prague:{lat:50.0755,lng:14.4378,type:"city"},Warsaw:{lat:52.2297,lng:21.0122,type:"city"},Budapest:{lat:47.4979,lng:19.0402,type:"city"},Stockholm:{lat:59.3293,lng:18.0686,type:"city"},Oslo:{lat:59.9139,lng:10.7522,type:"city"},Copenhagen:{lat:55.6761,lng:12.5683,type:"city"},Helsinki:{lat:60.1699,lng:24.9384,type:"city"},Tokyo:{lat:35.6762,lng:139.6503,type:"city"},Osaka:{lat:34.6937,lng:135.5023,type:"city"},Kyoto:{lat:35.0116,lng:135.7681,type:"city"},Seoul:{lat:37.5665,lng:126.978,type:"city"},Busan:{lat:35.1796,lng:129.0756,type:"city"},Beijing:{lat:39.9042,lng:116.4074,type:"city"},Shanghai:{lat:31.2304,lng:121.4737,type:"city"},"Hong Kong":{lat:22.3193,lng:114.1694,type:"city"},Taipei:{lat:25.033,lng:121.5654,type:"city"},Bangkok:{lat:13.7563,lng:100.5018,type:"city"},Sydney:{lat:-33.8688,lng:151.2093,type:"city"},Melbourne:{lat:-37.8136,lng:144.9631,type:"city"},Brisbane:{lat:-27.4698,lng:153.0251,type:"city"},Perth:{lat:-31.9505,lng:115.8605,type:"city"},Auckland:{lat:-36.8485,lng:174.7633,type:"city"},Wellington:{lat:-41.2865,lng:174.7762,type:"city"},Cairo:{lat:30.0444,lng:31.2357,type:"city"},"Cape Town":{lat:-33.9249,lng:18.4241,type:"city"},Johannesburg:{lat:-26.2041,lng:28.0473,type:"city"},Nairobi:{lat:-1.2921,lng:36.8219,type:"city"},Lagos:{lat:6.5244,lng:3.3792,type:"city"},Casablanca:{lat:33.5731,lng:-7.5898,type:"city"},"Tel Aviv":{lat:32.0853,lng:34.7818,type:"city"},Dubai:{lat:25.2048,lng:55.2708,type:"city"},"Abu Dhabi":{lat:24.4539,lng:54.3773,type:"city"},Riyadh:{lat:24.7136,lng:46.6753,type:"city"},Jeddah:{lat:21.4858,lng:39.1925,type:"city"},Istanbul:{lat:41.0082,lng:28.9784,type:"city"},Ankara:{lat:39.9334,lng:32.8597,type:"city"},Tehran:{lat:35.6892,lng:51.389,type:"city"},Mumbai:{lat:19.076,lng:72.8777,type:"city"},"Buenos Aires":{lat:-34.6118,lng:-58.396,type:"city"},Santiago:{lat:-33.4489,lng:-70.6693,type:"city"},Lima:{lat:-12.0464,lng:-77.0428,type:"city"},"Bogot\xe1":{lat:4.711,lng:-74.0721,type:"city"},Caracas:{lat:10.4806,lng:-66.9036,type:"city"},"Mexico City":{lat:19.4326,lng:-99.1332,type:"city"},Guadalajara:{lat:20.6597,lng:-103.3496,type:"city"},Monterrey:{lat:25.6866,lng:-100.3161,type:"city"},Toronto:{lat:43.6532,lng:-79.3832,type:"city"},Vancouver:{lat:49.2827,lng:-123.1207,type:"city"},Montreal:{lat:45.5017,lng:-73.5673,type:"city"},Ottawa:{lat:45.4215,lng:-75.6972,type:"city"},Calgary:{lat:51.0447,lng:-114.0719,type:"city"}};function $G(e){let{tripDataList:t,temperatureData:n,isUpdating:a,lastUpdateTime:s,currentLocation:r,locationWeather:i,searchedLocation:o,searchedLocationWeather:l,isTrackingLocation:c}=e;const u={};t.forEach(e=>{let t=!1;Object.keys(QG).forEach(n=>{e.origin&&e.origin.includes(n)&&(u[n]=(u[n]||0)+1,t=!0)}),!t&&e.origin&&(u.Other=(u.Other||0)+1)});const d=Object.entries(QG).map(e=>{let[t,a]=e;const s=u[t]||0,r=n[t]||{temp:20,condition:"Pleasant",humidity:65,windSpeed:8};return Lt(Lt({},a),{},{count:s,city:t,temperature:r.temp,condition:r.condition,humidity:r.humidity,windSpeed:r.windSpeed})});return(0,Dt.jsxs)("div",{className:"w-full h-96 rounded-lg overflow-hidden border mb-6 relative",children:[(0,Dt.jsx)("style",{jsx:!0,children:"\n        .temperature-tooltip {\n          background: rgba(255, 255, 255, 0.95) !important;\n          border: 1px solid #e5e7eb !important;\n          border-radius: 8px !important;\n          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;\n          backdrop-filter: blur(10px) !important;\n        }\n        .temperature-tooltip .leaflet-popup-content-wrapper {\n          background: transparent !important;\n          box-shadow: none !important;\n          border-radius: 8px !important;\n        }\n        .temperature-tooltip .leaflet-popup-content {\n          margin: 0 !important;\n          padding: 0 !important;\n        }\n        .temperature-tooltip .leaflet-popup-tip-container {\n          display: none !important;\n        }\n      "}),(0,Dt.jsx)("div",{className:"absolute top-2 left-2 z-50 bg-white bg-opacity-90 rounded-lg px-3 py-2 shadow-md",children:(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(a?"bg-yellow-500 animate-pulse":"bg-green-500")}),(0,Dt.jsx)("span",{className:"text-xs font-medium text-gray-700",children:a?"Updating weather...":"Live Weather Data"}),s&&(0,Dt.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["Last update: ",s.toLocaleTimeString()]})]})}),(0,Dt.jsxs)(da,{center:r&&c?[r.lat,r.lng]:o?[o.lat,o.lng]:[20,0],zoom:r&&c?12:o?8:2,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[(0,Dt.jsx)(_a,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),d.map((e,t)=>{const n=(a=e.temperature)>=35?{color:"#dc2626",fillColor:"#ef4444",fillOpacity:.7}:a>=30?{color:"#ea580c",fillColor:"#f97316",fillOpacity:.6}:a>=25?{color:"#ca8a04",fillColor:"#eab308",fillOpacity:.5}:a>=20?{color:"#16a34a",fillColor:"#22c55e",fillOpacity:.4}:{color:"#2563eb",fillColor:"#3b82f6",fillOpacity:.3};var a;return(0,Dt.jsx)(Ta,{center:[e.lat,e.lng],radius:Math.max(8,Math.min(25,8+1.5*e.count)),pathOptions:n,children:(0,Dt.jsx)(JG,{direction:"top",offset:[0,-10],opacity:1,permanent:!0,className:"temperature-tooltip",children:(0,Dt.jsxs)("div",{className:"text-center min-w-[140px] bg-white rounded-lg shadow-lg p-3 border border-gray-200",children:[(0,Dt.jsx)("div",{className:"font-bold text-gray-900 text-sm mb-1",children:e.city}),(0,Dt.jsx)("div",{className:"text-xs text-gray-600 mb-2",children:e.count>0?"".concat(e.count," trip").concat(e.count>1?"s":""):"No trips"}),(0,Dt.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,Dt.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:[e.temperature,"\xb0C"]}),(0,Dt.jsx)("span",{className:"ml-2 text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:e.condition})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("span",{className:"mr-1",children:"\ud83d\udca7"}),(0,Dt.jsxs)("span",{children:[e.humidity,"%"]})]}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("span",{className:"mr-1",children:"\ud83d\udca8"}),(0,Dt.jsxs)("span",{children:[e.windSpeed,"m/s"]})]})]}),(0,Dt.jsx)("div",{className:"text-xs text-gray-400 mt-2 pt-2 border-t border-gray-100",children:"\ud83d\udd04 Live Weather Data"})]})})},t)}),r&&(0,Dt.jsx)(Ta,{center:[r.lat,r.lng],radius:15,pathOptions:{color:"#ff0000",fillColor:"#ff4444",fillOpacity:.8},children:(0,Dt.jsx)(JG,{direction:"top",offset:[0,-10],opacity:1,permanent:!0,className:"temperature-tooltip",children:(0,Dt.jsxs)("div",{className:"text-center min-w-[160px] bg-white rounded-lg shadow-lg p-3 border border-red-200",children:[(0,Dt.jsx)("div",{className:"font-bold text-red-600 text-sm mb-1",children:"\ud83d\udccd Your Location"}),i&&(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,Dt.jsxs)("span",{className:"text-2xl font-bold text-red-600",children:[i.temp,"\xb0C"]}),(0,Dt.jsx)("span",{className:"ml-2 text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:i.condition})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("span",{className:"mr-1",children:"\ud83d\udca7"}),(0,Dt.jsxs)("span",{children:[i.humidity,"%"]})]}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("span",{className:"mr-1",children:"\ud83d\udca8"}),(0,Dt.jsxs)("span",{children:[i.windSpeed,"m/s"]})]})]}),(0,Dt.jsx)("div",{className:"text-xs text-gray-400 mt-2 pt-2 border-t border-gray-100",children:"\ud83d\udd04 Live Location Weather"})]}),!i&&(0,Dt.jsx)("div",{className:"text-xs text-gray-500",children:"Loading weather..."})]})})}),o&&(0,Dt.jsx)(Ta,{center:[o.lat,o.lng],radius:18,pathOptions:{color:"#8b5cf6",fillColor:"#a855f7",fillOpacity:.8},children:(0,Dt.jsx)(JG,{direction:"top",offset:[0,-10],opacity:1,permanent:!0,className:"temperature-tooltip",children:(0,Dt.jsxs)("div",{className:"text-center min-w-[160px] bg-white rounded-lg shadow-lg p-3 border border-purple-200",children:[(0,Dt.jsx)("div",{className:"font-bold text-purple-600 text-sm mb-1",children:"\ud83d\udd0d Searched Location"}),(0,Dt.jsx)("div",{className:"text-xs text-gray-600 mb-2 truncate",style:{maxWidth:"200px"},children:o.displayName||o.locationName}),l&&(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,Dt.jsxs)("span",{className:"text-2xl font-bold text-purple-600",children:[l.temp,"\xb0C"]}),(0,Dt.jsx)("span",{className:"ml-2 text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:l.condition})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("span",{className:"mr-1",children:"\ud83d\udca7"}),(0,Dt.jsxs)("span",{children:[l.humidity,"%"]})]}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("span",{className:"mr-1",children:"\ud83d\udca8"}),(0,Dt.jsxs)("span",{children:[l.windSpeed,"m/s"]})]})]}),(0,Dt.jsx)("div",{className:"text-xs text-gray-400 mt-2 pt-2 border-t border-gray-100",children:"\ud83d\udd04 Auto-updating every 60s"})]}),!l&&(0,Dt.jsx)("div",{className:"text-xs text-gray-500",children:"Loading weather..."})]})})})]},r&&c?"".concat(r.lat,"-").concat(r.lng):o?"".concat(o.lat,"-").concat(o.lng):"default-center")]})}const eq=function(){const[e,t]=(0,B.useState)("dashboard"),[n,a]=(0,B.useState)(null),[s,r]=(0,B.useState)("week"),[i,o]=(0,B.useState)("csv"),[l,c]=(0,B.useState)(!1),[u,d]=(0,B.useState)(""),[h,p]=(0,B.useState)(""),[m,f]=(0,B.useState)(""),[g,x]=(0,B.useState)([]);(0,B.useEffect)(()=>{"dashboard"!==e&&"bookings"!==e||x(On())},[e]);const[y,b]=(0,B.useState)({origin:"",destination:"",startTime:"",endTime:"",mode:"car",purpose:"work",accompaniedBy:0,consentGiven:!1}),[v,w]=(0,B.useState)([]),[k,N]=(0,B.useState)(!1),_=[{email:"admin@natpac.org",password:"natpac123",organization:"NATPAC",role:"Administrator"},{email:"manager@natpac.org",password:"manager456",organization:"NATPAC",role:"Manager"},{email:"analyst@natpac.org",password:"analyst789",organization:"NATPAC",role:"Data Analyst"},{email:"admintravell5525@gmail.com",password:"admin55@55travell",organization:"NATPAC",role:"Super Administrator"}],[S,C]=(0,B.useState)(""),[j,T]=(0,B.useState)(""),I={totalTrips:12458,activeUsers:3245,averageTripLength:8.7,popularModes:[{mode:"Car",percentage:45},{mode:"Public Transit",percentage:30},{mode:"Walking",percentage:15},{mode:"Cycling",percentage:10}],tripsByDay:[{day:"Mon",count:1850},{day:"Tue",count:2100},{day:"Wed",count:1950},{day:"Thu",count:2300},{day:"Fri",count:2450},{day:"Sat",count:1200},{day:"Sun",count:950}],tripsByWeek:[{week:"Week 1",count:8500},{week:"Week 2",count:9200},{week:"Week 3",count:7800},{week:"Week 4",count:8900}],peakHours:[{hour:"7-8 AM",count:1250},{hour:"8-9 AM",count:1850},{hour:"5-6 PM",count:1650},{hour:"6-7 PM",count:1450}],popularDestinations:[{name:"Central Business District",count:3250},{name:"University Area",count:2100},{name:"Shopping Mall",count:1850},{name:"Tech Park",count:1650},{name:"Airport",count:950}]},E=[{id:"T1001",userId:"U5432",username:"rahul_sharma",origin:"Connaught Place, Delhi",destination:"Cyber City, Gurugram",startTime:"2023-09-15T08:30:00",endTime:"2023-09-15T09:45:00",mode:"Car",distance:28.5,duration:75,accompaniedBy:2,purpose:"Work",consentGiven:!0,automaticallyDetected:!0},{id:"T1002",userId:"U2187",username:"priya_patel",origin:"Indiranagar, Bangalore",destination:"Whitefield, Bangalore",startTime:"2023-09-15T09:15:00",endTime:"2023-09-15T10:30:00",mode:"Bus",distance:15.2,duration:75,accompaniedBy:0,purpose:"Work",consentGiven:!0,automaticallyDetected:!1},{id:"T1003",userId:"U7891",username:"amit_kumar",origin:"Andheri, Mumbai",destination:"Bandra, Mumbai",startTime:"2023-09-15T18:00:00",endTime:"2023-09-15T18:45:00",mode:"Train",distance:8.7,duration:45,accompaniedBy:1,purpose:"Shopping",consentGiven:!0,automaticallyDetected:!0}];(0,B.useEffect)(()=>{w(E)},[]);const[A,R]=(0,B.useState)(!1),[M,L]=(0,B.useState)(new Date),[D,O]=(0,B.useState)(!1),[F,P]=(0,B.useState)(null),[z,W]=(0,B.useState)(null),[V,U]=(0,B.useState)(null),[H,G]=(0,B.useState)(""),[q,K]=(0,B.useState)(null),[Z,X]=(0,B.useState)(null),[Y,J]=(0,B.useState)(!1),[Q,$]=(0,B.useState)(null),[ee,te]=(0,B.useState)(new Date),[ne,ae]=(0,B.useState)(!1),[se,re]=(0,B.useState)({"United States":{temp:15,condition:"Cool",humidity:60,windSpeed:8},Canada:{temp:8,condition:"Cold",humidity:70,windSpeed:12},"United Kingdom":{temp:12,condition:"Cool",humidity:75,windSpeed:10},Germany:{temp:10,condition:"Cool",humidity:65,windSpeed:9},France:{temp:14,condition:"Mild",humidity:68,windSpeed:7},Italy:{temp:16,condition:"Mild",humidity:62,windSpeed:6},Spain:{temp:18,condition:"Warm",humidity:58,windSpeed:8},Australia:{temp:22,condition:"Pleasant",humidity:55,windSpeed:11},Japan:{temp:13,condition:"Cool",humidity:72,windSpeed:9},China:{temp:11,condition:"Cool",humidity:64,windSpeed:7},Brazil:{temp:26,condition:"Warm",humidity:78,windSpeed:5},Russia:{temp:2,condition:"Very Cold",humidity:80,windSpeed:15},India:{temp:28,condition:"Warm",humidity:70,windSpeed:6},Mexico:{temp:20,condition:"Pleasant",humidity:65,windSpeed:8},"South Korea":{temp:12,condition:"Cool",humidity:68,windSpeed:10},Thailand:{temp:30,condition:"Hot",humidity:82,windSpeed:4},Singapore:{temp:29,condition:"Hot",humidity:85,windSpeed:3},Malaysia:{temp:28,condition:"Warm",humidity:80,windSpeed:5},Indonesia:{temp:27,condition:"Warm",humidity:83,windSpeed:4},Philippines:{temp:28,condition:"Warm",humidity:81,windSpeed:6},Vietnam:{temp:26,condition:"Warm",humidity:78,windSpeed:5},Turkey:{temp:15,condition:"Cool",humidity:62,windSpeed:8},Egypt:{temp:25,condition:"Warm",humidity:55,windSpeed:7},"South Africa":{temp:18,condition:"Mild",humidity:60,windSpeed:9},Nigeria:{temp:30,condition:"Hot",humidity:75,windSpeed:6},Kenya:{temp:22,condition:"Pleasant",humidity:68,windSpeed:8},Argentina:{temp:16,condition:"Mild",humidity:65,windSpeed:12},Chile:{temp:14,condition:"Cool",humidity:70,windSpeed:14},Colombia:{temp:24,condition:"Pleasant",humidity:72,windSpeed:7},Peru:{temp:20,condition:"Pleasant",humidity:68,windSpeed:9},Venezuela:{temp:28,condition:"Warm",humidity:76,windSpeed:5},California:{temp:18,condition:"Mild",humidity:60,windSpeed:10},Texas:{temp:22,condition:"Pleasant",humidity:65,windSpeed:12},Florida:{temp:25,condition:"Warm",humidity:78,windSpeed:8},"New York":{temp:12,condition:"Cool",humidity:68,windSpeed:11},Illinois:{temp:10,condition:"Cool",humidity:70,windSpeed:13},Pennsylvania:{temp:11,condition:"Cool",humidity:69,windSpeed:10},Ohio:{temp:9,condition:"Cool",humidity:71,windSpeed:12},Georgia:{temp:20,condition:"Pleasant",humidity:72,windSpeed:9},"North Carolina":{temp:17,condition:"Cool",humidity:70,windSpeed:10},Michigan:{temp:6,condition:"Cold",humidity:75,windSpeed:14},Delhi:{temp:32,condition:"Hot",humidity:65,windSpeed:5},Mumbai:{temp:28,condition:"Humid",humidity:78,windSpeed:7},Bangalore:{temp:24,condition:"Pleasant",humidity:68,windSpeed:8},Chennai:{temp:30,condition:"Warm",humidity:80,windSpeed:6},Kolkata:{temp:29,condition:"Humid",humidity:75,windSpeed:6},Hyderabad:{temp:31,condition:"Hot",humidity:70,windSpeed:7},Pune:{temp:26,condition:"Nice",humidity:62,windSpeed:8},Ahmedabad:{temp:33,condition:"Very Hot",humidity:60,windSpeed:9},Jaipur:{temp:34,condition:"Very Hot",humidity:55,windSpeed:8},Gurugram:{temp:31,condition:"Hot",humidity:63,windSpeed:6},Andheri:{temp:28,condition:"Humid",humidity:76,windSpeed:7},Bandra:{temp:28,condition:"Humid",humidity:77,windSpeed:6},Whitefield:{temp:24,condition:"Pleasant",humidity:69,windSpeed:8},Indiranagar:{temp:24,condition:"Pleasant",humidity:67,windSpeed:7},"Connaught Place":{temp:32,condition:"Hot",humidity:64,windSpeed:5},"Cyber City":{temp:31,condition:"Hot",humidity:62,windSpeed:6},"New York City":{temp:13,condition:"Cool",humidity:66,windSpeed:12},"Los Angeles":{temp:20,condition:"Pleasant",humidity:58,windSpeed:9},Chicago:{temp:8,condition:"Cold",humidity:72,windSpeed:15},Houston:{temp:24,condition:"Warm",humidity:73,windSpeed:8},Phoenix:{temp:28,condition:"Warm",humidity:35,windSpeed:7},Philadelphia:{temp:12,condition:"Cool",humidity:67,windSpeed:11},"San Antonio":{temp:23,condition:"Pleasant",humidity:70,windSpeed:9},"San Diego":{temp:19,condition:"Mild",humidity:65,windSpeed:8},Dallas:{temp:21,condition:"Pleasant",humidity:68,windSpeed:11},"San Jose":{temp:16,condition:"Cool",humidity:63,windSpeed:10},London:{temp:11,condition:"Cool",humidity:78,windSpeed:13},Paris:{temp:13,condition:"Cool",humidity:71,windSpeed:9},Berlin:{temp:9,condition:"Cool",humidity:73,windSpeed:12},Madrid:{temp:15,condition:"Cool",humidity:60,windSpeed:8},Rome:{temp:16,condition:"Mild",humidity:68,windSpeed:7},Amsterdam:{temp:10,condition:"Cool",humidity:80,windSpeed:14},Vienna:{temp:8,condition:"Cold",humidity:75,windSpeed:11},Prague:{temp:7,condition:"Cold",humidity:77,windSpeed:10},Warsaw:{temp:5,condition:"Very Cold",humidity:82,windSpeed:13},Budapest:{temp:9,condition:"Cool",humidity:74,windSpeed:9},Stockholm:{temp:3,condition:"Very Cold",humidity:85,windSpeed:16},Oslo:{temp:1,condition:"Very Cold",humidity:88,windSpeed:18},Copenhagen:{temp:6,condition:"Cold",humidity:81,windSpeed:15},Helsinki:{temp:2,condition:"Very Cold",humidity:87,windSpeed:17},Tokyo:{temp:14,condition:"Cool",humidity:70,windSpeed:11},Osaka:{temp:15,condition:"Cool",humidity:68,windSpeed:9},Kyoto:{temp:13,condition:"Cool",humidity:72,windSpeed:8},Seoul:{temp:10,condition:"Cool",humidity:65,windSpeed:12},Busan:{temp:12,condition:"Cool",humidity:66,windSpeed:10},Beijing:{temp:8,condition:"Cold",humidity:58,windSpeed:9},Shanghai:{temp:12,condition:"Cool",humidity:71,windSpeed:8},"Hong Kong":{temp:22,condition:"Pleasant",humidity:75,windSpeed:6},Taipei:{temp:20,condition:"Pleasant",humidity:73,windSpeed:7},Bangkok:{temp:31,condition:"Hot",humidity:84,windSpeed:3},Sydney:{temp:22,condition:"Pleasant",humidity:62,windSpeed:13},Melbourne:{temp:18,condition:"Mild",humidity:65,windSpeed:15},Brisbane:{temp:24,condition:"Pleasant",humidity:68,windSpeed:11},Perth:{temp:21,condition:"Pleasant",humidity:58,windSpeed:14},Auckland:{temp:16,condition:"Cool",humidity:75,windSpeed:12},Wellington:{temp:13,condition:"Cool",humidity:78,windSpeed:18},Cairo:{temp:24,condition:"Pleasant",humidity:48,windSpeed:8},"Cape Town":{temp:19,condition:"Mild",humidity:65,windSpeed:11},Johannesburg:{temp:17,condition:"Cool",humidity:62,windSpeed:10},Nairobi:{temp:20,condition:"Pleasant",humidity:70,windSpeed:9},Lagos:{temp:31,condition:"Hot",humidity:78,windSpeed:5},Casablanca:{temp:18,condition:"Mild",humidity:72,windSpeed:12},"Tel Aviv":{temp:21,condition:"Pleasant",humidity:68,windSpeed:10},Dubai:{temp:32,condition:"Very Hot",humidity:60,windSpeed:7},"Abu Dhabi":{temp:33,condition:"Very Hot",humidity:58,windSpeed:8},Riyadh:{temp:35,condition:"Very Hot",humidity:25,windSpeed:9},Jeddah:{temp:33,condition:"Very Hot",humidity:65,windSpeed:8},Istanbul:{temp:14,condition:"Cool",humidity:70,windSpeed:11},Ankara:{temp:11,condition:"Cool",humidity:68,windSpeed:10},Tehran:{temp:12,condition:"Cool",humidity:52,windSpeed:8},"Buenos Aires":{temp:17,condition:"Cool",humidity:72,windSpeed:13},Santiago:{temp:14,condition:"Cool",humidity:65,windSpeed:10},Lima:{temp:19,condition:"Mild",humidity:78,windSpeed:9},"Bogot\xe1":{temp:14,condition:"Cool",humidity:75,windSpeed:8},Caracas:{temp:26,condition:"Warm",humidity:73,windSpeed:6},"Mexico City":{temp:16,condition:"Cool",humidity:56,windSpeed:7},Guadalajara:{temp:20,condition:"Pleasant",humidity:60,windSpeed:8},Monterrey:{temp:22,condition:"Pleasant",humidity:62,windSpeed:10},Toronto:{temp:7,condition:"Cold",humidity:74,windSpeed:14},Vancouver:{temp:9,condition:"Cool",humidity:78,windSpeed:12},Montreal:{temp:5,condition:"Very Cold",humidity:76,windSpeed:15},Ottawa:{temp:4,condition:"Very Cold",humidity:78,windSpeed:16},Calgary:{temp:2,condition:"Very Cold",humidity:68,windSpeed:18},Other:{temp:20,condition:"Pleasant",humidity:65,windSpeed:8}}),ie=(0,B.useCallback)(async()=>{R(!0);const e={"New York":{lat:40.7128,lon:-74.006},"Los Angeles":{lat:34.0522,lon:-118.2437},Chicago:{lat:41.8781,lon:-87.6298},London:{lat:51.5074,lon:-.1278},Paris:{lat:48.8566,lon:2.3522},Berlin:{lat:52.52,lon:13.405},Tokyo:{lat:35.6762,lon:139.6503},Beijing:{lat:39.9042,lon:116.4074},Sydney:{lat:-33.8688,lon:151.2093},Mumbai:{lat:19.076,lon:72.8777},Delhi:{lat:28.6139,lon:77.209},Bangalore:{lat:12.9716,lon:77.5946},"S\xe3o Paulo":{lat:-23.5505,lon:-46.6333},"Buenos Aires":{lat:-34.6037,lon:-58.3816},Cairo:{lat:30.0444,lon:31.2357},"Cape Town":{lat:-33.9249,lon:18.4241},Dubai:{lat:25.2048,lon:55.2708},Singapore:{lat:1.3521,lon:103.8198},"Hong Kong":{lat:22.3193,lon:114.1694},Toronto:{lat:43.6532,lon:-79.3832},"Mexico City":{lat:19.4326,lon:-99.1332}},t=Lt({},se);try{const n=Object.entries(e).map(async e=>{let[t,n]=e;try{const e=await fetch("https://api.openweathermap.org/data/2.5/weather?lat=".concat(n.lat,"&lon=").concat(n.lon,"&appid=").concat("demo_key","&units=metric"));if(e.ok){const n=await e.json();return{city:t,temp:Math.round(10*n.main.temp)/10,condition:n.weather[0].main,humidity:n.main.humidity,windSpeed:n.wind.speed}}return{city:t,temp:Math.round(10*(se[t].temp+2*(Math.random()-.5)))/10,condition:se[t].condition,humidity:65,windSpeed:5}}catch(m){return{city:t,temp:Math.round(10*(se[t].temp+2*(Math.random()-.5)))/10,condition:se[t].condition,humidity:65,windSpeed:5}}});(await Promise.all(n)).forEach(e=>{e&&e.city&&(t[e.city]={temp:e.temp,condition:e.condition,humidity:e.humidity,windSpeed:e.windSpeed})}),re(t),L(new Date)}catch(m){console.error("Error fetching weather data:",m),oe()}finally{R(!1)}},[se]),oe=(0,B.useCallback)(()=>{const e=Lt({},se);Object.keys(e).forEach(t=>{if("Other"!==t){const n=4*(Math.random()-.5);e[t].temp=Math.round(10*(e[t].temp+n))/10,e[t].temp>=35?e[t].condition="Very Hot":e[t].temp>=30?e[t].condition="Hot":e[t].temp>=25?e[t].condition="Warm":e[t].temp>=15?e[t].condition="Pleasant":e[t].temp>=5?e[t].condition="Cool":e[t].condition="Cold";const a=Math.floor(10*(Math.random()-.5));e[t].humidity=Math.max(20,Math.min(95,e[t].humidity+a));const s=4*(Math.random()-.5);e[t].windSpeed=Math.max(0,Math.round(10*(e[t].windSpeed+s))/10)}}),re(e),L(new Date)},[se]);(0,B.useEffect)(()=>{"heatmap"===e&&ie();const t=setInterval(()=>{"heatmap"===e&&ie()},6e4);return()=>clearInterval(t)},[e,ie]);const le=e=>{e.preventDefault();const t=_.find(e=>e.email===u&&e.password===h);t?(c(!0),C(t.organization),T(t.role),f(""),localStorage.setItem("adminAuth","true"),localStorage.setItem("adminOrg",t.organization),localStorage.setItem("adminRole",t.role)):f("Invalid credentials. Please try again.")};(0,B.useEffect)(()=>{"true"===localStorage.getItem("adminAuth")&&(c(!0),C(localStorage.getItem("adminOrg")||""),T(localStorage.getItem("adminRole")||""))},[]);const ce=e=>{const{name:t,value:n,type:a,checked:s}=e.target;b(e=>Lt(Lt({},e),{},{[t]:"checkbox"===a?s:n}))},ue=()=>{if(!y.consentGiven)return void N(!0);const e=Lt(Lt({id:"T".concat(Math.floor(1e3+9e3*Math.random())),userId:"U".concat(Math.floor(1e3+9e3*Math.random())),username:"current_user"},y),{},{distance:Math.floor(30*Math.random())+1,duration:Math.floor(90*Math.random())+15,automaticallyDetected:Math.random()>.5});w(t=>[e,...t]),b({origin:"",destination:"",startTime:"",endTime:"",mode:"car",purpose:"work",accompaniedBy:0,consentGiven:!1}),alert("Trip data saved successfully!")},de=e=>{N(!1),e&&(b(e=>Lt(Lt({},e),{},{consentGiven:!0})),setTimeout(()=>ue(),100))},he=async(e,t)=>{try{const n="demo_key",a=await fetch("https://api.openweathermap.org/data/2.5/weather?lat=".concat(e,"&lon=").concat(t,"&appid=").concat(n,"&units=metric"));if(a.ok){const e=await a.json();W({temp:Math.round(10*e.main.temp)/10,condition:e.weather[0].main,humidity:e.main.humidity,windSpeed:e.wind.speed,location:e.name||"Your Location"})}else{const e=Math.round(10*(20+15*Math.random()))/10,t=["Pleasant","Warm","Cool","Sunny","Cloudy"];W({temp:e,condition:t[Math.floor(Math.random()*t.length)],humidity:Math.round(50+30*Math.random()),windSpeed:Math.round(10*(3+7*Math.random()))/10,location:"Your Location"})}}catch(m){console.error("Weather fetch error:",m);const t=Math.round(10*(20+15*Math.random()))/10,n=["Pleasant","Warm","Cool","Sunny","Cloudy"];W({temp:t,condition:n[Math.floor(Math.random()*n.length)],humidity:Math.round(50+30*Math.random()),windSpeed:Math.round(10*(3+7*Math.random()))/10,location:"Your Location"})}};(0,B.useEffect)(()=>{let e;return D&&F&&(e=setInterval(()=>{he(F.lat,F.lng)},6e4)),()=>{e&&clearInterval(e)}},[D,F]);const pe=async(e,t)=>{try{const n="demo_key",a=await fetch("https://api.openweathermap.org/data/2.5/weather?lat=".concat(e,"&lon=").concat(t,"&appid=").concat(n,"&units=metric"));if(a.ok){const e=await a.json();X({temp:Math.round(10*e.main.temp)/10,condition:e.weather[0].main,humidity:e.main.humidity,windSpeed:e.wind.speed,locationName:e.name||H})}else{const e=Math.round(10*(20+15*Math.random()))/10,t=["Pleasant","Warm","Cool","Sunny","Cloudy"];X({temp:e,condition:t[Math.floor(Math.random()*t.length)],humidity:Math.round(50+30*Math.random()),windSpeed:Math.round(10*(3+7*Math.random()))/10,locationName:H})}}catch(m){console.error("Weather fetch error for searched location:",m);const t=Math.round(10*(20+15*Math.random()))/10,n=["Pleasant","Warm","Cool","Sunny","Cloudy"];X({temp:t,condition:n[Math.floor(Math.random()*n.length)],humidity:Math.round(50+30*Math.random()),windSpeed:Math.round(10*(3+7*Math.random()))/10,locationName:H})}},me=async()=>{if(H.trim()){J(!0);try{const e=await(async e=>{try{const t=await fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(e),"&limit=1"));if(t.ok){const e=await t.json();if(e&&e.length>0)return{lat:parseFloat(e[0].lat),lng:parseFloat(e[0].lon),displayName:e[0].display_name}}return null}catch(m){return console.error("Geocoding error:",m),null}})(H);if(e){K(e),await pe(e.lat,e.lng),Q&&clearInterval(Q);const t=setInterval(()=>{pe(e.lat,e.lng)},6e4);$(t)}else alert("Location not found. Please try a different search term.")}catch(m){console.error("Search error:",m),alert("Error searching for location. Please try again.")}finally{J(!1)}}};return(0,B.useEffect)(()=>()=>{Q&&clearInterval(Q)},[Q]),l?(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Dt.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Panel"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:"Access and analyze anonymized user trip data"}),(0,Dt.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800 mr-2",children:S}),(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:j})]})]}),(0,Dt.jsx)("button",{onClick:()=>{c(!1),C(""),T(""),localStorage.removeItem("adminAuth"),localStorage.removeItem("adminOrg"),localStorage.removeItem("adminRole")},className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 mr-3",children:"Logout"}),(0,Dt.jsxs)("div",{className:"mt-4 md:mt-0 flex flex-wrap gap-3",children:[(0,Dt.jsxs)("select",{value:s,onChange:e=>r(e.target.value),className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500",children:[(0,Dt.jsx)("option",{value:"today",children:"Today"}),(0,Dt.jsx)("option",{value:"week",children:"This Week"}),(0,Dt.jsx)("option",{value:"month",children:"This Month"}),(0,Dt.jsx)("option",{value:"quarter",children:"This Quarter"}),(0,Dt.jsx)("option",{value:"year",children:"This Year"})]}),(0,Dt.jsxs)("div",{className:"flex",children:[(0,Dt.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"border border-gray-300 rounded-l-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500",children:[(0,Dt.jsx)("option",{value:"csv",children:"CSV"}),(0,Dt.jsx)("option",{value:"excel",children:"Excel"}),(0,Dt.jsx)("option",{value:"json",children:"JSON"}),(0,Dt.jsx)("option",{value:"pdf",children:"PDF Report"})]}),(0,Dt.jsx)("button",{onClick:()=>{alert("Exporting data in ".concat(i.toUpperCase()," format for the selected ").concat(s," period"))},className:"bg-primary-600 text-white px-4 py-1.5 rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",children:"Export Data"})]})]})]}),(0,Dt.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,Dt.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,Dt.jsx)("button",{onClick:()=>t("dashboard"),className:"".concat("dashboard"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Dashboard"}),(0,Dt.jsx)("button",{onClick:()=>t("bookings"),className:"".concat("bookings"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Bookings"}),(0,Dt.jsx)("button",{onClick:()=>t("heatmap"),className:"".concat("heatmap"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Trip Heatmap"}),(0,Dt.jsx)("button",{onClick:()=>t("patterns"),className:"".concat("patterns"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Trip Patterns"}),(0,Dt.jsx)("button",{onClick:()=>t("users"),className:"".concat("users"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"User Data"}),(0,Dt.jsx)("button",{onClick:()=>t("tripdata"),className:"".concat("tripdata"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Trip Data Collection"})]})}),"dashboard"===e&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 rounded-md bg-blue-100 p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),(0,Dt.jsxs)("div",{className:"ml-5",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Trips"}),(0,Dt.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:I.totalTrips.toLocaleString()})]})]}),(0,Dt.jsx)("div",{className:"mt-4",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsxs)("span",{className:"text-green-500 text-sm font-medium flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}),"8.2%"]}),(0,Dt.jsx)("span",{className:"text-gray-500 text-sm ml-2",children:"from previous period"})]})})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 rounded-md bg-green-100 p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,Dt.jsxs)("div",{className:"ml-5",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Users"}),(0,Dt.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:I.activeUsers.toLocaleString()})]})]}),(0,Dt.jsx)("div",{className:"mt-4",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsxs)("span",{className:"text-green-500 text-sm font-medium flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}),"5.7%"]}),(0,Dt.jsx)("span",{className:"text-gray-500 text-sm ml-2",children:"from previous period"})]})})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 rounded-md bg-purple-100 p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-purple-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),(0,Dt.jsxs)("div",{className:"ml-5",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg. Trip Length"}),(0,Dt.jsxs)("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:[I.averageTripLength," km"]})]})]}),(0,Dt.jsx)("div",{className:"mt-4",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsxs)("span",{className:"text-red-500 text-sm font-medium flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M12 13a1 1 0 100 2h5a1 1 0 001-1V9a1 1 0 10-2 0v2.586l-4.293-4.293a1 1 0 00-1.414 0L8 9.586 3.707 5.293a1 1 0 00-1.414 1.414l5 5a1 1 0 001.414 0L11 9.414 14.586 13H12z",clipRule:"evenodd"})}),"2.3%"]}),(0,Dt.jsx)("span",{className:"text-gray-500 text-sm ml-2",children:"from previous period"})]})})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 rounded-md bg-yellow-100 p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Dt.jsxs)("div",{className:"ml-5",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Peak Travel Time"}),(0,Dt.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:"8-9 AM"})]})]}),(0,Dt.jsx)("div",{className:"mt-4",children:(0,Dt.jsx)("div",{className:"flex items-center",children:(0,Dt.jsx)("span",{className:"text-gray-500 text-sm",children:"1,850 trips during this hour"})})})]})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Trips by Day of Week"}),(0,Dt.jsxs)("div",{className:"h-64",children:[(0,Dt.jsxs)("div",{className:"h-full relative",children:[(0,Dt.jsxs)("div",{className:"absolute left-0 top-0 h-full w-10 flex flex-col justify-between text-xs text-gray-500 font-medium",children:[(0,Dt.jsx)("span",{children:"2500"}),(0,Dt.jsx)("span",{children:"2000"}),(0,Dt.jsx)("span",{children:"1500"}),(0,Dt.jsx)("span",{children:"1000"}),(0,Dt.jsx)("span",{children:"500"}),(0,Dt.jsx)("span",{children:"0"})]}),(0,Dt.jsxs)("div",{className:"ml-10 h-full flex flex-col",children:[(0,Dt.jsx)("div",{className:"h-full w-full absolute grid grid-rows-5 gap-0",children:[...Array(6)].map((e,t)=>(0,Dt.jsx)("div",{className:"border-t border-gray-200 w-full"},t))}),(0,Dt.jsx)("div",{className:"h-full w-full relative",children:(0,Dt.jsxs)("svg",{className:"h-full w-full",viewBox:"0 0 700 300",preserveAspectRatio:"none",children:[(0,Dt.jsxs)("defs",{children:[(0,Dt.jsxs)("linearGradient",{id:"blueGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[(0,Dt.jsx)("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.8"}),(0,Dt.jsx)("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:"0.1"})]}),(0,Dt.jsxs)("filter",{id:"glow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[(0,Dt.jsx)("feGaussianBlur",{stdDeviation:"4",result:"blur"}),(0,Dt.jsx)("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})]}),(0,Dt.jsx)("path",{d:" M 0,${300 - (tripData.tripsByDay[0].count / 2500) * 300} L 100,${300 - (tripData.tripsByDay[1].count / 2500) * 300} L 200,${300 - (tripData.tripsByDay[2].count / 2500) * 300} L 300,${300 - (tripData.tripsByDay[3].count / 2500) * 300} L 400,${300 - (tripData.tripsByDay[4].count / 2500) * 300} L 500,${300 - (tripData.tripsByDay[5].count / 2500) * 300} L 600,${300 - (tripData.tripsByDay[6].count / 2500) * 300} L 600,300 L 0,300 Z ",fill:"url(#blueGradient)",opacity:"0.7"}),(0,Dt.jsx)("polyline",{points:" 0,${300 - (tripData.tripsByDay[0].count / 2500) * 300} 100,${300 - (tripData.tripsByDay[1].count / 2500) * 300} 200,${300 - (tripData.tripsByDay[2].count / 2500) * 300} 300,${300 - (tripData.tripsByDay[3].count / 2500) * 300} 400,${300 - (tripData.tripsByDay[4].count / 2500) * 300} 500,${300 - (tripData.tripsByDay[5].count / 2500) * 300} 600,${300 - (tripData.tripsByDay[6].count / 2500) * 300} ",fill:"none",stroke:"#3b82f6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow)"}),I.tripsByDay.map((e,t)=>(0,Dt.jsxs)("g",{transform:"translate(".concat(100*t,", ").concat(300-e.count/2500*300,")"),children:[(0,Dt.jsx)("circle",{r:"6",fill:"#fff",stroke:"#3b82f6",strokeWidth:"2",filter:"url(#glow)"}),(0,Dt.jsx)("circle",{r:"3",fill:"#3b82f6"}),(0,Dt.jsxs)("title",{children:[e.day,": ",e.count," trips"]})]},t)),(0,Dt.jsx)("g",{transform:"translate(0, 300)",className:"text-xs text-gray-600 font-medium",children:I.tripsByDay.map((e,t)=>(0,Dt.jsx)("text",{x:100*t,y:"20",textAnchor:"middle",children:e.day.substring(0,3)},t))})]})})]})]}),(0,Dt.jsx)("div",{className:"ml-10 flex justify-between mt-2",children:I.tripsByDay.map(e=>(0,Dt.jsxs)("div",{className:"text-xs text-center",children:[(0,Dt.jsx)("div",{className:"text-gray-500",children:e.day}),(0,Dt.jsx)("div",{className:"font-medium",children:e.count})]},e.day))})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Trips by Week"}),(0,Dt.jsxs)("div",{className:"h-64",children:[(0,Dt.jsxs)("div",{className:"h-full relative",children:[(0,Dt.jsxs)("div",{className:"absolute left-0 top-0 h-full w-10 flex flex-col justify-between text-xs text-gray-500 font-medium",children:[(0,Dt.jsx)("span",{children:"10k"}),(0,Dt.jsx)("span",{children:"8k"}),(0,Dt.jsx)("span",{children:"6k"}),(0,Dt.jsx)("span",{children:"4k"}),(0,Dt.jsx)("span",{children:"2k"}),(0,Dt.jsx)("span",{children:"0"})]}),(0,Dt.jsxs)("div",{className:"ml-10 h-full flex flex-col",children:[(0,Dt.jsx)("div",{className:"h-full w-full absolute grid grid-rows-5 gap-0",children:[...Array(6)].map((e,t)=>(0,Dt.jsx)("div",{className:"border-t border-gray-200 w-full"},t))}),(0,Dt.jsx)("div",{className:"h-full w-full relative",children:(0,Dt.jsxs)("svg",{className:"h-full w-full",viewBox:"0 0 300 300",preserveAspectRatio:"none",children:[(0,Dt.jsxs)("defs",{children:[(0,Dt.jsxs)("linearGradient",{id:"greenGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[(0,Dt.jsx)("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.8"}),(0,Dt.jsx)("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.1"})]}),(0,Dt.jsxs)("filter",{id:"greenGlow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[(0,Dt.jsx)("feGaussianBlur",{stdDeviation:"4",result:"blur"}),(0,Dt.jsx)("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})]}),(0,Dt.jsx)("path",{d:" M 0,${300 - (tripData.tripsByWeek[0].count / 10000) * 300} L 100,${300 - (tripData.tripsByWeek[1].count / 10000) * 300} L 200,${300 - (tripData.tripsByWeek[2].count / 10000) * 300} L 300,${300 - (tripData.tripsByWeek[3].count / 10000) * 300} L 300,300 L 0,300 Z ",fill:"url(#greenGradient)",opacity:"0.7"}),(0,Dt.jsx)("polyline",{points:" 0,${300 - (tripData.tripsByWeek[0].count / 10000) * 300} 100,${300 - (tripData.tripsByWeek[1].count / 10000) * 300} 200,${300 - (tripData.tripsByWeek[2].count / 10000) * 300} 300,${300 - (tripData.tripsByWeek[3].count / 10000) * 300} ",fill:"none",stroke:"#10b981",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#greenGlow)"}),I.tripsByWeek.map((e,t)=>(0,Dt.jsxs)("g",{transform:"translate(".concat(100*t,", ").concat(300-e.count/1e4*300,")"),children:[(0,Dt.jsx)("circle",{r:"6",fill:"#fff",stroke:"#10b981",strokeWidth:"2",filter:"url(#greenGlow)"}),(0,Dt.jsx)("circle",{r:"3",fill:"#10b981"}),(0,Dt.jsxs)("title",{children:["Week ",e.week,": ",e.count," trips"]})]},e.week)),(0,Dt.jsx)("g",{transform:"translate(0, 300)",className:"text-xs text-gray-600 font-medium",children:I.tripsByWeek.map((e,t)=>(0,Dt.jsxs)("text",{x:100*t,y:"20",textAnchor:"middle",children:["Week ",e.week]},t))})]})})]})]}),(0,Dt.jsx)("div",{className:"ml-10 flex justify-between mt-2",children:I.tripsByWeek.map(e=>(0,Dt.jsxs)("div",{className:"text-xs text-center",children:[(0,Dt.jsx)("div",{className:"text-gray-500",children:e.week}),(0,Dt.jsx)("div",{className:"font-medium",children:e.count})]},e.week))})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Transport Mode Distribution"}),(0,Dt.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"relative h-48 w-48",children:[(0,Dt.jsxs)("svg",{viewBox:"0 0 36 36",className:"h-full w-full",children:[(0,Dt.jsx)("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#3B82F6",strokeWidth:"32",strokeDasharray:"".concat(I.popularModes[0].percentage," 100"),strokeDashoffset:"25"}),(0,Dt.jsx)("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#10B981",strokeWidth:"32",strokeDasharray:"".concat(I.popularModes[1].percentage," 100"),strokeDashoffset:"".concat(100-I.popularModes[0].percentage+25)}),(0,Dt.jsx)("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#F59E0B",strokeWidth:"32",strokeDasharray:"".concat(I.popularModes[2].percentage," 100"),strokeDashoffset:"".concat(100-I.popularModes[0].percentage-I.popularModes[1].percentage+25)}),(0,Dt.jsx)("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#EF4444",strokeWidth:"32",strokeDasharray:"".concat(I.popularModes[3].percentage," 100"),strokeDashoffset:"".concat(100-I.popularModes[0].percentage-I.popularModes[1].percentage-I.popularModes[2].percentage+25)})]}),(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Dt.jsx)("span",{className:"text-lg font-semibold",children:"100%"})})]})}),(0,Dt.jsx)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:I.popularModes.map((e,t)=>(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"h-3 w-3 rounded-full ".concat(["bg-blue-500","bg-green-500","bg-yellow-500","bg-red-500"][t]," mr-2")}),(0,Dt.jsxs)("span",{className:"text-sm text-gray-600",children:[e.mode,": ",e.percentage,"%"]})]},e.mode))})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Popular Destinations"}),(0,Dt.jsx)("div",{className:"overflow-x-auto",children:(0,Dt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Dt.jsx)("thead",{className:"bg-gray-50",children:(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Destination"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip Count"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trend"})]})}),(0,Dt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:I.popularDestinations.map(e=>(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.count.toLocaleString()}),(0,Dt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(e.count/I.totalTrips*100).toFixed(1),"%"]}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[Math.random()>.5?(0,Dt.jsx)("svg",{className:"h-5 w-5 text-green-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}):(0,Dt.jsx)("svg",{className:"h-5 w-5 text-red-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M12 13a1 1 0 100 2h5a1 1 0 001-1V9a1 1 0 10-2 0v2.586l-4.293-4.293a1 1 0 00-1.414 0L8 9.586 3.707 5.293a1 1 0 00-1.414 1.414l5 5a1 1 0 001.414 0L11 9.414 14.586 13H12z",clipRule:"evenodd"})}),(0,Dt.jsxs)("span",{className:"ml-1",children:[(10*Math.random()).toFixed(1),"%"]})]})})]},e.name))})]})})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-primary-700 mb-4",children:"Bookings"}),(0,Dt.jsx)("div",{className:"overflow-x-auto",children:0===g.length?(0,Dt.jsx)("div",{className:"text-gray-500",children:"No bookings found."}):(0,Dt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Dt.jsx)("thead",{className:"bg-gray-50",children:(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pickup"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Destination"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mode"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),(0,Dt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map((e,t)=>(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.pickup}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.destination}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.mode}),(0,Dt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["\u20b9 ",e.price]}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.date})]},t))})]})})]})]}),"heatmap"===e&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Trip Density Heatmap"}),(0,Dt.jsxs)("div",{className:"mt-4 md:mt-0 flex space-x-2",children:[(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("input",{type:"text",placeholder:"Search location (e.g., New York, London)",value:H,onChange:e=>G(e.target.value),onKeyPress:e=>"Enter"===e.key&&me(),className:"w-64 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),Y&&(0,Dt.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,Dt.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-primary-500 border-t-transparent rounded-full"})})]}),(0,Dt.jsxs)("button",{onClick:me,disabled:!H.trim()||Y,className:"px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-md font-medium transition-colors flex items-center gap-2",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search"]})]}),(0,Dt.jsxs)("button",{onClick:()=>{if(D)V&&(navigator.geolocation.clearWatch(V),U(null)),O(!1),P(null),W(null);else if(navigator.geolocation){if(O(!0),!window.isSecureContext)return alert("Location tracking requires a secure connection (HTTPS) or localhost."),void O(!1);navigator.geolocation.getCurrentPosition(e=>{console.log("Location obtained:",e.coords);const{latitude:t,longitude:n}=e.coords;P({lat:t,lng:n}),he(t,n);const a=navigator.geolocation.watchPosition(e=>{console.log("Location updated:",e.coords);const{latitude:t,longitude:n}=e.coords;P({lat:t,lng:n}),he(t,n)},e=>{console.error("Location watch error:",e);let t="Unable to track your location.";switch(e.code){case e.PERMISSION_DENIED:t="Location access denied. Please enable location permissions in your browser settings.";break;case e.POSITION_UNAVAILABLE:t="Location information unavailable. Please check your device settings.";break;case e.TIMEOUT:t="Location request timed out. Please try again.";break;default:t="Unable to track your location. Please check your location settings."}alert(t),O(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4});U(a)},e=>{console.error("Location error:",e);let t="Unable to access your location.";switch(e.code){case e.PERMISSION_DENIED:t="Location access denied. Please enable location permissions in your browser settings.";break;case e.POSITION_UNAVAILABLE:t="Location information unavailable. Please check your device settings.";break;case e.TIMEOUT:t="Location request timed out. Please try again.";break;default:t="Unable to access your location. Please check your location settings."}alert(t),O(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}else alert("Geolocation is not supported by your browser.")},className:"px-4 py-2 rounded-md font-medium transition-all duration-300 flex items-center gap-2 ".concat(D?"bg-red-500 hover:bg-red-600 text-white animate-pulse shadow-lg shadow-red-500/30":"bg-primary-500 hover:bg-primary-600 text-white hover:shadow-lg hover:shadow-primary-500/30"),children:[(0,Dt.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),D?"Stop Tracking":"Track My Location"]})]})]}),q&&Z&&(0,Dt.jsx)("div",{className:"mb-6 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:['\ud83d\udd0d Search Results for "',H,'"']}),(0,Dt.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[Z.temp,"\xb0C"]}),(0,Dt.jsx)("div",{className:"text-sm text-gray-600",children:"Temperature"})]}),(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsx)("div",{className:"text-lg font-semibold text-gray-800",children:Z.condition}),(0,Dt.jsx)("div",{className:"text-sm text-gray-600",children:"Condition"})]}),(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsxs)("div",{className:"text-lg font-semibold text-blue-600",children:[Z.humidity,"%"]}),(0,Dt.jsx)("div",{className:"text-sm text-gray-600",children:"Humidity"})]}),(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsxs)("div",{className:"text-lg font-semibold text-green-600",children:[Z.windSpeed," m/s"]}),(0,Dt.jsx)("div",{className:"text-sm text-gray-600",children:"Wind Speed"})]})]}),(0,Dt.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Coordinates: ",q.lat.toFixed(4),", ",q.lng.toFixed(4)]})]}),(0,Dt.jsx)("button",{onClick:()=>{K(null),X(null),Q&&(clearInterval(Q),$(null))},className:"px-3 py-1 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded text-sm",children:"Clear"})]})}),(0,Dt.jsx)($G,{tripDataList:v,temperatureData:se,isUpdating:A,lastUpdateTime:M,currentLocation:F,locationWeather:z,searchedLocation:q,searchedLocationWeather:Z,isTrackingLocation:D}),(0,Dt.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Dt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Trip Density:"}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"h-4 w-8 bg-gradient-to-r from-green-500 to-yellow-500 rounded mr-2"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-500",children:"Low Density"})]}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"h-4 w-8 bg-gradient-to-r from-yellow-500 to-red-500 rounded mr-2"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-500",children:"High Density"})]})]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Temperature:"}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("div",{className:"h-4 w-4 bg-blue-500 rounded-full"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-500",children:"Cool (<20\xb0C)"})]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("div",{className:"h-4 w-4 bg-green-500 rounded-full"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-500",children:"Pleasant (20-25\xb0C)"})]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("div",{className:"h-4 w-4 bg-yellow-500 rounded-full"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-500",children:"Warm (25-30\xb0C)"})]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("div",{className:"h-4 w-4 bg-red-500 rounded-full"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-500",children:"Hot (>30\xb0C)"})]})]})]}),(0,Dt.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,Dt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[ne?(0,Dt.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-primary-500 border-t-transparent rounded-full"}):(0,Dt.jsx)("div",{className:"h-4 w-4 bg-green-500 rounded-full"}),(0,Dt.jsx)("span",{className:"text-sm text-gray-600",children:ne?"Updating temperature data...":"Temperature data updated"})]}),D&&(0,Dt.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,Dt.jsx)("div",{className:"h-2 w-2 bg-red-500 rounded-full animate-pulse"}),(0,Dt.jsx)("span",{className:"text-red-600 font-medium",children:"Tracking Location"}),F&&(0,Dt.jsxs)("span",{className:"text-gray-500",children:["(",F.lat.toFixed(4),", ",F.lng.toFixed(4),")"]})]}),q&&(0,Dt.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,Dt.jsx)("div",{className:"h-2 w-2 bg-purple-500 rounded-full animate-pulse"}),(0,Dt.jsx)("span",{className:"text-purple-600 font-medium",children:"Searched Location"}),(0,Dt.jsxs)("span",{className:"text-gray-500",children:["(",q.lat.toFixed(4),", ",q.lng.toFixed(4),")"]})]})]}),(0,Dt.jsxs)("span",{className:"text-xs text-gray-500",children:["Last updated: ",ee.toLocaleTimeString()]})]})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Origin-Destination Pairs"}),(0,Dt.jsx)("div",{className:"overflow-x-auto",children:(0,Dt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Dt.jsx)("thead",{className:"bg-gray-50",children:(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origin"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Destination"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip Count"})]})}),(0,Dt.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Residential Area A"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Central Business District"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"1,245"})]}),(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Residential Area B"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Tech Park"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"987"})]}),(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"University Area"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Shopping Mall"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"876"})]}),(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Residential Area C"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"University Area"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"754"})]}),(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Shopping Mall"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Residential Area A"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"689"})]})]})]})})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Congestion Analysis"}),(0,Dt.jsxs)("div",{className:"space-y-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Main Highway (North)"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-red-600",children:"Severe"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-red-600 h-2.5 rounded-full",style:{width:"85%"}})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Downtown Area"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-orange-500",children:"Heavy"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-orange-500 h-2.5 rounded-full",style:{width:"70%"}})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"East-West Connector"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-yellow-500",children:"Moderate"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-yellow-500 h-2.5 rounded-full",style:{width:"50%"}})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Suburban Routes"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-green-600",children:"Light"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:"30%"}})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Residential Streets"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-green-600",children:"Light"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:"15%"}})})]})]})]})]})]}),"patterns"===e&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Peak Hours Analysis"}),(0,Dt.jsxs)("div",{className:"h-80 bg-gradient-to-br from-purple-50 to-blue-50 rounded-lg p-4",children:[(0,Dt.jsxs)("div",{className:"relative h-full",children:[(0,Dt.jsxs)("div",{className:"absolute left-0 top-0 h-full w-10 flex flex-col justify-between text-xs font-medium text-gray-600",children:[(0,Dt.jsx)("span",{children:"2000"}),(0,Dt.jsx)("span",{children:"1500"}),(0,Dt.jsx)("span",{children:"1000"}),(0,Dt.jsx)("span",{children:"500"}),(0,Dt.jsx)("span",{children:"0"})]}),(0,Dt.jsxs)("div",{className:"ml-10 h-full flex flex-col",children:[(0,Dt.jsx)("div",{className:"h-full w-full absolute grid grid-rows-4 gap-0",children:[...Array(5)].map((e,t)=>(0,Dt.jsx)("div",{className:"border-t border-gray-200 w-full opacity-60"},t))}),(0,Dt.jsx)("div",{className:"h-full w-full relative",children:(0,Dt.jsxs)("svg",{className:"h-full w-full",viewBox:"0 0 400 300",preserveAspectRatio:"none",children:[(0,Dt.jsxs)("defs",{children:[(0,Dt.jsxs)("linearGradient",{id:"purpleGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[(0,Dt.jsx)("stop",{offset:"0%",stopColor:"#8b5cf6",stopOpacity:"0.8"}),(0,Dt.jsx)("stop",{offset:"100%",stopColor:"#8b5cf6",stopOpacity:"0.1"})]}),(0,Dt.jsxs)("filter",{id:"purpleGlow",height:"300%",width:"300%",x:"-100%",y:"-100%",children:[(0,Dt.jsx)("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),(0,Dt.jsxs)("feMerge",{children:[(0,Dt.jsx)("feMergeNode",{in:"coloredBlur"}),(0,Dt.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]}),(0,Dt.jsx)("path",{d:"M 0,".concat(300-I.peakHours[0].count/2e3*300,"\n                            L 133,").concat(300-I.peakHours[1].count/2e3*300,"\n                            L 266,").concat(300-I.peakHours[2].count/2e3*300,"\n                            L 400,").concat(300-I.peakHours[3].count/2e3*300,"\n                            L 400,300\n                            L 0,300\n                            Z"),fill:"url(#purpleGradient)",opacity:"0.4"}),(0,Dt.jsx)("polyline",{points:"0,".concat(300-I.peakHours[0].count/2e3*300,"\n                            133,").concat(300-I.peakHours[1].count/2e3*300,"\n                            266,").concat(300-I.peakHours[2].count/2e3*300,"\n                            400,").concat(300-I.peakHours[3].count/2e3*300),fill:"none",stroke:"#8b5cf6",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#purpleGlow)"}),I.peakHours.map((e,t)=>(0,Dt.jsxs)("g",{transform:"translate(".concat(133*t,", ").concat(300-e.count/2e3*300,")"),children:[(0,Dt.jsx)("circle",{r:"12",fill:"#8b5cf6",opacity:"0.1",className:"transition-all duration-300"}),(0,Dt.jsx)("circle",{r:"8",fill:"#8b5cf6",className:"transition-all duration-300 hover:r-10 cursor-pointer",filter:"url(#purpleGlow)",onMouseEnter:e=>{e.target.setAttribute("r","10"),e.target.style.opacity="0.9"},onMouseLeave:e=>{e.target.setAttribute("r","8"),e.target.style.opacity="1"},children:(0,Dt.jsxs)("title",{children:[e.hour,": ",e.count," trips"]})}),(0,Dt.jsx)("circle",{r:"4",fill:"white",opacity:"0.8",className:"transition-all duration-300"}),(0,Dt.jsx)("text",{y:"-15",textAnchor:"middle",className:"text-xs font-bold fill-purple-700",style:{fontSize:"12px"},children:e.count})]},e.hour))]})})]})]}),(0,Dt.jsx)("div",{className:"ml-10 flex justify-between mt-4",children:I.peakHours.map((e,t)=>(0,Dt.jsxs)("div",{className:"text-center flex flex-col items-center",children:[(0,Dt.jsx)("div",{className:"text-sm font-semibold text-gray-700",children:e.hour}),(0,Dt.jsx)("div",{className:"text-lg font-bold text-purple-600 mt-1",children:e.count}),(0,Dt.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[0===t&&"\ud83c\udf05 Morning",1===t&&"\u2600\ufe0f Peak",2===t&&"\ud83c\udf07 Evening",3===t&&"\ud83c\udf19 Late"]})]},e.hour))})]}),(0,Dt.jsxs)("div",{className:"mt-6 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-4 border border-purple-200",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-purple-900 mb-3 flex items-center",children:(0,Dt.jsx)("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,Dt.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,Dt.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-purple-900",children:"Peak Volume"}),(0,Dt.jsx)("p",{className:"text-sm text-purple-700",children:"8-9 AM shows highest trip volume (1,850 trips)"})]})]}),(0,Dt.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,Dt.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Evening Spread"}),(0,Dt.jsx)("p",{className:"text-sm text-blue-700",children:"Evening peaks are more distributed across time"})]})]}),(0,Dt.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,Dt.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-green-900",children:"Weekend Patterns"}),(0,Dt.jsx)("p",{className:"text-sm text-green-700",children:"Weekend travel differs significantly from weekdays"})]})]}),(0,Dt.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,Dt.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full mt-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-yellow-900",children:"School Zones"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700",children:"Educational areas show specialized peak patterns"})]})]})]}),(0,Dt.jsx)("div",{className:"mt-4 p-3 bg-white rounded-lg border border-purple-100",children:(0,Dt.jsxs)("p",{className:"text-sm text-purple-800",children:[(0,Dt.jsx)("span",{className:"font-semibold",children:"\ud83d\udca1 Recommendation:"})," Consider implementing dynamic pricing or additional services during peak hours to optimize resource allocation and improve user experience."]})})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Trip Purpose Distribution"}),(0,Dt.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"w-full max-w-md",children:[(0,Dt.jsxs)("div",{className:"mb-2",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Work Commute"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"45%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"45%"}})})]}),(0,Dt.jsxs)("div",{className:"mb-2",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Shopping/Errands"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"25%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:"25%"}})})]}),(0,Dt.jsxs)("div",{className:"mb-2",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Education"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"15%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-yellow-500 h-2.5 rounded-full",style:{width:"15%"}})})]}),(0,Dt.jsxs)("div",{className:"mb-2",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Leisure/Recreation"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"10%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-purple-600 h-2.5 rounded-full",style:{width:"10%"}})})]}),(0,Dt.jsxs)("div",{className:"mb-2",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Other"}),(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"5%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Dt.jsx)("div",{className:"bg-gray-600 h-2.5 rounded-full",style:{width:"5%"}})})]})]})})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Trip Chain Analysis"}),(0,Dt.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-lg p-6 border border-blue-200",children:[(0,Dt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Trip Chain Flow Visualization"}),(0,Dt.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200",children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Most Common Chain (42%)"}),(0,Dt.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"High Frequency"})]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("div",{className:"bg-green-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),(0,Dt.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded relative",children:(0,Dt.jsx)("div",{className:"absolute inset-0 bg-blue-500 rounded",style:{width:"42%"}})}),(0,Dt.jsx)("div",{className:"bg-orange-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,Dt.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded relative",children:(0,Dt.jsx)("div",{className:"absolute inset-0 bg-blue-500 rounded",style:{width:"42%"}})}),(0,Dt.jsx)("div",{className:"bg-green-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})})]}),(0,Dt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Dt.jsx)("span",{children:"Home"}),(0,Dt.jsx)("span",{children:"Work"}),(0,Dt.jsx)("span",{children:"Home"})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200",children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Second Most Common (18%)"}),(0,Dt.jsx)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Medium Frequency"})]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("div",{className:"bg-green-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),(0,Dt.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded relative",children:(0,Dt.jsx)("div",{className:"absolute inset-0 bg-green-500 rounded",style:{width:"18%"}})}),(0,Dt.jsx)("div",{className:"bg-purple-500 text-white rounded-full p-2",children:(0,Dt.jsxs)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l9-5-9-5-9 5 9 5z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})]})}),(0,Dt.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded relative",children:(0,Dt.jsx)("div",{className:"absolute inset-0 bg-green-500 rounded",style:{width:"18%"}})}),(0,Dt.jsx)("div",{className:"bg-green-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})})]}),(0,Dt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Dt.jsx)("span",{children:"Home"}),(0,Dt.jsx)("span",{children:"School"}),(0,Dt.jsx)("span",{children:"Home"})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200",children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Dt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Complex Multi-stop Chain (12%)"}),(0,Dt.jsx)("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Complex Pattern"})]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Dt.jsx)("div",{className:"bg-green-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),(0,Dt.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded relative",children:(0,Dt.jsx)("div",{className:"absolute inset-0 bg-orange-500 rounded",style:{width:"12%"}})}),(0,Dt.jsx)("div",{className:"bg-orange-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,Dt.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded relative",children:(0,Dt.jsx)("div",{className:"absolute inset-0 bg-purple-500 rounded",style:{width:"8%"}})}),(0,Dt.jsx)("div",{className:"bg-purple-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,Dt.jsx)("div",{className:"flex-1 h-1 bg-gray-200 rounded relative",children:(0,Dt.jsx)("div",{className:"absolute inset-0 bg-green-500 rounded",style:{width:"12%"}})}),(0,Dt.jsx)("div",{className:"bg-green-500 text-white rounded-full p-2",children:(0,Dt.jsx)("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})})]}),(0,Dt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Dt.jsx)("span",{children:"Home"}),(0,Dt.jsx)("span",{children:"Work"}),(0,Dt.jsx)("span",{children:"Shopping"}),(0,Dt.jsx)("span",{children:"Home"})]})]})]}),(0,Dt.jsx)("div",{className:"mt-4 text-center",children:(0,Dt.jsx)("p",{className:"text-sm text-gray-600",children:"Interactive trip chain patterns showing common movement flows"})})]}),(0,Dt.jsxs)("div",{className:"mt-6",children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Common Trip Chains:"}),(0,Dt.jsx)("div",{className:"overflow-x-auto",children:(0,Dt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Dt.jsx)("thead",{className:"bg-gray-50",children:(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pattern"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Frequency"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg. Duration"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Primary Mode"})]})}),(0,Dt.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Home \u2192 Work \u2192 Home"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"42%"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"9.5 hours"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Car (65%)"})]}),(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Home \u2192 School \u2192 Home"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"18%"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"7.2 hours"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Public Transit (42%)"})]}),(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Home \u2192 Work \u2192 Shopping \u2192 Home"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"12%"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"10.3 hours"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Car (78%)"})]}),(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Home \u2192 Shopping \u2192 Home"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"10%"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"2.1 hours"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Walking (35%)"})]}),(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Home \u2192 Leisure \u2192 Dining \u2192 Home"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"8%"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"4.5 hours"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Car (52%)"})]})]})]})})]})]})]}),"tripdata"===e&&(0,Dt.jsxs)("div",{className:"animate-fade-in",children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 transform transition-all duration-300 hover:scale-105",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 bg-blue-100 rounded-lg p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Trips"}),(0,Dt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:v.length})]})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 transform transition-all duration-300 hover:scale-105",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 bg-green-100 rounded-lg p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Active Users"}),(0,Dt.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:new Set(v.map(e=>e.userId)).size})]})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 transform transition-all duration-300 hover:scale-105",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 bg-purple-100 rounded-lg p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Avg Distance"}),(0,Dt.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[v.length>0?(v.reduce((e,t)=>e+t.distance,0)/v.length).toFixed(1):0," km"]})]})]})}),(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 transform transition-all duration-300 hover:scale-105",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 bg-yellow-100 rounded-lg p-3",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Avg Duration"}),(0,Dt.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[v.length>0?Math.round(v.reduce((e,t)=>e+t.duration,0)/v.length):0," min"]})]})]})})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8 transform transition-all duration-300 hover:shadow-lg",children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Trip Data Collection"}),(0,Dt.jsx)("p",{className:"text-gray-600 mt-1",children:"Collect trip data with user consent. Some fields can be automatically detected while others require user input."})]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Dt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg px-4 py-2",children:(0,Dt.jsxs)("span",{className:"text-sm text-blue-800 font-medium",children:["Auto Detection: ",v.filter(e=>e.automaticallyDetected).length," trips"]})}),(0,Dt.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg px-4 py-2",children:(0,Dt.jsxs)("span",{className:"text-sm text-green-800 font-medium",children:["User Input: ",v.filter(e=>!e.automaticallyDetected).length," trips"]})})]})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:[(0,Dt.jsxs)("div",{className:"space-y-2",children:[(0,Dt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center",children:[(0,Dt.jsxs)("svg",{className:"h-4 w-4 text-blue-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Origin Location"]}),(0,Dt.jsx)("input",{type:"text",name:"origin",value:y.origin,onChange:ce,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Starting location (e.g., Connaught Place, Delhi)"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Can be auto-detected using GPS"})]}),(0,Dt.jsxs)("div",{className:"space-y-2",children:[(0,Dt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center",children:[(0,Dt.jsxs)("svg",{className:"h-4 w-4 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Destination Location"]}),(0,Dt.jsx)("input",{type:"text",name:"destination",value:y.destination,onChange:ce,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",placeholder:"Ending location (e.g., Cyber City, Gurugram)"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Can be auto-detected using GPS"})]}),(0,Dt.jsxs)("div",{className:"space-y-2",children:[(0,Dt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Start Time"]}),(0,Dt.jsx)("input",{type:"datetime-local",name:"startTime",value:y.startTime,onChange:ce,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Can be auto-detected using device sensors"})]}),(0,Dt.jsxs)("div",{className:"space-y-2",children:[(0,Dt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 text-purple-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"End Time"]}),(0,Dt.jsx)("input",{type:"datetime-local",name:"endTime",value:y.endTime,onChange:ce,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-colors"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Can be auto-detected using device sensors"})]}),(0,Dt.jsxs)("div",{className:"space-y-2",children:[(0,Dt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 text-indigo-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"Transport Mode"]}),(0,Dt.jsxs)("select",{name:"mode",value:y.mode,onChange:ce,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",children:[(0,Dt.jsx)("option",{value:"car",children:"\ud83d\ude97 Car"}),(0,Dt.jsx)("option",{value:"bus",children:"\ud83d\ude8c Bus"}),(0,Dt.jsx)("option",{value:"train",children:"\ud83d\ude86 Train"}),(0,Dt.jsx)("option",{value:"walking",children:"\ud83d\udeb6 Walking"}),(0,Dt.jsx)("option",{value:"cycling",children:"\ud83d\udeb4 Cycling"}),(0,Dt.jsx)("option",{value:"auto",children:"\ud83d\udefa Auto Rickshaw"}),(0,Dt.jsx)("option",{value:"taxi",children:"\ud83d\ude95 Taxi"}),(0,Dt.jsx)("option",{value:"other",children:"\ud83d\udce6 Other"})]}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"User input required"})]}),(0,Dt.jsxs)("div",{className:"space-y-2",children:[(0,Dt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 text-orange-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Trip Purpose"]}),(0,Dt.jsxs)("select",{name:"purpose",value:y.purpose,onChange:ce,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",children:[(0,Dt.jsx)("option",{value:"work",children:"\ud83d\udcbc Work"}),(0,Dt.jsx)("option",{value:"education",children:"\ud83c\udf93 Education"}),(0,Dt.jsx)("option",{value:"shopping",children:"\ud83d\udecd\ufe0f Shopping"}),(0,Dt.jsx)("option",{value:"leisure",children:"\ud83c\udfae Leisure"}),(0,Dt.jsx)("option",{value:"medical",children:"\ud83c\udfe5 Medical"}),(0,Dt.jsx)("option",{value:"other",children:"\ud83d\udccb Other"})]}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"User input required"})]}),(0,Dt.jsxs)("div",{className:"space-y-2",children:[(0,Dt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 text-pink-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Accompanied By"]}),(0,Dt.jsx)("input",{type:"number",name:"accompaniedBy",value:y.accompaniedBy,onChange:ce,min:"0",max:"20",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-colors"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Number of people traveling with"})]})]}),(0,Dt.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("input",{type:"checkbox",id:"consentGiven",name:"consentGiven",checked:y.consentGiven,onChange:ce,className:"h-5 w-5 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,Dt.jsx)("label",{htmlFor:"consentGiven",className:"ml-3 block text-sm font-medium text-gray-900",children:"I consent to share this trip data for planning purposes"})]}),(0,Dt.jsx)("button",{onClick:()=>N(!0),className:"text-sm text-primary-600 hover:text-primary-800 underline",children:"Learn more"})]})}),(0,Dt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Dt.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mr-2",children:"Auto Detection Available"}),(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"User Consent Required"})]}),(0,Dt.jsxs)("button",{onClick:ue,disabled:!y.consentGiven,className:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"})}),"Save Trip Data"]})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 transform transition-all duration-300 hover:shadow-lg",children:[(0,Dt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Collected Trip Data"}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Dt.jsx)("button",{onClick:()=>{const e=v.filter(e=>!e.origin.includes("Test")&&!e.destination.includes("Sample")&&"Delhi"!==e.origin&&"Mumbai"!==e.destination);w(e),localStorage.setItem("detailedTripData",JSON.stringify(e))},className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-red-200 transition-colors",children:"Remove Dummy Data"}),(0,Dt.jsx)("button",{onClick:()=>{const e=v.map(e=>Lt(Lt({},e),{},{distance:50*Math.random()+5,duration:120*Math.random()+15}));w(e),localStorage.setItem("detailedTripData",JSON.stringify(e))},className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-blue-200 transition-colors",children:"Add Analytics"}),(0,Dt.jsx)("button",{onClick:()=>{const e=[...v].sort((e,t)=>new Date(t.startTime)-new Date(e.startTime));w(e)},className:"bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors",children:"Sort by Latest"})]})]}),0===v.length?(0,Dt.jsxs)("div",{className:"text-center py-12",children:[(0,Dt.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-gray-100 mb-4",children:(0,Dt.jsx)("svg",{className:"h-6 w-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No trip data collected yet"}),(0,Dt.jsx)("p",{className:"text-gray-500 mb-4",children:"Start collecting trip data using the form above to see insights here."}),(0,Dt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto",children:[(0,Dt.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"\ud83d\udca1 Quick Start Tips:"}),(0,Dt.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,Dt.jsx)("li",{children:"\u2022 Fill in the trip details above"}),(0,Dt.jsx)("li",{children:"\u2022 Enable consent for data sharing"}),(0,Dt.jsx)("li",{children:'\u2022 Click "Save Trip Data" to add your first trip'}),(0,Dt.jsx)("li",{children:"\u2022 View real-time analytics and insights"})]})]})]}):(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,Dt.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0",children:(0,Dt.jsx)("svg",{className:"h-8 w-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Total Distance"}),(0,Dt.jsxs)("p",{className:"text-2xl font-bold text-blue-900",children:[v.reduce((e,t)=>e+(t.distance||0),0).toFixed(1)," km"]})]})]})}),(0,Dt.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0",children:(0,Dt.jsx)("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Total Duration"}),(0,Dt.jsxs)("p",{className:"text-2xl font-bold text-green-900",children:[Math.round(v.reduce((e,t)=>e+(t.duration||0),0))," min"]})]})]})}),(0,Dt.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0",children:(0,Dt.jsx)("svg",{className:"h-8 w-8 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("p",{className:"text-sm font-medium text-purple-600",children:"Unique Users"}),(0,Dt.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:new Set(v.map(e=>e.userId)).size})]})]})})]}),(0,Dt.jsx)("div",{className:"overflow-x-auto",children:(0,Dt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Dt.jsx)("thead",{className:"bg-gray-50",children:(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mode"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Purpose"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"People"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data Source"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Dt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map((e,t)=>(0,Dt.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,Dt.jsx)("td",{className:"px-6 py-4",children:(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[(0,Dt.jsxs)("svg",{className:"h-4 w-4 text-blue-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.origin]}),(0,Dt.jsxs)("div",{className:"text-sm text-gray-500 flex items-center mt-1",children:[(0,Dt.jsxs)("svg",{className:"h-4 w-4 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.destination]})]})}),(0,Dt.jsx)("td",{className:"px-6 py-4",children:(0,Dt.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,Dt.jsx)("div",{children:new Date(e.startTime).toLocaleDateString()}),(0,Dt.jsxs)("div",{className:"text-gray-500",children:[new Date(e.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," -",new Date(e.endTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,Dt.jsxs)("div",{className:"text-xs text-blue-600 font-medium",children:[e.distance?"".concat(e.distance," km"):"Distance N/A"," \u2022 ",e.duration?"".concat(e.duration," min"):"Duration N/A"]})]})}),(0,Dt.jsx)("td",{className:"px-6 py-4",children:(0,Dt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 capitalize",children:["car"===e.mode&&"\ud83d\ude97"," ","bus"===e.mode&&"\ud83d\ude8c"," ","train"===e.mode&&"\ud83d\ude86"," ","walking"===e.mode&&"\ud83d\udeb6"," ","cycling"===e.mode&&"\ud83d\udeb4"," ","auto"===e.mode&&"\ud83d\udefa"," ","taxi"===e.mode&&"\ud83d\ude95"," ","other"===e.mode&&"\ud83d\udce6",e.mode]})}),(0,Dt.jsx)("td",{className:"px-6 py-4",children:(0,Dt.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 capitalize",children:["work"===e.purpose&&"\ud83d\udcbc"," ","education"===e.purpose&&"\ud83c\udf93"," ","shopping"===e.purpose&&"\ud83d\udecd\ufe0f"," ","leisure"===e.purpose&&"\ud83c\udfae"," ","medical"===e.purpose&&"\ud83c\udfe5"," ","other"===e.purpose&&"\ud83d\udccb",e.purpose]})}),(0,Dt.jsx)("td",{className:"px-6 py-4",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-4 w-4 text-gray-400 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,Dt.jsx)("span",{className:"text-sm text-gray-900",children:e.accompaniedBy})]})}),(0,Dt.jsx)("td",{className:"px-6 py-4",children:(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.automaticallyDetected?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:e.automaticallyDetected?"\ud83e\udd16 Auto":"\ud83d\udc64 User"})}),(0,Dt.jsx)("td",{className:"px-6 py-4",children:(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("button",{onClick:()=>{const e=v.filter((e,n)=>n!==t);w(e),localStorage.setItem("detailedTripData",JSON.stringify(e))},className:"text-red-600 hover:text-red-900 text-sm font-medium",children:"Delete"}),(0,Dt.jsx)("button",{onClick:()=>{b(e),window.scrollTo({top:0,behavior:"smooth"})},className:"text-blue-600 hover:text-blue-900 text-sm font-medium",children:"Edit"})]})})]},t))})]})}),(0,Dt.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,Dt.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",(0,Dt.jsx)("span",{className:"font-medium",children:"1"})," to ",(0,Dt.jsx)("span",{className:"font-medium",children:v.length})," of ",(0,Dt.jsx)("span",{className:"font-medium",children:v.length})," results"]}),(0,Dt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Dt.jsx)("button",{className:"px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",disabled:!0,children:"Previous"}),(0,Dt.jsx)("button",{className:"px-3 py-1 text-sm border border-gray-300 rounded-md bg-primary-600 text-white",children:"1"}),(0,Dt.jsx)("button",{className:"px-3 py-1 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",disabled:!0,children:"Next"})]})]})]})]}),k&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Consent Required"}),(0,Dt.jsx)("p",{className:"text-gray-600 mb-6",children:"We need your consent to collect and store this trip data. The data will be used by NATPAC scientists for planning purposes only."}),(0,Dt.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,Dt.jsx)("button",{onClick:()=>de(!1),className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Decline"}),(0,Dt.jsx)("button",{onClick:()=>de(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500",children:"Give Consent"})]})]})})]}),"bookings"===e&&(0,Dt.jsx)("div",{children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Booking Management"}),(0,Dt.jsxs)("div",{className:"mt-4 md:mt-0 flex space-x-2",children:[(0,Dt.jsx)("input",{type:"text",placeholder:"Search bookings...",className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500"}),(0,Dt.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500",children:[(0,Dt.jsx)("option",{value:"all",children:"All Statuses"}),(0,Dt.jsx)("option",{value:"pending",children:"Pending"}),(0,Dt.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,Dt.jsx)("option",{value:"completed",children:"Completed"}),(0,Dt.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})]}),(0,Dt.jsx)("div",{className:"overflow-x-auto",children:(0,Dt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Dt.jsx)("thead",{className:"bg-gray-50",children:(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Booking ID"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Dt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(e=>(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.id}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.type||"Guide"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.customerName||"Customer"}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.timestamp||Date.now()).toLocaleDateString()}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Dt.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full \n                          ".concat("confirmed"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"cancelled"===e.status?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e.status||"pending"})}),(0,Dt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",e.amount||Math.floor(200*Math.random())+50]}),(0,Dt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(0,Dt.jsx)("button",{onClick:()=>{a(e);const t="pending"===e.status?"confirmed":"confirmed"===e.status?"completed":"pending";zn(e.id,t),x(g.map(n=>n.id===e.id?Lt(Lt({},n),{},{status:t}):n))},className:"text-primary-600 hover:text-primary-900 mr-3",children:"pending"===e.status?"Confirm":"confirmed"===e.status?"Complete":"Reopen"}),(0,Dt.jsx)("button",{onClick:()=>{a(e)},className:"text-primary-600 hover:text-primary-900",children:"View Details"})]})]},e.id))})]})}),0===g.length&&(0,Dt.jsx)("div",{className:"text-center py-4",children:(0,Dt.jsx)("p",{className:"text-gray-500",children:"No bookings found"})}),(0,Dt.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,Dt.jsxs)("div",{className:"text-sm text-gray-500",children:["Showing ",g.length," bookings"]}),(0,Dt.jsxs)("div",{className:"flex space-x-2",children:[(0,Dt.jsx)("button",{className:"border border-gray-300 rounded-md px-3 py-1.5 text-sm text-gray-500 hover:bg-gray-50",children:"Previous"}),(0,Dt.jsx)("button",{className:"border border-gray-300 rounded-md px-3 py-1.5 text-sm text-gray-500 hover:bg-gray-50",children:"Next"})]})]})]})}),"users"===e&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Anonymized User Data"}),(0,Dt.jsxs)("div",{className:"mt-4 md:mt-0 flex space-x-2",children:[(0,Dt.jsx)("input",{type:"text",placeholder:"Search users...",className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500"}),(0,Dt.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-1.5 focus:ring-primary-500 focus:border-primary-500",children:[(0,Dt.jsx)("option",{children:"All Age Groups"}),(0,Dt.jsx)("option",{children:"18-24"}),(0,Dt.jsx)("option",{children:"25-34"}),(0,Dt.jsx)("option",{children:"35-44"}),(0,Dt.jsx)("option",{children:"45-54"}),(0,Dt.jsx)("option",{children:"55+"})]})]})]}),(0,Dt.jsx)("div",{className:"overflow-x-auto",children:(0,Dt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Dt.jsx)("thead",{className:"bg-gray-50",children:(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User ID"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age Group"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gender"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trip Count"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg. Distance"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Most Used Mode"}),(0,Dt.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Dt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:[{id:1,userId:"U78945",age:"25-34",gender:"Female",tripCount:37,avgDistance:12.5,mostUsedMode:"Car"},{id:2,userId:"U23456",age:"18-24",gender:"Male",tripCount:42,avgDistance:8.3,mostUsedMode:"Public Transit"},{id:3,userId:"U34567",age:"35-44",gender:"Female",tripCount:28,avgDistance:15.7,mostUsedMode:"Car"},{id:4,userId:"U45678",age:"25-34",gender:"Male",tripCount:53,avgDistance:5.2,mostUsedMode:"Cycling"},{id:5,userId:"U56789",age:"45-54",gender:"Female",tripCount:19,avgDistance:18.9,mostUsedMode:"Car"},{id:6,userId:"U67890",age:"18-24",gender:"Non-binary",tripCount:31,avgDistance:7.6,mostUsedMode:"Public Transit"},{id:7,userId:"U78901",age:"55-64",gender:"Male",tripCount:15,avgDistance:22.3,mostUsedMode:"Car"},{id:8,userId:"U89012",age:"25-34",gender:"Female",tripCount:47,avgDistance:9.1,mostUsedMode:"Walking"}].map(e=>(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.userId}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.age}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.gender}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.tripCount}),(0,Dt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.avgDistance," km"]}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.mostUsedMode}),(0,Dt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(0,Dt.jsx)("button",{className:"text-primary-600 hover:text-primary-900 mr-3",children:"View Details"}),(0,Dt.jsx)("button",{className:"text-primary-600 hover:text-primary-900",children:"Export"})]})]},e.id))})]})}),(0,Dt.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,Dt.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",(0,Dt.jsx)("span",{className:"font-medium",children:"1"})," to ",(0,Dt.jsx)("span",{className:"font-medium",children:"8"})," of ",(0,Dt.jsx)("span",{className:"font-medium",children:"245"})," users"]}),(0,Dt.jsxs)("div",{className:"flex space-x-2",children:[(0,Dt.jsx)("button",{className:"px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",disabled:!0,children:"Previous"}),(0,Dt.jsx)("button",{className:"px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]})]})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Demographics"}),(0,Dt.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"w-full max-w-md",children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Age Distribution"}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"18-24"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"22%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Dt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"22%"}})})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"25-34"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"35%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Dt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"35%"}})})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"35-44"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"25%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Dt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"25%"}})})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"45-54"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"12%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Dt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"12%"}})})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"55+"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"6%"})]}),(0,Dt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Dt.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"6%"}})})]})]})})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Engagement"}),(0,Dt.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"w-full max-w-md space-y-6",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"App Usage Frequency"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,Dt.jsxs)("div",{className:"bg-blue-100 p-3 rounded-lg text-center",children:[(0,Dt.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:"45%"}),(0,Dt.jsx)("div",{className:"text-xs text-blue-700 mt-1",children:"Daily"})]}),(0,Dt.jsxs)("div",{className:"bg-blue-100 p-3 rounded-lg text-center",children:[(0,Dt.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:"32%"}),(0,Dt.jsx)("div",{className:"text-xs text-blue-700 mt-1",children:"Weekly"})]}),(0,Dt.jsxs)("div",{className:"bg-blue-100 p-3 rounded-lg text-center",children:[(0,Dt.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:"23%"}),(0,Dt.jsx)("div",{className:"text-xs text-blue-700 mt-1",children:"Monthly"})]})]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Feature Usage"}),(0,Dt.jsxs)("div",{className:"space-y-2",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"Trip Logging"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"92%"})]}),(0,Dt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"Route Recommendations"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"78%"})]}),(0,Dt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"Safety Features"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"65%"})]}),(0,Dt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"Community Features"}),(0,Dt.jsx)("span",{className:"text-xs text-gray-600",children:"42%"})]})]})]})]})})]})]})]})]}):(0,Dt.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,Dt.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Admin Access"}),(0,Dt.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Authorized NATPAC personnel only"}),(0,Dt.jsx)("div",{className:"mt-3 p-4 bg-orange-50 border border-orange-200 rounded-md",children:(0,Dt.jsx)("p",{className:"text-sm text-center text-orange-700",children:"Please log in with your organization-provided credentials"})})]}),m&&(0,Dt.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:(0,Dt.jsx)("span",{className:"block sm:inline",children:m})}),(0,Dt.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:le,children:[(0,Dt.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),(0,Dt.jsx)("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:u,onChange:e=>d(e.target.value)})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,Dt.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password",value:h,onChange:e=>p(e.target.value)})]})]}),(0,Dt.jsx)("div",{children:(0,Dt.jsx)("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Sign in"})})]})]})})};const tq=function(){const[e,t]=(0,B.useState)(""),[n,a]=(0,B.useState)(""),[s,r]=(0,B.useState)(!1),[i,o]=(0,B.useState)(!1),[l,c]=(0,B.useState)(""),{login:u}=Pt(),d=Oe();return(0,Dt.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,Dt.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,Dt.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),(0,Dt.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",(0,Dt.jsx)(ut,{to:"/signup",className:"font-medium text-primary-600 hover:text-primary-500",children:"create a new account"})]})]}),(0,Dt.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,Dt.jsxs)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[l&&(0,Dt.jsx)("div",{className:"mb-4 bg-red-50 border-l-4 border-red-400 p-4",children:(0,Dt.jsxs)("div",{className:"flex",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0",children:(0,Dt.jsx)("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,Dt.jsx)("div",{className:"ml-3",children:(0,Dt.jsx)("p",{className:"text-sm text-red-700",children:l})})]})}),(0,Dt.jsxs)("form",{className:"space-y-6",onSubmit:t=>{t.preventDefault(),o(!0),c(""),setTimeout(()=>{if(e.includes("@")&&n.length>=6){const t={email:e,username:e.split("@")[0],avatar:"https://ui-avatars.com/api/?name=".concat(e.split("@")[0],"&background=random"),id:Math.floor(1e4*Math.random()).toString()};u(t),d("/dashboard")}else c("Invalid email or password. Please try again.");o(!1)},1e3)},children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:n,onChange:e=>a(e.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})})]}),(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("input",{id:"remember-me",name:"remember-me",type:"checkbox",checked:s,onChange:e=>r(e.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,Dt.jsx)("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),(0,Dt.jsx)("div",{className:"text-sm",children:(0,Dt.jsx)("a",{href:"#",className:"font-medium text-primary-600 hover:text-primary-500",children:"Forgot your password?"})})]}),(0,Dt.jsx)("div",{children:(0,Dt.jsxs)("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:[i?(0,Dt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Dt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,"Sign in"]})})]}),(0,Dt.jsxs)("div",{className:"mt-6",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,Dt.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,Dt.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,Dt.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),(0,Dt.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[(0,Dt.jsx)("div",{children:(0,Dt.jsxs)("a",{href:"#",className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[(0,Dt.jsx)("span",{className:"sr-only",children:"Sign in with Google"}),(0,Dt.jsx)("svg",{className:"w-5 h-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{d:"M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"})})]})}),(0,Dt.jsx)("div",{children:(0,Dt.jsxs)("a",{href:"#",className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[(0,Dt.jsx)("span",{className:"sr-only",children:"Sign in with Phone"}),(0,Dt.jsx)("svg",{className:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})]})})]})]})]})})]})};const nq=function(){const[e,t]=(0,B.useState)({name:"",email:"",phone:"",password:"",confirmPassword:"",agreeTerms:!1}),[n,a]=(0,B.useState)(!1),[s,r]=(0,B.useState)(""),[i,o]=(0,B.useState)(1),[l,c]=(0,B.useState)(["","","",""]),{login:u}=Pt(),d=Oe(),h=n=>{const{name:a,value:s,type:r,checked:i}=n.target;t(Lt(Lt({},e),{},{[a]:"checkbox"===r?i:s}))},p=t=>{if(t.preventDefault(),a(!0),r(""),e.password!==e.confirmPassword)return r("Passwords do not match"),void a(!1);setTimeout(()=>{if(1===i)if(e.phone)o(2);else{const t={email:e.email,username:e.name||e.email.split("@")[0],avatar:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e.name||e.email.split("@")[0]),"&background=random"),id:Math.floor(1e4*Math.random()).toString()};u(t),d("/dashboard")}else{if("1234"===l.join("")){const t={email:e.email,username:e.name||e.email.split("@")[0],phone:e.phone,avatar:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e.name||e.email.split("@")[0]),"&background=random"),id:Math.floor(1e4*Math.random()).toString()};u(t),d("/dashboard")}else r("Invalid OTP. Please try again.")}a(!1)},1e3)};return(0,Dt.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,Dt.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,Dt.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:1===i?"Create your account":"Verify your phone"}),(0,Dt.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",(0,Dt.jsx)(ut,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"sign in to your account"})]})]}),(0,Dt.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,Dt.jsxs)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[s&&(0,Dt.jsx)("div",{className:"mb-4 bg-red-50 border-l-4 border-red-400 p-4",children:(0,Dt.jsxs)("div",{className:"flex",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0",children:(0,Dt.jsx)("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,Dt.jsx)("div",{className:"ml-3",children:(0,Dt.jsx)("p",{className:"text-sm text-red-700",children:s})})]})}),1===i?(0,Dt.jsxs)("form",{className:"space-y-6",onSubmit:p,children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full name"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{id:"name",name:"name",type:"text",autoComplete:"name",required:!0,value:e.name,onChange:h,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e.email,onChange:h,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone number (optional for OTP login)"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{id:"phone",name:"phone",type:"tel",autoComplete:"tel",value:e.phone,onChange:h,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:e.password,onChange:h,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm password"}),(0,Dt.jsx)("div",{className:"mt-1",children:(0,Dt.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:e.confirmPassword,onChange:h,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})})]}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("input",{id:"agreeTerms",name:"agreeTerms",type:"checkbox",required:!0,checked:e.agreeTerms,onChange:h,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,Dt.jsxs)("label",{htmlFor:"agreeTerms",className:"ml-2 block text-sm text-gray-900",children:["I agree to the"," ",(0,Dt.jsx)("a",{href:"#",className:"font-medium text-primary-600 hover:text-primary-500",children:"Terms of Service"})," ","and"," ",(0,Dt.jsx)("a",{href:"#",className:"font-medium text-primary-600 hover:text-primary-500",children:"Privacy Policy"})]})]}),(0,Dt.jsx)("div",{children:(0,Dt.jsxs)("button",{type:"submit",disabled:n,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:[n?(0,Dt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Dt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,"Sign up"]})})]}):(0,Dt.jsxs)("div",{className:"space-y-6",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("p",{className:"text-sm text-gray-700 mb-4",children:["We've sent a verification code to your phone number ending in ",e.phone.slice(-4),". Please enter the code below to verify your account."]}),(0,Dt.jsx)("div",{className:"flex justify-center space-x-2 my-8",children:l.map((e,t)=>(0,Dt.jsx)("input",{id:"otp-".concat(t),type:"text",maxLength:"1",value:e,onChange:e=>((e,t)=>{if(t.length<=1){const n=[...l];n[e]=t,c(n),t&&e<3&&document.getElementById("otp-".concat(e+1)).focus()}})(t,e.target.value),className:"w-12 h-12 text-center text-2xl border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"},t))}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500 text-center",children:["Didn't receive a code?"," ",(0,Dt.jsx)("button",{type:"button",className:"text-primary-600 hover:text-primary-500 font-medium",onClick:()=>{a(!0),setTimeout(()=>{o(2),a(!1)},1e3)},children:"Resend"})]})]}),(0,Dt.jsx)("div",{children:(0,Dt.jsxs)("button",{type:"button",onClick:p,disabled:n||l.some(e=>!e),className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:[n?(0,Dt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Dt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,"Verify"]})}),(0,Dt.jsx)("div",{className:"text-center",children:(0,Dt.jsx)("button",{type:"button",onClick:()=>o(1),className:"text-sm text-primary-600 hover:text-primary-500 font-medium",children:"Go back"})})]}),(0,Dt.jsxs)("div",{className:"mt-6",children:[(0,Dt.jsxs)("div",{className:"relative",children:[(0,Dt.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,Dt.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,Dt.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,Dt.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"Or sign up with"})})]}),(0,Dt.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[(0,Dt.jsx)("div",{children:(0,Dt.jsxs)("a",{href:"#",className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[(0,Dt.jsx)("span",{className:"sr-only",children:"Sign up with Google"}),(0,Dt.jsx)("svg",{className:"w-5 h-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{d:"M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"})})]})}),(0,Dt.jsx)("div",{children:(0,Dt.jsxs)("a",{href:"#",className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[(0,Dt.jsx)("span",{className:"sr-only",children:"Sign up with Phone"}),(0,Dt.jsx)("svg",{className:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})]})})]})]}),1===i&&(0,Dt.jsx)("div",{className:"mt-6"})]})})]})};const aq=function(){return(0,Dt.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:(0,Dt.jsx)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsx)("h1",{className:"text-9xl font-bold text-primary-600",children:"404"}),(0,Dt.jsx)("h2",{className:"mt-4 text-3xl font-extrabold text-gray-900",children:"Page not found"}),(0,Dt.jsx)("p",{className:"mt-2 text-base text-gray-500",children:"Sorry, we couldn't find the page you're looking for."}),(0,Dt.jsx)("div",{className:"mt-6",children:(0,Dt.jsxs)(ut,{to:"/",className:"text-base font-medium text-primary-600 hover:text-primary-500",children:["Go back home",(0,Dt.jsx)("span",{"aria-hidden":"true",children:" \u2192"})]})})]})})})};const sq=function(){const{cartItems:e,removeFromCart:t,clearCart:n}=Bt(),a=Oe(),s=e.reduce((e,t)=>e+(t.price||0),0),r=e.reduce((e,t)=>(e[t.type]||(e[t.type]=[]),e[t.type].push(t),e),{});return 0===e.length?(0,Dt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,Dt.jsxs)("div",{className:"text-center py-16",children:[(0,Dt.jsx)("h2",{className:"text-3xl font-extrabold text-gray-900 mb-4",children:"Your Trip Cart is Empty"}),(0,Dt.jsx)("p",{className:"text-lg text-gray-600 mb-8",children:"Start adding attractions, packages, and services to plan your perfect trip!"}),(0,Dt.jsx)(ut,{to:"/recommendations",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700",children:"Browse Recommendations"})]})}):(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-extrabold text-gray-900 mb-8",children:"Your Trip Cart"}),(0,Dt.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,Dt.jsxs)("div",{className:"lg:w-2/3",children:[Object.entries(r).map(e=>{let[n,a]=e;return(0,Dt.jsxs)("div",{className:"mb-8",children:[(0,Dt.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-4 capitalize",children:[n,"s"]}),(0,Dt.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:(0,Dt.jsx)("ul",{className:"divide-y divide-gray-200",children:a.map(e=>(0,Dt.jsx)("li",{className:"px-6 py-4",children:(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[e.image&&(0,Dt.jsx)("div",{className:"flex-shrink-0 h-16 w-16 mr-4",children:(0,Dt.jsx)("img",{className:"h-16 w-16 rounded-md object-cover",src:e.image,alt:e.name})}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:e.name}),(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:e.description}),e.location&&(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:e.location}),e.date&&(0,Dt.jsxs)("p",{className:"text-sm text-gray-500",children:["Date: ",e.date]})]})]}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[e.price&&(0,Dt.jsxs)("span",{className:"text-lg font-medium text-gray-900 mr-4",children:["\u20b9",e.price]}),(0,Dt.jsx)("button",{onClick:()=>t(e.id,e.type),className:"text-red-600 hover:text-red-800",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},"".concat(e.type,"-").concat(e.id)))})})]},n)}),(0,Dt.jsx)("div",{className:"flex justify-end mt-6",children:(0,Dt.jsx)("button",{onClick:n,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Clear Cart"})})]}),(0,Dt.jsx)("div",{className:"lg:w-1/3",children:(0,Dt.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,Dt.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,Dt.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Trip Summary"}),(0,Dt.jsxs)("div",{className:"mt-5",children:[(0,Dt.jsxs)("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[(0,Dt.jsx)("span",{className:"text-gray-600",children:"Items in cart"}),(0,Dt.jsx)("span",{className:"font-medium",children:e.length})]}),s>0&&(0,Dt.jsxs)("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[(0,Dt.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,Dt.jsxs)("span",{className:"font-medium",children:["\u20b9",s]})]}),(0,Dt.jsxs)("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[(0,Dt.jsx)("span",{className:"text-gray-600",children:"Taxes & Fees"}),(0,Dt.jsxs)("span",{className:"font-medium",children:["\u20b9",Math.round(.18*s)]})]}),(0,Dt.jsxs)("div",{className:"flex justify-between py-4 font-bold",children:[(0,Dt.jsx)("span",{children:"Total"}),(0,Dt.jsxs)("span",{children:["\u20b9",s+Math.round(.18*s)]})]}),(0,Dt.jsxs)("div",{className:"mt-6",children:[(0,Dt.jsx)("button",{onClick:()=>{if(Pn())return void alert("You have an active booking. Please complete or delete your current trip before making a new booking.");if(0===e.length)return void alert("Your cart is empty. Please add items to proceed.");const t=e.reduce((e,t)=>e+(t.price||0),0),n=Math.round(.18*t),s=t+n,r={id:"CART-".concat(Date.now().toString().slice(-6)),type:"Cart Items",name:"Multiple Items (".concat(e.length,")"),price:s,date:(new Date).toISOString().split("T")[0],items:e,status:"Pending Payment",details:{"Booking ID":"CART-".concat(Date.now().toString().slice(-6)),"Items Count":e.length,Subtotal:"\u20b9".concat(t),"Taxes & Fees":"\u20b9".concat(n),"Total Amount":"\u20b9".concat(s),Payment:"Pending"}};a("/payment",{state:{bookingDetails:r,totalAmount:s,bookingType:"Cart Items",cartItems:e}})},className:"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700",children:"Proceed to Checkout"}),(0,Dt.jsx)(ut,{to:"/recommendations",className:"w-full mt-3 inline-flex justify-center items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Continue Shopping"})]})]})]})})})]})]})};const rq=function(){const{id:e}=function(){let{matches:e}=B.useContext(Ae),t=e[e.length-1];return t?t.params:{}}(),t=Oe(),[n,a]=(0,B.useState)(null),[s,r]=(0,B.useState)(!0),[i,o]=(0,B.useState)("overview"),l=[{id:1,name:"Mountain View Cafe",type:"restaurant",distance:"1.2 km",rating:4.7,reviews:128,image:"https://images.unsplash.com/photo-1554118811-1e0d58224f24?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8M3x8Y2FmZXxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",description:"Cozy cafe with panoramic mountain views and excellent coffee.",address:"123 Mountain Road, Hillside District",phone:"+1 (555) 123-4567",website:"www.mountainviewcafe.com",hours:"Mon-Fri: 7am-8pm, Sat-Sun: 8am-9pm",features:["Outdoor Seating","Wi-Fi","Vegan Options","Pet Friendly"],menu:[{name:"Mountain Blend Coffee",price:"$3.50",description:"Our signature blend with notes of chocolate and hazelnut"},{name:"Avocado Toast",price:"$8.95",description:"Sourdough bread with fresh avocado, cherry tomatoes, and microgreens"},{name:"Berry Parfait",price:"$6.50",description:"Greek yogurt with fresh berries, honey, and homemade granola"}],photos:["https://images.unsplash.com/photo-1554118811-1e0d58224f24?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8M3x8Y2FmZXxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60","https://images.unsplash.com/photo-1559925393-8be0ec4767c8?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NXx8Y2FmZXxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60","https://images.unsplash.com/photo-1501339847302-ac426a4a7cbb?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Nnx8Y2FmZXxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60"]},{id:2,name:"Heritage Museum",type:"attraction",distance:"3.5 km",rating:4.5,reviews:312,image:"https://images.unsplash.com/photo-1566127992631-137a642a90f4?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8bXVzZXVtfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60",description:"Explore local history and culture at this well-preserved museum.",address:"456 Heritage Avenue, Downtown",phone:"+1 (555) 987-6543",website:"www.heritagemuseum.org",hours:"Tue-Sun: 10am-6pm, Closed on Mondays",features:["Guided Tours","Gift Shop","Wheelchair Accessible","Audio Guides"],exhibits:[{name:"Ancient Artifacts",description:"Collection of artifacts dating back to 3000 BCE"},{name:"Local History",description:"Exhibits showcasing the evolution of the city over 200 years"},{name:"Interactive Science",description:"Hands-on exhibits exploring principles of physics and chemistry"}],photos:["https://images.unsplash.com/photo-1566127992631-137a642a90f4?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8bXVzZXVtfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60","https://images.unsplash.com/photo-1565060169861-2d4b3c5126ab?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8N3x8bXVzZXVtfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60","https://images.unsplash.com/photo-1626271763156-00e3d2a7c9a9?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTB8fG11c2V1bXxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60"]},{id:3,name:"Riverside Park",type:"park",distance:"2.1 km",rating:4.6,reviews:245,image:"https://images.unsplash.com/photo-1519331379826-f10be5486c6f?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8cGFya3xlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",description:"Peaceful park with walking trails, picnic areas, and river views.",address:"789 Riverside Drive, Waterfront District",phone:"+1 (555) 456-7890",website:"www.riversidepark.gov",hours:"Open daily: 6am-10pm",features:["Walking Trails","Picnic Areas","Playground","Dog Park","Boat Rentals"],activities:[{name:"Hiking",description:"5 miles of scenic trails with varying difficulty levels"},{name:"Boating",description:"Kayak and canoe rentals available at the boathouse"},{name:"Bird Watching",description:"Over 100 species of birds can be spotted throughout the year"}],photos:["https://images.unsplash.com/photo-1519331379826-f10be5486c6f?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8cGFya3xlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60","https://images.unsplash.com/photo-1500630417200-63156e226754?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8M3x8cGFya3xlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60","https://images.unsplash.com/photo-1534251623184-22cb7e61c526?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NHx8cGFya3xlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60"]},{id:4,name:"Seafood Grill",type:"restaurant",distance:"4.3 km",rating:4.4,reviews:189,image:"https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8c2VhZm9vZHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",description:"Fresh seafood prepared with local ingredients and unique flavors.",address:"321 Harbor Street, Marina District",phone:"+1 (555) 789-0123",website:"www.seafoodgrill.com",hours:"Mon-Sun: 11am-10pm",features:["Waterfront View","Full Bar","Outdoor Seating","Private Dining"],menu:[{name:"Grilled Salmon",price:"$24.95",description:"Fresh salmon with lemon herb butter and seasonal vegetables"},{name:"Seafood Pasta",price:"$22.50",description:"Linguine with shrimp, clams, and mussels in white wine sauce"},{name:"Lobster Roll",price:"$19.95",description:"Maine lobster with light mayo on a toasted brioche bun"}],photos:["https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8c2VhZm9vZHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60","https://images.unsplash.com/photo-1559847844-5315695dadae?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8M3x8c2VhZm9vZHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60","https://images.unsplash.com/photo-1579631542720-3a87824fff86?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Nnx8c2VhZm9vZHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60"]}];return(0,B.useEffect)(()=>{r(!0),setTimeout(()=>{const t=l.find(t=>t.id===parseInt(e));a(t||null),r(!1)},500)},[e]),s?(0,Dt.jsx)("div",{className:"container mx-auto px-4 py-16 flex justify-center",children:(0,Dt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):n?(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Dt.jsxs)("button",{onClick:()=>t(-1),className:"mb-6 inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[(0,Dt.jsx)("svg",{className:"mr-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to Recommendations"]}),(0,Dt.jsxs)("div",{className:"relative h-64 md:h-96 rounded-xl overflow-hidden mb-8",children:[(0,Dt.jsx)("img",{src:n.image,alt:n.name,className:"w-full h-full object-cover"}),(0,Dt.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end",children:(0,Dt.jsxs)("div",{className:"p-6 text-white",children:[(0,Dt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Dt.jsx)("span",{className:"px-2 py-1 bg-primary-600 text-white text-xs font-bold uppercase rounded-md mr-2",children:n.type}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.462a1 1 0 00.95-.69l1.07-3.292z"})}),(0,Dt.jsx)("span",{className:"ml-1 text-sm",children:n.rating}),(0,Dt.jsx)("span",{className:"mx-1",children:"\u2022"}),(0,Dt.jsxs)("span",{className:"text-sm",children:[n.reviews," reviews"]})]})]}),(0,Dt.jsx)("h1",{className:"text-3xl font-bold",children:n.name}),(0,Dt.jsxs)("p",{className:"text-gray-200",children:[n.distance," from your location"]})]})})]}),(0,Dt.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,Dt.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,Dt.jsx)("button",{onClick:()=>o("overview"),className:"".concat("overview"===i?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Overview"}),(0,Dt.jsx)("button",{onClick:()=>o("photos"),className:"".concat("photos"===i?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Photos"}),(0,Dt.jsx)("button",{onClick:()=>o("reviews"),className:"".concat("reviews"===i?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Reviews"}),(0,Dt.jsx)("button",{onClick:()=>o("nearby"),className:"".concat("nearby"===i?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Nearby"})]})}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Dt.jsxs)("div",{className:"lg:col-span-2",children:["overview"===i&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["About ",n.name]}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-6",children:n.description}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Address"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:n.address})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Hours"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:n.hours})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Phone"}),(0,Dt.jsx)("p",{className:"text-gray-600",children:n.phone})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Website"}),(0,Dt.jsx)("a",{href:"https://".concat(n.website),target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",children:n.website})]})]}),(0,Dt.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Features"}),(0,Dt.jsx)("div",{className:"flex flex-wrap gap-2",children:n.features.map((e,t)=>(0,Dt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e},t))})]}),"restaurant"===n.type&&(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Popular Menu Items"}),(0,Dt.jsx)("div",{className:"space-y-4",children:n.menu.map((e,t)=>(0,Dt.jsxs)("div",{className:"border-b border-gray-200 pb-4 last:border-0 last:pb-0",children:[(0,Dt.jsxs)("div",{className:"flex justify-between",children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),(0,Dt.jsx)("span",{className:"font-medium text-gray-900",children:e.price})]}),(0,Dt.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:e.description})]},t))})]}),"attraction"===n.type&&n.exhibits&&(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Featured Exhibits"}),(0,Dt.jsx)("div",{className:"space-y-4",children:n.exhibits.map((e,t)=>(0,Dt.jsxs)("div",{className:"border-b border-gray-200 pb-4 last:border-0 last:pb-0",children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),(0,Dt.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:e.description})]},t))})]}),"park"===n.type&&n.activities&&(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Activities"}),(0,Dt.jsx)("div",{className:"space-y-4",children:n.activities.map((e,t)=>(0,Dt.jsxs)("div",{className:"border-b border-gray-200 pb-4 last:border-0 last:pb-0",children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),(0,Dt.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:e.description})]},t))})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Location"}),(0,Dt.jsx)("div",{className:"h-64 bg-gray-200 rounded-lg flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"text-center text-gray-500",children:[(0,Dt.jsxs)("svg",{className:"mx-auto h-12 w-12 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,Dt.jsx)("p",{className:"mt-2",children:"Interactive map would be displayed here"})]})})]})]}),"photos"===i&&(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Photos"}),(0,Dt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.photos.map((e,t)=>(0,Dt.jsx)("div",{className:"rounded-lg overflow-hidden",children:(0,Dt.jsx)("img",{src:e,alt:"".concat(n.name," - Photo ").concat(t+1),className:"w-full h-48 object-cover hover:opacity-90 transition-opacity cursor-pointer"})},t))})]}),"reviews"===i&&(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold",children:"Reviews"}),(0,Dt.jsx)("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Write a Review"})]}),(0,Dt.jsxs)("div",{className:"space-y-6",children:[(0,Dt.jsxs)("div",{className:"border-b border-gray-200 pb-6",children:[(0,Dt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Dt.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 font-medium",children:"JD"}),(0,Dt.jsxs)("div",{className:"ml-3",children:[(0,Dt.jsx)("div",{className:"font-medium",children:"John Doe"}),(0,Dt.jsx)("div",{className:"text-gray-500 text-sm",children:"Visited 2 weeks ago"})]})]}),(0,Dt.jsx)("div",{className:"flex items-center mb-2",children:[1,2,3,4,5].map(e=>(0,Dt.jsx)("svg",{className:"h-5 w-5 ".concat(e<=5?"text-yellow-400":"text-gray-300"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.462a1 1 0 00.95-.69l1.07-3.292z"})},e))}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"Absolutely loved this place! The atmosphere was amazing and the service was top-notch. Would definitely recommend to anyone visiting the area."})]}),(0,Dt.jsxs)("div",{className:"border-b border-gray-200 pb-6",children:[(0,Dt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Dt.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 font-medium",children:"AS"}),(0,Dt.jsxs)("div",{className:"ml-3",children:[(0,Dt.jsx)("div",{className:"font-medium",children:"Alice Smith"}),(0,Dt.jsx)("div",{className:"text-gray-500 text-sm",children:"Visited 1 month ago"})]})]}),(0,Dt.jsx)("div",{className:"flex items-center mb-2",children:[1,2,3,4,5].map(e=>(0,Dt.jsx)("svg",{className:"h-5 w-5 ".concat(e<=4?"text-yellow-400":"text-gray-300"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.462a1 1 0 00.95-.69l1.07-3.292z"})},e))}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"Great experience overall. The only reason I'm giving 4 stars instead of 5 is because it was a bit crowded when we visited. Otherwise, everything was perfect!"})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Dt.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 font-medium",children:"RJ"}),(0,Dt.jsxs)("div",{className:"ml-3",children:[(0,Dt.jsx)("div",{className:"font-medium",children:"Robert Johnson"}),(0,Dt.jsx)("div",{className:"text-gray-500 text-sm",children:"Visited 3 months ago"})]})]}),(0,Dt.jsx)("div",{className:"flex items-center mb-2",children:[1,2,3,4,5].map(e=>(0,Dt.jsx)("svg",{className:"h-5 w-5 ".concat(e<=5?"text-yellow-400":"text-gray-300"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.462a1 1 0 00.95-.69l1.07-3.292z"})},e))}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"One of the best experiences I've had. The staff was friendly and attentive, and everything exceeded my expectations. Will definitely be coming back!"})]})]})]}),"nearby"===i&&(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Nearby Attractions"}),(0,Dt.jsx)("div",{className:"space-y-4",children:l.filter(e=>e.id!==n.id).map(e=>(0,Dt.jsxs)("div",{className:"flex border-b border-gray-200 pb-4 last:border-0 last:pb-0",children:[(0,Dt.jsx)("div",{className:"h-20 w-20 flex-shrink-0 rounded-md overflow-hidden",children:(0,Dt.jsx)("img",{src:e.image,alt:e.name,className:"h-full w-full object-cover"})}),(0,Dt.jsxs)("div",{className:"ml-4 flex-1",children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),(0,Dt.jsxs)("div",{className:"flex items-center mt-1",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118l-2.8-2.034c-.783-.57-.38-1.81.588-1.81h3.462a1 1 0 00.95-.69l1.07-3.292z"})}),(0,Dt.jsx)("span",{className:"ml-1 text-sm text-gray-600",children:e.rating}),(0,Dt.jsx)("span",{className:"mx-1 text-gray-500",children:"\u2022"}),(0,Dt.jsx)("span",{className:"text-sm text-gray-600",children:e.distance})]}),(0,Dt.jsx)("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.description}),(0,Dt.jsx)("button",{onClick:()=>t("/attraction/".concat(e.id)),className:"mt-2 text-sm text-primary-600 hover:text-primary-700 font-medium",children:"View Details"})]})]},e.id))})]})]}),(0,Dt.jsxs)("div",{className:"lg:col-span-1",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Plan Your Visit"}),(0,Dt.jsxs)("div",{className:"space-y-4",children:[(0,Dt.jsx)("button",{className:"w-full bg-primary-600 text-white py-2 px-4 rounded-md font-medium hover:bg-primary-700 transition",children:"Add to Trip"}),(0,Dt.jsx)("button",{className:"w-full bg-white text-primary-600 py-2 px-4 rounded-md font-medium border border-primary-600 hover:bg-primary-50 transition",children:"Get Directions"}),(0,Dt.jsx)("button",{className:"w-full bg-white text-gray-700 py-2 px-4 rounded-md font-medium border border-gray-300 hover:bg-gray-50 transition",children:"Share"})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Weather"}),(0,Dt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("svg",{className:"h-10 w-10 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,Dt.jsxs)("div",{className:"ml-3",children:[(0,Dt.jsx)("div",{className:"text-gray-900 font-medium",children:"Sunny"}),(0,Dt.jsx)("div",{className:"text-gray-500 text-sm",children:"Perfect day to visit!"})]})]}),(0,Dt.jsx)("div",{className:"text-2xl font-bold",children:"28\xb0C"})]})]}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Opening Hours"}),(0,Dt.jsxs)("div",{className:"text-gray-700",children:[(0,Dt.jsx)("p",{className:"mb-1",children:n.hours}),(0,Dt.jsxs)("div",{className:"mt-3 text-sm",children:[(0,Dt.jsxs)("div",{className:"flex justify-between py-1",children:[(0,Dt.jsx)("span",{className:"font-medium",children:"Today"}),(0,Dt.jsx)("span",{className:"text-green-600 font-medium",children:"Open Now"})]}),(0,Dt.jsx)("div",{className:"h-2 w-full bg-gray-200 rounded-full mt-2",children:(0,Dt.jsx)("div",{className:"h-2 bg-green-500 rounded-full",style:{width:"60%"}})}),(0,Dt.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,Dt.jsx)("span",{children:"Opens 7:00 AM"}),(0,Dt.jsx)("span",{children:"Closes 10:00 PM"})]})]})]})]})]})]})]}):(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-16 text-center",children:[(0,Dt.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Attraction not found"}),(0,Dt.jsx)("p",{className:"mt-2 text-gray-600",children:"The attraction you're looking for doesn't exist or has been removed."}),(0,Dt.jsx)("button",{onClick:()=>t(-1),className:"mt-6 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700",children:"Go Back"})]})};const iq=function(){const e=Oe(),{isAuthenticated:t}=Pt(),{addToCart:n}=Bt(),[a,s]=(0,B.useState)(""),[r,i]=(0,B.useState)(""),[o,l]=(0,B.useState)(""),[c,u]=(0,B.useState)(""),[d,h]=(0,B.useState)("Economy"),[p,m]=(0,B.useState)(!1),f=[{id:1,name:"Economy",price:299,description:"Affordable rides for everyday travel",image:"https://tse4.mm.bing.net/th/id/OIP.CX4gDX1B3lcnjEtQFXqyvgHaFj?rs=1&pid=ImgDetMain&o=7&rm=3"},{id:2,name:"Premium",price:499,description:"Comfortable cars with extra legroom",image:"https://dam.alfuttaim.com/dx/api/dam/v1/collections/2838cf54-504b-498c-9fa3-41e8136fdfdf/items/4a949ea1-fcc4-4bde-82da-658c6bc99a12/renditions/f2ddaa7b-e250-4818-8fa3-4944f79c0129?binary=true"},{id:3,name:"Luxury",price:999,description:"Premium vehicles with top-rated drivers",image:"https://img.freepik.com/premium-photo/modern-luxury-car-transparent-white-isolated-background-p-white-background-white-background-hd-pho_873925-972118.jpg?w=2000"},{id:4,name:"SUV",price:799,description:"Spacious vehicles for groups and families",image:"https://thumbs.dreamstime.com/b/white-metallic-generic-suv-car-white-background-isolated-path-white-metallic-generic-suv-car-off-road-crossover-123337285.jpg"}];return(0,B.useEffect)(()=>{t()||e("/login",{state:{from:"/booking/cabs"}});(async()=>{const e=await Pn();m(e)})()},[t,e]),(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8",children:[p&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-6 text-primary-700",children:"Book a Cab"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Dt.jsx)("div",{className:"lg:col-span-2",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Enter Trip Details"}),(0,Dt.jsxs)("form",{onSubmit:s=>{if(s.preventDefault(),!t())return void e("/login",{state:{from:"/booking/cabs"}});if(p)return void alert("You already have an active booking. Please complete or delete your current booking before making a new one.");if(!a||!r)return void alert("Please enter both pickup and destination addresses.");const i=f.find(e=>e.name===d)||f[0],l=Math.floor(20*Math.random())+5,u=i.price+10*l,h={id:"CAB-".concat(Date.now().toString().slice(-6)),type:"Cab Service",cabType:d,from:a,to:r,date:o||(new Date).toLocaleDateString(),time:c||(new Date).toLocaleTimeString(),estimatedDistance:"".concat(l," km"),price:u,image:i.image};n(h),alert("".concat(d," cab booking has been added to your cart!"))},children:[(0,Dt.jsx)(Bn,{label:"Pickup Location",value:a,onChange:s,placeholder:"Enter your pickup location",allowCurrentLocation:!0}),(0,Dt.jsx)(Bn,{label:"Destination",value:r,onChange:i,placeholder:"Enter your destination",allowCurrentLocation:!1}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:o,onChange:e=>l(e.target.value),required:!0})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Time:"}),(0,Dt.jsx)("input",{type:"time",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:c,onChange:e=>u(e.target.value),required:!0})]})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Cab Type:"}),(0,Dt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:f.map(e=>(0,Dt.jsxs)("div",{className:"border rounded-lg p-3 cursor-pointer transition-all ".concat(d===e.name?"border-primary-500 bg-primary-50 ring-2 ring-primary-500":"border-gray-200 hover:border-primary-300"),onClick:()=>h(e.name),children:[(0,Dt.jsx)("div",{className:"font-medium",children:e.name}),(0,Dt.jsxs)("div",{className:"text-sm text-gray-500",children:["\u20b9",e.price]})]},e.id))})]}),(0,Dt.jsx)("button",{type:"submit",className:"w-full bg-primary-600 text-white py-3 rounded-md font-bold hover:bg-primary-700 transition",children:"Book Now"})]})]})}),(0,Dt.jsxs)("div",{className:"lg:col-span-1",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Cab Packages"}),(0,Dt.jsx)("div",{className:"space-y-4",children:f.map(e=>(0,Dt.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("img",{src:e.image,alt:e.name,className:"w-12 h-12 rounded-md object-cover"}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("h3",{className:"font-medium",children:e.name}),(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:e.description}),(0,Dt.jsxs)("div",{className:"mt-1 font-semibold text-primary-600",children:["\u20b9",e.price]})]})]})},e.id))})]}),(0,Dt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-100",children:[(0,Dt.jsx)("h3",{className:"font-medium text-blue-800 mb-2",children:"Why book with us?"}),(0,Dt.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,Dt.jsx)("li",{children:"\u2022 Verified drivers with background checks"}),(0,Dt.jsx)("li",{children:"\u2022 24/7 customer support"}),(0,Dt.jsx)("li",{children:"\u2022 No cancellation fees"}),(0,Dt.jsx)("li",{children:"\u2022 Clean and sanitized vehicles"})]})]})]})]})]})};const oq=function(){const e=Oe(),{isAuthenticated:t}=Pt(),{addToCart:n}=Bt(),[a,s]=(0,B.useState)(""),[r,i]=(0,B.useState)(""),[o,l]=(0,B.useState)(""),[c,u]=(0,B.useState)(""),[d,h]=(0,B.useState)("Standard"),[p,m]=(0,B.useState)(!1),f=[{id:1,name:"Standard",price:199,description:"Regular commuter bikes",image:"https://tse2.mm.bing.net/th/id/OIP.vxMB0cYGN-yzWgU8suQAlAHaD4?rs=1&pid=ImgDetMain&o=7&rm=3"},{id:2,name:"Electric",price:299,description:"Battery-powered for effortless rides",image:"https://img.freepik.com/premium-photo/electric-motorcycle-realistic-isolated-8k-white-backgroundgenerative-ai_760510-6569.jpg?w=2000"},{id:3,name:"Mountain",price:349,description:"Off-road capable with suspension",image:"https://tse2.mm.bing.net/th/id/OIP.8GLTyrudWUwqbX3pipbfMQHaHa?rs=1&pid=ImgDetMain&o=7&rm=3"},{id:4,name:"Sports",price:399,description:"High-performance racing bikes",image:"https://tse4.mm.bing.net/th/id/OIP.8r2g7m3AtvroZ5FQilIx4AHaEJ?rs=1&pid=ImgDetMain&o=7&rm=3"}];return(0,B.useEffect)(()=>{t()||e("/login",{state:{from:"/booking/bikes"}}),m(Pn())},[t,e]),(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8",children:[p&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-6 text-primary-700",children:"Rent a Bike"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Dt.jsx)("div",{className:"lg:col-span-2",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Enter Rental Details"}),(0,Dt.jsxs)("form",{onSubmit:s=>{if(s.preventDefault(),!t())return void e("/login",{state:{from:"/booking/bikes"}});if(p)return void alert("You already have an active booking. Please complete or delete your current booking before making a new one.");if(!a)return void alert("Please enter pickup location.");const i=f.find(e=>e.name===d)||f[0],l=new Date(o),u=new Date(c),h=c?Math.ceil((u-l)/864e5):1,m=i.price*h,g={id:"BIKE-".concat(Date.now().toString().slice(-6)),type:"Bike Rental",bikeType:d,from:a,to:r||a,startDate:o||(new Date).toLocaleDateString(),endDate:c||(new Date).toLocaleDateString(),days:h,price:m,image:i.image};n(g),alert("".concat(d," bike rental has been added to your cart!"))},children:[(0,Dt.jsx)(Bn,{label:"Pickup Location",value:a,onChange:s,placeholder:"Enter pickup location",allowCurrentLocation:!0}),(0,Dt.jsx)(Bn,{label:"Return Location (optional)",value:r,onChange:i,placeholder:"Same as pickup location if left empty",allowCurrentLocation:!1}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Start Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:o,onChange:e=>l(e.target.value),required:!0})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"End Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:c,onChange:e=>u(e.target.value),required:!0})]})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Bike Type:"}),(0,Dt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:f.map(e=>(0,Dt.jsxs)("div",{className:"border rounded-lg p-3 cursor-pointer transition-all ".concat(d===e.name?"border-primary-500 bg-primary-50 ring-2 ring-primary-500":"border-gray-200 hover:border-primary-300"),onClick:()=>h(e.name),children:[(0,Dt.jsx)("div",{className:"font-medium",children:e.name}),(0,Dt.jsxs)("div",{className:"text-sm text-gray-500",children:["\u20b9",e.price,"/day"]})]},e.id))})]}),(0,Dt.jsx)("button",{type:"submit",className:"w-full bg-primary-600 text-white py-3 rounded-md font-bold hover:bg-primary-700 transition",children:"Book Now"})]})]})}),(0,Dt.jsxs)("div",{className:"lg:col-span-1",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Bike Options"}),(0,Dt.jsx)("div",{className:"space-y-4",children:f.map(e=>(0,Dt.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("img",{src:e.image,alt:e.name,className:"w-12 h-12 rounded-md object-cover"}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("h3",{className:"font-medium",children:e.name}),(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:e.description}),(0,Dt.jsxs)("div",{className:"mt-1 font-semibold text-primary-600",children:["\u20b9",e.price,"/day"]})]})]})},e.id))})]}),(0,Dt.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 border border-green-100",children:[(0,Dt.jsx)("h3",{className:"font-medium text-green-800 mb-2",children:"Why rent with us?"}),(0,Dt.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:[(0,Dt.jsx)("li",{children:"\u2022 Well-maintained bikes"}),(0,Dt.jsx)("li",{children:"\u2022 Helmets and safety gear included"}),(0,Dt.jsx)("li",{children:"\u2022 Flexible pickup and return"}),(0,Dt.jsx)("li",{children:"\u2022 24/7 roadside assistance"})]})]})]})]})]})};const lq=function(){const e=Oe(),{isAuthenticated:t}=Pt(),[n,a]=(0,B.useState)(""),[s,r]=(0,B.useState)(""),[i,o]=(0,B.useState)(""),[l,c]=(0,B.useState)(1),[u,d]=(0,B.useState)("Sleeper"),[h,p]=(0,B.useState)(!1),m=[{id:1,name:"Sleeper",price:499,description:"Comfortable berths for overnight travel"},{id:2,name:"3AC",price:899,description:"Air-conditioned three-tier sleeper coach"},{id:3,name:"2AC",price:1299,description:"Air-conditioned two-tier sleeper coach"},{id:4,name:"1AC",price:2499,description:"Premium air-conditioned private cabins"}];return(0,B.useEffect)(()=>{t()||e("/login",{state:{from:"/booking/train"}}),p(Pn())},[t,e]),(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8",children:[h&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-6 text-primary-700",children:"Book Train Tickets"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Dt.jsxs)("div",{className:"lg:col-span-2",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Enter Journey Details"}),(0,Dt.jsxs)("form",{onSubmit:a=>{a.preventDefault(),t()?h?alert("You already have an active booking. Please complete or delete your current booking before making a new one."):n&&s?alert("Train booking successful! Your ".concat(u," class tickets from ").concat(n," to ").concat(s," on ").concat(i," have been confirmed.")):alert("Please enter both origin and destination stations."):e("/login",{state:{from:"/booking/train"}})},children:[(0,Dt.jsx)(Bn,{label:"From Station",value:n,onChange:a,placeholder:"Enter origin station",allowCurrentLocation:!1}),(0,Dt.jsx)(Bn,{label:"To Station",value:s,onChange:r,placeholder:"Enter destination station",allowCurrentLocation:!1}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Journey Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:i,onChange:e=>o(e.target.value),required:!0})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Passengers:"}),(0,Dt.jsx)("input",{type:"number",min:"1",max:"6",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:l,onChange:e=>c(parseInt(e.target.value)),required:!0})]})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Class:"}),(0,Dt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:m.map(e=>(0,Dt.jsxs)("div",{className:"border rounded-lg p-3 cursor-pointer transition-all ".concat(u===e.name?"border-primary-500 bg-primary-50 ring-2 ring-primary-500":"border-gray-200 hover:border-primary-300"),onClick:()=>d(e.name),children:[(0,Dt.jsx)("div",{className:"font-medium",children:e.name}),(0,Dt.jsxs)("div",{className:"text-sm text-gray-500",children:["\u20b9",e.price]})]},e.id))})]}),(0,Dt.jsx)("button",{type:"submit",className:"w-full bg-primary-600 text-white py-3 rounded-md font-bold hover:bg-primary-700 transition",children:"Search Trains"})]})]}),(0,Dt.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Available Trains"}),(0,Dt.jsx)("div",{className:"overflow-x-auto",children:(0,Dt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Dt.jsx)("thead",{className:"bg-gray-50",children:(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Train"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departure"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Arrival"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),(0,Dt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),(0,Dt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:[{id:101,name:"Rajdhani Express",departure:"16:50",arrival:"10:20",duration:"17h 30m"},{id:102,name:"Shatabdi Express",departure:"06:15",arrival:"12:45",duration:"6h 30m"},{id:103,name:"Duronto Express",departure:"23:00",arrival:"14:30",duration:"15h 30m"}].map(e=>(0,Dt.jsxs)("tr",{children:[(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.departure}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.arrival}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.duration}),(0,Dt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,Dt.jsx)("button",{className:"text-primary-600 hover:text-primary-900 font-medium",children:"Select"})})]},e.id))})]})})]})]}),(0,Dt.jsxs)("div",{className:"lg:col-span-1",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Class Information"}),(0,Dt.jsx)("div",{className:"space-y-4",children:m.map(e=>(0,Dt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition",children:[(0,Dt.jsx)("h3",{className:"font-medium",children:e.name}),(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:e.description}),(0,Dt.jsxs)("div",{className:"mt-1 font-semibold text-primary-600",children:["\u20b9",e.price]})]},e.id))})]}),(0,Dt.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-4 border border-yellow-100",children:[(0,Dt.jsx)("h3",{className:"font-medium text-yellow-800 mb-2",children:"Important Information"}),(0,Dt.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,Dt.jsx)("li",{children:"\u2022 Arrive 30 minutes before departure"}),(0,Dt.jsx)("li",{children:"\u2022 Carry valid ID proof for all passengers"}),(0,Dt.jsx)("li",{children:"\u2022 Children below 5 years travel free"}),(0,Dt.jsx)("li",{children:"\u2022 Cancellation charges apply as per rules"})]})]})]})]})]})};const cq=function(){const e=Oe(),{isAuthenticated:t}=Pt(),{addToCart:n}=Bt(),[a,s]=(0,B.useState)(""),[r,i]=(0,B.useState)(""),[o,l]=(0,B.useState)(""),[c,u]=(0,B.useState)(1),[d,h]=(0,B.useState)("Single Journey"),[p,m]=(0,B.useState)(!1),f=[{id:1,name:"Single Journey",price:30,description:"One-way trip between stations"},{id:2,name:"Return Journey",price:50,description:"Round trip on the same day"},{id:3,name:"Day Pass",price:100,description:"Unlimited travel for one day"},{id:4,name:"Tourist Pass",price:250,description:"3-day unlimited travel"}];return(0,B.useEffect)(()=>{t()||e("/login",{state:{from:"/booking/metro"}});(async()=>{const e=await Pn();m(e)})()},[t,e]),(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8",children:[p&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-6 text-primary-700",children:"Book Metro Tickets"}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Dt.jsxs)("div",{className:"lg:col-span-2",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Enter Journey Details"}),(0,Dt.jsxs)("form",{onSubmit:s=>{if(s.preventDefault(),!t())return void e("/login",{state:{from:"/booking/metro"}});if(p)return void alert("You already have an active booking. Please complete or delete your current booking before making a new one.");if(!a||!r)return void alert("Please enter both origin and destination stations.");const i=f.find(e=>e.name===d)||f[0],l=i.price*c,u={id:"METRO-".concat(Date.now().toString().slice(-6)),type:"Metro Ticket",ticketType:d,from:a,to:r,date:o||(new Date).toLocaleDateString(),passengers:c,price:l,description:i.description};n(u),alert("".concat(d," metro ticket has been added to your cart!"))},children:[(0,Dt.jsx)(Bn,{label:"From Station",value:a,onChange:s,placeholder:"Enter origin station",allowCurrentLocation:!1}),(0,Dt.jsx)(Bn,{label:"To Station",value:r,onChange:i,placeholder:"Enter destination station",allowCurrentLocation:!1}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Journey Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:o,onChange:e=>l(e.target.value),required:!0})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Passengers:"}),(0,Dt.jsx)("input",{type:"number",min:"1",max:"6",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:c,onChange:e=>u(parseInt(e.target.value)),required:!0})]})]}),(0,Dt.jsxs)("div",{className:"mb-6",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Ticket Type:"}),(0,Dt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:f.map(e=>(0,Dt.jsxs)("div",{className:"border rounded-lg p-3 cursor-pointer transition-all ".concat(d===e.name?"border-primary-500 bg-primary-50 ring-2 ring-primary-500":"border-gray-200 hover:border-primary-300"),onClick:()=>h(e.name),children:[(0,Dt.jsx)("div",{className:"font-medium",children:e.name}),(0,Dt.jsxs)("div",{className:"text-sm text-gray-500",children:["\u20b9",e.price]})]},e.id))})]}),(0,Dt.jsx)("button",{type:"submit",className:"w-full bg-primary-600 text-white py-3 rounded-md font-bold hover:bg-primary-700 transition",children:"Book Tickets"})]})]}),(0,Dt.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow-md p-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Metro Network"}),(0,Dt.jsxs)("div",{className:"p-4 bg-gray-100 rounded-lg",children:[(0,Dt.jsx)("div",{className:"text-center text-gray-500 italic",children:"Interactive metro map would be displayed here"}),(0,Dt.jsx)("div",{className:"mt-6 space-y-4",children:[{id:1,name:"Blue Line",color:"bg-blue-500",stations:["Dwarka","Rajiv Chowk","Noida City Centre"]},{id:2,name:"Yellow Line",color:"bg-yellow-500",stations:["Samaypur Badli","Kashmere Gate","Huda City Centre"]},{id:3,name:"Red Line",color:"bg-red-500",stations:["Rithala","Kashmere Gate","Shaheed Sthal"]},{id:4,name:"Green Line",color:"bg-green-500",stations:["Kirti Nagar","Inderlok","Brigadier Hoshiar Singh"]}].map(e=>(0,Dt.jsxs)("div",{className:"border border-gray-200 rounded-lg bg-white p-4",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(e.color)}),(0,Dt.jsx)("h3",{className:"ml-2 font-medium",children:e.name})]}),(0,Dt.jsx)("div",{className:"mt-2 flex items-center",children:(0,Dt.jsx)("div",{className:"text-sm text-gray-600",children:e.stations.map((t,n)=>(0,Dt.jsxs)("span",{children:[t,n<e.stations.length-1&&(0,Dt.jsx)("span",{className:"mx-1",children:"\u2192"})]},t))})})]},e.id))})]})]})]}),(0,Dt.jsxs)("div",{className:"lg:col-span-1",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Ticket Information"}),(0,Dt.jsx)("div",{className:"space-y-4",children:f.map(e=>(0,Dt.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition",children:[(0,Dt.jsx)("h3",{className:"font-medium",children:e.name}),(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:e.description}),(0,Dt.jsxs)("div",{className:"mt-1 font-semibold text-primary-600",children:["\u20b9",e.price]})]},e.id))})]}),(0,Dt.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-100",children:[(0,Dt.jsx)("h3",{className:"font-medium text-purple-800 mb-2",children:"Metro Guidelines"}),(0,Dt.jsxs)("ul",{className:"text-sm text-purple-700 space-y-1",children:[(0,Dt.jsx)("li",{children:"\u2022 Security check is mandatory at all stations"}),(0,Dt.jsx)("li",{children:"\u2022 Last train timings vary by station"}),(0,Dt.jsx)("li",{children:"\u2022 Children below 3 feet height travel free"}),(0,Dt.jsx)("li",{children:"\u2022 No eating or drinking inside the metro"})]})]})]})]})]})};const uq=function(){const e=Oe(),{isAuthenticated:t}=Pt(),{addToCart:n}=Bt(),[a,s]=(0,B.useState)(""),[r,i]=(0,B.useState)(""),[o,l]=(0,B.useState)(""),[c,u]=(0,B.useState)(""),[d,h]=(0,B.useState)(1),[p,m]=(0,B.useState)("Economy"),[f,g]=(0,B.useState)("round"),[x,y]=(0,B.useState)(!1);return(0,B.useEffect)(()=>{(async()=>{const e=await Pn();y(e)})()},[]),(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8",children:[x&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-6 text-primary-700",children:"Book Flight Tickets"}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsxs)("div",{className:"flex space-x-4 mb-6",children:[(0,Dt.jsx)("button",{className:"px-4 py-2 rounded-md ".concat("round"===f?"bg-primary-600 text-white":"bg-gray-100 text-gray-700"),onClick:()=>g("round"),children:"Round Trip"}),(0,Dt.jsx)("button",{className:"px-4 py-2 rounded-md ".concat("oneway"===f?"bg-primary-600 text-white":"bg-gray-100 text-gray-700"),onClick:()=>g("oneway"),children:"One Way"})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsx)(Bn,{label:"From",value:a,onChange:s,placeholder:"Enter origin city/airport",allowCurrentLocation:!1}),(0,Dt.jsx)(Bn,{label:"To",value:r,onChange:i,placeholder:"Enter destination city/airport",allowCurrentLocation:!1})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Departure Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:o,onChange:e=>l(e.target.value),min:(new Date).toISOString().split("T")[0]})]}),"round"===f&&(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Return Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:c,onChange:e=>u(e.target.value),min:o||(new Date).toISOString().split("T")[0]})]})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Passengers:"}),(0,Dt.jsx)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:d,onChange:e=>h(parseInt(e.target.value)),children:[1,2,3,4,5,6,7,8,9].map(e=>(0,Dt.jsxs)("option",{value:e,children:[e," ",1===e?"Passenger":"Passengers"]},e))})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Class:"}),(0,Dt.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:p,onChange:e=>m(e.target.value),children:[(0,Dt.jsx)("option",{value:"Economy",children:"Economy"}),(0,Dt.jsx)("option",{value:"Premium Economy",children:"Premium Economy"}),(0,Dt.jsx)("option",{value:"Business",children:"Business"}),(0,Dt.jsx)("option",{value:"First",children:"First Class"})]})]})]}),(0,Dt.jsx)("button",{className:"w-full bg-primary-600 text-white py-3 rounded-md font-bold hover:bg-primary-700 transition",onClick:()=>{a&&r&&o?document.getElementById("flight-results").scrollIntoView({behavior:"smooth"}):alert("Please fill in all required fields")},children:"Search Flights"})]}),(0,Dt.jsxs)("div",{id:"flight-results",className:"mb-8",children:[(0,Dt.jsx)("h2",{className:"text-2xl font-bold mb-4 text-primary-700",children:"Available Flights"}),(0,Dt.jsx)("div",{className:"space-y-4",children:[{id:1,airline:"IndiGo",departure:"06:30",arrival:"08:45",duration:"2h 15m",price:4999,stops:0},{id:2,airline:"Air India",departure:"08:15",arrival:"10:45",duration:"2h 30m",price:5499,stops:0},{id:3,airline:"SpiceJet",departure:"10:30",arrival:"13:15",duration:"2h 45m",price:4799,stops:1},{id:4,airline:"Vistara",departure:"14:00",arrival:"16:15",duration:"2h 15m",price:6299,stops:0},{id:5,airline:"GoAir",departure:"16:45",arrival:"19:30",duration:"2h 45m",price:4599,stops:1},{id:6,airline:"AirAsia",departure:"19:30",arrival:"21:45",duration:"2h 15m",price:4899,stops:0}].map(s=>(0,Dt.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition",children:(0,Dt.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[(0,Dt.jsxs)("div",{className:"mb-4 md:mb-0",children:[(0,Dt.jsx)("div",{className:"font-bold text-lg",children:s.airline}),(0,Dt.jsx)("div",{className:"text-sm text-gray-500",children:0===s.stops?"Direct Flight":"".concat(s.stops," Stop")})]}),(0,Dt.jsxs)("div",{className:"flex items-center mb-4 md:mb-0",children:[(0,Dt.jsxs)("div",{className:"text-right mr-8",children:[(0,Dt.jsx)("div",{className:"font-bold",children:s.departure}),(0,Dt.jsx)("div",{className:"text-sm text-gray-500",children:a})]}),(0,Dt.jsxs)("div",{className:"text-center mx-4",children:[(0,Dt.jsx)("div",{className:"text-xs text-gray-500",children:s.duration}),(0,Dt.jsxs)("div",{className:"w-20 h-0.5 bg-gray-300 relative",children:[(0,Dt.jsx)("div",{className:"absolute -top-1.5 -right-1 w-3 h-3 border-2 border-gray-300 bg-white rounded-full"}),(0,Dt.jsx)("div",{className:"absolute -top-1.5 -left-1 w-3 h-3 border-2 border-gray-300 bg-white rounded-full"})]})]}),(0,Dt.jsxs)("div",{className:"text-left ml-8",children:[(0,Dt.jsx)("div",{className:"font-bold",children:s.arrival}),(0,Dt.jsx)("div",{className:"text-sm text-gray-500",children:r})]})]}),(0,Dt.jsxs)("div",{className:"flex flex-col items-end",children:[(0,Dt.jsxs)("div",{className:"font-bold text-xl text-primary-600 mb-2",children:["\u20b9",s.price]}),(0,Dt.jsx)("button",{onClick:()=>(s=>{if(!t())return void e("/login",{state:{from:"/booking/flight"}});if(x)return void alert("You already have an active booking. Please complete or delete your current booking before making a new one.");if(!a||!r||!o)return void alert("Please fill in all required fields");const i={id:"FL-".concat(Date.now().toString().slice(-6)),type:"Flight",from:a,to:r,departDate:o,returnDate:"round"===f?c:null,passengers:d,class:p,airline:s.airline,departure:s.departure,arrival:s.arrival,price:s.price*d,tripType:f};n(i),alert("Flight added to cart!")})(s),className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition",children:"Book Now"})]})]})},s.id))})]}),(0,Dt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-6 border border-blue-100",children:[(0,Dt.jsx)("h3",{className:"font-medium text-blue-800 mb-4 text-lg",children:"Flight Booking Tips"}),(0,Dt.jsxs)("ul",{className:"text-blue-700 space-y-2",children:[(0,Dt.jsxs)("li",{className:"flex items-start",children:[(0,Dt.jsx)("span",{className:"mr-2",children:"\u2022"}),(0,Dt.jsx)("span",{children:"Book 3-4 weeks in advance for domestic flights to get the best prices"})]}),(0,Dt.jsxs)("li",{className:"flex items-start",children:[(0,Dt.jsx)("span",{className:"mr-2",children:"\u2022"}),(0,Dt.jsx)("span",{children:"Tuesday and Wednesday are typically the cheapest days to fly"})]}),(0,Dt.jsxs)("li",{className:"flex items-start",children:[(0,Dt.jsx)("span",{className:"mr-2",children:"\u2022"}),(0,Dt.jsx)("span",{children:"Early morning or late night flights are often less expensive"})]}),(0,Dt.jsxs)("li",{className:"flex items-start",children:[(0,Dt.jsx)("span",{className:"mr-2",children:"\u2022"}),(0,Dt.jsx)("span",{children:"Check baggage allowance before booking to avoid extra charges"})]})]})]})]})};const dq=function(){const e=Oe(),{isAuthenticated:t}=Pt(),{addToCart:n}=Bt(),[a,s]=(0,B.useState)(""),[r,i]=(0,B.useState)(""),[o,l]=(0,B.useState)(""),[c,u]=(0,B.useState)(""),[d,h]=(0,B.useState)(1);(0,B.useEffect)(()=>{x(Pn())},[]);const p=[{id:1,type:"Regular Auto",basePrice:50,perKmRate:15,capacity:3,features:["Metered","Standard"]},{id:2,type:"Premium Auto",basePrice:70,perKmRate:18,capacity:3,features:["Metered","Comfortable Seating","Mobile Charging"]},{id:3,type:"Shared Auto",basePrice:30,perKmRate:10,capacity:6,features:["Fixed Routes","Shared Ride","Economical"]},{id:4,type:"Electric Auto",basePrice:60,perKmRate:16,capacity:3,features:["Eco-friendly","Quiet Ride","Modern"]}],[m,f]=(0,B.useState)(p[0]),[g,x]=(0,B.useState)(!1),y=(e,t)=>m.basePrice+m.perKmRate*(Math.floor(10*Math.random())+1);return(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[g&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,Dt.jsx)("div",{className:"lg:col-span-2",children:(0,Dt.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,Dt.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Book an Auto Rickshaw"}),(0,Dt.jsxs)("form",{onSubmit:s=>{if(s.preventDefault(),!t())return void e("/login",{state:{from:"/booking/auto"}});if(g)return void alert("You already have an active booking. Please complete or delete your current booking before making a new one.");if(!a||!r)return void alert("Please enter both pickup and destination addresses.");const i={id:"AU-".concat(Date.now().toString().slice(-6)),type:"Auto Rickshaw",from:a,to:r,date:o||(new Date).toLocaleDateString(),time:c||(new Date).toLocaleTimeString(),passengers:d,price:y(a,r)};n(i),alert("Auto rickshaw booking added to cart!")},className:"space-y-6",children:[(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pickup Location"}),(0,Dt.jsx)(Bn,{placeholder:"Enter pickup location",value:a,onChange:s})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination"}),(0,Dt.jsx)(Bn,{placeholder:"Enter destination",value:r,onChange:i})]})]}),(0,Dt.jsxs)("div",{className:"mt-6",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Auto Type"}),(0,Dt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:p.map(e=>(0,Dt.jsxs)("div",{onClick:()=>f(e),className:"border rounded-lg p-4 cursor-pointer transition-all ".concat(m.id===e.id?"border-primary-500 bg-primary-50 shadow-md":"border-gray-200 hover:border-primary-300 hover:bg-gray-50"),children:[(0,Dt.jsx)("h3",{className:"font-medium text-gray-900",children:e.type}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Base fare: \u20b9",e.basePrice]}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500",children:["Per km: \u20b9",e.perKmRate]}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-500",children:["Capacity: ",e.capacity," persons"]}),(0,Dt.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:e.features.map((e,t)=>(0,Dt.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:e},t))})]},e.id))})]}),(0,Dt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Date:"}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:o,onChange:e=>l(e.target.value),min:(new Date).toISOString().split("T")[0]})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Time:"}),(0,Dt.jsx)("input",{type:"time",className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:c,onChange:e=>u(e.target.value)})]})]}),(0,Dt.jsxs)("div",{className:"mb-4",children:[(0,Dt.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Passengers:"}),(0,Dt.jsxs)("select",{className:"w-full px-3 py-2 border border-primary-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",value:d,onChange:e=>h(parseInt(e.target.value)),children:[(0,Dt.jsx)("option",{value:"1",children:"1 Passenger"}),(0,Dt.jsx)("option",{value:"2",children:"2 Passengers"}),(0,Dt.jsx)("option",{value:"3",children:"3 Passengers"})]}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Auto rickshaws can accommodate up to 3 passengers"})]}),(0,Dt.jsx)("button",{type:"submit",className:"w-full bg-primary-600 text-white py-3 rounded-md font-bold hover:bg-primary-700 transition",children:"Book Now"})]})]})}),(0,Dt.jsxs)("div",{className:"lg:col-span-1",children:[(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Auto Rickshaw Info"}),(0,Dt.jsxs)("div",{className:"space-y-4",children:[(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-yellow-100 flex items-center justify-center",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium",children:"Quick & Convenient"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Perfect for short distances within the city"})]})]}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium",children:"Affordable"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Economical option with metered fares"})]})]}),(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium",children:"Navigate Narrow Streets"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Can access areas where larger vehicles can't go"})]})]}),(0,Dt.jsxs)("div",{className:"flex items-center mt-4",children:[(0,Dt.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-red-100 flex items-center justify-center",children:(0,Dt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,Dt.jsxs)("div",{className:"ml-4",children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium",children:"Safety Guidelines"}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Always check driver ID and vehicle number before boarding"})]})]})]})]}),(0,Dt.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-4 border border-yellow-100",children:[(0,Dt.jsx)("h3",{className:"font-medium text-yellow-800 mb-2",children:"Fare Information"}),(0,Dt.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,Dt.jsx)("li",{children:"\u2022 Base fare: \u20b950 for first 1.5 km"}),(0,Dt.jsx)("li",{children:"\u2022 \u20b915 per additional km"}),(0,Dt.jsx)("li",{children:"\u2022 Waiting charges: \u20b930 per 15 minutes"}),(0,Dt.jsx)("li",{children:"\u2022 Night charges (10 PM - 5 AM): 1.5x regular fare"})]})]})]})]})]})},hq=Zn("bug",[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]]),pq=[{id:1,name:"Golden Triangle Tour",description:"Explore Delhi, Agra, and Jaipur in this classic Indian tour package",duration:"6 days, 5 nights",price:24999,image:"https://storage.googleapis.com/prune/blog_image/Golden-tringle.jpg",highlights:["Taj Mahal","Amber Fort","Qutub Minar","City Palace"]},{id:2,name:"Kerala Backwaters",description:"Experience the serene backwaters and lush landscapes of God's Own Country",duration:"5 days, 4 nights",price:19999,image:"https://www.ekeralatourism.net/wp-content/uploads/2019/04/keralabacwater-sept.jpg",highlights:["Houseboat Stay","Munnar Tea Gardens","Kovalam Beach","Periyar Wildlife"]},{id:3,name:"Himalayan Adventure",description:"Trek through the majestic Himalayas and experience the mountain culture",duration:"7 days, 6 nights",price:29999,image:"https://trisoj.com/travel-guide/wp-content/uploads/2023/08/Places-to-visit-in-Shimla-Kullu-Manali.jpg",highlights:["Shimla","Manali","Dharamshala","Dalhousie"]},{id:4,name:"Goa Beach Getaway",description:"Relax on the beautiful beaches of Goa and enjoy water sports",duration:"4 days, 3 nights",price:15999,image:"https://www.adotrip.com/public/images/areas/master_images/60d0813807aff-Baga_Beach_In_Goa.jpg",highlights:["Calangute Beach","Water Sports","Nightlife","Dudhsagar Falls"]},{id:5,name:"Rajasthan Heritage Tour",description:"Discover the royal heritage and culture of Rajasthan",duration:"8 days, 7 nights",price:32999,image:"https://www.tripnstay.com/wp-content/uploads/2023/04/raj-1024x587.jpg",highlights:["Udaipur Lake Palace","Jodhpur Fort","Jaisalmer Desert Safari","Pushkar"]},{id:6,name:"Northeast Explorer",description:"Explore the unexplored beauty of India's Northeast states",duration:"9 days, 8 nights",price:35999,image:"https://www.tourism-of-india.com/blog/wp-content/uploads/2018/06/Tawang-Arunachal-Pradesh.jpg",highlights:["Kaziranga National Park","Cherrapunji","Tawang Monastery","Majuli Island"]}];const mq=function(){const e=Oe(),[t,n]=(0,B.useState)(null),[a,s]=(0,B.useState)(!1),[r,i]=(0,B.useState)(1),[o,l]=(0,B.useState)(""),[c,u]=(0,B.useState)(!1),[d,h]=(0,B.useState)([]),[p,m]=(0,B.useState)(null),[f,g]=(0,B.useState)(!1);return(0,B.useEffect)(()=>{const e=setTimeout(()=>{h(pq)},100),t=()=>{g(Pn())};t();const n=setInterval(t,1e3),a=()=>{t()};return window.addEventListener("storage",a),()=>{clearTimeout(e),clearInterval(n),window.removeEventListener("storage",a)}},[]),(0,Dt.jsxs)("div",{className:"max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8",children:[f&&(0,Dt.jsx)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Active Booking Detected"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"You already have an active booking. Please complete or delete your current booking before making a new one."})]})]})}),(0,Dt.jsxs)("div",{className:"flex justify-between items-center mb-8 animate-fadeIn",children:[(0,Dt.jsxs)("div",{className:"animate-slideInLeft",children:[(0,Dt.jsx)("h1",{className:"text-4xl font-bold mb-2 text-primary-700 bg-gradient-to-r from-primary-600 to-purple-600 bg-clip-text text-transparent",children:"Trip Packages"}),(0,Dt.jsx)("p",{className:"text-gray-600 text-lg",children:"Choose from our curated selection of travel packages across India"})]}),(0,Dt.jsxs)("button",{onClick:()=>{const e=JSON.parse(localStorage.getItem("bookings")||"[]");console.log("Current bookings:",e),console.log("hasActiveBooking():",Pn()),console.log("activeBookingExists state:",f),alert("Debug Info:\nTotal bookings: ".concat(e.length,"\nActive booking exists: ").concat(Pn(),"\nState activeBookingExists: ").concat(f))},className:"bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-gray-700 transition-colors duration-300",children:[(0,Dt.jsx)(hq,{className:"w-4 h-4 mr-2"}),"Debug"]})]}),(0,Dt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:d.map((e,t)=>(0,Dt.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2 hover:scale-105 group animate-fadeInUp ".concat(p===e.id?"ring-4 ring-primary-200":""),style:{animationDelay:"".concat(100*t,"ms")},onMouseEnter:()=>m(e.id),onMouseLeave:()=>m(null),children:[(0,Dt.jsxs)("div",{className:"relative overflow-hidden",children:[(0,Dt.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-56 object-cover transform group-hover:scale-110 transition-transform duration-700"}),(0,Dt.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,Dt.jsx)("div",{className:"absolute top-4 right-4",children:(0,Dt.jsx)("span",{className:"bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full text-sm font-semibold text-primary-700 shadow-lg",children:e.duration})})]}),(0,Dt.jsxs)("div",{className:"p-6",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,Dt.jsx)("h2",{className:"text-xl font-bold text-gray-900 group-hover:text-primary-700 transition-colors duration-300",children:e.name}),(0,Dt.jsxs)("span",{className:"text-2xl font-bold text-primary-600",children:["\u20b9",e.price.toLocaleString()]})]}),(0,Dt.jsx)("p",{className:"text-gray-600 mb-4 leading-relaxed group-hover:text-gray-700 transition-colors duration-300",children:e.description}),(0,Dt.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4 mr-2 text-primary-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 13.047 14.01c-.04.27-.24.49-.51.51h-.054c-.27-.02-.47-.24-.51-.51L9.854 7.2 11.033 2.744A1 1 0 0112 2z",clipRule:"evenodd"})}),"Highlights:"]}),(0,Dt.jsx)("ul",{className:"text-sm text-gray-600 mb-6 space-y-2",children:e.highlights.map((e,t)=>(0,Dt.jsxs)("li",{className:"flex items-center group-hover:translate-x-1 transition-transform duration-300",children:[(0,Dt.jsx)("span",{className:"mr-3 text-primary-500 group-hover:text-primary-600 transition-colors duration-300",children:(0,Dt.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,Dt.jsx)("span",{className:"group-hover:text-gray-800 transition-colors duration-300",children:e})]},t))}),(0,Dt.jsx)("button",{onClick:()=>(e=>{Pn()?alert("You already have an active booking. Please complete or delete your current booking before making a new one."):(n(e),s(!0))})(e),disabled:f,className:"w-full py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 hover:shadow-lg shadow-md group-hover:shadow-xl ".concat(f?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800"),children:(0,Dt.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Dt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),f?"Booking Restricted":"Book Now"]})})]})]},e.id))}),a&&t&&(0,Dt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 animate-fadeIn",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-xl max-w-md w-full p-8 animate-scaleIn shadow-2xl",children:[(0,Dt.jsxs)("div",{className:"text-center mb-6",children:[(0,Dt.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-primary-100 to-primary-200 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Dt.jsx)("svg",{className:"w-8 h-8 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),(0,Dt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t.name}),(0,Dt.jsx)("p",{className:"text-gray-600",children:"Complete your booking details"}),f&&(0,Dt.jsxs)("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-center",children:[(0,Dt.jsx)(Xn,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0"}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Booking Restricted"}),(0,Dt.jsx)("p",{className:"text-xs text-yellow-700",children:"You already have an active booking. This will replace your current booking."})]})]})]}),(0,Dt.jsxs)("div",{className:"space-y-6",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4 mr-2 text-primary-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"})}),"Number of Travelers"]}),(0,Dt.jsx)("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-300 bg-white shadow-sm",value:r,onChange:e=>i(parseInt(e.target.value)),children:[1,2,3,4,5,6,7,8].map(e=>(0,Dt.jsxs)("option",{value:e,className:"py-2",children:[e," ",1===e?"person":"people"]},e))})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[(0,Dt.jsx)("svg",{className:"w-4 h-4 mr-2 text-primary-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Dt.jsx)("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})}),"Departure Date"]}),(0,Dt.jsx)("input",{type:"date",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-300 bg-white shadow-sm",value:o,onChange:e=>l(e.target.value),min:(new Date).toISOString().split("T")[0]})]})]}),(0,Dt.jsxs)("div",{className:"bg-gradient-to-r from-primary-50 to-purple-50 rounded-lg p-4 mt-6 border border-primary-100",children:[(0,Dt.jsxs)("div",{className:"flex justify-between items-center text-sm font-medium text-gray-700 mb-2",children:[(0,Dt.jsx)("span",{children:"Package Price:"}),(0,Dt.jsxs)("span",{children:["\u20b9",t.price.toLocaleString()," \xd7 ",r]})]}),(0,Dt.jsxs)("div",{className:"flex justify-between items-center text-xl font-bold text-primary-700 border-t border-primary-200 pt-2",children:[(0,Dt.jsx)("span",{children:"Total Amount:"}),(0,Dt.jsxs)("span",{className:"text-2xl",children:["\u20b9",(t.price*r).toLocaleString()]})]})]}),(0,Dt.jsxs)("div",{className:"flex gap-4 mt-8",children:[(0,Dt.jsx)("button",{onClick:()=>s(!1),className:"flex-1 py-3 border border-gray-300 rounded-lg font-semibold text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition-all duration-300 transform hover:scale-105",children:"Cancel"}),(0,Dt.jsx)("button",{onClick:()=>{if(o){if(Pn())return alert("You already have an active booking. Please complete or delete your current booking before making a new one."),void s(!1);u(!0),setTimeout(()=>{const n={id:"TP-".concat(Date.now().toString().slice(-6)),type:"Trip Package",name:t.name,price:t.price*r,date:o,travelers:r,duration:t.duration,status:"Pending Payment",details:{"Booking ID":"TP-".concat(Date.now().toString().slice(-6)),Package:t.name,Travelers:r,Departure:o,Duration:t.duration,Payment:"Pending"}},a=t.price*r;u(!1),s(!1),e("/payment",{state:{bookingDetails:n,totalAmount:a,bookingType:"Trip Package"}})},1500)}else alert("Please select a departure date")},disabled:c,className:"flex-1 bg-gradient-to-r from-primary-600 to-primary-700 text-white py-3 rounded-lg font-semibold hover:from-primary-700 hover:to-primary-800 transition-all duration-300 transform hover:scale-105 hover:shadow-lg shadow-md disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center",children:c?(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsxs)("svg",{className:"animate-spin w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Dt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Confirm Booking"]})})]})]})})]})};const fq=function(){return(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Privacy Policy"}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsx)("p",{className:"text-gray-600 mb-4",children:"Last updated: June 2023"}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"1. Introduction"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Welcome to Trailblazers. We respect your privacy and are committed to protecting your personal data. This privacy policy will inform you about how we look after your personal data when you visit our website and tell you about your privacy rights and how the law protects you."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"2. The Data We Collect"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"We may collect, use, store and transfer different kinds of personal data about you which we have grouped together as follows:"}),(0,Dt.jsxs)("ul",{className:"list-disc pl-6 text-gray-700 mb-3",children:[(0,Dt.jsx)("li",{className:"mb-2",children:"Identity Data includes first name, last name, username or similar identifier."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Contact Data includes email address and telephone numbers."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Technical Data includes internet protocol (IP) address, your login data, browser type and version."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Profile Data includes your username and password, your interests, preferences, feedback and survey responses."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Usage Data includes information about how you use our website, products and services."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Location Data includes your current location when you use our travel tracking features."})]})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"3. How We Use Your Data"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"We will only use your personal data when the law allows us to. Most commonly, we will use your personal data in the following circumstances:"}),(0,Dt.jsxs)("ul",{className:"list-disc pl-6 text-gray-700 mb-3",children:[(0,Dt.jsx)("li",{className:"mb-2",children:"To register you as a new customer."}),(0,Dt.jsx)("li",{className:"mb-2",children:"To process and deliver your bookings."}),(0,Dt.jsx)("li",{className:"mb-2",children:"To manage our relationship with you."}),(0,Dt.jsx)("li",{className:"mb-2",children:"To enable you to participate in community features."}),(0,Dt.jsx)("li",{className:"mb-2",children:"To provide travel safety information based on your location."}),(0,Dt.jsx)("li",{className:"mb-2",children:"To improve our website, products/services, marketing or customer relationships."})]})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"4. Data Security"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"We have put in place appropriate security measures to prevent your personal data from being accidentally lost, used or accessed in an unauthorized way, altered or disclosed. In addition, we limit access to your personal data to those employees, agents, contractors and other third parties who have a business need to know."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"5. Your Legal Rights"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Under certain circumstances, you have rights under data protection laws in relation to your personal data, including:"}),(0,Dt.jsxs)("ul",{className:"list-disc pl-6 text-gray-700 mb-3",children:[(0,Dt.jsx)("li",{className:"mb-2",children:"Request access to your personal data."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Request correction of your personal data."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Request erasure of your personal data."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Object to processing of your personal data."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Request restriction of processing your personal data."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Request transfer of your personal data."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Right to withdraw consent."})]})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"6. Contact Us"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"If you have any questions about this privacy policy or our privacy practices, please contact us at:"}),(0,Dt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,Dt.jsx)("p",{className:"text-gray-700",children:"Email: kumarsanskar52515@gmail.com"}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"Phone: +91 7302028936"}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"Address: Gautam Buddha University, Greater Noida"})]})]})]})]})};const gq=function(){return(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Terms of Service"}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsx)("p",{className:"text-gray-600 mb-4",children:"Last updated: June 2023"}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"1. Introduction"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Welcome to Trailblazers. These terms and conditions outline the rules and regulations for the use of our website and services."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"By accessing this website, we assume you accept these terms and conditions. Do not continue to use Trailblazers if you do not agree to take all of the terms and conditions stated on this page."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"2. License"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Unless otherwise stated, Trailblazers and/or its licensors own the intellectual property rights for all material on the website. All intellectual property rights are reserved."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"You may view and/or print pages from the website for your own personal use subject to restrictions set in these terms and conditions."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"3. User Account"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"When you create an account with us, you guarantee that the information you provide is accurate, complete, and current at all times. Inaccurate, incomplete, or obsolete information may result in the immediate termination of your account on the service."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"You are responsible for maintaining the confidentiality of your account and password, including but not limited to the restriction of access to your computer and/or account. You agree to accept responsibility for any and all activities or actions that occur under your account and/or password."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"4. Services and Bookings"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Trailblazers provides a platform for travel planning, booking, and community engagement. All bookings made through our platform are subject to availability and confirmation."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"We reserve the right to refuse service to anyone for any reason at any time. We reserve the right to make changes to or terminate the service for any reason, without notice at any time."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"5. User Content"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Our service allows you to post, link, store, share and otherwise make available certain information, text, graphics, videos, or other material. You are responsible for the content that you post to the service, including its legality, reliability, and appropriateness."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"By posting content to the service, you grant us the right and license to use, modify, publicly perform, publicly display, reproduce, and distribute such content on and through the service."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"6. Limitation of Liability"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"In no event shall Trailblazers, nor its directors, employees, partners, agents, suppliers, or affiliates, be liable for any indirect, incidental, special, consequential or punitive damages, including without limitation, loss of profits, data, use, goodwill, or other intangible losses, resulting from:"}),(0,Dt.jsxs)("ul",{className:"list-disc pl-6 text-gray-700 mb-3",children:[(0,Dt.jsx)("li",{className:"mb-2",children:"Your access to or use of or inability to access or use the service;"}),(0,Dt.jsx)("li",{className:"mb-2",children:"Any conduct or content of any third party on the service;"}),(0,Dt.jsx)("li",{className:"mb-2",children:"Any content obtained from the service; and"}),(0,Dt.jsx)("li",{className:"mb-2",children:"Unauthorized access, use or alteration of your transmissions or content."})]})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"7. Governing Law"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"These Terms shall be governed and construed in accordance with the laws of India, without regard to its conflict of law provisions."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Our failure to enforce any right or provision of these Terms will not be considered a waiver of those rights. If any provision of these Terms is held to be invalid or unenforceable by a court, the remaining provisions of these Terms will remain in effect."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"8. Changes to Terms"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"We reserve the right, at our sole discretion, to modify or replace these Terms at any time. If a revision is material we will try to provide at least 30 days notice prior to any new terms taking effect."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"By continuing to access or use our service after those revisions become effective, you agree to be bound by the revised terms. If you do not agree to the new terms, please stop using the service."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"9. Contact Us"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"If you have any questions about these Terms, please contact us at:"}),(0,Dt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,Dt.jsx)("p",{className:"text-gray-700",children:"Email: kumarsanskar52515@gmail.com"}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"Phone: +91 7302028936"}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"Address: Gautam Buddha University, Greater Noida"})]})]})]})]})};const xq=function(){return(0,Dt.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Cookie Policy"}),(0,Dt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Dt.jsx)("p",{className:"text-gray-600 mb-4",children:"Last updated: June 2023"}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"1. What Are Cookies"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Cookies are small pieces of text sent to your web browser by a website you visit. A cookie file is stored in your web browser and allows the service or a third-party to recognize you and make your next visit easier and the service more useful to you."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:'Cookies can be "persistent" or "session" cookies. Persistent cookies remain on your personal computer or mobile device when you go offline, while session cookies are deleted as soon as you close your web browser.'})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"2. How We Use Cookies"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"When you use and access our service, we may place a number of cookie files in your web browser. We use cookies for the following purposes:"}),(0,Dt.jsxs)("ul",{className:"list-disc pl-6 text-gray-700 mb-3",children:[(0,Dt.jsx)("li",{className:"mb-2",children:"To enable certain functions of the service"}),(0,Dt.jsx)("li",{className:"mb-2",children:"To provide analytics"}),(0,Dt.jsx)("li",{className:"mb-2",children:"To store your preferences"}),(0,Dt.jsx)("li",{className:"mb-2",children:"To enable advertisements delivery, including behavioral advertising"})]}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"We use both session and persistent cookies on the service and we use different types of cookies to run the service:"}),(0,Dt.jsxs)("ul",{className:"list-disc pl-6 text-gray-700 mb-3",children:[(0,Dt.jsx)("li",{className:"mb-2",children:"Essential cookies. We may use essential cookies to authenticate users and prevent fraudulent use of user accounts."}),(0,Dt.jsx)("li",{className:"mb-2",children:'Preferences cookies. We may use preferences cookies to remember information that changes the way the service behaves or looks, such as the "remember me" functionality.'}),(0,Dt.jsx)("li",{className:"mb-2",children:"Analytics cookies. We may use analytics cookies to track information how the service is used so that we can make improvements."}),(0,Dt.jsx)("li",{className:"mb-2",children:"Advertising cookies. These cookies collect information about your visit to our website, the content you viewed, the links you followed and information about your browser, device, and your IP address."})]})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"3. Third-Party Cookies"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"In addition to our own cookies, we may also use various third-party cookies to report usage statistics of the service, deliver advertisements on and through the service, and so on."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"4. What Are Your Choices Regarding Cookies"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"If you'd like to delete cookies or instruct your web browser to delete or refuse cookies, please visit the help pages of your web browser."}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"Please note, however, that if you delete cookies or refuse to accept them, you might not be able to use all of the features we offer, you may not be able to store your preferences, and some of our pages might not display properly."})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"5. Where Can You Find More Information About Cookies"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"You can learn more about cookies and the following third-party websites:"}),(0,Dt.jsxs)("ul",{className:"list-disc pl-6 text-gray-700 mb-3",children:[(0,Dt.jsxs)("li",{className:"mb-2",children:["AllAboutCookies: ",(0,Dt.jsx)("a",{href:"http://www.allaboutcookies.org/",className:"text-primary-600 hover:text-primary-800",children:"http://www.allaboutcookies.org/"})]}),(0,Dt.jsxs)("li",{className:"mb-2",children:["Network Advertising Initiative: ",(0,Dt.jsx)("a",{href:"http://www.networkadvertising.org/",className:"text-primary-600 hover:text-primary-800",children:"http://www.networkadvertising.org/"})]})]})]}),(0,Dt.jsxs)("section",{className:"mb-6",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-3",children:"6. Contact Us"}),(0,Dt.jsx)("p",{className:"text-gray-700 mb-3",children:"If you have any questions about our Cookie Policy, please contact us at:"}),(0,Dt.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,Dt.jsx)("p",{className:"text-gray-700",children:"Email: kumarsanskar52515@gmail.com"}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"Phone: +91 7302028936"}),(0,Dt.jsx)("p",{className:"text-gray-700",children:"Address: Gautam Buddha University, Greater Noida"})]})]})]})]})};const yq=function(){var e,t,n;const a=Le(),s=Oe(),{clearCart:r}=Bt(),[i,o]=(0,B.useState)("pending"),[l,c]=(0,B.useState)(300),u=null===(e=a.state)||void 0===e?void 0:e.bookingDetails,d=null===(t=a.state)||void 0===t?void 0:t.totalAmount,h=(null===(n=a.state)||void 0===n?void 0:n.bookingType)||"Trip Package";return(0,B.useEffect)(()=>{if(!u||!d)return alert("No booking details found. Please try again."),void s("/trip-packages");const e=setInterval(()=>{c(t=>t<=1?(clearInterval(e),o("expired"),0):t-1)},1e3);return()=>clearInterval(e)},[u,d,s]),"success"===i?(0,Dt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-green-100 flex items-center justify-center px-4",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:[(0,Dt.jsx)("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,Dt.jsx)("svg",{className:"w-10 h-10 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,Dt.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Shopping Confirmed!"}),(0,Dt.jsx)("p",{className:"text-gray-600 mb-6",children:"Your payment was successful and your booking has been confirmed."}),(0,Dt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,Dt.jsxs)("p",{className:"text-sm text-gray-600",children:["Amount: ",(0,Dt.jsxs)("span",{className:"font-bold text-green-600",children:["\u20b9",null===d||void 0===d?void 0:d.toLocaleString()]})]}),(0,Dt.jsxs)("p",{className:"text-sm text-gray-600",children:["ID: ",(0,Dt.jsx)("span",{className:"font-mono",children:null===u||void 0===u?void 0:u.id})]})]}),(0,Dt.jsx)("p",{className:"text-sm text-gray-500",children:"Redirecting to dashboard..."})]})}):"expired"===i?(0,Dt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-red-100 flex items-center justify-center px-4",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center",children:[(0,Dt.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,Dt.jsx)("svg",{className:"w-10 h-10 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,Dt.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Payment Expired"}),(0,Dt.jsx)("p",{className:"text-gray-600 mb-6",children:"The payment session has expired."}),(0,Dt.jsx)("button",{onClick:()=>s("/trip-packages"),className:"bg-primary-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-primary-700 transition-colors",children:"Back to Packages"})]})}):(0,Dt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-10 px-4",children:(0,Dt.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,Dt.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,Dt.jsx)("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 text-white p-6",children:(0,Dt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Secure Payment"}),(0,Dt.jsx)("p",{className:"text-primary-100",children:"Complete your booking payment"})]}),(0,Dt.jsxs)("div",{className:"text-right",children:[(0,Dt.jsxs)("div",{className:"text-2xl font-bold",children:["\u20b9",null===d||void 0===d?void 0:d.toLocaleString()]}),(0,Dt.jsxs)("div",{className:"text-sm text-primary-100",children:["Time: ",(e=>{const t=Math.floor(e/60),n=e%60;return"".concat(t,":").concat(n.toString().padStart(2,"0"))})(l)]})]})]})}),(0,Dt.jsx)("div",{className:"p-8",children:(0,Dt.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Scan QR Code to Pay"}),(0,Dt.jsx)("div",{className:"bg-gray-50 rounded-xl p-6 mb-4",children:(0,Dt.jsx)("div",{className:"w-48 h-48 mx-auto bg-white rounded-lg p-4 shadow-lg flex items-center justify-center",children:(0,Dt.jsxs)("div",{className:"text-center",children:[(0,Dt.jsx)("div",{className:"w-32 h-32 bg-black rounded-lg mx-auto mb-2",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Crect width='100' height='100' fill='white'/%3E%3Crect x='10' y='10' width='80' height='80' fill='black'/%3E%3Crect x='20' y='20' width='60' height='60' fill='white'/%3E%3Crect x='30' y='30' width='40' height='40' fill='black'/%3E%3C/svg%3E\")",backgroundSize:"cover"}}),(0,Dt.jsx)("p",{className:"text-xs text-gray-500",children:"Demo QR Code"})]})})}),(0,Dt.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Use any UPI app (Google Pay, PhonePe, Paytm) to scan and pay"}),(0,Dt.jsx)("div",{className:"bg-blue-50 rounded-lg p-3",children:(0,Dt.jsx)("p",{className:"text-xs text-blue-600 font-mono break-all",children:"travelapp@upi"})})]}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Payment Details"}),(0,Dt.jsx)("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:(0,Dt.jsxs)("div",{className:"space-y-3",children:[(0,Dt.jsxs)("div",{className:"flex justify-between",children:[(0,Dt.jsx)("span",{className:"text-gray-600",children:"Type:"}),(0,Dt.jsx)("span",{className:"font-medium",children:h})]}),(0,Dt.jsxs)("div",{className:"flex justify-between",children:[(0,Dt.jsx)("span",{className:"text-gray-600",children:"ID:"}),(0,Dt.jsx)("span",{className:"font-mono text-sm",children:null===u||void 0===u?void 0:u.id})]}),(0,Dt.jsxs)("div",{className:"flex justify-between",children:[(0,Dt.jsx)("span",{className:"text-gray-600",children:"Amount:"}),(0,Dt.jsxs)("span",{className:"font-medium",children:["\u20b9",null===d||void 0===d?void 0:d.toLocaleString()]})]}),(0,Dt.jsx)("hr",{className:"my-3"}),(0,Dt.jsxs)("div",{className:"flex justify-between text-lg font-semibold",children:[(0,Dt.jsx)("span",{children:"Total:"}),(0,Dt.jsxs)("span",{className:"text-primary-600",children:["\u20b9",null===d||void 0===d?void 0:d.toLocaleString()]})]})]})}),(0,Dt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:(0,Dt.jsxs)("div",{className:"flex items-center",children:[(0,Dt.jsx)("svg",{className:"w-5 h-5 text-yellow-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Dt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,Dt.jsxs)("div",{children:[(0,Dt.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Important"}),(0,Dt.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:'After payment, click "I Have Paid" to confirm your booking.'})]})]})}),(0,Dt.jsxs)("div",{className:"space-y-3",children:[(0,Dt.jsx)("button",{onClick:()=>{o("processing"),setTimeout(()=>{const e=Lt(Lt({},u),{},{status:"Confirmed",details:Lt(Lt({},u.details),{},{Payment:"Completed"})});Dn(e),r(),o("success"),setTimeout(()=>{s("/dashboard",{state:{paymentSuccess:!0,bookingId:e.id,amount:d,shoppingConfirmed:!0}})},2e3)},1e3)},disabled:"processing"===i,className:"w-full bg-gradient-to-r from-green-600 to-green-700 text-white py-3 rounded-lg font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:"processing"===i?(0,Dt.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Dt.jsxs)("svg",{className:"animate-spin w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",children:[(0,Dt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Dt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"I Have Paid"}),(0,Dt.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to cancel the payment?")&&s("/trip-packages")},className:"w-full bg-gray-100 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-200 transition-colors",children:"Cancel Payment"})]})]})]})})]})})})};const bq=function(){return(0,Dt.jsx)(Ft,{children:(0,Dt.jsx)(Wt,{children:(0,Dt.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[(0,Dt.jsx)(Gt,{}),(0,Dt.jsx)("main",{className:"flex-grow",children:(0,Dt.jsxs)($e,{children:[(0,Dt.jsx)(Je,{path:"/",element:(0,Dt.jsx)(jG,{})}),(0,Dt.jsx)(Je,{path:"/dashboard",element:(0,Dt.jsx)(HG,{})}),(0,Dt.jsx)(Je,{path:"/recommendations",element:(0,Dt.jsx)(GG,{})}),(0,Dt.jsx)(Je,{path:"/safety",element:(0,Dt.jsx)(ZG,{})}),(0,Dt.jsx)(Je,{path:"/live-location",element:(0,Dt.jsx)(XG,{})}),(0,Dt.jsx)(Je,{path:"/community",element:(0,Dt.jsx)(YG,{})}),(0,Dt.jsx)(Je,{path:"/booking",element:(0,Dt.jsx)(Qn,{})}),(0,Dt.jsx)(Je,{path:"/hotels-restaurants",element:(0,Dt.jsx)(ta,{})}),(0,Dt.jsx)(Je,{path:"/trip-packages",element:(0,Dt.jsx)(mq,{})}),(0,Dt.jsx)(Je,{path:"/admin",element:(0,Dt.jsx)(eq,{})}),(0,Dt.jsx)(Je,{path:"/attraction/:id",element:(0,Dt.jsx)(rq,{})}),(0,Dt.jsx)(Je,{path:"/booking/cabs",element:(0,Dt.jsx)(iq,{})}),(0,Dt.jsx)(Je,{path:"/booking/bikes",element:(0,Dt.jsx)(oq,{})}),(0,Dt.jsx)(Je,{path:"/booking/train",element:(0,Dt.jsx)(lq,{})}),(0,Dt.jsx)(Je,{path:"/booking/metro",element:(0,Dt.jsx)(cq,{})}),(0,Dt.jsx)(Je,{path:"/booking/flight",element:(0,Dt.jsx)(uq,{})}),(0,Dt.jsx)(Je,{path:"/booking/Flight",element:(0,Dt.jsx)(uq,{})}),(0,Dt.jsx)(Je,{path:"/booking/auto",element:(0,Dt.jsx)(dq,{})}),(0,Dt.jsx)(Je,{path:"/login",element:(0,Dt.jsx)(tq,{})}),(0,Dt.jsx)(Je,{path:"/signup",element:(0,Dt.jsx)(nq,{})}),(0,Dt.jsx)(Je,{path:"/cart",element:(0,Dt.jsx)(sq,{})}),(0,Dt.jsx)(Je,{path:"/payment",element:(0,Dt.jsx)(yq,{})}),(0,Dt.jsx)(Je,{path:"/privacy-policy",element:(0,Dt.jsx)(fq,{})}),(0,Dt.jsx)(Je,{path:"/terms-of-service",element:(0,Dt.jsx)(gq,{})}),(0,Dt.jsx)(Je,{path:"/cookie-policy",element:(0,Dt.jsx)(xq,{})}),(0,Dt.jsx)(Je,{path:"*",element:(0,Dt.jsx)(aq,{})})]})}),(0,Dt.jsx)(qt,{}),(0,Dt.jsx)(Ln,{position:"bottom-right",autoClose:3e3})]})})})};V.createRoot(document.getElementById("root")).render((0,Dt.jsx)(B.StrictMode,{children:(0,Dt.jsx)(ot,{basename:"/Trailbrazer--",children:(0,Dt.jsx)(bq,{})})}))})()})();
//# sourceMappingURL=main.b7fe0df0.js.map